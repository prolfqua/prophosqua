<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Kinase Activity (Kinase Library + GSEA) â€¢ prophosqua</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Kinase Activity (Kinase Library + GSEA)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">prophosqua</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/prolfqua/prophosqua/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="Analysis_KinaseLibrary_files/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
<script src="Analysis_KinaseLibrary_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="Analysis_KinaseLibrary_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="Analysis_KinaseLibrary_files/datatables-binding-0.34.0/datatables.js"></script><link href="Analysis_KinaseLibrary_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="Analysis_KinaseLibrary_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="Analysis_KinaseLibrary_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><script src="Analysis_KinaseLibrary_files/jszip-1.13.6/jszip.min.js"></script><link href="Analysis_KinaseLibrary_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="Analysis_KinaseLibrary_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="Analysis_KinaseLibrary_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="Analysis_KinaseLibrary_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="Analysis_KinaseLibrary_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="Analysis_KinaseLibrary_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="Analysis_KinaseLibrary_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="Analysis_KinaseLibrary_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="Analysis_KinaseLibrary_files/selectize-0.12.0/selectize.min.js"></script><link href="Analysis_KinaseLibrary_files/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="Analysis_KinaseLibrary_files/crosstalk-1.2.2/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Kinase Activity (Kinase Library + GSEA)</h1>
            <h3 data-toc-skip class="subtitle">DPA</h3>
                        <h4 data-toc-skip class="author">FGCZ</h4>
            
            <h4 data-toc-skip class="date">17 February, 2026</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/prolfqua/prophosqua/blob/HEAD/vignettes/Analysis_KinaseLibrary.Rmd" class="external-link"><code>vignettes/Analysis_KinaseLibrary.Rmd</code></a></small>
      <div class="d-none name"><code>Analysis_KinaseLibrary.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>This report demonstrates kinase activity inference using the
<strong>Kinase Library</strong> motif predictions. Unlike PTMsigDB
(which uses curated kinase-substrate relationships), Kinase Library
predicts kinase-substrate assignments based on position-specific scoring
matrices (PSSMs) derived from peptide library screens.</p>
<p>We use the <code>term2gene.csv</code> file generated by the
<code>scan-motifs</code> CLI, which contains kinase-sequence
assignments.</p>
<p><strong>Approach:</strong> GSEA (Gene Set Enrichment Analysis) using
ranked phosphosite statistics.</p>
</div>
<div class="section level3">
<h3 id="analysis-details">Analysis Details<a class="anchor" aria-label="anchor" href="#analysis-details"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Analysis Type</td>
<td>DPA</td>
</tr>
<tr class="even">
<td>Mode</td>
<td>Vignette</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="load-data-and-kinase-library-predictions">Load Data and Kinase Library Predictions<a class="anchor" aria-label="anchor" href="#load-data-and-kinase-library-predictions"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/contribution-knowledge-mining/" class="external-link">clusterProfiler</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/contribution-knowledge-mining/" class="external-link">enrichplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ropensci.r-universe.dev/writexl" class="external-link">writexl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prolfqua.github.io/prophosqua">prophosqua</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="va">pipeline_mode</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Pipeline mode: load from files</span></span>
<span>  <span class="co"># Use explicit sheet param if provided, otherwise use analysis type as sheet name</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">sheet</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sheet_name</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">sheet</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co"># Default: use analysis type as sheet name (works for combined PTM_results.xlsx)</span></span>
<span>    <span class="va">sheet_name</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">analysis_type</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Load differential analysis data</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_xlsx</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">xlsx_file</span>, sheet <span class="op">=</span> <span class="va">sheet_name</span><span class="op">)</span></span>
<span>  <span class="va">output_dir</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">output_dir</span><span class="op">)</span><span class="op">)</span> <span class="va">params</span><span class="op">$</span><span class="va">output_dir</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">xlsx_file</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Define config for stat_col (used in GSEA ranking)</span></span>
<span>  <span class="co"># Combined PTM_results.xlsx uses standardized column names</span></span>
<span>  <span class="va">config</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    sheet <span class="op">=</span> <span class="va">sheet_name</span>,</span>
<span>    stat_col <span class="op">=</span> <span class="st">"statistic.site"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="co"># Vignette mode: use example data</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"combined_test_diff_example"</span>, package <span class="op">=</span> <span class="st">"prophosqua"</span><span class="op">)</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">combined_test_diff_example</span></span>
<span>  <span class="va">output_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Define config for vignette mode</span></span>
<span>  <span class="va">config</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    sheet <span class="op">=</span> <span class="st">"DPA"</span>,</span>
<span>    stat_col <span class="op">=</span> <span class="st">"statistic.site"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Ensure SequenceWindow column exists</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"SequenceWindow"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="st">"PTM_FlankingRegion"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>SequenceWindow <span class="op">=</span> <span class="va">PTM_FlankingRegion</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">data_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Property <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rows"</span>, <span class="st">"Columns"</span>, <span class="st">"Contrasts"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">contrast</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">data_info</span>, caption <span class="op">=</span> <span class="st">"Differential Analysis Data"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Differential Analysis Data</caption>
<colgroup>
<col width="12%">
<col width="87%">
</colgroup>
<thead><tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Rows</td>
<td align="left">105824</td>
</tr>
<tr class="even">
<td align="left">Columns</td>
<td align="left">56</td>
</tr>
<tr class="odd">
<td align="left">Contrasts</td>
<td align="left">KO_vs_WT, KO_vs_WT_at_Early, KO_vs_WT_at_Late,
KO_vs_WT_at_Uninfect</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load term2gene - try multiple sources</span></span>
<span><span class="va">term2gene_file</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">term2gene_file</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">term2gene_file</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">term2gene_file</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Try bundled resource (compressed)</span></span>
<span>  <span class="va">bundled_zip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"term2gene.csv.zip"</span>, package <span class="op">=</span> <span class="st">"prophosqua"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">bundled_zip</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">temp_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">bundled_zip</span>, exdir <span class="op">=</span> <span class="va">temp_dir</span><span class="op">)</span></span>
<span>    <span class="va">term2gene_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_dir</span>, <span class="st">"term2gene.csv"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Using bundled term2gene from prophosqua package"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">term2gene_file</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">term2gene_file</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"term2gene file not found. Provide via params$term2gene_file or install prophosqua with bundled data."</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Load term2gene from scan-motifs output</span></span>
<span><span class="va">term2gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">term2gene_file</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kl_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Property <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Total assignments"</span>, <span class="st">"Unique kinases"</span>, <span class="st">"Unique sequences"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">term2gene</span><span class="op">)</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">term2gene</span><span class="op">$</span><span class="va">term</span><span class="op">)</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">term2gene</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">kl_info</span>, caption <span class="op">=</span> <span class="st">"Kinase Library Predictions"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Kinase Library Predictions</caption>
<thead><tr class="header">
<th align="left">Property</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Total assignments</td>
<td align="right">384764</td>
</tr>
<tr class="even">
<td align="left">Unique kinases</td>
<td align="right">311</td>
</tr>
<tr class="odd">
<td align="left">Unique sequences</td>
<td align="right">18935</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IMPORTANT: Kinase Library sequences have lowercase letters for phosphorylated residues</span></span>
<span><span class="co"># (e.g., "PETITIRsGPPSPLP"). Convert to uppercase to match our data.</span></span>
<span><span class="va">term2gene</span> <span class="op">&lt;-</span> <span class="va">term2gene</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Keep as TERM2GENE format for clusterProfiler GSEA</span></span>
<span><span class="va">term2gene_df</span> <span class="op">&lt;-</span> <span class="va">term2gene</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">term</span>, <span class="va">gene</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Vignette mode: subsample to 50 kinase sets for speed</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">pipeline_mode</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span>  <span class="va">keep_sets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">term2gene_df</span><span class="op">$</span><span class="va">term</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">term2gene_df</span><span class="op">$</span><span class="va">term</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">term2gene_df</span> <span class="op">&lt;-</span> <span class="va">term2gene_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">keep_sets</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Vignette mode: subsampled to "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">keep_sets</span><span class="op">)</span>, <span class="st">" kinase sets"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="kinase-substrate-assignment-statistics">Kinase-Substrate Assignment Statistics<a class="anchor" aria-label="anchor" href="#kinase-substrate-assignment-statistics"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">our_sequences</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">SequenceWindow</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/trimws.html" class="external-link">trimws</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">assigned_sequences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">term2gene</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span></span>
<span><span class="va">overlap_seqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">our_sequences</span>, <span class="va">assigned_sequences</span><span class="op">)</span></span>
<span></span>
<span><span class="va">assignment_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Phosphosites in differential analysis"</span>,</span>
<span>             <span class="st">"Sites with kinase assignments"</span>,</span>
<span>             <span class="st">"Sites usable for GSEA"</span>,</span>
<span>             <span class="st">"Coverage (%)"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">our_sequences</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">assigned_sequences</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">overlap_seqs</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">overlap_seqs</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">our_sequences</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">assignment_stats</span>, caption <span class="op">=</span> <span class="st">"Assignment Statistics"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Assignment Statistics</caption>
<thead><tr class="header">
<th align="left">Metric</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Phosphosites in differential analysis</td>
<td align="right">21683.0</td>
</tr>
<tr class="even">
<td align="left">Sites with kinase assignments</td>
<td align="right">18902.0</td>
</tr>
<tr class="odd">
<td align="left">Sites usable for GSEA</td>
<td align="right">18902.0</td>
</tr>
<tr class="even">
<td align="left">Coverage (%)</td>
<td align="right">87.2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate kinase set sizes from term2gene</span></span>
<span><span class="va">kinase_sizes</span> <span class="op">&lt;-</span> <span class="va">term2gene_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">term</span>, name <span class="op">=</span> <span class="st">"size"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kinase_overlap</span> <span class="op">&lt;-</span> <span class="va">term2gene_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gene</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">our_sequences</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">term</span>, name <span class="op">=</span> <span class="st">"overlap"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kinase_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Number of kinases"</span>, <span class="st">"Mean substrates/kinase"</span>, <span class="st">"Median substrates/kinase"</span>,</span>
<span>             <span class="st">"Range (min-max)"</span>, <span class="st">"Mean substrates in our data"</span>,</span>
<span>             <span class="st">"Kinases with &gt;= 15 substrates"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">kinase_sizes</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">kinase_sizes</span><span class="op">$</span><span class="va">size</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">kinase_sizes</span><span class="op">$</span><span class="va">size</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">kinase_sizes</span><span class="op">$</span><span class="va">size</span><span class="op">)</span>, <span class="st">"-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">kinase_sizes</span><span class="op">$</span><span class="va">size</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">kinase_overlap</span><span class="op">$</span><span class="va">overlap</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">kinase_overlap</span><span class="op">$</span><span class="va">overlap</span> <span class="op">&gt;=</span> <span class="fl">15</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">kinase_stats</span>, caption <span class="op">=</span> <span class="st">"Kinase Set Size Distribution"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Kinase Set Size Distribution</caption>
<thead><tr class="header">
<th align="left">Metric</th>
<th align="left">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Number of kinases</td>
<td align="left">50</td>
</tr>
<tr class="even">
<td align="left">Mean substrates/kinase</td>
<td align="left">1246</td>
</tr>
<tr class="odd">
<td align="left">Median substrates/kinase</td>
<td align="left">1299.5</td>
</tr>
<tr class="even">
<td align="left">Range (min-max)</td>
<td align="left">593 - 1694</td>
</tr>
<tr class="odd">
<td align="left">Mean substrates in our data</td>
<td align="left">1246</td>
</tr>
<tr class="even">
<td align="left">Kinases with &gt;= 15 substrates</td>
<td align="left">50</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="prepare-ranked-lists">Prepare Ranked Lists<a class="anchor" aria-label="anchor" href="#prepare-ranked-lists"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare ranked lists using prophosqua function</span></span>
<span><span class="va">ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_gsea_ranks.html">prepare_gsea_ranks</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  stat_col <span class="op">=</span> <span class="va">config</span><span class="op">$</span><span class="va">stat_col</span>,</span>
<span>  seq_col <span class="op">=</span> <span class="st">"SequenceWindow"</span>,</span>
<span>  contrast_col <span class="op">=</span> <span class="st">"contrast"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ranks_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span>,</span>
<span>  Sites <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">ranks</span>, <span class="va">length</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">ranks_info</span>, caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">analysis_type</span>, <span class="st">"Ranks Prepared"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>DPA Ranks Prepared</caption>
<thead><tr class="header">
<th align="left">Contrast</th>
<th align="right">Sites</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KO_vs_WT</td>
<td align="right">21682</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Early</td>
<td align="right">21682</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Late</td>
<td align="right">21682</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Uninfect</td>
<td align="right">21682</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="gsea-analysis">GSEA Analysis<a class="anchor" aria-label="anchor" href="#gsea-analysis"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gsea_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">ct</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/GSEA.html" class="external-link">GSEA</a></span><span class="op">(</span></span>
<span>      geneList <span class="op">=</span> <span class="va">ranks</span><span class="op">[[</span><span class="va">ct</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      TERM2GENE <span class="op">=</span> <span class="va">term2gene_df</span>,</span>
<span>      minGSSize <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">min_size</span>,</span>
<span>      maxGSSize <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">max_size</span>,</span>
<span>      pvalueCutoff <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>      nPermSimple <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n_perm</span>,</span>
<span>      verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gsea_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gsea_results</span><span class="op">)</span>,</span>
<span>  `Significant Kinases (FDR &lt; 0.25)` <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">gsea_results</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">.x</span><span class="op">@</span><span class="va">result</span><span class="op">$</span><span class="va">p.adjust</span> <span class="op">&lt;</span> <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">gsea_info</span>, caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">analysis_type</span>, <span class="st">"GSEA Results Summary"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>DPA GSEA Results Summary</caption>
<thead><tr class="header">
<th align="left">Contrast</th>
<th align="right">Significant Kinases (FDR &lt; 0.25)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KO_vs_WT</td>
<td align="right">29</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Early</td>
<td align="right">35</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Late</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Uninfect</td>
<td align="right">41</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">has_gsea_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">gsea_results</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.x</span><span class="op">@</span><span class="va">result</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\n# No GSEA Results\n\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"No kinase gene sets passed the size filter (min_size="</span>, <span class="va">params</span><span class="op">$</span><span class="va">min_size</span>, <span class="st">").\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"This typically means too few phosphosites overlap with kinase library assignments.\n\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"**Coverage was:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">overlap_seqs</span><span class="op">)</span>, <span class="st">"sites out of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">our_sequences</span><span class="op">)</span>, <span class="st">"**\n\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="tabset tabset-pills" id="results-by-contrast">Results by Contrast<a class="anchor" aria-label="anchor" href="#results-by-contrast"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract all results into data frame using shared function</span></span>
<span><span class="va">all_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_gsea_results.html">extract_gsea_results</a></span><span class="op">(</span><span class="va">gsea_results</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>kinase <span class="op">=</span> <span class="va">ID</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">ctr</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">all_clean</span><span class="op">$</span><span class="va">contrast</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\n## "</span>, <span class="va">ctr</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">ctr_data</span> <span class="op">&lt;-</span> <span class="va">all_clean</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">contrast</span> <span class="op">==</span> <span class="va">ctr</span><span class="op">)</span></span>
<span>  <span class="va">n_sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ctr_data</span><span class="op">$</span><span class="va">p.adjust</span> <span class="op">&lt;</span> <span class="fl">0.1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"**Significant kinases (FDR &lt; 0.1):** "</span>, <span class="va">n_sig</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Using shared dotplot function</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_enrichment_dotplot.html">plot_enrichment_dotplot</a></span><span class="op">(</span></span>
<span>    <span class="va">ctr_data</span>,</span>
<span>    item_col <span class="op">=</span> <span class="st">"kinase"</span>,</span>
<span>    fdr_col <span class="op">=</span> <span class="st">"p.adjust"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">analysis_type</span>, <span class="st">" - "</span>, <span class="va">ctr</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Top 30 kinases by FDR"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Significant kinases table</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"**Significant Kinases (FDR &lt; 0.1):**\n\n"</span><span class="op">)</span></span>
<span>  <span class="va">sig_table</span> <span class="op">&lt;-</span> <span class="va">ctr_data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p.adjust</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">kinase</span>, <span class="va">NES</span>, <span class="va">pvalue</span>, FDR <span class="op">=</span> <span class="va">p.adjust</span>, <span class="va">setSize</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">FDR</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">htmltools</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>    <span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">sig_table</span>,</span>
<span>                  extensions <span class="op">=</span> <span class="st">'Buttons'</span>,</span>
<span>                  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pageLength <span class="op">=</span> <span class="fl">15</span>, scrollX <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 dom <span class="op">=</span> <span class="st">'Bfrtip'</span>, buttons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level3">
<h3 id="ko_vs_wt">KO_vs_WT<a class="anchor" aria-label="anchor" href="#ko_vs_wt"></a>
</h3>
<p><strong>Significant kinases (FDR &lt; 0.1):</strong> 26</p>
<p><img src="Analysis_KinaseLibrary_files/figure-html/contrastPlots-1.png" class="r-plt" alt="" width="1152"></p>
<p><strong>Significant Kinases (FDR &lt; 0.1):</strong></p>
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" class="datatables html-widget html-fill-item" style="width:100%;height:auto;">

</div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26"],["CDK2","CDK3","TBK1","CDK1","YSK4","NLK","IKKA","RAF1","TLK2","CDK16","MINK","CDKL5","SRPK2","PLK4","TLK1","MEK2","ICK","MARK4","EEF2K","TTBK1","ANKRD3","DYRK3","NEK9","WNK3","JNK2","CK1D"],[-2.4046,-2.3784,2.2668,-2.1162,2.0959,-1.6846,1.6633,1.5857,1.6784,-1.5114,1.4422,-1.3053,-1.2848,1.3038,1.3357,1.3224,-1.2364,1.2225,-1.2552,1.2105,1.2038,-1.1446,1.212,-1.1689,-1.143,1.1381],[0,0,0,0,0,0,0,0,0,0,0,0.0001,0.0002,0.0004,0.0005,0.0007,0.0016,0.0022,0.0068,0.0071,0.0127,0.0238,0.0257,0.0269,0.0397,0.0401],[0,0,0,0,0,0,0,0,0,0,0,0.0004,0.0007,0.0016,0.0018,0.0023,0.0048,0.0061,0.0177,0.0177,0.0303,0.054,0.0559,0.0561,0.0771,0.0771],[1519,1575,966,1557,788,1579,1158,1272,760,1482,855,1522,1667,832,728,644,1505,1155,808,808,868,1677,593,1495,1326,979]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>kinase<\/th>\n      <th>NES<\/th>\n      <th>pvalue<\/th>\n      <th>FDR<\/th>\n      <th>setSize<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":15,"scrollX":true,"dom":"Bfrtip","buttons":["copy","csv","excel"],"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"kinase","targets":1},{"name":"NES","targets":2},{"name":"pvalue","targets":3},{"name":"FDR","targets":4},{"name":"setSize","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="ko_vs_wt_at_early">KO_vs_WT_at_Early<a class="anchor" aria-label="anchor" href="#ko_vs_wt_at_early"></a>
</h3>
<p><strong>Significant kinases (FDR &lt; 0.1):</strong> 26</p>
<p><img src="Analysis_KinaseLibrary_files/figure-html/contrastPlots-2.png" class="r-plt" alt="" width="1152"></p>
<p><strong>Significant Kinases (FDR &lt; 0.1):</strong></p>
<div id="htmlwidget-e5c8c404fe174e4c81bd" class="datatables html-widget html-fill-item" style="width:100%;height:auto;">

</div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26"],["CDK2","CDK3","CDK1","TBK1","YSK4","NLK","TLK2","CDK16","IKKA","RAF1","CDKL5","WNK3","PHKG2","AMPKA1","SRPK2","PHKG1","NUAK1","TLK1","ICK","EEF2K","HRI","MEKK6","MINK","TSSK2","DCAMKL2","DYRK3"],[-2.2863,-2.203,-1.9155,1.7901,1.785,-1.5574,1.5759,-1.3801,1.368,1.3419,-1.3394,-1.3311,-1.3325,-1.3134,-1.2898,-1.2799,-1.2503,1.2789,-1.1959,-1.2473,-1.2401,-1.2053,1.1608,-1.1707,-1.1469,-1.1313],[0,0,0,0,0,0,0,0,0,0,0,0,0.0001,0.0001,0.0001,0.0004,0.0012,0.0032,0.006,0.0107,0.018,0.019,0.0269,0.0297,0.0351,0.0385],[0,0,0,0,0,0,0,0,0,0.0001,0.0002,0.0002,0.0003,0.0004,0.0004,0.0013,0.0035,0.008800000000000001,0.0157,0.0268,0.0429,0.0432,0.0585,0.0619,0.0702,0.074],[1519,1575,1557,966,788,1579,760,1482,1158,1272,1522,1495,1429,1517,1667,1329,1379,728,1505,808,690,950,855,1144,1453,1677]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>kinase<\/th>\n      <th>NES<\/th>\n      <th>pvalue<\/th>\n      <th>FDR<\/th>\n      <th>setSize<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":15,"scrollX":true,"dom":"Bfrtip","buttons":["copy","csv","excel"],"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"kinase","targets":1},{"name":"NES","targets":2},{"name":"pvalue","targets":3},{"name":"FDR","targets":4},{"name":"setSize","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="ko_vs_wt_at_late">KO_vs_WT_at_Late<a class="anchor" aria-label="anchor" href="#ko_vs_wt_at_late"></a>
</h3>
<p><strong>Significant kinases (FDR &lt; 0.1):</strong> 31</p>
<p><img src="Analysis_KinaseLibrary_files/figure-html/contrastPlots-3.png" class="r-plt" alt="" width="1152"></p>
<p><strong>Significant Kinases (FDR &lt; 0.1):</strong></p>
<div id="htmlwidget-36aa3d2a04d42bbc2145" class="datatables html-widget html-fill-item" style="width:100%;height:auto;">

</div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],["CDK2","CDK3","CDK1","TBK1","NLK","YSK4","BMPR1A","TLK2","CK1D","CDK16","TLK1","IKKA","EEF2K","PHKG2","WNK3","CDKL5","RAF1","SRPK2","PHKG1","NUAK1","PAK6","AMPKA1","MEK2","ICK","MINK","MEK5","MEKK6","PKCB","HRI","JNK2","MARK4"],[-2.6217,-2.5663,-2.1653,1.9826,-1.8214,1.8045,1.777,1.7653,1.6695,-1.5664,1.5553,1.4502,-1.457,-1.3857,-1.38,-1.3442,1.3358,-1.3137,-1.3188,-1.2694,-1.2293,-1.2307,1.1932,-1.1904,1.1752,-1.1763,-1.187,-1.1778,-1.2135,-1.1529,1.1307],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0001,0.001,0.0017,0.002,0.01,0.0106,0.0115,0.0165,0.0194,0.0192,0.0293,0.0329,0.0339],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0001,0.0004,0.0024,0.0041,0.0045,0.0218,0.022,0.023,0.0316,0.0346,0.0346,0.0505,0.0547,0.0547],[1519,1575,1557,966,1579,788,858,760,979,1482,728,1158,808,1429,1495,1522,1272,1667,1329,1379,1603,1517,644,1505,855,997,950,1254,690,1326,1155]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>kinase<\/th>\n      <th>NES<\/th>\n      <th>pvalue<\/th>\n      <th>FDR<\/th>\n      <th>setSize<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":15,"scrollX":true,"dom":"Bfrtip","buttons":["copy","csv","excel"],"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"kinase","targets":1},{"name":"NES","targets":2},{"name":"pvalue","targets":3},{"name":"FDR","targets":4},{"name":"setSize","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="ko_vs_wt_at_uninfect">KO_vs_WT_at_Uninfect<a class="anchor" aria-label="anchor" href="#ko_vs_wt_at_uninfect"></a>
</h3>
<p><strong>Significant kinases (FDR &lt; 0.1):</strong> 38</p>
<p><img src="Analysis_KinaseLibrary_files/figure-html/contrastPlots-4.png" class="r-plt" alt="" width="1152"></p>
<p><strong>Significant Kinases (FDR &lt; 0.1):</strong></p>
<div id="htmlwidget-febe03efa1a2d8d52a86" class="datatables html-widget html-fill-item" style="width:100%;height:auto;">

</div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38"],["TBK1","YSK4","IKKA","RAF1","CDK2","MINK","CDK3","PLK4","TTBK1","CDK1","MARK4","NIM1","IRAK1","BMPR1A","ANKRD3","PHKG2","MEK2","NEK9","CDK16","NUAK1","DCAMKL2","JNK2","MAP3K15","TLK2","PHKG1","MEK5","MEKK6","NLK","TSSK2","PKCB","TLK1","WNK3","ICK","HRI","YANK3","AMPKA1","DYRK3","SMMLCK"],[2.6903,2.4175,1.9699,1.9693,-1.8722,1.8687,-1.8671,1.8036,1.7631,-1.7585,1.5908,1.5726,1.5312,-1.5826,1.5644,1.4053,1.5529,1.5457,-1.378,1.3631,1.3536,-1.4026,1.4183,1.4282,1.3114,1.3595,1.3445,-1.3009,1.2764,1.2624,1.2654,1.1834,-1.1875,1.237,1.1417,1.1489,-1.1491,1.086],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0001,0.0001,0.0001,0.0002,0.0003,0.0005,0.0029,0.0072,0.0103,0.0121,0.0139,0.0184,0.031,0.0664],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0001,0.0001,0.0002,0.0003,0.0004,0.0005,0.0008,0.0046,0.0112,0.0156,0.0178,0.0198,0.0255,0.0419,0.08740000000000001],[966,788,1158,1272,1519,855,1575,832,808,1557,1155,1200,1058,858,868,1429,644,593,1482,1379,1453,1326,847,760,1329,997,950,1579,1144,1254,728,1495,1505,690,1689,1517,1677,1674]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>kinase<\/th>\n      <th>NES<\/th>\n      <th>pvalue<\/th>\n      <th>FDR<\/th>\n      <th>setSize<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":15,"scrollX":true,"dom":"Bfrtip","buttons":["copy","csv","excel"],"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"kinase","targets":1},{"name":"NES","targets":2},{"name":"pvalue","targets":3},{"name":"FDR","targets":4},{"name":"setSize","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level2">
<h2 class="tabset tabset-pills" id="clusterprofiler-dotplots">clusterProfiler Dotplots<a class="anchor" aria-label="anchor" href="#clusterprofiler-dotplots"></a>
</h2>
<div class="section level4">
<h4 id="merged-dotplot">Merged Dotplot<a class="anchor" aria-label="anchor" href="#merged-dotplot"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/merge_result.html" class="external-link">merge_result</a></span><span class="op">(</span><span class="va">gsea_results</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html" class="external-link">dotplot</a></span><span class="op">(</span><span class="va">merged</span>, showCategory <span class="op">=</span> <span class="fl">15</span>,</span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">analysis_type</span>, <span class="st">"GSEA - Kinase Library (FDR &lt; 0.25)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Analysis_KinaseLibrary_files/figure-html/merged-dotplot-1.png" class="r-plt" alt="" width="1344"></p>
</div>
<div class="section level4">
<h4 id="individual-contrasts">Individual Contrasts<a class="anchor" aria-label="anchor" href="#individual-contrasts"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gsea_results</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">ct</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">gsea_results</span><span class="op">[[</span><span class="va">ct</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">result</span></span>
<span>    <span class="co"># Skip if no results</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">NES</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.5</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ct</span>, <span class="st">"\nNo significant kinases"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="va">ct</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html" class="external-link">dotplot</a></span><span class="op">(</span><span class="va">gsea_results</span><span class="op">[[</span><span class="va">ct</span><span class="op">]</span><span class="op">]</span>, showCategory <span class="op">=</span> <span class="fl">15</span>, title <span class="op">=</span> <span class="va">ct</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">plots</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Analysis_KinaseLibrary_files/figure-html/individual-dotplots-1.png" class="r-plt" alt="" width="1344"></p>
</div>
<div class="section level4">
<h4 id="nes-heatmap">NES Heatmap<a class="anchor" aria-label="anchor" href="#nes-heatmap"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using shared heatmap function</span></span>
<span><span class="fu"><a href="../reference/plot_enrichment_heatmap.html">plot_enrichment_heatmap</a></span><span class="op">(</span></span>
<span>  <span class="va">all_clean</span>,</span>
<span>  item_col <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>  fdr_col <span class="op">=</span> <span class="st">"p.adjust"</span>,</span>
<span>  fdr_filter <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  n_top <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">analysis_type</span>, <span class="st">"- Top Kinases by NES"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Analysis_KinaseLibrary_files/figure-html/nes-heatmap-1.png" class="r-plt" alt="" width="1152"></p>
</div>
</div>
<div class="section level2">
<h2 id="volcano-plot">Volcano Plot<a class="anchor" aria-label="anchor" href="#volcano-plot"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using shared volcano function</span></span>
<span><span class="fu"><a href="../reference/plot_enrichment_volcano.html">plot_enrichment_volcano</a></span><span class="op">(</span></span>
<span>  <span class="va">all_clean</span>,</span>
<span>  item_col <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>  fdr_col <span class="op">=</span> <span class="st">"p.adjust"</span>,</span>
<span>  title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">analysis_type</span>, <span class="st">"- GSEA Volcano Plots"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Analysis_KinaseLibrary_files/figure-html/volcano-plot-1.png" class="r-plt" alt="" width="1152"></p>
</div>
<div class="section level2">
<h2 id="diagnostics">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pval_diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gsea_results</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">ct</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">gsea_results</span><span class="op">[[</span><span class="va">ct</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">result</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      Contrast <span class="op">=</span> <span class="va">ct</span>,</span>
<span>      `Min p-value` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">pvalue</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      `p &lt; 0.05` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">pvalue</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      `p &lt; 0.01` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">pvalue</span> <span class="op">&lt;</span> <span class="fl">0.01</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      Total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">pval_diag</span>, caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Raw p-value Distribution ("</span>, <span class="va">params</span><span class="op">$</span><span class="va">analysis_type</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Raw p-value Distribution ( DPA )</caption>
<thead><tr class="header">
<th align="left">Contrast</th>
<th align="right">Min p-value</th>
<th align="right">p &lt; 0.05</th>
<th align="right">p &lt; 0.01</th>
<th align="right">Total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KO_vs_WT</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">20</td>
<td align="right">29</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Early</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">19</td>
<td align="right">35</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Late</td>
<td align="right">0</td>
<td align="right">31</td>
<td align="right">22</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Uninfect</td>
<td align="right">0</td>
<td align="right">37</td>
<td align="right">32</td>
<td align="right">41</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="export-all-gsea-plots-to-pdf">Export All GSEA Plots to PDF<a class="anchor" aria-label="anchor" href="#export-all-gsea-plots-to-pdf"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Export all GSEA enrichment plots to PDF using shared function</span></span>
<span><span class="va">pdf_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"GSEA_plots_"</span>, <span class="va">params</span><span class="op">$</span><span class="va">analysis_type</span>, <span class="st">".pdf"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">n_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/export_gsea_plots_pdf.html">export_gsea_plots_pdf</a></span><span class="op">(</span><span class="va">gsea_results</span>, <span class="va">pdf_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Exported"</span>, <span class="va">n_plots</span>, <span class="st">"GSEA plots to:"</span>, <span class="va">pdf_file</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Vignette mode: skip PDF export</span></span>
<span><span class="va">n_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">gsea_results</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.x</span><span class="op">@</span><span class="va">result</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Vignette mode: PDF export skipped. Would export "</span>, <span class="va">n_plots</span>, <span class="st">" plots."</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="tabset tabset-pills" id="gsea-enrichment-plots">GSEA Enrichment Plots<a class="anchor" aria-label="anchor" href="#gsea-enrichment-plots"></a>
</h2>
<p>Showing top 3 plots per contrast.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">ct</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gsea_results</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\n### "</span>, <span class="va">ct</span>, <span class="st">" {.tabset}\n\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">gsea_results</span><span class="op">[[</span><span class="va">ct</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">top10</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">@</span><span class="va">result</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">pvalue</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">top_genesets</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">top10</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">geneset</span> <span class="op">&lt;-</span> <span class="va">top10</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\n#### "</span>, <span class="va">geneset</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">row</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">@</span><span class="va">result</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">==</span> <span class="va">geneset</span><span class="op">)</span></span>
<span>    <span class="va">nes_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">row</span><span class="op">$</span><span class="va">NES</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">fdr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="va">row</span><span class="op">$</span><span class="va">p.adjust</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/gseaplot2.html" class="external-link">gseaplot2</a></span><span class="op">(</span><span class="va">res</span>, geneSetID <span class="op">=</span> <span class="va">geneset</span>,</span>
<span>      title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">geneset</span>, <span class="st">" (NES="</span>, <span class="va">nes_val</span>, <span class="st">", FDR="</span>, <span class="va">fdr</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level4">
<h4 class="tabset" id="ko_vs_wt-1">KO_vs_WT<a class="anchor" aria-label="anchor" href="#ko_vs_wt-1"></a>
</h4>
<div class="section level5">
<h5 id="cdk2">CDK2<a class="anchor" aria-label="anchor" href="#cdk2"></a>
</h5>
<p><img src="Analysis_KinaseLibrary_files/figure-html/gsea-example-plots-1.png" class="r-plt" alt="" width="960"></p>
</div>
<div class="section level5">
<h5 id="cdk3">CDK3<a class="anchor" aria-label="anchor" href="#cdk3"></a>
</h5>
<p><img src="Analysis_KinaseLibrary_files/figure-html/gsea-example-plots-2.png" class="r-plt" alt="" width="960"></p>
</div>
<div class="section level5">
<h5 id="tbk1">TBK1<a class="anchor" aria-label="anchor" href="#tbk1"></a>
</h5>
<p><img src="Analysis_KinaseLibrary_files/figure-html/gsea-example-plots-3.png" class="r-plt" alt="" width="960"></p>
</div>
</div>
<div class="section level4">
<h4 class="tabset" id="ko_vs_wt_at_early-1">KO_vs_WT_at_Early<a class="anchor" aria-label="anchor" href="#ko_vs_wt_at_early-1"></a>
</h4>
<div class="section level5">
<h5 id="cdk2-1">CDK2<a class="anchor" aria-label="anchor" href="#cdk2-1"></a>
</h5>
<p><img src="Analysis_KinaseLibrary_files/figure-html/gsea-example-plots-4.png" class="r-plt" alt="" width="960"></p>
</div>
<div class="section level5">
<h5 id="cdk3-1">CDK3<a class="anchor" aria-label="anchor" href="#cdk3-1"></a>
</h5>
<p><img src="Analysis_KinaseLibrary_files/figure-html/gsea-example-plots-5.png" class="r-plt" alt="" width="960"></p>
</div>
<div class="section level5">
<h5 id="cdk1">CDK1<a class="anchor" aria-label="anchor" href="#cdk1"></a>
</h5>
<p><img src="Analysis_KinaseLibrary_files/figure-html/gsea-example-plots-6.png" class="r-plt" alt="" width="960"></p>
</div>
</div>
<div class="section level4">
<h4 class="tabset" id="ko_vs_wt_at_late-1">KO_vs_WT_at_Late<a class="anchor" aria-label="anchor" href="#ko_vs_wt_at_late-1"></a>
</h4>
<div class="section level5">
<h5 id="cdk2-2">CDK2<a class="anchor" aria-label="anchor" href="#cdk2-2"></a>
</h5>
<p><img src="Analysis_KinaseLibrary_files/figure-html/gsea-example-plots-7.png" class="r-plt" alt="" width="960"></p>
</div>
<div class="section level5">
<h5 id="cdk3-2">CDK3<a class="anchor" aria-label="anchor" href="#cdk3-2"></a>
</h5>
<p><img src="Analysis_KinaseLibrary_files/figure-html/gsea-example-plots-8.png" class="r-plt" alt="" width="960"></p>
</div>
<div class="section level5">
<h5 id="cdk1-1">CDK1<a class="anchor" aria-label="anchor" href="#cdk1-1"></a>
</h5>
<p><img src="Analysis_KinaseLibrary_files/figure-html/gsea-example-plots-9.png" class="r-plt" alt="" width="960"></p>
</div>
</div>
<div class="section level4">
<h4 class="tabset" id="ko_vs_wt_at_uninfect-1">KO_vs_WT_at_Uninfect<a class="anchor" aria-label="anchor" href="#ko_vs_wt_at_uninfect-1"></a>
</h4>
<div class="section level5">
<h5 id="tbk1-1">TBK1<a class="anchor" aria-label="anchor" href="#tbk1-1"></a>
</h5>
<p><img src="Analysis_KinaseLibrary_files/figure-html/gsea-example-plots-10.png" class="r-plt" alt="" width="960"></p>
</div>
<div class="section level5">
<h5 id="ysk4">YSK4<a class="anchor" aria-label="anchor" href="#ysk4"></a>
</h5>
<p><img src="Analysis_KinaseLibrary_files/figure-html/gsea-example-plots-11.png" class="r-plt" alt="" width="960"></p>
</div>
<div class="section level5">
<h5 id="ikka">IKKA<a class="anchor" aria-label="anchor" href="#ikka"></a>
</h5>
<p><img src="Analysis_KinaseLibrary_files/figure-html/gsea-example-plots-12.png" class="r-plt" alt="" width="960"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="all-results">All Results<a class="anchor" aria-label="anchor" href="#all-results"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All kinases across all contrasts</span></span>
<span><span class="va">all_results_dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gsea_results</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">ct</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">gsea_results</span><span class="op">[[</span><span class="va">ct</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">result</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>contrast <span class="op">=</span> <span class="va">ct</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">contrast</span>, kinase <span class="op">=</span> <span class="va">ID</span>, <span class="va">NES</span>, <span class="va">pvalue</span>, FDR <span class="op">=</span> <span class="va">p.adjust</span>, <span class="va">setSize</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">FDR</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">all_results_dt</span>,</span>
<span>  filter <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>  extensions <span class="op">=</span> <span class="st">'Buttons'</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pageLength <span class="op">=</span> <span class="fl">15</span>, scrollX <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 dom <span class="op">=</span> <span class="st">'Bfrtip'</span>, buttons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"All kinases across all contrasts"</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-1fb4450895fe099f74a1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-2.6217\" data-max=\"2.6903\" data-scale=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.1563\" data-scale=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.2233\" data-scale=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"593\" data-max=\"1689\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"caption":"<caption>All kinases across all contrasts<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140"],["KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Early","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Late","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect","KO_vs_WT_at_Uninfect"],["CDK2","CDK3","TBK1","CDK1","YSK4","NLK","IKKA","RAF1","TLK2","CDK16","MINK","CDKL5","SRPK2","PLK4","TLK1","MEK2","ICK","MARK4","EEF2K","TTBK1","ANKRD3","DYRK3","NEK9","WNK3","JNK2","CK1D","NIM1","PAK6","AMPKA1","CDK2","CDK3","CDK1","TBK1","YSK4","NLK","TLK2","CDK16","IKKA","RAF1","CDKL5","WNK3","PHKG2","AMPKA1","SRPK2","PHKG1","NUAK1","TLK1","ICK","EEF2K","HRI","MEKK6","MINK","TSSK2","DCAMKL2","DYRK3","PRKD1","MEK5","PAK6","NIM1","BMPR1A","CK1D","YANK3","RSK3","MEK2","CDK2","CDK3","CDK1","TBK1","NLK","YSK4","BMPR1A","TLK2","CK1D","CDK16","TLK1","IKKA","EEF2K","PHKG2","WNK3","CDKL5","RAF1","SRPK2","PHKG1","NUAK1","PAK6","AMPKA1","MEK2","ICK","MINK","MEK5","MEKK6","PKCB","HRI","JNK2","MARK4","ANKRD3","DCAMKL2","RSK3","PLK4","TBK1","YSK4","IKKA","RAF1","CDK2","MINK","CDK3","PLK4","TTBK1","CDK1","MARK4","NIM1","IRAK1","BMPR1A","ANKRD3","PHKG2","MEK2","NEK9","CDK16","NUAK1","DCAMKL2","JNK2","MAP3K15","TLK2","PHKG1","MEK5","MEKK6","NLK","TSSK2","PKCB","TLK1","WNK3","ICK","HRI","YANK3","AMPKA1","DYRK3","SMMLCK","PKACB","SRPK2","CDKL5"],[-2.4046,-2.3784,2.2668,-2.1162,2.0959,-1.6846,1.6633,1.5857,1.6784,-1.5114,1.4422,-1.3053,-1.2848,1.3038,1.3357,1.3224,-1.2364,1.2225,-1.2552,1.2105,1.2038,-1.1446,1.212,-1.1689,-1.143,1.1381,1.0915,-1.0862,-1.0732,-2.2863,-2.203,-1.9155,1.7901,1.785,-1.5574,1.5759,-1.3801,1.368,1.3419,-1.3394,-1.3311,-1.3325,-1.3134,-1.2898,-1.2799,-1.2503,1.2789,-1.1959,-1.2473,-1.2401,-1.2053,1.1608,-1.1707,-1.1469,-1.1313,1.0895,-1.1505,-1.1273,-1.1088,1.0859,1.0846,-1.0709,-1.0615,1.0924,-2.6217,-2.5663,-2.1653,1.9826,-1.8214,1.8045,1.777,1.7653,1.6695,-1.5664,1.5553,1.4502,-1.457,-1.3857,-1.38,-1.3442,1.3358,-1.3137,-1.3188,-1.2694,-1.2293,-1.2307,1.1932,-1.1904,1.1752,-1.1763,-1.187,-1.1778,-1.2135,-1.1529,1.1307,1.0525,-1.0703,-1.0687,1.0574,2.6903,2.4175,1.9699,1.9693,-1.8722,1.8687,-1.8671,1.8036,1.7631,-1.7585,1.5908,1.5726,1.5312,-1.5826,1.5644,1.4053,1.5529,1.5457,-1.378,1.3631,1.3536,-1.4026,1.4183,1.4282,1.3114,1.3595,1.3445,-1.3009,1.2764,1.2624,1.2654,1.1834,-1.1875,1.237,1.1417,1.1489,-1.1491,1.086,-1.0908,-1.0922,-1.0776],[0,0,0,0,0,0,0,0,0,0,0,0.0001,0.0002,0.0004,0.0005,0.0007,0.0016,0.0022,0.0068,0.0071,0.0127,0.0238,0.0257,0.0269,0.0397,0.0401,0.0741,0.0897,0.1126,0,0,0,0,0,0,0,0,0,0,0,0,0.0001,0.0001,0.0001,0.0004,0.0012,0.0032,0.006,0.0107,0.018,0.019,0.0269,0.0297,0.0351,0.0385,0.0557,0.0708,0.08260000000000001,0.0803,0.0863,0.0896,0.1214,0.1422,0.1563,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0001,0.001,0.0017,0.002,0.01,0.0106,0.0115,0.0165,0.0194,0.0192,0.0293,0.0329,0.0339,0.1132,0.1305,0.1561,0.155,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0001,0.0001,0.0001,0.0002,0.0003,0.0005,0.0029,0.0072,0.0103,0.0121,0.0139,0.0184,0.031,0.0664,0.1149,0.1368,0.1528],[0,0,0,0,0,0,0,0,0,0,0,0.0004,0.0007,0.0016,0.0018,0.0023,0.0048,0.0061,0.0177,0.0177,0.0303,0.054,0.0559,0.0561,0.0771,0.0771,0.1373,0.1602,0.1942,0,0,0,0,0,0,0,0,0,0.0001,0.0002,0.0002,0.0003,0.0004,0.0004,0.0013,0.0035,0.008800000000000001,0.0157,0.0268,0.0429,0.0432,0.0585,0.0619,0.0702,0.074,0.1032,0.1264,0.1377,0.1377,0.1392,0.1401,0.184,0.2091,0.2233,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0001,0.0004,0.0024,0.0041,0.0045,0.0218,0.022,0.023,0.0316,0.0346,0.0346,0.0505,0.0547,0.0547,0.1768,0.1977,0.223,0.223,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0001,0.0001,0.0002,0.0003,0.0004,0.0005,0.0008,0.0046,0.0112,0.0156,0.0178,0.0198,0.0255,0.0419,0.08740000000000001,0.1473,0.171,0.1863],[1519,1575,966,1557,788,1579,1158,1272,760,1482,855,1522,1667,832,728,644,1505,1155,808,808,868,1677,593,1495,1326,979,1200,1603,1517,1519,1575,1557,966,788,1579,760,1482,1158,1272,1522,1495,1429,1517,1667,1329,1379,728,1505,808,690,950,855,1144,1453,1677,1164,997,1603,1200,858,979,1689,1633,644,1519,1575,1557,966,1579,788,858,760,979,1482,728,1158,808,1429,1495,1522,1272,1667,1329,1379,1603,1517,644,1505,855,997,950,1254,690,1326,1155,868,1453,1633,832,966,788,1158,1272,1519,855,1575,832,808,1557,1155,1200,1058,858,868,1429,644,593,1482,1379,1453,1326,847,760,1329,997,950,1579,1144,1254,728,1495,1505,690,1689,1517,1677,1674,1676,1667,1522]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>contrast<\/th>\n      <th>kinase<\/th>\n      <th>NES<\/th>\n      <th>pvalue<\/th>\n      <th>FDR<\/th>\n      <th>setSize<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":15,"scrollX":true,"dom":"Bfrtip","buttons":["copy","csv","excel"],"columnDefs":[{"className":"dt-right","targets":[3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"contrast","targets":1},{"name":"kinase","targets":2},{"name":"NES","targets":3},{"name":"pvalue","targets":4},{"name":"FDR","targets":5},{"name":"setSize","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,15,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="export-results">Export Results<a class="anchor" aria-label="anchor" href="#export-results"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">output_dir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine all results</span></span>
<span><span class="va">all_results_export</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gsea_results</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">ct</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">gsea_results</span><span class="op">[[</span><span class="va">ct</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">result</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>contrast <span class="op">=</span> <span class="va">ct</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">contrast</span>, kinase <span class="op">=</span> <span class="va">ID</span>, <span class="va">NES</span>, <span class="va">pvalue</span>, FDR <span class="op">=</span> <span class="va">p.adjust</span>, <span class="va">setSize</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Export to Excel</span></span>
<span><span class="va">export_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  all_results <span class="op">=</span> <span class="va">all_results_export</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">FDR</span><span class="op">)</span>,</span>
<span>  significant <span class="op">=</span> <span class="va">all_results_export</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">FDR</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">FDR</span><span class="op">)</span>,</span>
<span>  summary <span class="op">=</span> <span class="va">gsea_info</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">xlsx_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"KinaseLib_GSEA_"</span>, <span class="va">params</span><span class="op">$</span><span class="va">analysis_type</span>, <span class="st">".xlsx"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">writexl</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/writexl//reference/write_xlsx.html" class="external-link">write_xlsx</a></span><span class="op">(</span><span class="va">export_list</span>, <span class="va">xlsx_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Exported Excel:"</span>, <span class="va">xlsx_file</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Export RDS with full clusterProfiler result objects</span></span>
<span><span class="va">rds_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"KinaseLib_GSEA_"</span>, <span class="va">params</span><span class="op">$</span><span class="va">analysis_type</span>, <span class="st">".rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">gsea_results</span>, <span class="va">rds_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Exported RDS:"</span>, <span class="va">rds_file</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Vignette mode: File export skipped."</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">## Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">## Running under: macOS Tahoe 26.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Zurich</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] prophosqua_0.3.0       DT_0.34.0              patchwork_1.3.2       </span></span>
<span><span class="co">##  [4] writexl_1.5.4          forcats_1.0.1          purrr_1.2.1           </span></span>
<span><span class="co">##  [7] enrichplot_1.30.3      ggplot2_4.0.2          readxl_1.4.5          </span></span>
<span><span class="co">## [10] tidyr_1.3.2            dplyr_1.2.0            clusterProfiler_4.18.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] DBI_1.2.3               gson_0.1.0              rlang_1.1.7            </span></span>
<span><span class="co">##   [4] magrittr_2.0.4          DOSE_4.4.0              otel_0.2.0             </span></span>
<span><span class="co">##   [7] compiler_4.5.2          RSQLite_2.4.5           png_0.1-8              </span></span>
<span><span class="co">##  [10] systemfonts_1.3.1       vctrs_0.7.1             reshape2_1.4.5         </span></span>
<span><span class="co">##  [13] stringr_1.6.0           pkgconfig_2.0.3         crayon_1.5.3           </span></span>
<span><span class="co">##  [16] fastmap_1.2.0           XVector_0.50.0          labeling_0.4.3         </span></span>
<span><span class="co">##  [19] rmarkdown_2.30          ragg_1.5.0              bit_4.6.0              </span></span>
<span><span class="co">##  [22] xfun_0.55               ggseqlogo_0.2.2         cachem_1.1.0           </span></span>
<span><span class="co">##  [25] aplot_0.2.9             jsonlite_2.0.0          blob_1.2.4             </span></span>
<span><span class="co">##  [28] BiocParallel_1.44.0     parallel_4.5.2          R6_2.6.1               </span></span>
<span><span class="co">##  [31] bslib_0.9.0             stringi_1.8.7           RColorBrewer_1.1-3     </span></span>
<span><span class="co">##  [34] cellranger_1.1.0        jquerylib_0.1.4         GOSemSim_2.36.0        </span></span>
<span><span class="co">##  [37] Rcpp_1.1.1              Seqinfo_1.0.0           bookdown_0.46          </span></span>
<span><span class="co">##  [40] knitr_1.51              ggtangle_0.0.9          R.utils_2.13.0         </span></span>
<span><span class="co">##  [43] IRanges_2.44.0          Matrix_1.7-4            splines_4.5.2          </span></span>
<span><span class="co">##  [46] igraph_2.2.1            tidyselect_1.2.1        qvalue_2.42.0          </span></span>
<span><span class="co">##  [49] yaml_2.3.12             codetools_0.2-20        lattice_0.22-7         </span></span>
<span><span class="co">##  [52] tibble_3.3.1            plyr_1.8.9              withr_3.0.2            </span></span>
<span><span class="co">##  [55] treeio_1.34.0           Biobase_2.70.0          KEGGREST_1.50.0        </span></span>
<span><span class="co">##  [58] S7_0.2.1                evaluate_1.0.5          gridGraphics_0.5-1     </span></span>
<span><span class="co">##  [61] desc_1.4.3              Biostrings_2.78.0       pillar_1.11.1          </span></span>
<span><span class="co">##  [64] ggtree_4.0.1            stats4_4.5.2            ggfun_0.2.0            </span></span>
<span><span class="co">##  [67] generics_0.1.4          S4Vectors_0.48.0        scales_1.4.0           </span></span>
<span><span class="co">##  [70] tidytree_0.4.6          glue_1.8.0              gdtools_0.4.4          </span></span>
<span><span class="co">##  [73] lazyeval_0.2.2          tools_4.5.2             data.table_1.18.0      </span></span>
<span><span class="co">##  [76] fgsea_1.36.0            ggiraph_0.9.2           fs_1.6.6               </span></span>
<span><span class="co">##  [79] fastmatch_1.1-6         cowplot_1.2.0           grid_4.5.2             </span></span>
<span><span class="co">##  [82] ape_5.8-1               crosstalk_1.2.2         AnnotationDbi_1.72.0   </span></span>
<span><span class="co">##  [85] nlme_3.1-168            cli_3.6.5               rappdirs_0.3.3         </span></span>
<span><span class="co">##  [88] textshaping_1.0.4       fontBitstreamVera_0.1.1 gtable_0.3.6           </span></span>
<span><span class="co">##  [91] R.methodsS3_1.8.2       yulab.utils_0.2.2       fontquiver_0.2.1       </span></span>
<span><span class="co">##  [94] sass_0.4.10             digest_0.6.39           BiocGenerics_0.56.0    </span></span>
<span><span class="co">##  [97] ggrepel_0.9.6           ggplotify_0.1.3         htmlwidgets_1.6.4      </span></span>
<span><span class="co">## [100] farver_2.1.2            memoise_2.0.1           htmltools_0.5.9        </span></span>
<span><span class="co">## [103] pkgdown_2.2.0           R.oo_1.27.1             lifecycle_1.0.5        </span></span>
<span><span class="co">## [106] httr_1.4.7              GO.db_3.22.0            fontLiberation_0.1.0   </span></span>
<span><span class="co">## [109] bit64_4.6.0-1</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonas Grossmann, Witold Wolski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
