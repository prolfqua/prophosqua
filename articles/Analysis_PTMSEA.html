<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data â€¢ prophosqua</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">prophosqua</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Supplementary_Material_v3.html">Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data</h1>
            
      

      <div class="d-none name"><code>Analysis_PTMSEA.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>PTM-SEA (Post-Translational Modification Signature Enrichment
Analysis) uses curated phosphosite signatures from PTMsigDB to infer
kinase activities from phosphoproteomics data. This vignette
demonstrates three approaches:</p>
<ol style="list-style-type: decimal">
<li>
<strong>GSEA without direction</strong> - ignores ;u/;d suffixes in
PTMsigDB</li>
<li>
<strong>GSEA with direction</strong> - splits pathways into _up and
_down sets</li>
<li>
<strong>ORA with direction</strong> - over-representation analysis
on significant sites</li>
</ol>
<p>We analyze both DPA (Differential PTM Abundance) and DPU
(Differential PTM Usage) results.</p>
</div>
<div class="section level2">
<h2 id="load-data-and-ptmsigdb">Load Data and PTMsigDB<a class="anchor" aria-label="anchor" href="#load-data-and-ptmsigdb"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">prophosqua</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/contribution-knowledge-mining/" class="external-link">clusterProfiler</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/contribution-knowledge-mining/" class="external-link">enrichplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ctlab/fgsea/" class="external-link">fgsea</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load example data</span></span>
<span><span class="va">example_path</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"combined_test_diff_example.rds"</span><span class="op">)</span></span>
<span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">example_path</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Property <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rows"</span>, <span class="st">"Columns"</span>, <span class="st">"Contrasts"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">$</span><span class="va">contrast</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">data_info</span>, caption <span class="op">=</span> <span class="st">"Example Data"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Example Data</caption>
<colgroup>
<col width="12%">
<col width="87%">
</colgroup>
<thead><tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Rows</td>
<td align="left">105824</td>
</tr>
<tr class="even">
<td align="left">Columns</td>
<td align="left">56</td>
</tr>
<tr class="odd">
<td align="left">Contrasts</td>
<td align="left">KO_vs_WT, KO_vs_WT_at_Early, KO_vs_WT_at_Late,
KO_vs_WT_at_Uninfect</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download PTMsigDB signatures</span></span>
<span><span class="va">gmt_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_ptmsigdb.html">download_ptmsigdb</a></span><span class="op">(</span>species <span class="op">=</span> <span class="st">"mouse"</span>, output_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pathways_raw</span> <span class="op">&lt;-</span> <span class="fu">fgsea</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fgsea/man/gmtPathways.html" class="external-link">gmtPathways</a></span><span class="op">(</span><span class="va">gmt_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Trim pathways to 11-mer (default) to increase overlap with our data</span></span>
<span><span class="va">pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trim_ptmsigdb_pathways.html">trim_ptmsigdb_pathways</a></span><span class="op">(</span><span class="va">pathways_raw</span>, trim_to <span class="op">=</span> <span class="st">"11"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="overlap-statistics">Overlap Statistics<a class="anchor" aria-label="anchor" href="#overlap-statistics"></a>
</h2>
<p>Understanding the overlap between our data and PTMsigDB is crucial
for interpreting results.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Our data: unique flanking sequences (trimmed to 11-mer to match pathways)</span></span>
<span><span class="va">our_sequences</span> <span class="op">&lt;-</span> <span class="va">example_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">SequenceWindow</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/trimws.html" class="external-link">trimws</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">our_sequences_trimmed</span> <span class="op">&lt;-</span> <span class="va">our_sequences</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span><span class="op">~</span><span class="fu">prophosqua</span><span class="fu">:::</span><span class="fu"><a href="../reference/trim_flanking_seq.html">trim_flanking_seq</a></span><span class="op">(</span><span class="va">.x</span>, trim_to <span class="op">=</span> <span class="fl">11L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">our_site_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">our_sequences_trimmed</span>, <span class="st">"-p"</span><span class="op">)</span></span>
<span><span class="va">n_our_sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">our_site_ids</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PTMsigDB: unique site IDs (strip ;u/;d for comparison)</span></span>
<span><span class="va">ptmsigdb_ids_raw</span> <span class="op">&lt;-</span> <span class="va">pathways</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ptmsigdb_ids_stripped</span> <span class="op">&lt;-</span> <span class="va">ptmsigdb_ids_raw</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">";[ud]$"</span>, <span class="st">""</span>, x <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">n_ptmsigdb_sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ptmsigdb_ids_stripped</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Overlap</span></span>
<span><span class="va">overlap_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">our_site_ids</span><span class="op">)</span>, <span class="va">ptmsigdb_ids_stripped</span><span class="op">)</span></span>
<span><span class="va">n_overlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">overlap_ids</span><span class="op">)</span></span>
<span></span>
<span><span class="va">overlap_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Our data (unique sequences)"</span>, <span class="st">"PTMsigDB (unique site IDs)"</span>, <span class="st">"Overlap"</span>,</span>
<span>             <span class="st">"% of our sites"</span>, <span class="st">"% of PTMsigDB sites"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n_our_sites</span>, <span class="va">n_ptmsigdb_sites</span>, <span class="va">n_overlap</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">n_overlap</span> <span class="op">/</span> <span class="va">n_our_sites</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">n_overlap</span> <span class="op">/</span> <span class="va">n_ptmsigdb_sites</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">overlap_stats</span>, caption <span class="op">=</span> <span class="st">"Overlap Statistics (11-mer)"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Overlap Statistics (11-mer)</caption>
<thead><tr class="header">
<th align="left">Metric</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Our data (unique sequences)</td>
<td align="right">21653.00</td>
</tr>
<tr class="even">
<td align="left">PTMsigDB (unique site IDs)</td>
<td align="right">1746.00</td>
</tr>
<tr class="odd">
<td align="left">Overlap</td>
<td align="right">331.00</td>
</tr>
<tr class="even">
<td align="left">% of our sites</td>
<td align="right">1.53</td>
</tr>
<tr class="odd">
<td align="left">% of PTMsigDB sites</td>
<td align="right">18.96</td>
</tr>
</tbody>
</table>
<p>The low overlap is expected because:</p>
<ol style="list-style-type: decimal">
<li>PTMsigDB contains curated kinase-substrate relationships (~1,700
unique sites)</li>
<li>Our phosphoproteomics data measures ~20,000+ sites</li>
<li>Most measured sites have no known kinase annotation</li>
</ol>
</div>
<div class="section level2">
<h2 id="dpa-analysis-differential-ptm-abundance">DPA Analysis (Differential PTM Abundance)<a class="anchor" aria-label="anchor" href="#dpa-analysis-differential-ptm-abundance"></a>
</h2>
<p>DPA uses raw phosphosite fold changes, which include both true
signaling changes and protein abundance effects.</p>
<div class="section level3">
<h3 id="prepare-dpa-data">Prepare DPA Data<a class="anchor" aria-label="anchor" href="#prepare-dpa-data"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use t-statistic for ranking</span></span>
<span><span class="va">prep_dpa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ptmsea_data_prep.html">ptmsea_data_prep</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">example_data</span>,</span>
<span>  stat_column <span class="op">=</span> <span class="st">"statistic.site"</span>,</span>
<span>  seq_window_col <span class="op">=</span> <span class="st">"SequenceWindow"</span>,</span>
<span>  contrast_col <span class="op">=</span> <span class="st">"contrast"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dpa_prep_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prep_dpa</span><span class="op">$</span><span class="va">ranks</span><span class="op">)</span>,</span>
<span>  Sites <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">prep_dpa</span><span class="op">$</span><span class="va">ranks</span>, <span class="va">length</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">dpa_prep_info</span>, caption <span class="op">=</span> <span class="st">"DPA Contrasts Prepared"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>DPA Contrasts Prepared</caption>
<thead><tr class="header">
<th align="left">Contrast</th>
<th align="right">Sites</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KO_vs_WT</td>
<td align="right">21652</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Early</td>
<td align="right">21652</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Late</td>
<td align="right">21652</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Uninfect</td>
<td align="right">21652</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="dpa-gsea-without-direction">DPA: GSEA without Direction<a class="anchor" aria-label="anchor" href="#dpa-gsea-without-direction"></a>
</h3>
<p>Standard GSEA ignoring the ;u/;d direction suffixes in PTMsigDB.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_dpa_nodir</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_ptmsea.html">run_ptmsea</a></span><span class="op">(</span></span>
<span>  ranks_list <span class="op">=</span> <span class="va">prep_dpa</span><span class="op">$</span><span class="va">ranks</span>,</span>
<span>  pathways <span class="op">=</span> <span class="va">pathways</span>,</span>
<span>  min_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_size <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  n_perm <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  pvalueCutoff <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dpa_nodir_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results_dpa_nodir</span><span class="op">)</span>,</span>
<span>  `Significant (FDR &lt; 0.1)` <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">results_dpa_nodir</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.x</span><span class="op">@</span><span class="va">result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">dpa_nodir_info</span>, caption <span class="op">=</span> <span class="st">"DPA GSEA (no direction) Results"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>DPA GSEA (no direction) Results</caption>
<thead><tr class="header">
<th align="left">Contrast</th>
<th align="right">Significant (FDR &lt; 0.1)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KO_vs_WT</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Early</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Late</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Uninfect</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">merged_dpa_nodir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/merge_result.html" class="external-link">merge_result</a></span><span class="op">(</span><span class="va">results_dpa_nodir</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html" class="external-link">dotplot</a></span><span class="op">(</span><span class="va">merged_dpa_nodir</span>, showCategory <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"DPA GSEA (no direction) - Significant (FDR &lt; 0.1)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Analysis_PTMSEA_files/figure-html/dpa_gsea_nodir_plot-1.png" class="r-plt" width="1152"></p>
</div>
<div class="section level3">
<h3 id="dpa-gsea-with-direction">DPA: GSEA with Direction<a class="anchor" aria-label="anchor" href="#dpa-gsea-with-direction"></a>
</h3>
<p>Splits pathways into _up and _down sets, runs ascending and
descending.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_dpa_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_ptmsea_up_down.html">run_ptmsea_up_down</a></span><span class="op">(</span></span>
<span>  ranks_list <span class="op">=</span> <span class="va">prep_dpa</span><span class="op">$</span><span class="va">ranks</span>,</span>
<span>  pathways <span class="op">=</span> <span class="va">pathways</span>,</span>
<span>  min_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_size <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  n_perm <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  pvalueCutoff <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dpa_dir_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results_dpa_dir</span><span class="op">)</span>,</span>
<span>  `Significant (FDR &lt; 0.1)` <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">results_dpa_dir</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.x</span><span class="op">@</span><span class="va">result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">dpa_dir_info</span>, caption <span class="op">=</span> <span class="st">"DPA GSEA (with direction) Results"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>DPA GSEA (with direction) Results</caption>
<thead><tr class="header">
<th align="left">Contrast</th>
<th align="right">Significant (FDR &lt; 0.1)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KO_vs_WT_descending</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_ascending</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Early_descending</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Early_ascending</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Late_descending</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Late_ascending</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Uninfect_descending</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Uninfect_ascending</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">merged_dpa_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/merge_result.html" class="external-link">merge_result</a></span><span class="op">(</span><span class="va">results_dpa_dir</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html" class="external-link">dotplot</a></span><span class="op">(</span><span class="va">merged_dpa_dir</span>, showCategory <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"DPA GSEA (with direction) - Significant (FDR &lt; 0.1)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Analysis_PTMSEA_files/figure-html/dpa_gsea_dir_plot-1.png" class="r-plt" width="1344"></p>
</div>
</div>
<div class="section level2">
<h2 id="dpu-analysis-differential-ptm-usage">DPU Analysis (Differential PTM Usage)<a class="anchor" aria-label="anchor" href="#dpu-analysis-differential-ptm-usage"></a>
</h2>
<p>DPU uses protein-normalized phosphosite fold changes, representing
true stoichiometry changes independent of protein abundance.</p>
<div class="section level3">
<h3 id="prepare-dpu-data">Prepare DPU Data<a class="anchor" aria-label="anchor" href="#prepare-dpu-data"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use t-statistic for DPU ranking</span></span>
<span><span class="va">prep_dpu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ptmsea_data_prep.html">ptmsea_data_prep</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">example_data</span>,</span>
<span>  stat_column <span class="op">=</span> <span class="st">"tstatistic_I"</span>,</span>
<span>  seq_window_col <span class="op">=</span> <span class="st">"SequenceWindow"</span>,</span>
<span>  contrast_col <span class="op">=</span> <span class="st">"contrast"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dpu_prep_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prep_dpu</span><span class="op">$</span><span class="va">ranks</span><span class="op">)</span>,</span>
<span>  Sites <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">prep_dpu</span><span class="op">$</span><span class="va">ranks</span>, <span class="va">length</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">dpu_prep_info</span>, caption <span class="op">=</span> <span class="st">"DPU Contrasts Prepared"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>DPU Contrasts Prepared</caption>
<thead><tr class="header">
<th align="left">Contrast</th>
<th align="right">Sites</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KO_vs_WT</td>
<td align="right">20920</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Early</td>
<td align="right">20920</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Late</td>
<td align="right">20920</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Uninfect</td>
<td align="right">20920</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="dpu-gsea-without-direction">DPU: GSEA without Direction<a class="anchor" aria-label="anchor" href="#dpu-gsea-without-direction"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_dpu_nodir</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_ptmsea.html">run_ptmsea</a></span><span class="op">(</span></span>
<span>  ranks_list <span class="op">=</span> <span class="va">prep_dpu</span><span class="op">$</span><span class="va">ranks</span>,</span>
<span>  pathways <span class="op">=</span> <span class="va">pathways</span>,</span>
<span>  min_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_size <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  n_perm <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  pvalueCutoff <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dpu_nodir_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results_dpu_nodir</span><span class="op">)</span>,</span>
<span>  `Significant (FDR &lt; 0.1)` <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">results_dpu_nodir</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.x</span><span class="op">@</span><span class="va">result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">dpu_nodir_info</span>, caption <span class="op">=</span> <span class="st">"DPU GSEA (no direction) Results"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>DPU GSEA (no direction) Results</caption>
<thead><tr class="header">
<th align="left">Contrast</th>
<th align="right">Significant (FDR &lt; 0.1)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KO_vs_WT</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Early</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Late</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Uninfect</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">merged_dpu_nodir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/merge_result.html" class="external-link">merge_result</a></span><span class="op">(</span><span class="va">results_dpu_nodir</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html" class="external-link">dotplot</a></span><span class="op">(</span><span class="va">merged_dpu_nodir</span>, showCategory <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"DPU GSEA (no direction) - Significant (FDR &lt; 0.1)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Analysis_PTMSEA_files/figure-html/dpu_gsea_nodir_plot-1.png" class="r-plt" width="1152"></p>
</div>
<div class="section level3">
<h3 id="dpu-gsea-with-direction">DPU: GSEA with Direction<a class="anchor" aria-label="anchor" href="#dpu-gsea-with-direction"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_dpu_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_ptmsea_up_down.html">run_ptmsea_up_down</a></span><span class="op">(</span></span>
<span>  ranks_list <span class="op">=</span> <span class="va">prep_dpu</span><span class="op">$</span><span class="va">ranks</span>,</span>
<span>  pathways <span class="op">=</span> <span class="va">pathways</span>,</span>
<span>  min_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_size <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  n_perm <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  pvalueCutoff <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dpu_dir_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results_dpu_dir</span><span class="op">)</span>,</span>
<span>  `Significant (FDR &lt; 0.1)` <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">results_dpu_dir</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.x</span><span class="op">@</span><span class="va">result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">dpu_dir_info</span>, caption <span class="op">=</span> <span class="st">"DPU GSEA (with direction) Results"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>DPU GSEA (with direction) Results</caption>
<thead><tr class="header">
<th align="left">Contrast</th>
<th align="right">Significant (FDR &lt; 0.1)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KO_vs_WT_descending</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_ascending</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Early_descending</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Early_ascending</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Late_descending</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Late_ascending</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Uninfect_descending</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Uninfect_ascending</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">merged_dpu_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/merge_result.html" class="external-link">merge_result</a></span><span class="op">(</span><span class="va">results_dpu_dir</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html" class="external-link">dotplot</a></span><span class="op">(</span><span class="va">merged_dpu_dir</span>, showCategory <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"DPU GSEA (with direction) - Significant (FDR &lt; 0.1)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Analysis_PTMSEA_files/figure-html/dpu_gsea_dir_plot-1.png" class="r-plt" width="1344"></p>
</div>
<div class="section level3">
<h3 id="dpu-ora-with-direction">DPU: ORA with Direction<a class="anchor" aria-label="anchor" href="#dpu-ora-with-direction"></a>
</h3>
<p>Over-representation analysis on significant sites for all contrasts.
When <code>fc_col</code> is provided, sites are split into up-regulated
and down-regulated sets for separate ORA tests.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert pathways to TERM2GENE format and strip direction suffixes</span></span>
<span><span class="va">term2gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ptmsigdb_to_term2gene.html">ptmsigdb_to_term2gene</a></span><span class="op">(</span><span class="va">pathways</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">";[ud]$"</span>, <span class="st">""</span>, <span class="va">gene</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get all PTMsigDB site IDs (stripped, without ;u/;d)</span></span>
<span><span class="va">ptmsigdb_sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">term2gene</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run ORA for each contrast (up and down separately)</span></span>
<span><span class="va">contrasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">$</span><span class="va">contrast</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ora_prep_list</span> <span class="op">&lt;-</span> <span class="va">contrasts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">contrast_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">contrast_data</span> <span class="op">&lt;-</span> <span class="va">example_data</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">contrast</span> <span class="op">==</span> <span class="va">contrast_name</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">prep_ora</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ptmsea_ora_prep.html">ptmsea_ora_prep</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">contrast_data</span>,</span>
<span>      ptmsigdb_sites <span class="op">=</span> <span class="va">ptmsigdb_sites</span>,</span>
<span>      score_col <span class="op">=</span> <span class="st">"FDR_I"</span>,</span>
<span>      fc_col <span class="op">=</span> <span class="st">"diff_diff"</span>,</span>
<span>      threshold <span class="op">=</span> <span class="fl">0.1</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      Contrast <span class="op">=</span> <span class="va">contrast_name</span>,</span>
<span>      Up <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">prep_ora</span><span class="op">$</span><span class="va">enriched_up</span><span class="op">)</span>,</span>
<span>      Down <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">prep_ora</span><span class="op">$</span><span class="va">enriched_down</span><span class="op">)</span>,</span>
<span>      Background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">prep_ora</span><span class="op">$</span><span class="va">background</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ora_results</span> <span class="op">&lt;-</span> <span class="va">contrasts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">contrast_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">contrast_data</span> <span class="op">&lt;-</span> <span class="va">example_data</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">contrast</span> <span class="op">==</span> <span class="va">contrast_name</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">prep_ora</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ptmsea_ora_prep.html">ptmsea_ora_prep</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">contrast_data</span>,</span>
<span>      ptmsigdb_sites <span class="op">=</span> <span class="va">ptmsigdb_sites</span>,</span>
<span>      score_col <span class="op">=</span> <span class="st">"FDR_I"</span>,</span>
<span>      fc_col <span class="op">=</span> <span class="st">"diff_diff"</span>,</span>
<span>      threshold <span class="op">=</span> <span class="fl">0.1</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># ORA for up-regulated sites</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">prep_ora</span><span class="op">$</span><span class="va">enriched_up</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">ora_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/enricher.html" class="external-link">enricher</a></span><span class="op">(</span></span>
<span>        gene <span class="op">=</span> <span class="va">prep_ora</span><span class="op">$</span><span class="va">enriched_up</span>,</span>
<span>        universe <span class="op">=</span> <span class="va">prep_ora</span><span class="op">$</span><span class="va">background</span>,</span>
<span>        TERM2GENE <span class="op">=</span> <span class="va">term2gene</span>,</span>
<span>        pvalueCutoff <span class="op">=</span> <span class="fl">0.1</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">ora_up</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ora_up</span><span class="op">@</span><span class="va">result</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">results</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">contrast_name</span>, <span class="st">"_up"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ora_up</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="co"># ORA for down-regulated sites</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">prep_ora</span><span class="op">$</span><span class="va">enriched_down</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">ora_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/enricher.html" class="external-link">enricher</a></span><span class="op">(</span></span>
<span>        gene <span class="op">=</span> <span class="va">prep_ora</span><span class="op">$</span><span class="va">enriched_down</span>,</span>
<span>        universe <span class="op">=</span> <span class="va">prep_ora</span><span class="op">$</span><span class="va">background</span>,</span>
<span>        TERM2GENE <span class="op">=</span> <span class="va">term2gene</span>,</span>
<span>        pvalueCutoff <span class="op">=</span> <span class="fl">0.1</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">ora_down</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ora_down</span><span class="op">@</span><span class="va">result</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">results</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">contrast_name</span>, <span class="st">"_down"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ora_down</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">results</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">ora_prep_list</span>, caption <span class="op">=</span> <span class="st">"ORA Preparation Summary"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>ORA Preparation Summary</caption>
<thead><tr class="header">
<th align="left">Contrast</th>
<th align="right">Up</th>
<th align="right">Down</th>
<th align="right">Background</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KO_vs_WT</td>
<td align="right">40</td>
<td align="right">21</td>
<td align="right">323</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Early</td>
<td align="right">16</td>
<td align="right">5</td>
<td align="right">323</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Late</td>
<td align="right">22</td>
<td align="right">5</td>
<td align="right">323</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Uninfect</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">323</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ora_results</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">merged_ora</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/merge_result.html" class="external-link">merge_result</a></span><span class="op">(</span><span class="va">ora_results</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">merged_ora</span><span class="op">@</span><span class="va">compareClusterResult</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html" class="external-link">dotplot</a></span><span class="op">(</span><span class="va">merged_ora</span>, showCategory <span class="op">=</span> <span class="fl">10</span>,</span>
<span>            title <span class="op">=</span> <span class="st">"DPU ORA (up/down separate) - Significant (FDR &lt; 0.1)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="Analysis_PTMSEA_files/figure-html/dpu_ora_plot-1.png" class="r-plt" width="1344"></p>
</div>
</div>
<div class="section level2">
<h2 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h2>
<ul>
<li>
<strong>DPA results</strong> show kinase activity changes including
protein abundance effects</li>
<li>
<strong>DPU results</strong> show kinase activity changes
independent of protein abundance</li>
</ul>
<p>Kinases appearing significant in <strong>DPU but not DPA</strong>
represent genuine signaling changes. Kinases appearing in <strong>DPA
but not DPU</strong> may be driven by protein abundance changes.</p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">## Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">## Running under: macOS Tahoe 26.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Zurich</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] purrr_1.2.0            fgsea_1.36.0           enrichplot_1.30.3     </span></span>
<span><span class="co">## [4] dplyr_1.1.4            clusterProfiler_4.18.1 prophosqua_0.2.0      </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] DBI_1.2.3               gson_0.1.0              rlang_1.1.6            </span></span>
<span><span class="co">##   [4] magrittr_2.0.4          DOSE_4.4.0              compiler_4.5.2         </span></span>
<span><span class="co">##   [7] RSQLite_2.4.5           png_0.1-8               systemfonts_1.3.1      </span></span>
<span><span class="co">##  [10] vctrs_0.6.5             reshape2_1.4.5          stringr_1.6.0          </span></span>
<span><span class="co">##  [13] pkgconfig_2.0.3         crayon_1.5.3            fastmap_1.2.0          </span></span>
<span><span class="co">##  [16] XVector_0.50.0          labeling_0.4.3          rmarkdown_2.30         </span></span>
<span><span class="co">##  [19] ragg_1.5.0              bit_4.6.0               xfun_0.54              </span></span>
<span><span class="co">##  [22] ggseqlogo_0.2           cachem_1.1.0            aplot_0.2.9            </span></span>
<span><span class="co">##  [25] jsonlite_2.0.0          blob_1.2.4              BiocParallel_1.44.0    </span></span>
<span><span class="co">##  [28] parallel_4.5.2          R6_2.6.1                bslib_0.9.0            </span></span>
<span><span class="co">##  [31] stringi_1.8.7           RColorBrewer_1.1-3      jquerylib_0.1.4        </span></span>
<span><span class="co">##  [34] GOSemSim_2.36.0         Rcpp_1.1.0              Seqinfo_1.0.0          </span></span>
<span><span class="co">##  [37] bookdown_0.46           knitr_1.50              ggtangle_0.0.9         </span></span>
<span><span class="co">##  [40] R.utils_2.13.0          IRanges_2.44.0          Matrix_1.7-4           </span></span>
<span><span class="co">##  [43] splines_4.5.2           igraph_2.2.1            tidyselect_1.2.1       </span></span>
<span><span class="co">##  [46] qvalue_2.42.0           yaml_2.3.11             codetools_0.2-20       </span></span>
<span><span class="co">##  [49] lattice_0.22-7          tibble_3.3.0            plyr_1.8.9             </span></span>
<span><span class="co">##  [52] withr_3.0.2             Biobase_2.70.0          treeio_1.34.0          </span></span>
<span><span class="co">##  [55] KEGGREST_1.50.0         S7_0.2.1                evaluate_1.0.5         </span></span>
<span><span class="co">##  [58] gridGraphics_0.5-1      desc_1.4.3              Biostrings_2.78.0      </span></span>
<span><span class="co">##  [61] pillar_1.11.1           ggtree_4.0.1            stats4_4.5.2           </span></span>
<span><span class="co">##  [64] ggfun_0.2.0             generics_0.1.4          rprojroot_2.1.1        </span></span>
<span><span class="co">##  [67] S4Vectors_0.48.0        ggplot2_4.0.1           scales_1.4.0           </span></span>
<span><span class="co">##  [70] tidytree_0.4.6          glue_1.8.0              gdtools_0.4.4          </span></span>
<span><span class="co">##  [73] lazyeval_0.2.2          tools_4.5.2             data.table_1.17.8      </span></span>
<span><span class="co">##  [76] ggiraph_0.9.2           fs_1.6.6                fastmatch_1.1-6        </span></span>
<span><span class="co">##  [79] cowplot_1.2.0           grid_4.5.2              tidyr_1.3.1            </span></span>
<span><span class="co">##  [82] ape_5.8-1               AnnotationDbi_1.72.0    nlme_3.1-168           </span></span>
<span><span class="co">##  [85] patchwork_1.3.2         cli_3.6.5               rappdirs_0.3.3         </span></span>
<span><span class="co">##  [88] textshaping_1.0.4       fontBitstreamVera_0.1.1 gtable_0.3.6           </span></span>
<span><span class="co">##  [91] R.methodsS3_1.8.2       yulab.utils_0.2.2       sass_0.4.10            </span></span>
<span><span class="co">##  [94] digest_0.6.39           fontquiver_0.2.1        BiocGenerics_0.56.0    </span></span>
<span><span class="co">##  [97] ggrepel_0.9.6           ggplotify_0.1.3         htmlwidgets_1.6.4      </span></span>
<span><span class="co">## [100] farver_2.1.2            memoise_2.0.1           htmltools_0.5.9        </span></span>
<span><span class="co">## [103] pkgdown_2.2.0           R.oo_1.27.1             lifecycle_1.0.4        </span></span>
<span><span class="co">## [106] here_1.0.2              httr_1.4.7              GO.db_3.22.0           </span></span>
<span><span class="co">## [109] fontLiberation_0.1.0    bit64_4.6.0-1</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Witold Wolski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
