<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes • prophosqua</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">prophosqua</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/prolfqua/prophosqua/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="MiMBIntegratedPTM_files/kePrint-0.0.1/kePrint.js"></script><link href="MiMBIntegratedPTM_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes</h1>
                        <h4 data-toc-skip class="author">Witold
Wolski</h4>
                        <h4 data-toc-skip class="author">Antje
Dittmann</h4>
                        <h4 data-toc-skip class="author">Christian
Panse</h4>
                        <h4 data-toc-skip class="author">Laura Kunz</h4>
                        <h4 data-toc-skip class="author">Jonas
Grossmann</h4>
            
            <h4 data-toc-skip class="date">2025-07-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/prolfqua/prophosqua/blob/HEAD/vignettes/MiMBIntegratedPTM.Rmd" class="external-link"><code>vignettes/MiMBIntegratedPTM.Rmd</code></a></small>
      <div class="d-none name"><code>MiMBIntegratedPTM.Rmd</code></div>
    </div>

    
    
<table class="table">
<colgroup>
<col width="21%">
<col width="20%">
<col width="58%">
</colgroup>
<thead><tr class="header">
<th>Author</th>
<th>Affiliation(s)</th>
<th>Corresponding Author Email</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Witold Wolski</td>
<td>FGCZ, SIB</td>
<td><a href="mailto:witold.wolski@fgcz.uzh.ch">witold.wolski@fgcz.uzh.ch</a></td>
</tr>
<tr class="even">
<td>Antje Dittmann</td>
<td>FGCZ</td>
<td><a href="mailto:antje.dittmann@fgcz.uzh.ch">antje.dittmann@fgcz.uzh.ch</a></td>
</tr>
<tr class="odd">
<td>Laura Kunz</td>
<td>FGCZ</td>
<td></td>
</tr>
<tr class="even">
<td>Christian Panse</td>
<td>FGCZ, SIB</td>
<td></td>
</tr>
<tr class="odd">
<td>Jonas Grossmann</td>
<td>FGCZ, SIB</td>
<td><a href="mailto:jonas.grossmann@fgcz.uzh.ch">jonas.grossmann@fgcz.uzh.ch</a></td>
</tr>
</tbody>
</table>
<ul>
<li>FGCZ - Functional Genomics Center Zurich, Winterthurerstrasse 190,
CH-8057 Zurich,</li>
<li>SIB - Swiss Institute of Bioinformatics, Winterthurerstrasse 190,
CH-8057 Zurich</li>
</ul>
<div class="section level3">
<h3 class="unnumbered" id="abstract">
<strong>Abstract</strong><a class="anchor" aria-label="anchor" href="#abstract"></a>
</h3>
<p>Post-translational modifications (PTMs), particularly
phosphorylation, regulate protein function at substoichiometric levels,
making their quantitative analysis technically challenging. A critical
limitation in PTM studies is distinguishing between changes in
modification abundance due to altered protein expression versus genuine
changes in modification stoichiometry (the fraction of protein molecules
that are modified).</p>
<p>This chapter presents a comprehensive workflow integrating
Tandem-Mass-Tag (TMT)-based quantitative proteomics with specialized
computational analysis to distinguish differential PTM abundance (DPA)
from differential PTM usage (DPU) using the <code>prolfqua</code>,
<code>prolfquapp</code>, and <code>prophosqua</code> <em>R</em>
packages. The workflow introduces a robust statistical framework for
integrated PTM-protein analysis, comprehensive visualization tools
including N-terminus to C-terminus (N-to-C) plots for protein-centric
PTM mapping, and sequence motif analysis for kinase prediction.</p>
<p>This integrated approach enables researchers to identify actual
signaling changes in PTM studies, prioritize functionally relevant
modification sites, understand pathway-level regulation in disease
contexts, and generate robust datasets suitable for publication in
high-impact journals.</p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="key-words">Key Words<a class="anchor" aria-label="anchor" href="#key-words"></a>
</h3>
<p>Post-translational modifications, phosphoproteomics, TMT labeling,
differential PTM abundance analysis, differential PTM usage analysis,
mass spectrometry, data integration, kinase activity</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="biological-significance-of-post-translational-modifications">Biological Significance of Post-Translational Modifications<a class="anchor" aria-label="anchor" href="#biological-significance-of-post-translational-modifications"></a>
</h3>
<p>Protein phosphorylation is a reversible PTM that modulates a
protein’s conformation, enzymatic activity, subcellular localization, or
binding interactions. Because this modification can be reversed rapidly,
it acts as a molecular switch in cellular signaling networks. As a
result, cells respond to environmental cues without requiring new
protein synthesis. Dysregulation of phosphorylation is implicated in
cancer, neurodegeneration, and metabolic disorders <span class="citation">[<a href="#ref-10.1080/14789450.2021.1976152">1</a>]</span>. Large-scale
phosphoproteomic profiling by high-throughput mass spectrometry (MS)
(e.g., TMT-based workflows) is therefore crucial for dissecting
disease-associated signaling alterations and identifying candidate
therapeutic targets.</p>
</div>
<div class="section level3">
<h3 id="technical-challenges-in-ptm-analysis">Technical Challenges in PTM Analysis<a class="anchor" aria-label="anchor" href="#technical-challenges-in-ptm-analysis"></a>
</h3>
<p>The analysis of PTMs, such as phosphorylation, presents significant
analytical challenges due to the low abundance of modified peptides.
Typically, phosphorylated peptides represent less than 1–5% of the total
peptide population <span class="citation">[<a href="#ref-10.1186/1477-5956-4-15">2</a>]</span>. Additionally,
phosphopeptides generally exhibit poorer ionization efficiency in
MS-based proteomics compared to non-modified peptides, further
complicating their detection and quantification. This low abundance and
challenging ionization behavior necessitate specialized experimental
workflows and computational strategies to achieve accurate
quantification <span class="citation">[<a href="#ref-10.1016/j.mcpro.2024.100754">3</a>]</span>.</p>
<p>A key analytical challenge is distinguishing genuine changes in PTM
levels, due to altered kinase and phosphatase activity, from changes
caused by altered protein abundance <span class="citation">[<a href="#ref-10.1016/j.mcpro.2022.100477">4</a>, <a href="#ref-10.1016/j.mcpro.2023.100708">5</a>]</span>. Without proper
correction, this confounding factor can lead researchers to misinterpret
PTM data, incorrectly attributing higher phosphorylation signals solely
to increased modification efficiency or pathway activation, rather than
to elevated protein expression <span class="citation">[<a href="#ref-10.1039/c5mb00024f">6</a>]</span>. Controlling for this
confounder is critical to discern rapid, signaling-driven
phosphorylation events from slower, transcriptionally or translationally
regulated changes in protein abundance.</p>
<p>Because phosphorylation is substoichiometric, only a small fraction
of protein molecules carry the modification; therefore, enrichment is
required to isolate phosphopeptides. Enrichment steps (such as
Immobilized Metal Affinity Chromatography (IMAC) or Metal Oxide Affinity
Chromatography (MOAC)) introduce additional sample handling and
technical variability <span class="citation">[<a href="#ref-10.1039/c5mb00024f">6</a>–<a href="#ref-10.1038/nbt.3327">8</a>]</span>. Therefore, each stage, from
digestion to cleanup to MS acquisition, must be carefully optimized to
improve reproducibility <span class="citation">[<a href="#ref-10.1038/s41467-018-03309-6">9</a>]</span>. Effective
experimental design combined with tailored normalization strategies is
therefore essential to recover reliable, biologically meaningful PTM
signals.</p>
<p>Isobaric TMT labeling enables multiplexed PTM analysis of up to 35
samples in a single run, reducing inter-sample variability and missing
values to improve statistical power <span class="citation">[<a href="#ref-10.1021/acs.jproteome.4c00668">10</a>, <a href="#ref-10.1021/ac0262560">11</a>]</span>. Phosphopeptides are
typically enriched by IMAC or Metal Oxide Affinity Chromatography
(MOAC), which provide complementary selectivity and broaden coverage
<span class="citation">[<a href="#ref-10.1074/mcp.m114.045609">12</a>,
<a href="#ref-10.1101/2020.04.13.038810">13</a>]</span>. Adding offline
fractionation before liquid chromatography–tandem mass spectrometry
(LC–MS/MS) further increases phosphosite depth and distributes peptide
load, improving quantification consistency across fractions and
conditions <span class="citation">[<a href="#ref-10.1002/pmic.202100245">14</a>]</span>.</p>
<p>In TMT-based proteomics, a <em>plex</em> refers to the complete set
of isobarically tagged samples analyzed together in a single LC–MS/MS
run. When the total number of samples exceeds the available TMT
channels, each plex should include at least one biological replicate
from every experimental group and a common reference or pooled channel
for normalization <span class="citation">[<a href="#ref-10.1021/acs.jproteome.0c00536">15</a>]</span>. Replicates of
the same group are then distributed across different plexes rather than
clustered within a single run, preventing any group’s replicates from
being confined to one batch. If all samples fit within the channel
capacity of a single plex, these balancing measures are inherently
satisfied in that run.</p>
</div>
<div class="section level3">
<h3 id="computational-tools-and-workflows">Computational Tools and Workflows<a class="anchor" aria-label="anchor" href="#computational-tools-and-workflows"></a>
</h3>
<p>The computational landscape for quantitative protein PTM analysis has
undergone significant evolution, with numerous specialized software
platforms supporting bottom-up proteomics workflows. Following MS data
acquisition, spectra undergo database searching to identify peptide
sequences, which is subsequently followed by protein inference to
determine protein identities based on these identified peptides. The
ecosystem of PTM analysis includes several well-established
data-dependent acquisition (DDA)-TMT compatible software suites, both
free and commercial, such as <em>Andromeda</em> integrated within
<em>MaxQuant</em> <span class="citation">[<a href="#ref-10.1021/acs.jproteome.4c00869">16</a>]</span>, <em>Proteome
Discoverer</em> (Thermo Fisher Scientific), <em>FragPipe</em> <span class="citation">[<a href="#ref-10.1038/s41467-023-39891-7">17</a>]</span>, or
<em>PeptideShaker</em> <span class="citation">[<a href="#ref-10.1021/acs.jproteome.1c00678">18</a>]</span>.</p>
<p>Among the analytical steps following peptide identification, PTM site
localization scoring represents a particularly crucial computational
challenge. Site localization determines the confidence with which a
modification can be assigned to a specific amino acid residue within a
peptide sequence. This process is especially challenging when peptides
contain multiple potential modification sites, necessitating algorithms
to evaluate the quality and specificity of site-determining fragment
ions. Specialized tools have been developed explicitly for robust PTM
site localization, including <em>PTMProphet</em> <span class="citation">[<a href="#ref-10.1038/s41467-020-17914-x">19</a>]</span>,
<em>PhosphoRS</em> <span class="citation">[<a href="#ref-10.1021/pr200611n">20</a>]</span>, and <em>Ascore</em> <span class="citation">[<a href="#ref-10.1038/nbt1240">21</a>]</span>.
Accurate localization is essential, as incorrect site assignments can
lead to biological misinterpretations, particularly in signaling pathway
analyses and kinase-substrate predictions.</p>
<p>In DDA workflows, <em>FragPipe</em> <span class="citation">[<a href="#ref-10.1101/2025.05.27.656447">22</a>]</span> represents a widely
adopted and integrated platform that comprehensively addresses PTM
analysis, including site localization challenges. <em>FragPipe</em>
integrates the <em>MSFragger</em> search engine <span class="citation">[<a href="#ref-10.1038/nmeth.4256">23</a>]</span>,
enabling highly sensitive peptide identification, and employs
<em>PTMProphet</em> <span class="citation">[<a href="#ref-10.1021/acs.jproteome.9b00205">24</a>]</span> functionality
for site localization scoring. It also generates detailed quantitative
outputs, including site-level quantification reports and multisite
feature reports that group peptides sharing identical modification
patterns. A detailed description of the <em>FragPipe</em> workflow is
provided in the experimental methods section (see Section
@ref(fragpipeparams)).</p>
<p>While the above discussion has focused primarily on DDA workflows,
data-independent acquisition (DIA)-based approaches represent
alternative strategies with distinct computational considerations for
PTM analysis. Specialized DIA platforms such as <em>Spectronaut</em>
<span class="citation">[<a href="#ref-10.1002/pmic.202300088">25</a>]</span>, <span class="citation">[<a href="#ref-10.1074/mcp.m114.044305">26</a>]</span>
and <em>DIA-NN</em> <span class="citation">[<a href="#ref-10.1038/s41592-019-0638-x">27</a>]</span> offer PTM support
through dedicated site-localization scoring algorithms and site-level
quantification capabilities. Unlike DDA, DIA workflows require
specialized computational approaches to extract and quantify
modification-specific information from highly multiplexed fragmentation
spectra. Both <em>Spectronaut</em> and <em>DIA-NN</em> incorporate
advanced statistical frameworks designed explicitly for PTM
identification and quantification in DIA workflows.</p>
</div>
<div class="section level3">
<h3 id="data-analysis-frameworks">Data Analysis Frameworks<a class="anchor" aria-label="anchor" href="#data-analysis-frameworks"></a>
</h3>
<p>Proteomic data analysis can be conducted at multiple levels of
granularity, each providing distinct analytical perspectives. A
peptidoform represents a specific peptide sequence with a particular set
of modifications, while site-level analysis aggregates signals for each
residue position across multiple peptides. Differential analysis can
therefore target either peptidoforms or individual modification sites,
with each approach offering unique advantages for different research
questions.</p>
<p><em>FragPipe</em> introduces an additional analytical concept through
multisite features, which refers to the set of all identified
peptide-forms sharing the same set of modification sites under
investigation, regardless of sequence derivatives, cleavage state, or
whether the modifications are unambiguously localized. This approach
groups peptidoforms with different sequences, which can arise from
missed cleavages or alternative cleavage patterns, but identical
possible modification sites into the same multisite feature, providing a
balanced approach between peptidoform specificity and site-level
aggregation. Discarding all peptidoforms with ambiguous localization
would result in the loss of a large fraction of PTM information.
Furthermore, multisite features preserve information about
phosphorylation sites that occur together on the same peptide molecule,
revealing co-modification patterns that indicate coordinated regulation
by kinases or functional relationships between sites. Traditional
site-level analysis treats each phosphorylation site independently,
losing this valuable information about which specific combinations of
sites are modified together in biological samples.</p>
<p>Site-level reports collapse signals from all peptidoforms mapping to
the same PTM at an amino acid residue into a single quantitative value,
ensuring each site has exactly one intensity measurement per sample. In
downstream analysis, site-level intensities integrate seamlessly with
site-centric enrichment tools and kinase-activity inference platforms
(<code>PhosR</code> <span class="citation">[<a href="#ref-10.1016/j.celrep.2021.108771">28</a>]</span>,
<code>PTM-SEA</code> <span class="citation">[<a href="#ref-10.1074/mcp.TIR118.000943">29</a>]</span>, <code>RoKAI</code>
<span class="citation">[<a href="#ref-10.1038/s41467-021-21211-6">30</a>]</span>, etc.),
streamlining biological interpretation and network reconstruction
analyses <span class="citation">[<a href="#ref-10.1186/s12014-020-09290-x">31</a>]</span>.</p>
</div>
<div class="section level3">
<h3 id="statistical-analysis-of-ptm-data">Statistical Analysis of PTM Data<a class="anchor" aria-label="anchor" href="#statistical-analysis-of-ptm-data"></a>
</h3>
<p>Statistical analysis of PTM data requires specialized methods due to
confounding effects between PTM levels and protein abundances. Several
statistical packages have emerged to address the critical issue of
integrating PTM-feature quantifications with protein abundance data.
Notable examples include <code>MSstatsPTM</code> <span class="citation">[<a href="#ref-10.1016/j.mcpro.2022.100477">4</a>]</span> and
<code>msqrob2PTM</code> <span class="citation">[<a href="#ref-10.1016/j.mcpro.2023.100708">5</a>]</span>, which explicitly
model both modified peptide and protein-level changes to distinguish
genuine PTM regulation from protein abundance effects accurately.</p>
<p>The <code>msqrob2PTM</code> framework exemplifies the statistical
approaches now available for PTM analysis, defining two complementary
analytical strategies: DPA and DPU <span class="citation">[<a href="#ref-10.1016/j.mcpro.2023.100708">5</a>]</span>. DPA directly
models the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">log^2</annotation></semantics></math>
intensities of each modified peptide (peptidoform), detecting absolute
changes in PTM levels between experimental conditions. In contrast, DPU
adjusts the PTM intensities by the corresponding protein-level changes,
effectively testing for changes in the relative usage or stoichiometry
of a modification site. This dual approach enables researchers to
distinguish between PTM changes driven by protein abundance differences
(DPA) versus those reflecting genuine changes in modification efficiency
or regulatory activity (DPU).</p>
<p>These two frameworks differ in their analytical approaches for
addressing confounding between PTM and changes in protein abundance.
<code>MSstatsPTM</code> employs a “model then correct” strategy,
separately fitting linear models to modified and unmodified peptide
data, and then combining statistical inferences post-modeling. In
contrast, <code>msqrob2PTM</code> follows a “correct then model”
approach, first adjusting PTM intensities by their corresponding protein
abundances at the data level, and subsequently performing statistical
testing on these normalized values.</p>
<p>A further option, discussed in <span class="citation">[<a href="#ref-10.1007/978-1-0716-1967-4_12">32</a>]</span>, is to model the
PTM and total proteome data as a factorial design that jointly includes
a biologically relevant explanatory variable, e.g., genotype, and a
“component” indicator, i.e., modified peptide and its total proteome
parent protein, and fits a linear model with their interaction. It then
tests the statistical significance of the interaction term to flag
modified peptides whose dynamics deviate from the corresponding total
proteome protein abundance. Here, the package <code>limma</code> is used
to fit the model and perform the testing.</p>
<p>While all three methodologies ultimately estimate PTM abundance
changes corrected for protein-level effects, each method can yield
different test results due to varying assumptions about the relationship
between PTMs and protein abundances within a sample, as well as
differences in how variance and degrees of freedom are estimated.</p>
<ul>
<li>
<code>MSstatsPTM</code> fits the PTM and the protein in separate
models, then computes an adjusted effect as a difference of estimated
contrasts:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mrow><mi>a</mi><mi>d</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi mathvariant="normal">Δ</mi><mrow><mi>P</mi><mi>T</mi><mi>M</mi></mrow></msub><mo>−</mo><msub><mi mathvariant="normal">Δ</mi><mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>t</mi><mi>e</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Delta_{adj} = \Delta_{PTM} - \Delta_{protein}</annotation></semantics></math>
with standard error combined in quadrature for the test statistic, and
Welch’s approximation to estimate the degrees of freedom, which yields
p-values for the adjusted fold change directly on the contrast scale.
<code>MSstatsPTM</code> assumes that there is no correlation between PTM
and the protein abundances within the samples.</li>
<li>The single-model approach <span class="citation">[<a href="#ref-10.1007/978-1-0716-1967-4_12">32</a>]</span> uses
<code>limma</code> moderated (empirical-Bayes) variances for the
interaction contrast within one fit, which shrinks feature-wise
variances toward a common prior;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">df</annotation></semantics></math>
are moderated accordingly. The single-model formulation can capture
shared covariance by adding a sample blocking/random effect. Still, as
illustrated <span class="citation">[<a href="#ref-10.1007/978-1-0716-1967-4_12">32</a>]</span>, the baseline
model omits a sample term, effectively treating PTM and protein
measurements as independent.</li>
<li>
<code>msqrob2PTM</code> assumes that the PTM and the protein
abundances within a sample are correlated and therefore corrects PTM
abundances with the matched protein abundances. Then, for modelling,
only the corrected PTM intensities are used.</li>
</ul>
<p>The three pipelines target the PTM-vs-protein effect through
different modeling paths and make different assumptions about
within-sample covariance, and differ in variance moderation. Therefore,
even with the same raw data and contrasts, we can expect differences in
estimated effects, standard errors, and p-values.</p>
<p>To offer researchers additional flexibility, we developed
<code>prophosqua</code> <span class="citation">[<a href="#ref-10.5281/zenodo.15845272">33</a>]</span>, an <em>R</em>
package designed to streamline statistical analysis of phosphoproteomics
and other PTM datasets. Using <code>prophosqua</code> and the
<code>prolfqua</code> package <span class="citation">[<a href="#ref-10.1021/acs.jproteome.2c00441">34</a>]</span>, the
<code>MStatsPTM</code> <em>model-first</em> and <code>msqrob2PTM</code>
<em>correct first</em> approaches can be executed to obtain
protein-corrected PTM data and provide intuitive visualizations for
comprehensive exploratory analysis.</p>
</div>
<div class="section level3">
<h3 id="the-protein-assignment-problem-in-differential-ptm-feature-usage">The Protein Assignment Problem in Differential PTM-feature
Usage<a class="anchor" aria-label="anchor" href="#the-protein-assignment-problem-in-differential-ptm-feature-usage"></a>
</h3>
<p>Identification and quantification tools need to assign peptides to
proteins, i.e., find the leading or representative protein identifier
(ID). This assignment may be dataset-specific and may differ between the
PTM and the total proteome dataset. Therefore, using protein IDs to
match PTM features with proteins from the total run may lead to a loss
of information due to differing representative IDs <span class="citation">[<a href="#ref-10.1093/bib/bbr065">35</a>]</span>. For
example, a phosphopeptide might be assigned, by protein inference, to
protein isoform A in the PTM dataset. In contrast, in the total proteome
dataset, protein abundance is quantified under isoform B, which prevents
proper integration and DPU analysis.</p>
<p>A robust solution involves matching stripped peptide sequences from
the PTM dataset to peptide sequences of proteins quantified in the total
proteome dataset, bypassing protein ID dependency entirely. When
peptides are shared among multiple protein isoforms, the averaged
protein abundance across all matching isoforms provides a more stable
reference for normalization. While this sequence-based matching approach
requires additional computational implementation, it reduces the loss of
valuable information due to protein assignment differences between
datasets.</p>
</div>
<div class="section level3">
<h3 id="chapter-overview-and-learning-objectives">Chapter Overview and Learning Objectives<a class="anchor" aria-label="anchor" href="#chapter-overview-and-learning-objectives"></a>
</h3>
<p>This chapter introduces an analytical workflow that addresses the
biological challenge of accurately distinguishing DPA from DPU.
Distinguishing between protein-level effects and genuine
modification-specific changes is critical for meaningful interpretation
of PTM data. The workflow emphasizes reproducibility, automation, and
biological interpretation.</p>
<p>DPA tests raw PTM signal changes between experimental conditions,
identifying any modification abundance changes regardless of underlying
protein-level effects. This analysis captures the total impact of
experimental perturbations on PTM levels, including both direct
modification effects and indirect effects mediated through changes in
protein abundance.</p>
<p>DPU evaluates protein-normalized PTM changes, explicitly identifying
modification sites where stoichiometry is genuinely altered independent
of protein abundance. This analysis pinpoints sites where experimental
conditions directly impact modification efficiency, kinase activity, or
phosphatase activity, thereby highlighting specific regulatory
events.</p>
<p>Learning objectives include: 1. Conducting integrated statistical
analysis of PTM and total proteome data using <code>prolfquapp</code>
and <code>prophosqua</code> <em>R</em> packages 2. Interpreting DPA
vs. DPU results for biological insights and generating
publication-quality visualizations 3. Performing sequence motif analysis
for kinase prediction and pathway reconstruction</p>
</div>
</div>
<div class="section level2">
<h2 id="materials">Materials<a class="anchor" aria-label="anchor" href="#materials"></a>
</h2>
<div class="section level3">
<h3 id="demonstration-dataset">Demonstration Dataset<a class="anchor" aria-label="anchor" href="#demonstration-dataset"></a>
</h3>
<p>This protocol utilizes the Atg16l1 macrophage dataset from Maculins
et al. <span class="citation">[<a href="#ref-10.7554/elife.62320">36</a>]</span> to demonstrate the
bioinformatics workflow and integrated statistical analysis. The dataset
comprises TMT-11-plex measurements from six conditions (WT/KO ×
uninfected/early/late infection) with both phospho-enriched and total
proteome samples, making it ideal for illustrating the principles of
integrated PTM analysis. In the original publication, the authors also
performed ubiquitin remnant enrichment, although we focus on the
phosphoproteome and total proteome datasets for demonstration purposes.
This same dataset was previously used in the <code>MSstatsPTM</code>
publication <span class="citation">[<a href="#ref-10.1016/j.mcpro.2022.100477">4</a>]</span>, providing
additional validation of the analytical approaches.</p>
<p>As discussed below, TMT enables high-precision quantification across
many conditions, particularly when combined with fractionation. In
contrast, DIA is well suited when avoiding fractionation or scaling to
larger sample numbers (see Note @ref(notelfq)).</p>
</div>
<div class="section level3">
<h3 id="system-requirements">System Requirements<a class="anchor" aria-label="anchor" href="#system-requirements"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Search and quantification software: <em>FragPipe</em> 22.0 (free
download for academic use from <a href="https://fragpipe.nesvilab.org" class="external-link">fragpipe.nesvilab.org</a>; system
requirements: 32GB+ RAM, 50GB+ storage)</li>
<li>Statistical platform: <em>R</em> version
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\ge</annotation></semantics></math>
4.0.0 (<a href="https://www.r-project.org/" class="external-link">https://www.r-project.org/</a>) and
RStudio (<a href="https://posit.co/" class="external-link">https://posit.co/</a>)</li>
</ol>
<ul>
<li>
<strong>System requirements</strong>: 16GB+ RAM, 20 GB+ storage</li>
<li>
<strong>Expected runtime</strong>: 10 minutes to 1 hours depending
on dataset size and number of fractions</li>
</ul>
</div>
<div class="section level3">
<h3 id="r-packages">R packages<a class="anchor" aria-label="anchor" href="#r-packages"></a>
</h3>
<p>Most relevant <em>R</em> packages used for the analysis are:</p>
<ul>
<li>
<code>tidyverse</code> <span class="citation">[<a href="#ref-10.21105/joss.01686">37</a>]</span> - Data manipulation and
visualization tools</li>
<li>
<code>ggseqlogo</code> <span class="citation">[<a href="#ref-10.32614/cran.package.ggseqlogo">38</a>]</span> - Sequence
motif visualization</li>
<li>
<code>prolfqua</code> <span class="citation">[<a href="#ref-10.1021/acs.jproteome.2c00441">34</a>]</span> - Core
statistical framework for proteomics data analysis</li>
<li>
<code>prolfquapp</code> <span class="citation">[<a href="#ref-10.1021/acs.jproteome.4c00911">39</a>]</span> - Streamlined
differential expression analysis pipeline</li>
<li>
<code>prolfquappPTMreaders</code> <span class="citation">[<a href="#ref-10.5281/zenodo.15845243">40</a>]</span> - Specialized readers
for PTM data formats</li>
<li>
<code>prophosqua</code> <span class="citation">[<a href="#ref-10.5281/zenodo.15845272">33</a>]</span> - Integration and
visualization of PTM and protein data</li>
</ul>
<p>For detailed installation instructions, see the package documentation
on</p>
<ul>
<li>
<a href="https://github.com/fgcz/prolfqua" class="external-link">github.com/fgcz/prolfqua</a>,</li>
<li>
<a href="https://github.com/prolfqua/prolfquapp" class="external-link">github.com/prolfqua/prolfquapp</a>,</li>
<li>
<a href="https://github.com/prolfqua/prophosqua" class="external-link">github.com/prolfqua/prophosqua</a>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="mass-spectrometry-data-processing">Mass Spectrometry Data Processing<a class="anchor" aria-label="anchor" href="#mass-spectrometry-data-processing"></a>
</h3>
<p>Raw MS data acquired using DDA combined with TMT labeling are
processed using specialized software to:</p>
<ol style="list-style-type: decimal">
<li>Search spectra against a protein sequence database including
species-specific sequences, common contaminants, and decoy
sequences</li>
<li>to extract reporter ion intensities</li>
<li>and to compute site localization probabilities</li>
</ol>
<p>The section (see Methods @ref(fragpipeparams)) describes in detail
how we parameterized the <em>FragPipe</em> software <span class="citation">[<a href="#ref-10.1038/s41467-023-39891-7">17</a>]</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<p>A key challenge, when analysing PTMs, is to distinguish changes in
PTM abundance that are due to altered protein expression from those that
reflect a change in the modification stoichiometry (i.e., the fraction
of the protein pool that is modified). This protocol provides a
step-by-step computational workflow to analyze PTM data in the context
of total protein abundance changes. We leverage the <em>R</em> packages
<code>prolfquapp</code> <span class="citation">[<a href="#ref-10.1021/acs.jproteome.4c00911">39</a>]</span> for streamlined
differential expression analysis <span class="citation">[<a href="#ref-10.1021/acs.jproteome.2c00441">34</a>]</span> and
<code>prophosqua</code> <span class="citation">[<a href="#ref-10.5281/zenodo.15845272">33</a>]</span> for the integration,
analysis, and visualization of PTM and total proteome data. The workflow
comprises three parts: 1) analysing the raw mass spectrometric data with
<em>FragPipe</em>, 2) performing differential expression analysis for
the PTM-enriched and total proteome datasets, and 3) integrating the PTM
and total proteome data.</p>
<div class="section level3">
<h3 id="fragpipeparams">Analysing TMT raw data with <em>FragPipe</em><a class="anchor" aria-label="anchor" href="#fragpipeparams"></a>
</h3>
<p>We used the TMT 11-plex phospho workflow in <em>FragPipe</em> 22.0
<span class="citation">[<a href="#ref-10.1038/s41467-023-39891-7">17</a>]</span> with
<em>MSFragger</em> (version 4.1) <span class="citation">[<a href="#ref-10.1038/nmeth.4256">23</a>]</span>. Database searching was
performed against a species-specific protein sequence database
supplemented with common contaminants and reversed decoy sequences. The
search parameters included:</p>
<ul>
<li>Fixed modifications:</li>
<li>Carbamidomethylation of cysteine (+57.0215 Da)</li>
<li>TMT labeling of lysine residues and peptide N-termini (+229.1629
Da)</li>
<li>Variable modifications:</li>
<li>Phosphorylation on serine, threonine, and tyrosine residues
(+79.9663 Da)</li>
<li>Oxidation of methionine (+15.9949 Da)</li>
<li>Acetylation at protein N-termini (+42.0106 Da)</li>
</ul>
<p>Reporter ions are quantified by <em>IonQuant</em> (version 1.10.27),
with downstream processing in <em>TMTIntegrator</em> (version 1.10.27).
<em>TMTIntegrator</em> <span class="citation">[<a href="#ref-10.1101/2025.05.27.656447">22</a>]</span> performs
quantification and normalization specifically tailored for multiplexed
TMT experiments.</p>
<p>Selected <em>TMTIntegrator</em> parameters are:</p>
<ul>
<li>Best PSM selection: OFF</li>
<li>Outlier removal enabled: OFF</li>
<li>Allow overlabel/underlabel: OFF</li>
<li>Use MS1 intensity: OFF</li>
<li>Aggregation method: Median</li>
</ul>
<p>For phospho-enriched samples, PTM sites are scored using
<em>PTMProphet</em> <span class="citation">[<a href="#ref-10.1021/acs.jproteome.9b00205">24</a>]</span> localization
scores
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\ge</annotation></semantics></math>
0.75 are retained. <em>FragPipe</em> workflow parameters are stored in
configuration files (<code>fragpipe.workflow</code>). The workflow file
used to parametrize <em>FragPipe</em> can be downloaded from <span class="citation">[<a href="#ref-10.5281/zenodo.15850770">41</a>]</span>.</p>
<p><em>FragPipe</em> provides two types of PTM-features reports for the
phospho-enriched samples:</p>
<ul>
<li><p>Multisite features: groups peptidoforms sharing identical
modification sites, as described in Section
@ref(data-analysis-frameworks).</p></li>
<li><p>Site-level reports collapse signals from all peptidoforms mapping
to the same amino acid position into a single quantitative value per PTM
site, ensuring each site has exactly one intensity per sample. In
downstream analysis, site-level intensities can be fed into site-centric
enrichment or kinase-activity inference tools (<code>PhosR</code>,
<code>PTM-SEA</code>, <code>RoKAI</code>, etc.), streamlining biological
interpretation and network reconstruction.</p></li>
</ul>
<p>An essential step in the data preprocessing is the quality control
(QC) of the quantified samples, which involves estimating the missed
cleavage rates or labeling efficiency (see Note @ref(automatedqc)).</p>
</div>
<div class="section level3">
<h3 id="data-setup-for-statistical-analysis">Data Setup for Statistical Analysis<a class="anchor" aria-label="anchor" href="#data-setup-for-statistical-analysis"></a>
</h3>
<p>The following sections demonstrate the computational workflow through
<em>R</em> code snippets that implement each step of the integrated PTM
analysis. All code examples are also available within the
<code>prophosqua</code> package <span class="citation">[<a href="#ref-10.5281/zenodo.15845272">33</a>]</span> and can be easily
adapted to different datasets by modifying file paths and experimental
parameters.</p>
<p>The first step is to download the example PTM dataset, which serves
as a comprehensive demonstration of integrated PTM analysis. This
dataset is derived from the Atg16l1 macrophage study by Maculins et al.
<span class="citation">[<a href="#ref-10.7554/elife.62320">36</a>]</span>, which investigates the
role of autophagy in bacterial infection responses. The dataset contains
both total proteome and PTM-enriched measurements from a well-designed
factorial experiment with the following characteristics:</p>
<ul>
<li>Experimental design:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">2\times 3</annotation></semantics></math>
factorial (Genotype: WT/KO; Timepoint: Uninfected/Early/Late
infection)</li>
<li>Biological context: Macrophage responses to Shigella infection in
wild-type vs Atg16l1-knockout cells</li>
<li>Technical approach: TMT 11-plex labeling for precise quantification
across conditions</li>
<li>Data types: Total proteome protein-level and phospho-enriched
phospho-site quantification results.</li>
</ul>
<p>This dataset is particularly valuable for demonstrating PTM analysis
concepts because the Atg16l1 knockout creates both direct protein
abundance changes (loss of Atg16l1 itself) and secondary effects on
autophagy-related signaling pathways.</p>
<p>The first step involves obtaining the <em>FragPipe</em> 22 mass
spectrometry output files <span class="citation">[<a href="#ref-10.5281/zenodo.15850770">41</a>]</span> and setting up the
analysis environment in <em>R</em>. Depending on the sample type,
different <em>FragPipe</em> output files are required:</p>
<ul>
<li>total proteome samples: <code>psm.tsv</code> files, containing
peptide-spectrum match (PSM) information</li>
<li>phospho-enriched samples: <code>abundance_single-site.tsv</code>
files for individual modification site analysis</li>
</ul>
<p>This dataset is available from Zenodo <a href="http://doi.org/10.5281/zenodo.15879865" class="external-link">10.5281/zenodo.15879865</a>.
The code below downloads the data, extracts it into a folder, and
removes the zip archive.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">need_download</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="st">"PTM_example"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zenodo_url</span> <span class="op">&lt;-</span> <span class="st">"https://zenodo.org/records/15879865/files/PTM_experiment_FP_22_Maculins_and_QC.zip"</span></span>
<span></span>
<span><span class="va">destfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">zenodo_url</span><span class="op">)</span></span>
<span><span class="co"># Download, unzip and delete</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">zenodo_url</span>, <span class="va">destfile</span>, mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">destfile</span>, exdir <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">destfile</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="setting-up-prolfquapp-scripts">Setting up <code>prolfquapp</code> scripts<a class="anchor" aria-label="anchor" href="#setting-up-prolfquapp-scripts"></a>
</h3>
<p>This section demonstrates how to perform <strong>differential
expression analysis (DEA)</strong> on both total proteome and
PTM-enriched proteome data using the <code>prolfquapp</code> package.
The analysis provides the foundation for subsequent integration by
preprocessing, normalizing the data, and establishing which proteins and
PTM-features show significant changes between experimental
conditions.</p>
<p>The <code>prolfquapp</code> <span class="citation">[<a href="#ref-10.1021/acs.jproteome.4c00911">39</a>]</span> package
provides a set of shell scripts that automate the analysis workflow.
These scripts are copied into the working directory by running the
command in the Linux shell and are used in subsequent steps.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">R</span> <span class="at">--vanilla</span> <span class="at">-e</span> <span class="st">"library(prolfquapp); copy_shell_script(workdir = '.')"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="contrasts">Creating sample annotation<a class="anchor" aria-label="anchor" href="#contrasts"></a>
</h3>
<p>Sample annotation is the foundation of any meaningful DEA, serving as
the bridge between raw mass spectrometry files and biological
interpretation. The annotation file maps each raw data file to its
corresponding experimental conditions (WT or KO) and additional
explanatory variables, such as Time.</p>
<p>We start by reading the sample names from the <em>FragPipe</em>
output files using the <code>prolfqua_dataset.sh</code> script to create
a dataset annotation file compatible with <code>prolfquapp</code>, that
maps sample names to their experimental conditions (see Table
@ref(tab:showAnnotTable)).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">./prolfqua_dataset.sh</span> <span class="at">--indir</span> PTM_example/data_total/FP_22/ <span class="dt">\</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>--dataset <span class="st">"PTM_example/data_total/dataset.tsv"</span> <span class="dt">\</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>--software prolfquapp.FP_TMT</span></code></pre></div>
<p>We use <em>R</em> to extract experimental factors, the Genotype and
Timepoint, from the channel labels using the
<code><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">tidyr::separate</a></code> function. If the channel names do not
encode the experimental conditions, the explanatory variables must be
provided by adding columns to the annotation file using a text
editor.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="st">"PTM_example/data_total/dataset.tsv"</span><span class="op">)</span></span>
<span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="va">annot</span> <span class="op">|&gt;</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Genotype"</span>, <span class="st">"Timepoint"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                                  sep <span class="op">=</span> <span class="st">"_"</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">annot</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">annot</span><span class="op">$</span><span class="va">subject</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">annot</span><span class="op">$</span><span class="va">CONTROL</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>We then call the <code>annotation_add_contrasts</code> function in
the <code>prolfqua</code> <span class="citation">[<a href="#ref-10.1021/acs.jproteome.2c00441">34</a>]</span> to generate
factorial contrasts automatically. The
<code>annotation_add_contrasts</code> function adds two key columns to
the sample annotation:</p>
<ul>
<li>
<code>ContrastName</code>: A descriptive name for each statistical
contrast</li>
<li>
<code>Contrast</code>: The mathematical formula defining the
contrast in terms of group means</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annot2</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/prolfqua/man/annotation_add_contrasts.html" class="external-link">annotation_add_contrasts</a></span><span class="op">(</span></span>
<span>  <span class="va">annot</span>, primary_col <span class="op">=</span> <span class="st">"Genotype"</span>, secondary_col <span class="op">=</span> <span class="st">"Timepoint"</span> ,</span>
<span>  decreasing <span class="op">=</span> <span class="cn">TRUE</span>, interactions <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">annot</span></span>
<span></span>
<span><span class="fu">write_tsv</span><span class="op">(</span><span class="va">annot2</span>, <span class="st">"dataset_with_contrasts.tsv"</span><span class="op">)</span></span></code></pre></div>
<p>Note that setting the argument <code>interactions=FALSE</code> in the
<code>annotation_add_contrasts</code> function disables the generation
of interaction contrasts for factor level combinations. Interaction
contrasts assess whether the effect of one factor depends on the level
of another, thereby capturing non‑additive interplay between factors.
The file <code>dataset_with_contrasts.tsv</code> is the final dataset
file that will be used for the DEA (see Table
@ref(tab:showannotation)).</p>
<p>For the experimental design in this protocol
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">2\times3</annotation></semantics></math>
factorial: Genotype [KO/WT]
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>×</mi><annotation encoding="application/x-tex">\times</annotation></semantics></math>
Time [Uninfected/Early/Late]), the function generated four distinct
contrasts:</p>
<ol style="list-style-type: decimal">
<li>
<code>KO_vs_WT</code> (Main effect):
<code>( (G_KO_Uninfect + G_KO_Late + G_KO_Early)/3 - (G_WT_Uninfect + G_WT_Late + G_WT_Early)/3 )</code>
- Compares overall genotype effects across all timepoints</li>
<li>
<code>KO_vs_WT_at_Uninfect</code>:
<code>G_KO_Uninfect - G_WT_Uninfect</code> - Compares genotypes
specifically in the <em>uninfected</em> condition</li>
<li>
<code>KO_vs_WT_at_Late</code>: <code>G_KO_Late - G_WT_Late</code> -
Compares genotypes specifically in the <em>late</em> infection
condition<br>
</li>
<li>
<code>KO_vs_WT_at_Early</code>: <code>G_KO_Early - G_WT_Early</code>
- Compares genotypes specifically in the <em>early</em> infection
condition</li>
</ol>
<p>If we want to compare timepoints instead of genotypes, we set:
<code>primary_col="Timepoint"</code> and
<code>secondary_col = "Genotype"</code>.</p>
</div>
<div class="section level3">
<h3 id="execution-of-differential-abundance-analysis">Execution of Differential Abundance Analysis<a class="anchor" aria-label="anchor" href="#execution-of-differential-abundance-analysis"></a>
</h3>
<p>Before performing DEA, we generate a YAML configuration file using
the <code>prolfqua_yaml.sh</code> script. The configuration file
(<code>config.yaml</code>) defines key analysis parameters, including
the normalization method (variance stabilization normalization (VSN) by
default), protein summarization strategy (Tukey’s median polish by
default), and quality-filtering thresholds such as q-value cutoffs for
peptide or protein-level evidence.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">./prolfqua_yaml.sh</span> <span class="at">-y</span> config.yaml</span></code></pre></div>
<p>Once the sample annotation and configuration files are prepared, DEA
is executed via the <code>prolfqua_dea.sh</code> script. This script
reads the experimental design (sample IDs, group labels, and contrasts)
alongside the configuration file. Single-site or protein intensities are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>-transformed
and variance-stabilized before modeling, improving homoscedasticity
across conditions.</p>
<p>Linear models are fitted and contrasts are tested using the
<code>prolfqua</code> <em>R</em>-package’s contrast API. Rather than
imputing missing values, the model adjusts the degrees of freedom based
on the number of actual observations per feature, which naturally
down-weights features with high missingness and improves the reliability
of the fold-change and p-value estimates. Empirical Bayes variance
moderation is applied to stabilize variance estimates, particularly when
sample size is limited.</p>
<p>First, we run the DEA analysis of the total proteome quantification
results. The script uses <em>FragPipe</em> <code>psm.tsv</code> file as
input, aggregates reporter ions abundances to the peptide level, and
then estimates the protein abundances. The code below demonstrates how
the <code>prolfqua_dea.sh</code> shell script can be executed on the
Linux command line.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">./prolfqua_dea.sh</span> <span class="at">-i</span> PTM_example/data_total/FP_22 <span class="dt">\</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>-d dataset_with_contrasts.tsv <span class="dt">\</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>-y config.yaml <span class="dt">\</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>-w total_proteome <span class="dt">\</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>-s prolfquapp.FP_TMT</span></code></pre></div>
<p>The <code>prolfqua_dea</code> application expects the following
paramater:</p>
<ul>
<li>
<code>-i</code>: Specifies input directory with <em>FragPipe</em>
results</li>
<li>
<code>-d</code>: Uses the annotated dataset file</li>
<li>
<code>-y</code>: Applies configuration settings in the
<code>config.yaml</code> file.</li>
<li>
<code>-w</code>: Sets the name of the work unit</li>
<li>
<code>-s</code>: Specifies software format (<em>FragPipe</em>
TMT)</li>
</ul>
<p>After running the DEA, the results are stored in a time-stamped
directory. This code constructs the path to the results directory using
the <code><a href="https://rdrr.io/pkg/prolfquapp/man/zipdir_name.html" class="external-link">prolfquapp::zipdir_name()</a></code> function, which follows the
standard naming convention for DEA results.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">prolfquapp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/prolfquapp/man/zipdir_name.html" class="external-link">zipdir_name</a></span><span class="op">(</span><span class="st">"DEA"</span>, workunit_id <span class="op">=</span> <span class="st">"total_proteome"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "DEA_20260217_WUtotal_proteome_vsn"</span></span></code></pre>
<p>The DEA of the single-site output of enriched phosphoproteome
examines changes at individual modification sites and is performed by
running the code below. The analysis provides site-specific information
about which particular amino acids are modified under different
conditions. The <code>abundance_single-site_None.tsv</code> file
generated by <em>FragPipe</em> is used as input.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">./prolfqua_dea.sh</span> <span class="at">-i</span> PTM_example/data_ptm/FP_22 <span class="dt">\</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>-d dataset_with_contrasts.tsv <span class="dt">\</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>-y config.yaml <span class="dt">\</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>-w phospho_STY <span class="dt">\</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>-s prolfquappPTMreaders.FP_singlesite</span></code></pre></div>
<p>Please note that using the <code>-s</code> argument, we point to the
correct reader function in the <code>prolfquappPTMreaders</code>
<em>R</em> package to read the <em>FragPipe</em> single-site output.</p>
<p>For each data type, <code>prolfquapp</code> generates a comprehensive
suite of outputs:</p>
<ul>
<li>Dynamic HTML reports containing interactive PCA plots, boxplots,
volcano plots, and heatmaps for quality control and exploratory
analysis</li>
<li>XLSX tables (DE_<datatype>.xlsx) summarizing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold changes, moderated t-statistics, raw p-values, and
Benjamini–Hochberg–adjusted p-values</datatype>
</li>
<li>GSEA rank files (GSEA_<datatype>.rnk) for downstream gene-set
enrichment analysis</datatype>
</li>
<li>SummarizedExperiment objects (<datatype>.rds) for seamless import
into Shiny-based visualization tools</datatype>
</li>
</ul>
<p>These results can be integrated using the <code>prophosqua</code>
package for combined analysis of total proteome and PTM data. However,
it is essential to note that there are scenarios where performing
differential PTM-feature abundance analysis is the only practical option
(see Note @ref(useofDPADPU)).</p>
</div>
<div class="section level3">
<h3 id="integrated-ptm-analysis-using-prophosqua">Integrated PTM Analysis using <code>prophosqua</code><a class="anchor" aria-label="anchor" href="#integrated-ptm-analysis-using-prophosqua"></a>
</h3>
<p>The <code>prophosqua</code> package <span class="citation">[<a href="#ref-10.5281/zenodo.15845272">33</a>]</span> provides tools for
integrating and analyzing PTM data with total proteome measurements. It
enables researchers to distinguish between changes in protein abundance
and changes in the usage of modification sites. This section explains
how to load the results of the differential abundance analysis,
integrate the PTM and total proteome data, and determine differential
PTM-feature usage.</p>
<p>Differential expression results from <code>prolfquapp</code>,
provided in Excel format, for the total proteome and the multi- or
single-site PTM analyses are imported into <em>R</em>. These datasets
are then integrated by performing a left join on protein identifiers,
merging PTM-level statistics with the corresponding protein-level values
for each condition.</p>
<p>We start by defining the project name and analysis type.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prolfqua.github.io/prophosqua">prophosqua</a></span><span class="op">)</span></span>
<span><span class="va">wu_id</span> <span class="op">&lt;-</span> <span class="st">"CustomPhosphoAnalysis"</span></span>
<span><span class="va">fgcz_project</span> <span class="op">&lt;-</span> <span class="st">"PTM_analysis"</span></span>
<span><span class="va">oid_fgcz</span> <span class="op">&lt;-</span> <span class="st">"fgcz_project"</span></span>
<span><span class="va">datetoday</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%Y%m%d"</span><span class="op">)</span> </span>
<span><span class="va">project_dir</span> <span class="op">&lt;-</span> <span class="st">"."</span></span></code></pre></div>
<p>We also create a results directory to store the PTM/total proteome
integration results:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">descri</span> <span class="op">&lt;-</span> <span class="va">wu_id</span></span>
<span><span class="va">res_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>  <span class="va">project_dir</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">fgcz_project</span>, <span class="st">"_"</span>, <span class="va">datetoday</span>, <span class="st">"_singlesite_"</span>, <span class="va">descri</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">res_dir</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">res_dir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>In the code below, we define the paths to the DEA results in the XLSX
files stored by <code>prolfquapp</code>. We need to specify the workunit
names and the date when the DEA analysis was run.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use today's date if running DEA, otherwise use existing results</span></span>
<span><span class="va">datedea</span> <span class="op">&lt;-</span> <span class="kw">if</span><span class="op">(</span><span class="va">do_dea</span><span class="op">)</span> <span class="va">datetoday</span> <span class="kw">else</span> <span class="st">"20251214"</span></span>
<span></span>
<span><span class="va">tot_file</span> <span class="op">&lt;-</span> <span class="fu">prophosqua</span><span class="fu">::</span><span class="fu"><a href="../reference/dea_xlsx_path.html">dea_xlsx_path</a></span><span class="op">(</span><span class="va">project_dir</span>, <span class="st">"total_proteome"</span>, <span class="va">datedea</span><span class="op">)</span></span>
<span><span class="va">ptm_file</span> <span class="op">&lt;-</span> <span class="fu">prophosqua</span><span class="fu">::</span><span class="fu"><a href="../reference/dea_xlsx_path.html">dea_xlsx_path</a></span><span class="op">(</span><span class="va">project_dir</span>, <span class="st">"phospho_STY"</span>, <span class="va">datedea</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Directory paths</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">tot_file</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">ptm_file</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we load the differential expression results into the
<em>R</em> session.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">required_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"protein_Id"</span>, <span class="st">"protein_length"</span>, <span class="st">"contrast"</span><span class="op">)</span></span>
<span><span class="va">tot_res</span> <span class="op">&lt;-</span> <span class="fu">prophosqua</span><span class="fu">::</span><span class="fu"><a href="../reference/load_and_preprocess_data.html">load_and_preprocess_data</a></span><span class="op">(</span><span class="va">tot_file</span>, <span class="va">required_cols</span><span class="op">)</span></span>
<span><span class="va">tot_res</span> <span class="op">&lt;-</span> <span class="fu">prophosqua</span><span class="fu">::</span><span class="fu"><a href="../reference/filter_contaminants.html">filter_contaminants</a></span><span class="op">(</span><span class="va">tot_res</span><span class="op">)</span></span>
<span><span class="va">phospho_res</span> <span class="op">&lt;-</span> <span class="fu">prophosqua</span><span class="fu">::</span><span class="fu"><a href="../reference/load_and_preprocess_data.html">load_and_preprocess_data</a></span><span class="op">(</span><span class="va">ptm_file</span>, <span class="va">required_cols</span><span class="op">)</span></span>
<span><span class="va">phospho_res</span> <span class="op">&lt;-</span> <span class="fu">prophosqua</span><span class="fu">::</span><span class="fu"><a href="../reference/filter_contaminants.html">filter_contaminants</a></span><span class="op">(</span><span class="va">phospho_res</span><span class="op">)</span></span></code></pre></div>
<p>The data integration step is critical for enabling DPU analysis and
represents one of the most important technical aspects of the workflow.
This step joins phosphorylation site data with total protein data to
create a unified dataset where each PTM-feature is linked to its
corresponding protein-level measurements.</p>
<p>The <code>left_join</code> operation used here ensures that all
PTM-features are retained in the analysis, even if their parent proteins
were not detected in the total proteome experiment. This approach
maximizes the information content by allowing protein normalization
where possible, while also reporting PTM-features that cannot be mapped
to total proteome measurements.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">join_column</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"protein_Id"</span> <span class="op">=</span> <span class="st">"protein_Id"</span>,</span>
<span>  <span class="st">"contrast"</span> <span class="op">=</span> <span class="st">"contrast"</span>,</span>
<span>  <span class="st">"description"</span> <span class="op">=</span> <span class="st">"description"</span>,</span>
<span>  <span class="st">"protein_length"</span> <span class="op">=</span> <span class="st">"protein_length"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">suffix_a</span> <span class="op">&lt;-</span> <span class="st">".site"</span></span>
<span><span class="va">suffix_b</span> <span class="op">&lt;-</span> <span class="st">".protein"</span></span>
<span></span>
<span><span class="va">combined_site_prot</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>  <span class="va">phospho_res</span>,</span>
<span>  <span class="va">tot_res</span>,</span>
<span>  by <span class="op">=</span> <span class="va">join_column</span>,</span>
<span>  suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">suffix_a</span>, <span class="va">suffix_b</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We also need to check the match rate between PTM sites and proteins,
that is, the number of PTM sites that have a protein match divided by
the total number of PTM sites. Currently, <code>prolfquapp</code>
matches PTM and protein features using exact protein IDs, which
introduces a limitation: discrepancies in representative protein
identifiers between the PTM-enriched and total proteome datasets may
result in the loss of mapping information (see Note
@ref(matchrates)).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate match rate by contrast</span></span>
<span><span class="va">match_rates</span> <span class="op">&lt;-</span> <span class="va">combined_site_prot</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">contrast</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    total_sites <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    matched_sites <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">diff.protein</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    match_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">matched_sites</span> <span class="op">/</span> <span class="va">total_sites</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>The Table @ref(tab:b5matchrate) shows the match rates for each
contrast.</p>
</div>
<div class="section level3">
<h3 id="visualizing-ptm-feature-abundance-dpa">Visualizing PTM-feature Abundance (DPA)<a class="anchor" aria-label="anchor" href="#visualizing-ptm-feature-abundance-dpa"></a>
</h3>
<p>DPA tests the raw PTM-feature signal change between conditions,
without any correction for its parent protein’s expression level. This
analysis is used to flag any PTM-feature whose abundance changes, even
if the parent protein itself is also up- or down-regulated.</p>
<p>DPA results are visualized using N-to-C plots, generated by the
<code>prophosqua</code> <span class="citation">[<a href="#ref-10.5281/zenodo.15845272">33</a>]</span>
<code>n_to_c_expression_multicontrast</code> function. These multi-panel
plots map both the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold changes of individual modification sites along the primary sequence
of the protein and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold change of the protein abundance from the total proteome experiment
across all contrasts simultaneously. This representation provides a
clear visual summary of both site-specific and overall protein
expression changes across multiple experimental comparisons. The N-to-C
expression plot (see Figure @ref(fig:fig1Q64337)) shows that the protein
SQSTM1 (UniProt id Q64337) and the phosphorylation sites are upregulated
in the KO vs WT comparison across different timepoints.</p>
<p>Because generating N-to-C plots is computationally intensive, we
generate plots only for proteins with at least one significant
phosphorylation site in any contrast. The False Discovery Rate (FDR)
threshold for determining significance can be adjusted in the
<code>n_to_c_expression_multicontrast</code> or
<code>n_to_c_usage_multicontrast</code> functions, allowing researchers
to balance computational efficiency with comprehensive visualization
based on their specific considerations. When no significant PTM sites
are detected despite biological expectations, one possible reason is
insufficient statistical power, which can be mitigated by increasing the
sample size (see Note @ref(nosignificantPTM)).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/n_to_c_expression_multicontrast.html">n_to_c_expression_multicontrast</a></span><span class="op">(</span></span>
<span>  <span class="va">combined_site_prot</span>, FDR_threshold <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  max_plots <span class="op">=</span> <span class="fl">100</span>, include_proteins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Q64337"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Q64337"</span>, <span class="va">plot_data</span><span class="op">$</span><span class="va">protein_Id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fig1_plot</span> <span class="op">&lt;-</span> <span class="va">plot_data</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="va">x1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>The next code snippet exports
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>100</mn><annotation encoding="application/x-tex">100</annotation></semantics></math><code>N-to-C</code> expression plots to a PDF file for further analysis
and presentation (see also Note @ref(compperf) why we limit the number
of <code>N-to-C</code> plots written into a file).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">res_dir</span>, <span class="st">"Site_differential_Expression_multicontrast.pdf"</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">14</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analysis-of-differential-ptm-feature-usage-dpu---model-first">Analysis of Differential PTM-feature Usage (DPU) - model-first<a class="anchor" aria-label="anchor" href="#analysis-of-differential-ptm-feature-usage-dpu---model-first"></a>
</h3>
<p>DPU tests the protein-normalized changes of PTM-features. This
analysis is essential for determining whether the fraction of a protein
that is modified at a specific site changes between conditions. It
isolates changes in modification stoichiometry from changes in overall
protein abundance.</p>
<p>In the model-first approach, DPU is calculated by subtracting the
total proteome protein
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold change from the PTM-feature’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold change. The associated p-values are recalculated using a method
that combines the variance from both the PTM and protein-level models,
as implemented in <code>prophosqua</code> <span class="citation">[<a href="#ref-10.5281/zenodo.15845272">33</a>]</span>
<code>test_diff</code> function, or in the <code>MSstatsPTM</code>
<em>R</em>-package <span class="citation">[<a href="#ref-10.1016/j.mcpro.2022.100477">4</a>]</span>.</p>
<p>The analysis involves three key mathematical components:</p>
<ol style="list-style-type: decimal">
<li>Effect Size Calculation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi mathvariant="normal">Δ</mi><mi>I</mi></msub><annotation encoding="application/x-tex">\Delta_I</annotation></semantics></math>)</li>
<li>Standard Error Propagation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msub><mi>E</mi><mi>I</mi></msub></mrow><annotation encoding="application/x-tex">SE_I</annotation></semantics></math>)</li>
<li>Degrees of Freedom Calculation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>f</mi><mi>I</mi></msub></mrow><annotation encoding="application/x-tex">df_I</annotation></semantics></math>)</li>
</ol>
<p>The differential PTM usage effect size is calculated as the
difference between PTM and total proteome protein
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold changes for each comparison:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>I</mi></msub><mo>=</mo><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>F</mi><msub><mi>C</mi><mrow><mi>P</mi><mi>T</mi><mi>M</mi></mrow></msub><mo>−</mo><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>F</mi><msub><mi>C</mi><mrow><mi>P</mi><mi>r</mi><mi>o</mi><mi>t</mi><mi>e</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Delta_I = \log_2FC_{PTM} - \log_2FC_{Protein}</annotation></semantics></math></p>
<p>This difference represents the protein-normalized change in PTM
abundance, where:</p>
<ul>
<li>Positive values - indicate increased modification stoichiometry
(higher fraction of protein is modified)</li>
<li>Negative values - indicate decreased modification stoichiometry
(lower fraction of protein is modified)</li>
<li>Zero values - indicate no change in modification stoichiometry
relative to protein expression</li>
</ul>
<p>The combined standard error accounts for uncertainty in both PTM and
protein measurements:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msub><mi>E</mi><mi>I</mi></msub><mo>=</mo><msqrt><mrow><mi>S</mi><msubsup><mi>E</mi><mrow><mi>P</mi><mi>T</mi><mi>M</mi></mrow><mn>2</mn></msubsup><mo>+</mo><mi>S</mi><msubsup><mi>E</mi><mrow><mi>P</mi><mi>r</mi><mi>o</mi><mi>t</mi><mi>e</mi><mi>i</mi><mi>n</mi></mrow><mn>2</mn></msubsup></mrow></msqrt></mrow><annotation encoding="application/x-tex">SE_I = \sqrt{SE_{PTM}^2 + SE_{Protein}^2}</annotation></semantics></math></p>
<p>The error propagation ensures that the statistical significance of
usage changes reflects uncertainty from both datasets, providing a more
robust assessment of the reliability of the observed changes.</p>
<p>The effective degrees of freedom for the combined test are calculated
using Welch’s approximation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>f</mi><mi>I</mi></msub><mo>=</mo><mfrac><mrow><mo stretchy="false" form="prefix">(</mo><mi>S</mi><msubsup><mi>E</mi><mrow><mi>P</mi><mi>T</mi><mi>M</mi></mrow><mn>2</mn></msubsup><mo>+</mo><mi>S</mi><msubsup><mi>E</mi><mrow><mi>P</mi><mi>r</mi><mi>o</mi><mi>t</mi><mi>e</mi><mi>i</mi><mi>n</mi></mrow><mn>2</mn></msubsup><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup></mrow><mrow><mfrac><mrow><mi>S</mi><msubsup><mi>E</mi><mrow><mi>P</mi><mi>T</mi><mi>M</mi></mrow><mn>4</mn></msubsup></mrow><mrow><mi>D</mi><msub><mi>F</mi><mrow><mi>P</mi><mi>T</mi><mi>M</mi></mrow></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>S</mi><msubsup><mi>E</mi><mrow><mi>P</mi><mi>r</mi><mi>o</mi><mi>t</mi><mi>e</mi><mi>i</mi><mi>n</mi></mrow><mn>4</mn></msubsup></mrow><mrow><mi>D</mi><msub><mi>F</mi><mrow><mi>P</mi><mi>r</mi><mi>o</mi><mi>t</mi><mi>e</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow></mfrac></mrow></mfrac></mrow><annotation encoding="application/x-tex">df_I = \frac{(SE_{PTM}^2 + SE_{Protein}^2)^2}{\frac{SE_{PTM}^4}{DF_{PTM}} + \frac{SE_{Protein}^4}{DF_{Protein}}}</annotation></semantics></math></p>
<p>, which provides appropriate degrees of freedom. The Welch
approximation is essential when the two datasets have different
experimental designs or sample sizes.</p>
<p>Using these calculated parameters, the t-statistic is computed:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mfrac><msub><mi mathvariant="normal">Δ</mi><mi>I</mi></msub><mrow><mi>S</mi><msub><mi>E</mi><mi>I</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">t = \frac{\Delta_I}{SE_I}</annotation></semantics></math></p>
<p>The p-value is determined using the t-distribution with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>f</mi><mi>I</mi></msub></mrow><annotation encoding="application/x-tex">df_I</annotation></semantics></math>
degrees of freedom. Multiple testing correction (e.g.,
Benjamini-Hochberg FDR) is applied across all tested sites.</p>
<p>The <code>test_diff</code> function calculates the difference of
differences between PTM and total proteome data, revealing site-specific
usage changes.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_test_diff</span> <span class="op">&lt;-</span> <span class="fu">prophosqua</span><span class="fu">::</span><span class="fu"><a href="../reference/test_diff.html">test_diff</a></span><span class="op">(</span><span class="va">phospho_res</span>, <span class="va">tot_res</span>, join_column <span class="op">=</span> <span class="va">join_column</span><span class="op">)</span></span></code></pre></div>
<p>The PTM-feature usage
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold changes, p-values, and FDR estimates are added to the dataframe
<code>combined_test_diff</code>.</p>
<p>The DPU results are visualized using N-to-C plots generated by
<code><a href="../reference/n_to_c_usage_multicontrast.html">prophosqua::n_to_c_usage_multicontrast</a></code>, which display the
protein-normalized PTM-feature abundance changes across all contrasts
simultaneously and highlight sites with significant changes in usage.
These multi-panel plots reveal which sites are being used more or less
actively, independent of total protein changes, enabling comparison
across all experimental conditions.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data_usage</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/n_to_c_usage_multicontrast.html">n_to_c_usage_multicontrast</a></span><span class="op">(</span></span>
<span>  <span class="va">combined_test_diff</span>, FDR_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  max_plots <span class="op">=</span> <span class="fl">100</span>, include_proteins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Q64337"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>In the <em>Atg16l1</em> macrophage dataset <span class="citation">[<a href="#ref-10.7554/elife.62320">36</a>]</span>, SQSTM1 (uniprot id
Q64337) protein levels are markedly increased in Atg16l1-knockout (KO)
versus wild-type (WT), reflecting loss of autophagy-mediated turnover.
Phosphosite analysis reveals that the raw phosphopeptide intensities at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>e</mi><msub><mi>r</mi><mn>28</mn></msub></mrow><annotation encoding="application/x-tex">Ser_{28}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>e</mi><msub><mi>r</mi><mn>308</mn></msub></mrow><annotation encoding="application/x-tex">Ser_{308}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>e</mi><msub><mi>r</mi><mn>368</mn></msub></mrow><annotation encoding="application/x-tex">Ser_{368}</annotation></semantics></math>
are similarly elevated in cKO compared to WT (DPA), consistent with
higher protein abundance (see Figure @ref(fig:fig1Q64337)). However,
when applying DPU normalization, which subtracts the total proteome
protein
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold change from each site’s phospho
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold change, these apparent phosphorylation increases are substantially
reduced, indicating that most of the phosphosite abundance changes arise
from protein accumulation rather than genuine changes in modification
stoichiometry (see Figure @ref(fig:fig2usageQ64337)). This example
highlights how DPU effectively isolates regulatory events on SQSTM1 from
confounding protein-level effects.</p>
<p>Additionally, individual high-confidence DPA/DPU sites should be
carefully inspected for technical quality, including verification of
protein coverage and assessment of missing values across treatment
groups (see Note @ref(qcrecommend)).</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x1_usage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Q64337"</span>, <span class="va">plot_data_usage</span><span class="op">$</span><span class="va">protein_Id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fig2_plot</span> <span class="op">&lt;-</span> <span class="va">plot_data_usage</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="va">x1_usage</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>When evaluating statistical significance in DPU analysis, it is
essential to avoid overinterpreting results (see Note
@ref(overinterpret)). Statistical significance does not guarantee
biological relevance; effect sizes should be considered alongside FDR
values when prioritizing sites for further investigation. Key findings
should be validated through orthogonal methods to confirm biological
relevance.</p>
</div>
<div class="section level3">
<h3 id="protein-ptm-integration-report-generation">Protein PTM Integration Report Generation<a class="anchor" aria-label="anchor" href="#protein-ptm-integration-report-generation"></a>
</h3>
<p>The integrated analysis results are compiled into a comprehensive
HTML report using an <em>R</em> markdown template
<code>_Overview_PhosphoAndIntegration_site.Rmd</code>. The report
includes:</p>
<ul>
<li>Overview statistics on identified phosphorylation sites</li>
<li>Interactive scatter plots comparing protein vs PTM-feature
changes</li>
<li>Volcano plots highlighting differential PTM-feature usage</li>
</ul>
<p>The report includes data tables that allow searching for a specific
protein and phosphorylation feature, and highlighting it in the scatter
plot showing the total proteome protein
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>F</mi><mi>C</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">log_2(FC)</annotation></semantics></math>
as a function of the PTM-site
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>F</mi><mi>C</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">log_2(FC)</annotation></semantics></math>,
as well as in volcano plots. When analyzing the interactive reports,
different combinations of DPA and DPU results provide distinct
biological insights that guide interpretation. For instance,
<strong>DPA+ only</strong> indicates changes driven primarily by protein
abundance alterations, where PTM increases reflect higher protein levels
rather than enhanced modification efficiency (see Note
@ref(dpuvsdpa)).</p>
<p>To generate the HTML report, we begin by creating a report
configuration that includes the project ID, order ID, and a work unit
description to be displayed in the interactive HTML report.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drumm</span> <span class="op">&lt;-</span> <span class="fu">prolfquapp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/prolfquapp/man/make_DEA_config_R6.html" class="external-link">make_DEA_config_R6</a></span><span class="op">(</span></span>
<span>  PROJECTID <span class="op">=</span> <span class="va">fgcz_project</span>,</span>
<span>  ORDERID <span class="op">=</span> <span class="va">oid_fgcz</span>,</span>
<span>  WORKUNITID <span class="op">=</span> <span class="va">descri</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Copy integration files</span></span>
<span><span class="fu">prophosqua</span><span class="fu">::</span><span class="fu"><a href="../reference/copy_phospho_integration.html">copy_phospho_integration</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/Users/wolski/projects/prophosqua/inst/PTM_example_analysis_v2/_Overview_PhosphoAndIntegration_site.Rmd"</span></span>
<span><span class="co">## [2] "/Users/wolski/projects/prophosqua/inst/PTM_example_analysis_v2/bibliography2025.bib"</span></span></code></pre>
<p>Next, we can render the interactive HTML report with comprehensive
analysis results, including tables, plots, and statistical summaries.
This report is available for download from Zenodo <span class="citation">[<a href="#ref-10.5281/zenodo.15830988">42</a>]</span>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Render HTML report</span></span>
<span><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span></span>
<span>  <span class="st">"_Overview_PhosphoAndIntegration_site.Rmd"</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">combined_test_diff</span>,</span>
<span>    grp <span class="op">=</span> <span class="va">drumm</span></span>
<span>  <span class="op">)</span>,</span>
<span>  output_format <span class="op">=</span> <span class="fu">bookdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/bookdown/reference/html_document2.html" class="external-link">html_document2</a></span><span class="op">(</span></span>
<span>    toc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    toc_float <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">new.env</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">globalenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Copy HTML report to results directory (uses existing if not re-rendered)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"_Overview_PhosphoAndIntegration_site.html"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span></span>
<span>    from <span class="op">=</span> <span class="st">"_Overview_PhosphoAndIntegration_site.html"</span>,</span>
<span>    to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">res_dir</span>, <span class="st">"Result_phosphoAndTotalIntegration.html"</span><span class="op">)</span>,</span>
<span>    overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>In addition, the analysis results are exported to an Excel file for
further analysis and sharing. The Excel file contains two
worksheets:</p>
<ul>
<li>combinedSiteProteinData: Contains the merged PTM and protein-level
data used for the DPA analysis.</li>
<li>combinedStats: Contains the differential PTM-feature usage
statistics (DPU), including
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold changes, p-values, and FDR estimates for each phosphorylation
site.</li>
</ul>
<p>This Excel format facilitates downstream analysis, data sharing with
collaborators, and integration with other bioinformatics tools. The file
is automatically saved with a timestamped filename in the results
directory.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">excel_result_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  combinedStats <span class="op">=</span> <span class="va">combined_test_diff</span>,</span>
<span>  combinedSiteProteinData <span class="op">=</span> <span class="va">combined_site_prot</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">writexl</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/writexl//reference/write_xlsx.html" class="external-link">write_xlsx</a></span><span class="op">(</span></span>
<span>  <span class="va">excel_result_list</span>,</span>
<span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>    <span class="va">res_dir</span>,</span>
<span>    <span class="st">"Result_phosphoAndTotalIntegration.xlsx"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save example data for package (as .rda for data() loading)</span></span>
<span><span class="va">combined_test_diff_example</span> <span class="op">&lt;-</span> <span class="va">combined_test_diff</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">combined_test_diff_example</span>,</span>
<span>     file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"combined_test_diff_example.rda"</span><span class="op">)</span>,</span>
<span>     compress <span class="op">=</span> <span class="st">"xz"</span><span class="op">)</span></span></code></pre></div>
<p>The produced XLSX file can be downloaded from <span class="citation">[<a href="#ref-10.5281/zenodo.15830988">42</a>]</span>.
This comprehensive integrated analysis framework provides key advantages
for PTM research, including the ability to distinguish genuine signaling
changes from protein abundance effects (see Note @ref(keyinsight)).</p>
</div>
<div class="section level3">
<h3 id="estimating-ptm-feature-usage-by-the-correct-first-approach">Estimating PTM-feature usage by the correct first approach<a class="anchor" aria-label="anchor" href="#estimating-ptm-feature-usage-by-the-correct-first-approach"></a>
</h3>
<p>Here we show how to estimate the DPU using the correct first
approach. We first correct the PTM site abundances, using the total
proteome, and then model the differential usage changes. This analysis
starts by loading the <code>prolfquapp</code> outputs. This time, we
read the transformed and normalized total proteome protein
abundances.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tot_res_dir</span> <span class="op">&lt;-</span> <span class="fu">prophosqua</span><span class="fu">::</span><span class="fu"><a href="../reference/dea_res_dir.html">dea_res_dir</a></span><span class="op">(</span><span class="va">project_dir</span>, <span class="st">"total_proteome"</span>, <span class="va">datedea</span><span class="op">)</span></span>
<span><span class="va">ldata</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tot_res_dir</span>,<span class="st">"lfqdata_normalized.parquet"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ldata</span> <span class="op">&lt;-</span> <span class="va">ldata</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^rev_"</span>,<span class="va">protein_Id</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">tot_d</span> <span class="op">&lt;-</span> <span class="va">ldata</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">channel</span>, <span class="va">protein_Id</span>, <span class="va">normalized_abundance</span><span class="op">)</span></span></code></pre></div>
<p>We are also loading normalized single-site abundances. In addition to
loading the data, we create a <code><a href="https://rdrr.io/pkg/prolfqua/man/LFQData.html" class="external-link">prolfqua::LFQData</a></code> object
using the <code>LFQData$new</code> constructor. The <code>LFQData</code>
object provides numerous methods for analyzing and visualizing
quantitative proteomics data <span class="citation">[<a href="#ref-10.1021/acs.jproteome.2c00441">34</a>]</span>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ptm_res_dir</span> <span class="op">&lt;-</span> <span class="fu">prophosqua</span><span class="fu">::</span><span class="fu"><a href="../reference/dea_res_dir.html">dea_res_dir</a></span><span class="op">(</span><span class="va">project_dir</span>, <span class="st">"phospho_STY"</span>, <span class="va">datedea</span><span class="op">)</span></span>
<span><span class="va">ldata</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">ptm_res_dir</span>,<span class="st">"lfqdata_normalized.parquet"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">list</span> <span class="op">&lt;-</span> <span class="fu">yaml</span><span class="fu">::</span><span class="fu"><a href="https://yaml.r-lib.org/reference/read_yaml.html" class="external-link">read_yaml</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">ptm_res_dir</span>,<span class="st">"lfqdata.yaml"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/prolfqua/man/list_to_AnalysisConfiguration.html" class="external-link">list_to_AnalysisConfiguration</a></span><span class="op">(</span><span class="va">list</span><span class="op">)</span></span>
<span><span class="va">ptm_data</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/prolfqua/man/LFQData.html" class="external-link">LFQData</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">ldata</span>,<span class="va">config</span><span class="op">)</span></span></code></pre></div>
<p>We merge the data for the single-site and total proteome protein
abundances by protein identifier and sample. Then we subtract the total
proteome protein abundances from the single-site abundances. The Density
plot (see Figure @ref(fig:fig3densityCorrected)) shows the distribution
of the corrected single-site abundances.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ptm_data</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span></span>
<span>  <span class="va">ptm_data</span><span class="op">$</span><span class="va">data</span>, <span class="va">tot_d</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"channel"</span>, <span class="st">"protein_Id"</span><span class="op">)</span>, suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".site"</span>,<span class="st">".total"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ptm_data</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">ptm_data</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ptm_usage <span class="op">=</span> <span class="va">normalized_abundance.site</span> <span class="op">-</span> <span class="va">normalized_abundance.total</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ptm_data</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="fu">set_response</span><span class="op">(</span><span class="st">"ptm_usage"</span><span class="op">)</span></span>
<span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">ptm_data</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">fig3_plot</span> <span class="op">&lt;-</span> <span class="va">pl</span><span class="op">$</span><span class="fu">intensity_distribution_density</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Next, we fit a linear model for each PTM, which explains the
corrected PTM site abundances using the grouping of the samples. The
model is fitted for each site using the
<code><a href="https://rdrr.io/pkg/prolfqua/man/build_model.html" class="external-link">prolfqua::build_model</a></code> function.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strategy_lm</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/prolfqua/man/strategy.html" class="external-link">strategy_lm</a></span><span class="op">(</span><span class="st">"ptm_usage ~ G_"</span><span class="op">)</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/prolfqua/man/build_model.html" class="external-link">build_model</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ptm_data</span>, model_strategy <span class="op">=</span> <span class="va">strategy_lm</span><span class="op">)</span></span></code></pre></div>
<p>To compute the contrasts, we construct an array of contrasts from the
annotation table, which we built in Section @ref(contrasts).</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrasts</span> <span class="op">&lt;-</span> <span class="va">annot2</span><span class="op">$</span><span class="va">Contrast</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">contrasts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">annot2</span><span class="op">$</span><span class="va">ContrastName</span></span>
<span><span class="va">contrasts</span> <span class="op">&lt;-</span> <span class="va">contrasts</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">contrasts</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>The following code fragment computes contrasts from the linear
models. In the presence of missing values, some PTMs cannot be fitted by
the model. Therefore, we also estimate contrast using the
<code>ContrastsMissing</code> method, which estimates missing values
based on the inferred limit of detection (for more details, see <span class="citation">[<a href="#ref-10.1021/acs.jproteome.2c00441">34</a>]</span>).</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ctr</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/prolfqua/man/Contrasts.html" class="external-link">Contrasts</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">models</span>, <span class="va">contrasts</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">ctr</span><span class="op">$</span><span class="fu">get_contrasts</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ctr_m</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/prolfqua/man/ContrastsMissing.html" class="external-link">ContrastsMissing</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">ptm_data</span>, <span class="va">contrasts</span><span class="op">)</span></span>
<span><span class="va">ctr_all</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/prolfqua/man/merge_contrasts_results.html" class="external-link">merge_contrasts_results</a></span><span class="op">(</span><span class="va">ctr</span>, <span class="va">ctr_m</span><span class="op">)</span><span class="op">$</span><span class="va">merged</span></span>
<span><span class="va">ctr_mod</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/prolfqua/man/ContrastsModerated.html" class="external-link">ContrastsModerated</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">ctr_all</span><span class="op">)</span></span>
<span><span class="va">ctr_df</span> <span class="op">&lt;-</span> <span class="va">ctr_mod</span><span class="op">$</span><span class="fu">get_contrasts</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can create a volcano plot of the DPU results using the
<code>ctr_plotter</code> variable, which is an instance of the
<code><a href="https://rdrr.io/pkg/prolfqua/man/ContrastsPlotter.html" class="external-link">prolfqua::ContrastsPlotter</a></code> class (see Figure
@ref(fig:fig4FDRcorrfirst)).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ctr_plotter</span> <span class="op">&lt;-</span> <span class="va">ctr_all</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">fig4_plot</span> <span class="op">&lt;-</span> <span class="va">ctr_plotter</span><span class="op">$</span><span class="fu">volcano</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">FDR</span></span></code></pre></div>
<p>To enable downstream analyses such as sequence motif analysis and
PTM-SEA, we need to enrich the contrast results with sequence window
information. The <code>phospho_res</code> dataframe loaded earlier
contains all the annotation data we need.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select relevant columns from phospho_res for joining</span></span>
<span><span class="va">site_annotations</span> <span class="op">&lt;-</span> <span class="va">phospho_res</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    site_Id <span class="op">=</span> <span class="va">protein_Id</span>,</span>
<span>    <span class="va">SequenceWindow</span>,</span>
<span>    <span class="va">posInProtein</span>,</span>
<span>    <span class="va">modAA</span>,</span>
<span>    <span class="va">description</span>,</span>
<span>    <span class="va">protein_length</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Join to contrast results</span></span>
<span><span class="va">ctr_df_annotated</span> <span class="op">&lt;-</span> <span class="va">ctr_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">site_annotations</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"modelName"</span> <span class="op">=</span> <span class="st">"site_Id"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename columns to match the model-first output format</span></span>
<span><span class="va">ctr_df_annotated</span> <span class="op">&lt;-</span> <span class="va">ctr_df_annotated</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    diff_diff <span class="op">=</span> <span class="va">diff</span>,</span>
<span>    FDR_I <span class="op">=</span> <span class="va">FDR</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Save correct-first results alongside model-first output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">ctr_df_annotated</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">res_dir</span>, <span class="st">"ctr_df_annotated_correctfirst.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code>ctr_df_annotated</code> dataframe now contains both the DPU
statistics
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold changes, p-values, FDR) and the sequence annotations needed for
motif analysis and kinase activity inference.</p>
</div>
<div class="section level3">
<h3 id="sequence-logo-analysis-of-modified-sites">Sequence Logo Analysis of Modified Sites<a class="anchor" aria-label="anchor" href="#sequence-logo-analysis-of-modified-sites"></a>
</h3>
<p>This section guides the biological interpretation of PTM changes by
analyzing sequence motifs surrounding significantly modified sites to
identify potential kinase recognition patterns. This analysis bridges
the gap between statistical significance and biological mechanism (see
Note @ref(overinterpret)) by leveraging the well-established principle
that kinases recognize specific amino acid sequence patterns around
their target sites.</p>
<p>Protein kinases exhibit sequence specificity, preferentially
phosphorylating sites that match their recognition motifs. These motifs
typically encompass positions -5 to +4 relative to the phosphorylation
site, with specific positions being more critical than others. By
analyzing the sequence patterns of significantly regulated sites, we
can:</p>
<ul>
<li>Identify active kinases: Sites that share similar motifs likely
represent targets of the same kinase or kinase family. Table
@ref(tab:tablesites) shows examples of kinase-specific sequence
motives.</li>
<li>Understand pathway activation: Different kinase families are
associated with different signaling pathways</li>
<li>Predict functional consequences: Kinase-specific phosphorylation
often has predictable effects on protein function</li>
<li>Generate testable hypotheses: Motif predictions can guide follow-up
experiments with kinase inhibitors or knockdowns</li>
</ul>
<p>To identify potential kinases responsible for the observed
phosphorylation changes, sequence motif analysis is performed on
significantly regulated PTM sites identified in the DPU analysis. For
each contrast, amino acid sequences flanking the significantly regulated
sites (i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>D</mi><mi>R</mi><mo>&lt;</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">FDR &lt; 0.01</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>F</mi><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>&gt;</mo><mn>0.58</mn></mrow><annotation encoding="application/x-tex">|\log_2(FC)| &gt; 0.58</annotation></semantics></math>)
are extracted and grouped by regulation status (i.e., upregulated or
downregulated). The <code>ggseqlogo</code> <em>R</em> package is then
used to generate sequence logo plots for each group. These plots
visualize conserved amino acid patterns around the modification site,
facilitating comparison to known kinase recognition motifs and enabling
inference of upstream regulatory kinases (see Table
@ref(tab:tablesites)).</p>
<p>The analysis focuses on sites with strong statistical evidence to
ensure that motif patterns reflect genuine biological changes rather
than technical artifacts. For this dataset, this stringent filtering
yields many sites (see Table @ref(tab:tableSignificantContrasts)).
However, for other datasets, the number of sites might be insufficient
for creating sequence logos (see Note @ref(nosignificantPTM)).</p>
<p>We start by filtering the DPU data by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>F</mi><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>&gt;</mo><mn>0.58</mn></mrow><annotation encoding="application/x-tex">|\log_2(FC)| &gt; 0.58</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>D</mi><mi>R</mi><mo>≤</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">FDR \le 0.05</annotation></semantics></math>.
The Table @ref(tab:tableSignificantContrasts) summarizes the number of
PTM-features for each contrast, modification site, and up- or
down-regulation. We observe that for serine (S) and threonine (T), there
are many up- and downregulated sites, while for tyrosine (Y), there are
only a few.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_2FC_threshold</span> <span class="op">&lt;-</span> <span class="fl">0.58</span></span>
<span></span>
<span></span>
<span><span class="va">significant_sites</span> <span class="op">&lt;-</span> <span class="va">combined_test_diff</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">FDR_I</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">diff_diff</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">log_2FC_threshold</span>, </span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">posInProtein</span><span class="op">)</span>, </span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^_"</span>, <span class="va">SequenceWindow</span><span class="op">)</span>,</span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"_$"</span>, <span class="va">SequenceWindow</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    regulation <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case-and-replace-when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">diff_diff</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"upregulated"</span>,</span>
<span>      <span class="va">diff_diff</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"downregulated"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"no_change"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Before generating sequence logos, we must ensure that the sequence
windows are properly centered on the phosphorylation site. This code
validates that the 8th character (center position) of each sequence
window matches the reported modified amino acid (Note
@ref(seqwindow)).</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">significant_sites</span><span class="op">$</span><span class="va">seventh_chars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">significant_sites</span><span class="op">$</span><span class="va">SequenceWindow</span>, <span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">significant_sites</span> <span class="op">&lt;-</span> <span class="va">significant_sites</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seventh_chars</span> <span class="op">==</span> <span class="va">modAA</span><span class="op">)</span></span></code></pre></div>
<p>We generate sequence logos for sites of significantly regulated
serine and threonine phosphorylation. The plots are organized by
contrast in a 3-column layout showing upregulated sites, downregulated
sites, and their difference (Up - Down). The difference column
highlights amino acids that are enriched in upregulated sites (positive,
above baseline) versus downregulated sites (negative, below baseline),
helping to identify kinase-specific motifs (see Figure
@ref(fig:fig5seqlogoST)).</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sig_sites_ST</span> <span class="op">&lt;-</span> <span class="va">significant_sites</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">modAA</span> <span class="op">==</span> <span class="st">"S"</span> <span class="op">|</span> <span class="va">modAA</span> <span class="op">==</span> <span class="st">"T"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig5_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_seqlogo_with_diff.html">plot_seqlogo_with_diff</a></span><span class="op">(</span><span class="va">sig_sites_ST</span><span class="op">)</span></span></code></pre></div>
<p>This analysis helps identify the signaling pathways and kinases
responsible for the observed changes in phosphorylation under your
experimental conditions. When motif analysis yields weak or absent
sequence patterns, several factors may require optimization, including
the number of significant sites, the sequence window size used for motif
extraction (see Note @ref(motiflimit)).</p>
</div>
<div class="section level3">
<h3 id="kinase-activity-inference-using-ptm-pipeline">Kinase Activity Inference Using <code>ptm-pipeline</code><a class="anchor" aria-label="anchor" href="#kinase-activity-inference-using-ptm-pipeline"></a>
</h3>
<p>Kinase activity can be inferred from phosphoproteomics data by
testing whether known or predicted substrates of a kinase are
coordinately shifted in a ranked list of regulated phosphosites. Two
complementary resources for defining kinase–substrate sets are (i)
curated signatures from PTMsigDB (distributed via MSigDB’s PTMsig
collection) and (ii) motif specificity models from The Kinase
Library.</p>
<p>PTMsigDB / MSigDB PTMsig collection. The PTMsig collection (PTMsigDB)
provides literature-curated, PTM site–specific signature sets for
site-centric enrichment analysis, including kinase–substrate signatures,
perturbation signatures (e.g., growth factor or inhibitor treatment),
and pathway-related site signatures. Here, a “signature” refers to a
named set of many phosphosites (analogous to a gene set in classic
GSEA), not to a single sequence window. To maximize compatibility across
search engines and protein database versions, PTMsigDB distributes
signatures using multiple site identifier schemes, most commonly
phosphosite-centered flanking sequences (typically
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>±</mi><mn>7</mn></mrow><annotation encoding="application/x-tex">\pm 7</annotation></semantics></math>
amino acids around the modified residue; 15-mers) as well as
UniProt-centric residue identifiers (and optionally PhosphoSitePlus
site-group IDs). PTMsigDB provides organism-specific releases for human,
mouse, and rat; in the original PTMsigDB publication, the total number
of available signature sets was on the order of hundreds (reported as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo><mn>490</mn></mrow><annotation encoding="application/x-tex">\approx 490</annotation></semantics></math>),
and counts vary by database version and organism.</p>
<p>The Kinase Library. A more comprehensive, model-based resource is The
Kinase Library <span class="citation">[<a href="#ref-10.1038/s41586-022-05575-3">43</a>]</span>, which profiled
substrate sequence preferences for 303 human Ser/Thr kinases (covering
&gt;84% of those predicted to be active) and provides position-specific
scoring matrices (PSSMs). Unlike curated substrate lists that require
exact matches to previously observed sites, PSSMs assign a quantitative
compatibility score to any observed sequence window, enabling
kinase–substrate relationships to be inferred without perfect matching.
This makes it straightforward to construct “kinase substrate sets” by
applying a score threshold or selecting the top-ranked sites per kinase,
which can then be used as input signatures for enrichment testing.</p>
<p>PTM Signature Enrichment Analysis (PTM-SEA) using GSEA. Once
kinase–substrate sets are defined (from PTMsigDB, motif/PSSM scoring, or
both), kinase activity can be inferred quantitatively using PTM-SEA
<span class="citation">[<a href="#ref-10.1074/mcp.TIR118.000943">29</a>]</span>, which adapts the
Gene Set Enrichment Analysis (GSEA) framework <span class="citation">[<a href="#ref-10.1073/pnas.0506580102">44</a>]</span> to site-centric data.
Phosphosites (or their sequence-window identifiers) are ranked by a
differential signal (e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold change or a t-statistic). GSEA then tests whether members of a
kinase’s substrate set tend to occur near the top or bottom of this
ranked list more than expected under a null model of uniform
distribution. The enrichment score is computed by walking down the
ranked list, increasing a running sum when a set member is encountered
and decreasing it otherwise. Positive enrichment is consistent with
increased kinase activity (substrates preferentially upregulated), while
negative enrichment is consistent with reduced activity.</p>
<p>Practical considerations and coverage. PTMsigDB signatures provide
high-confidence, literature-supported kinase assignments, but they are
constrained by database coverage and identifier matching (including the
need for consistent site definitions and sequence context). These
constraints become more pronounced outside human (and to a lesser extent
mouse/rat). In contrast, motif-based scanning (e.g., basophilic motifs
such as R-x-x-S/T for PKA/CaMKII-like kinases) and Kinase Library PSSMs
generalize to any observed sequence window, enabling broader application
across datasets where curated substrate evidence is sparse—while trading
off direct experimental validation at the individual site level.</p>
<p>In <code>ptm-pipeline</code> <span class="citation">[<a href="#ref-10.5281/zenodo.18349420">45</a>]</span>, kinase activity
inference is implemented as an automated workflow that uses
<code>prolfquapp</code>/<code>prophosqua</code> to generate differential
phosphorylation abundance (DPA) and differential phosphorylation usage
(DPU) results under both the “model” and “correct-first” strategies. It
then performs GSEA-based PTM-SEA using kinase substrate signatures from
PTMsigDB as well as Kinase Library–derived sets generated by PSSM
scoring of phosphosite sequence windows. The workflow is provided as a
command-line tool and executed via a <em>Snakemake</em> pipeline. The
source code is available at <a href="https://github.com/wolski/ptm-pipeline" class="external-link">github.com/wolski/ptm-pipeline</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<div class="section level3">
<h3 id="notelfq">Label-free quantification vs. TMT-based approach<a class="anchor" aria-label="anchor" href="#notelfq"></a>
</h3>
<p>TMT-based quantification offers several advantages, including higher
throughput, reduced missing values, and improved quantitative precision,
while also enabling efficient use of fractionation since all samples are
represented within each fraction. In contrast, label-free approaches
avoid labeling-related artifacts, can handle an unlimited number of
samples, and typically have lower per-sample costs. Fractionation
strategies benefit particularly from TMT, as all samples can be compared
directly within each fraction with reliable cross-fraction integration.
In contrast, data-independent acquisition (DIA) is often preferred when
avoiding fractionation altogether. Overall, we recommend TMT for studies
requiring high precision across multiple conditions, particularly when
fractionation can be leveraged to increase depth. In contrast,
label-free or DIA workflows are well-suited for discovery-phase studies
or experiments where the number of samples exceeds the multiplexing
capacity.</p>
</div>
<div class="section level3">
<h3 id="automatedqc">Automated QC reporting with <em>FragPipe</em> TMT QC script<a class="anchor" aria-label="anchor" href="#automatedqc"></a>
</h3>
<p>The <code>prophosqua</code><span class="citation">[<a href="#ref-10.5281/zenodo.15845272">33</a>]</span> package vignette
<code>QCReport.qmd</code> can be used to generate a comprehensive TMT
labeling efficiency report, directly from <em>FragPipe</em> PSM
<code>psm.tsv</code> output file. The script evaluates labeling
completeness at both peptide and PSM levels for N-terminal and lysine
modifications, calculates missed cleavage rates for tryptic digestion
efficiency, and provides quantitative balance assessment across all TMT
channels. Key metrics include the percentage of modified N-termini and
lysine residues (expected to be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">\ge 95\%</annotation></semantics></math>),
missed cleavage rates for lysine and arginine residues, and relative
abundance distributions across channels to detect loading imbalances. To
assess labeling efficiency, the TMT labeling of lysine residues and
peptide N-termini must be specified as a variable modification in the
search.</p>
</div>
<div class="section level3">
<h3 id="useofDPADPU">Use of the integrated DPA/DPU approach<a class="anchor" aria-label="anchor" href="#useofDPADPU"></a>
</h3>
<p>The integrated DPA/DPU approach is most suitable when the biological
system under study exhibits substantial changes in protein expression.
In such cases, distinguishing between signaling effects and
expression-driven effects is essential, and including protein abundance
measurements as part of the study design allows these two sources of
variation to be effectively separated.</p>
<p>In contrast, enriched phosphoproteome measurements without
corresponding protein data can be considered when protein expression is
expected to remain stable across conditions, for example, in experiments
with very short timescales where transcriptional or translational
changes are unlikely. This strategy may also be justified when budget
limitations make comprehensive protein quantification infeasible.</p>
</div>
<div class="section level3">
<h3 id="matchrates">Match Rates<a class="anchor" aria-label="anchor" href="#matchrates"></a>
</h3>
<p>When evaluating integration between PTM and protein datasets, match
rates above
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>80</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">80\%</annotation></semantics></math>
generally indicate good consistency. In contrast, lower rates may
reflect differences in protein assignment between the PTM-enriched and
total proteome analyses. In cases where match rates fall below
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>60</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">60\%</annotation></semantics></math>,
the underlying cause is often inconsistent protein identifiers between
the two datasets. To address this, it is essential to verify that both
analyses utilized the same FASTA database and identical protein
inference settings, with particular attention to database versions and
the inclusion of contaminant sequences. As a preventative measure,
identical search parameters and databases should always be applied to
both total proteome and PTM analyses, while sequence-based matching can
further improve alignment across datasets.</p>
</div>
<div class="section level3">
<h3 id="nosignificantPTM">No significant PTM sites detected despite biological
expectation<a class="anchor" aria-label="anchor" href="#nosignificantPTM"></a>
</h3>
<p>The absence of significant PTM sites, even when biological regulation
is expected, can arise from several factors. Error propagation from both
PTM and protein measurements may amplify overall uncertainty, masking
accurate signals. Insufficient statistical power is another common
cause, emphasizing the need for at least three biological replicates per
group and, where possible, increasing sample size or reducing technical
variability. In some cases, stringent statistical thresholds may obscure
true positives, and adopting a more permissive cutoff (e.g., FDR = 0.25
instead of 0.05) during exploratory analysis can be informative.
Normalization problems, such as batch effects or inconsistent sample
loading, may also contribute and should be checked carefully. Outliers
in the data can further distort inference, making it useful to inspect
density or scatter plots, for example, in <code>prolfquapp</code>
reports. Finally, examining the distribution of p-values in
quality-control summaries can help assess whether the statistical model
adequately explains the variance in the data.</p>
<p>When no significant differential peptidoform usage (DPU) sites are
detected despite clear changes in PTMs, one possible explanation is that
the PTM changes are proportional to changes in the parent protein,
indicating no alteration in modification stoichiometry. In many cases,
this represents a valid biological result rather than a technical issue,
and it is advisable to verify it by inspecting individual examples where
protein and PTM changes are closely correlated. Alternatively, such an
outcome may suggest that the experimental perturbation primarily
influences protein expression rather than signaling activity.</p>
</div>
<div class="section level3">
<h3 id="compperf">Computational Performance Issues<a class="anchor" aria-label="anchor" href="#compperf"></a>
</h3>
<p>Long processing times for N-to-C plots often occur because generating
individual plots for hundreds of proteins is computationally intensive.
A practical solution is to limit plot generation to proteins of
particular interest, such as those with small FDR values and substantial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold changes, rather than producing plots for all detected proteins.</p>
</div>
<div class="section level3">
<h3 id="qcrecommend">Quality Control Recommendations<a class="anchor" aria-label="anchor" href="#qcrecommend"></a>
</h3>
<p>When focusing on specific phosphorylation sites, it is essential to
validate key findings by carefully inspecting high-confidence DPU sites
to ensure both technical and biological plausibility. For example, this
can be achieved by verifying the number of missing values in each
treatment group. In addition, protein coverage should be verified, since
meaningful interpretation of phosphorylation changes requires that the
corresponding proteins have sufficient coverage in the total proteome.
The number of peptides identified per protein, as reported in the
<code>prolfquapp</code> output, can serve as a filtering criterion.</p>
</div>
<div class="section level3">
<h3 id="overinterpret">Overinterpretation of statistical significance<a class="anchor" aria-label="anchor" href="#overinterpret"></a>
</h3>
<p>Overinterpretation of statistical significance can occur when FDR
estimates are reported without considering the design of the experiment
or its biological context. A statistically significant finding does not
necessarily imply biological relevance; therefore, it is essential to
evaluate effect sizes alongside p-values to assess the magnitude and
potential impact of a change. Key findings should also be validated with
orthogonal methods to ensure that they reflect genuine biological
regulation rather than statistical or technical artifacts.</p>
</div>
<div class="section level3">
<h3 id="dpuvsdpa">DPA vs DPU Interpretation<a class="anchor" aria-label="anchor" href="#dpuvsdpa"></a>
</h3>
<p>Conflicting results between DPA and DPU analyses can be due to:</p>
<ul>
<li>DPA+ only: Changes driven by protein abundance alterations</li>
<li>DPU+ only: True signaling changes with stable protein levels</li>
<li>DPA+ and DPU+: Amplified signaling (both protein and modification
efficiency increase)</li>
<li>DPA- and DPU+: Compensatory regulation (modification increases
despite protein decrease)</li>
</ul>
<p>Such discrepancies between DPA and DPU are often informative rather
than problematic. Sites that are significant in DPA but not in DPU
typically reflect protein-driven changes, whereas DPU-only sites
indicate genuine signaling regulation independent of protein abundance.
To assess their biological plausibility, these results should be
cross-referenced with known biology and supporting literature.</p>
</div>
<div class="section level3">
<h3 id="keyinsight">Key Insights from This Analysis<a class="anchor" aria-label="anchor" href="#keyinsight"></a>
</h3>
<p>This integrated analysis distinguishes PTM feature abundance from
usage changes, enabling site-specific insights into how phosphorylation
and other PTMs are regulated. By linking DPA and DPU results, it
clarifies whether observed changes reflect protein-level expression or
signaling pathway activity, and it highlights key regulatory sites for
functional validation. Visualization in sequence context and rigorous
statistical modeling further support interpretation, allowing
researchers to generate mechanistic hypotheses, identify pathway-level
regulation, and prioritize targeted follow-up experiments.</p>
</div>
<div class="section level3">
<h3 id="seqwindow">Extracting sequence windows with <code>prophosqua</code><a class="anchor" aria-label="anchor" href="#seqwindow"></a>
</h3>
<p>Although <em>FragPipe</em> reports the sequence windows in the
single-site report, we observed that some of the extracted windows are
not correctly aligned, making the filtering step necessary. Some
upstream quantification applications only report the modified amino acid
and the position in the protein sequence. For those cases, the
<code>prophosqua</code> function <code>get_sequence_windows</code> can
be used. The function expects a dataframe with two columns: the protein
sequences and the position of the modified amino acid. For details, see
<code>prophosqua</code> documentation <span class="citation">[<a href="#ref-10.5281/zenodo.15845272">33</a>]</span>.</p>
</div>
<div class="section level3">
<h3 id="motiflimit">Motif Analysis Limitations<a class="anchor" aria-label="anchor" href="#motiflimit"></a>
</h3>
<p>Weak or absent sequence motifs in significantly regulated sites can
arise for several reasons. One possibility is that too few significant
sites were detected, which limits the statistical power of motif
discovery. In such cases, it can be helpful to lower the threshold
specifically for motif analysis to increase the number of sites
included. Mixed kinase activities may also obscure motifs, and
separating upregulated from downregulated sites often clarifies distinct
regulatory patterns. Additionally, regulation may occur through
non-canonical mechanisms, such as phosphatases or protein–protein
interactions, rather than through specific kinase recognition motifs.
Other technical considerations, such as the choice of sequence window
size (e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>±</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">\pm 5</annotation></semantics></math>
versus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>±</mi><mn>7</mn></mrow><annotation encoding="application/x-tex">\pm 7</annotation></semantics></math>
amino acids), and biological factors like PTM crosstalk, can also
influence motif detection and interpretation.</p>
<p>Overall, weak motif signals can result from an insufficient number of
significant sites, the presence of multiple overlapping regulatory
activities, or regulation by mechanisms that do not rely on canonical
sequence motifs. To address these issues, one can lower the significance
threshold for motif analysis to capture more sites. If no clear kinase
sequence pattern emerges, keep in mind that regulation may involve
non-kinase pathways, which underscores the importance of considering
both statistical and biological explanations when interpreting motif
analysis results.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body">
<div id="ref-10.1080/14789450.2021.1976152" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Gerritsen JS, White FM (2021)
Phosphoproteomics: A valuable tool for uncovering molecular signaling in
cancer cells. Expert Review of Proteomics 18:661–674. <a href="https://doi.org/10.1080/14789450.2021.1976152" class="external-link">https://doi.org/10.1080/14789450.2021.1976152</a>
</div>
</div>
<div id="ref-10.1186/1477-5956-4-15" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">Delom F, Chevet E (2006). Proteome Science
4:15. <a href="https://doi.org/10.1186/1477-5956-4-15" class="external-link">https://doi.org/10.1186/1477-5956-4-15</a>
</div>
</div>
<div id="ref-10.1016/j.mcpro.2024.100754" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">Bortel P, Piga I, Koenig C, et al (2024)
Systematic optimization of automated phosphopeptide enrichment for
high-sensitivity phosphoproteomics. Molecular &amp; Cellular Proteomics
23:100754. <a href="https://doi.org/10.1016/j.mcpro.2024.100754" class="external-link">https://doi.org/10.1016/j.mcpro.2024.100754</a>
</div>
</div>
<div id="ref-10.1016/j.mcpro.2022.100477" class="csl-entry">
<div class="csl-left-margin">4. </div>
<div class="csl-right-inline">Kohler D, Tsai T-H, Verschueren E, et al (2023)
MSstatsPTM: Statistical relative quantification of posttranslational
modifications in bottom-up mass spectrometry-based proteomics. Molecular
&amp; Cellular Proteomics 22:100477. <a href="https://doi.org/10.1016/j.mcpro.2022.100477" class="external-link">https://doi.org/10.1016/j.mcpro.2022.100477</a>
</div>
</div>
<div id="ref-10.1016/j.mcpro.2023.100708" class="csl-entry">
<div class="csl-left-margin">5. </div>
<div class="csl-right-inline">Demeulemeester N, Gbelin M, Caldi Gomes L, et
al (2024) msqrob2PTM: Differential abundance and differential usage
analysis of MS-based proteomics data at the posttranslational
modification and peptidoform level. Molecular &amp; Cellular Proteomics
23:100708. <a href="https://doi.org/10.1016/j.mcpro.2023.100708" class="external-link">https://doi.org/10.1016/j.mcpro.2023.100708</a>
</div>
</div>
<div id="ref-10.1039/c5mb00024f" class="csl-entry">
<div class="csl-left-margin">6. </div>
<div class="csl-right-inline">Solari FA, Dell’Aica M, Sickmann A, Zahedi RP
(2015) Why phosphoproteomics is still a challenge. Molecular BioSystems
11:1487–1493. <a href="https://doi.org/10.1039/c5mb00024f" class="external-link">https://doi.org/10.1039/c5mb00024f</a>
</div>
</div>
<div id="ref-10.1016/j.aca.2021.338716" class="csl-entry">
<div class="csl-left-margin">7. </div>
<div class="csl-right-inline">Wentzell PD, Gonalves TR, Matsushita M,
Valderrama P (2021) Combinatorial projection pursuit analysis for
exploring multivariate chemical data. Analytica Chimica Acta
1174:338716. <a href="https://doi.org/10.1016/j.aca.2021.338716" class="external-link">https://doi.org/10.1016/j.aca.2021.338716</a>
</div>
</div>
<div id="ref-10.1038/nbt.3327" class="csl-entry">
<div class="csl-left-margin">8. </div>
<div class="csl-right-inline">Humphrey SJ, Azimifar SB, Mann M (2015)
High-throughput phosphoproteomics reveals in vivo insulin signaling
dynamics. Nature Biotechnology 33:990–995. <a href="https://doi.org/10.1038/nbt.3327" class="external-link">https://doi.org/10.1038/nbt.3327</a>
</div>
</div>
<div id="ref-10.1038/s41467-018-03309-6" class="csl-entry">
<div class="csl-left-margin">9. </div>
<div class="csl-right-inline">Hogrebe A, Stechow L von, Bekker-Jensen DB, et
al (2018) Benchmarking common quantification strategies for large-scale
phosphoproteomics. Nature Communications 9: <a href="https://doi.org/10.1038/s41467-018-03309-6" class="external-link">https://doi.org/10.1038/s41467-018-03309-6</a>
</div>
</div>
<div id="ref-10.1021/acs.jproteome.4c00668" class="csl-entry">
<div class="csl-left-margin">10. </div>
<div class="csl-right-inline">Zuniga NR, Frost DC, Kuhn K, et al (2024)
Achieving a 35-plex tandem mass tag reagent set through deuterium
incorporation. Journal of Proteome Research 23:5153–5165. <a href="https://doi.org/10.1021/acs.jproteome.4c00668" class="external-link">https://doi.org/10.1021/acs.jproteome.4c00668</a>
</div>
</div>
<div id="ref-10.1021/ac0262560" class="csl-entry">
<div class="csl-left-margin">11. </div>
<div class="csl-right-inline">Thompson A, Schfer J, Kuhn K, et al (2003)
Tandem mass tags: A novel quantification strategy for comparative
analysis of complex protein mixtures by MS/MS. Analytical Chemistry
75:1895–1904. <a href="https://doi.org/10.1021/ac0262560" class="external-link">https://doi.org/10.1021/ac0262560</a>
</div>
</div>
<div id="ref-10.1074/mcp.m114.045609" class="csl-entry">
<div class="csl-left-margin">12. </div>
<div class="csl-right-inline">Rauniyar N, Subramanian K, Lavalle-Adam M, et
al (2015) Quantitative proteomics of human fibroblasts with I1061T
mutation in niemann–pick C1 (NPC1) protein provides insights into the
disease pathogenesis*. Molecular &amp; Cellular Proteomics 14:1734–1749.
<a href="https://doi.org/10.1074/mcp.m114.045609" class="external-link">https://doi.org/10.1074/mcp.m114.045609</a>
</div>
</div>
<div id="ref-10.1101/2020.04.13.038810" class="csl-entry">
<div class="csl-left-margin">13. </div>
<div class="csl-right-inline">Diez IA, Govender I, Naicker P, et al (2020)
Zirconium(IV)-IMAC for phosphopeptide enrichment in phosphoproteomics.
<a href="https://doi.org/10.1101/2020.04.13.038810" class="external-link">https://doi.org/10.1101/2020.04.13.038810</a>
</div>
</div>
<div id="ref-10.1002/pmic.202100245" class="csl-entry">
<div class="csl-left-margin">14. </div>
<div class="csl-right-inline">Koenig C, MartinezVal A, Franciosa G, Olsen JV
(2022) Optimal analytical strategies for sensitive and quantitative
phosphoproteomics using TMTbased multiplexing. PROTEOMICS 22: <a href="https://doi.org/10.1002/pmic.202100245" class="external-link">https://doi.org/10.1002/pmic.202100245</a>
</div>
</div>
<div id="ref-10.1021/acs.jproteome.0c00536" class="csl-entry">
<div class="csl-left-margin">15. </div>
<div class="csl-right-inline">Burger B, Vaudel M, Barsnes H (2020) Importance
of block randomization when designing proteomics experiments. Journal of
Proteome Research 20:122–128. <a href="https://doi.org/10.1021/acs.jproteome.0c00536" class="external-link">https://doi.org/10.1021/acs.jproteome.0c00536</a>
</div>
</div>
<div id="ref-10.1021/acs.jproteome.4c00869" class="csl-entry">
<div class="csl-left-margin">16. </div>
<div class="csl-right-inline">Ferretti D, Kyriakidou P, Xiao J, et al (2025)
Isobaric labeling update in MaxQuant. Journal of Proteome Research
24:1219–1229. <a href="https://doi.org/10.1021/acs.jproteome.4c00869" class="external-link">https://doi.org/10.1021/acs.jproteome.4c00869</a>
</div>
</div>
<div id="ref-10.1038/s41467-023-39891-7" class="csl-entry">
<div class="csl-left-margin">17. </div>
<div class="csl-right-inline">Marini G, Poland B, Leininger C, et al (2023)
Structural journey of an insecticidal protein against western corn
rootworm. Nature Communications 14: <a href="https://doi.org/10.1038/s41467-023-39891-7" class="external-link">https://doi.org/10.1038/s41467-023-39891-7</a>
</div>
</div>
<div id="ref-10.1021/acs.jproteome.1c00678" class="csl-entry">
<div class="csl-left-margin">18. </div>
<div class="csl-right-inline">Farag YM, Horro C, Vaudel M, Barsnes H (2021)
PeptideShaker online: A user-friendly web-based framework for the
identification of mass spectrometry-based proteomics data. Journal of
Proteome Research 20:5419–5423. <a href="https://doi.org/10.1021/acs.jproteome.1c00678" class="external-link">https://doi.org/10.1021/acs.jproteome.1c00678</a>
</div>
</div>
<div id="ref-10.1038/s41467-020-17914-x" class="csl-entry">
<div class="csl-left-margin">19. </div>
<div class="csl-right-inline">Im
JH, Buzzelli JN, Jones K, et al (2020) FGF2 alters macrophage
polarization, tumour immunity and growth and can be targeted during
radiotherapy. Nature Communications 11: <a href="https://doi.org/10.1038/s41467-020-17914-x" class="external-link">https://doi.org/10.1038/s41467-020-17914-x</a>
</div>
</div>
<div id="ref-10.1021/pr200611n" class="csl-entry">
<div class="csl-left-margin">20. </div>
<div class="csl-right-inline">Taus T, Kcher T, Pichler P, et al (2011)
Universal and confident phosphorylation site localization using
phosphoRS. Journal of Proteome Research 10:5354–5362. <a href="https://doi.org/10.1021/pr200611n" class="external-link">https://doi.org/10.1021/pr200611n</a>
</div>
</div>
<div id="ref-10.1038/nbt1240" class="csl-entry">
<div class="csl-left-margin">21. </div>
<div class="csl-right-inline">Beausoleil SA, Villn J, Gerber SA, et al (2006)
A probability-based approach for high-throughput protein phosphorylation
analysis and site localization. Nature Biotechnology 24:1285–1292. <a href="https://doi.org/10.1038/nbt1240" class="external-link">https://doi.org/10.1038/nbt1240</a>
</div>
</div>
<div id="ref-10.1101/2025.05.27.656447" class="csl-entry">
<div class="csl-left-margin">22. </div>
<div class="csl-right-inline">Chang H-Y, Deng Y, Li R, et al (2025) Analysis
of isobaric quantitative proteomic data using TMT-integrator and
FragPipe computational platform. <a href="https://doi.org/10.1101/2025.05.27.656447" class="external-link">https://doi.org/10.1101/2025.05.27.656447</a>
</div>
</div>
<div id="ref-10.1038/nmeth.4256" class="csl-entry">
<div class="csl-left-margin">23. </div>
<div class="csl-right-inline">Kong AT, Leprevost FV, Avtonomov DM, et al
(2017) MSFragger: Ultrafast and comprehensive peptide identification in
mass spectrometry–based proteomics. Nature Methods 14:513–520. <a href="https://doi.org/10.1038/nmeth.4256" class="external-link">https://doi.org/10.1038/nmeth.4256</a>
</div>
</div>
<div id="ref-10.1021/acs.jproteome.9b00205" class="csl-entry">
<div class="csl-left-margin">24. </div>
<div class="csl-right-inline">Shteynberg DD, Deutsch EW, Campbell DS, et al
(2019) PTMProphet: Fast and accurate mass modification localization for
the trans-proteomic pipeline. Journal of Proteome Research 18:4262–4272.
<a href="https://doi.org/10.1021/acs.jproteome.9b00205" class="external-link">https://doi.org/10.1021/acs.jproteome.9b00205</a>
</div>
</div>
<div id="ref-10.1002/pmic.202300088" class="csl-entry">
<div class="csl-left-margin">25. </div>
<div class="csl-right-inline">Joyce AW, Searle BC (2023) Computational
approaches to identify sites of phosphorylation. PROTEOMICS 24: <a href="https://doi.org/10.1002/pmic.202300088" class="external-link">https://doi.org/10.1002/pmic.202300088</a>
</div>
</div>
<div id="ref-10.1074/mcp.m114.044305" class="csl-entry">
<div class="csl-left-margin">26. </div>
<div class="csl-right-inline">Bruderer R, Bernhardt OM, Gandhi T, et al
(2015) Extending the limits of quantitative proteome profiling with
data-independent acquisition and application to acetaminophen-treated
three-dimensional liver microtissues. Molecular &amp; Cellular
Proteomics 14:1400–1410. <a href="https://doi.org/10.1074/mcp.m114.044305" class="external-link">https://doi.org/10.1074/mcp.m114.044305</a>
</div>
</div>
<div id="ref-10.1038/s41592-019-0638-x" class="csl-entry">
<div class="csl-left-margin">27. </div>
<div class="csl-right-inline">Demichev V, Messner CB, Vernardis SI, et al
(2019) DIA-NN: Neural networks and interference correction enable deep
proteome coverage in high throughput. Nature Methods 17:41–44. <a href="https://doi.org/10.1038/s41592-019-0638-x" class="external-link">https://doi.org/10.1038/s41592-019-0638-x</a>
</div>
</div>
<div id="ref-10.1016/j.celrep.2021.108771" class="csl-entry">
<div class="csl-left-margin">28. </div>
<div class="csl-right-inline">Kim
HJ, Kim T, Hoffman NJ, et al (2021) PhosR enables processing and
functional analysis of phosphoproteomic data. Cell Reports 34:108771. <a href="https://doi.org/10.1016/j.celrep.2021.108771" class="external-link">https://doi.org/10.1016/j.celrep.2021.108771</a>
</div>
</div>
<div id="ref-10.1074/mcp.TIR118.000943" class="csl-entry">
<div class="csl-left-margin">29. </div>
<div class="csl-right-inline">Krug K, Mertins P, Zhang B, et al (2019) A
curated resource for phosphosite-specific signature analysis. Molecular
&amp; Cellular Proteomics 18:576–593. <a href="https://doi.org/10.1074/mcp.TIR118.000943" class="external-link">https://doi.org/10.1074/mcp.TIR118.000943</a>
</div>
</div>
<div id="ref-10.1038/s41467-021-21211-6" class="csl-entry">
<div class="csl-left-margin">30. </div>
<div class="csl-right-inline">
<span class="nocase">Ylmaz S, Ayati M,
Schlatzer D, et al</span> (2021) Robust inference of kinase activity
using functional networks. Nature Communications 12: <a href="https://doi.org/10.1038/s41467-021-21211-6" class="external-link">https://doi.org/10.1038/s41467-021-21211-6</a>
</div>
</div>
<div id="ref-10.1186/s12014-020-09290-x" class="csl-entry">
<div class="csl-left-margin">31. </div>
<div class="csl-right-inline">Savage SR, Zhang B (2020) Using
phosphoproteomics data to understand cellular signaling: A comprehensive
guide to bioinformatics resources. Clinical Proteomics 17: <a href="https://doi.org/10.1186/s12014-020-09290-x" class="external-link">https://doi.org/10.1186/s12014-020-09290-x</a>
</div>
</div>
<div id="ref-10.1007/978-1-0716-1967-4_12" class="csl-entry">
<div class="csl-left-margin">32. </div>
<div class="csl-right-inline">Giai Gianetto Q (2021) <a href="https://doi.org/10.1007/978-1-0716-1967-4_12" class="external-link">Statistical analysis
of post-translational modifications quantified by label-free proteomics
across multiple biological conditions with r: Illustration from
SARS-CoV-2 infected cells</a>. In: Statistical analysis of proteomic
data. Springer US, pp 267–302</div>
</div>
<div id="ref-10.5281/zenodo.15845272" class="csl-entry">
<div class="csl-left-margin">33. </div>
<div class="csl-right-inline">Grossmann Jonas, Witold Wolski (2025) <a href="https://doi.org/10.5281/zenodo.15845272" class="external-link">Prolfqua/prophosqua:
0.1.0</a>
</div>
</div>
<div id="ref-10.1021/acs.jproteome.2c00441" class="csl-entry">
<div class="csl-left-margin">34. </div>
<div class="csl-right-inline">
<span class="nocase">Wolski WE, Nanni P,
Grossmann J, et al</span> (2023) Prolfqua: A comprehensive r-package for
proteomics differential expression analysis. Journal of Proteome
Research 22:1092–1104. <a href="https://doi.org/10.1021/acs.jproteome.2c00441" class="external-link">https://doi.org/10.1021/acs.jproteome.2c00441</a>
</div>
</div>
<div id="ref-10.1093/bib/bbr065" class="csl-entry">
<div class="csl-left-margin">35. </div>
<div class="csl-right-inline">Schlatter R, Philippi N, Wangorsch G, et al
(2011) Integration of boolean models exemplified on hepatocyte signal
transduction. Briefings in Bioinformatics 13:365–376. <a href="https://doi.org/10.1093/bib/bbr065" class="external-link">https://doi.org/10.1093/bib/bbr065</a>
</div>
</div>
<div id="ref-10.7554/elife.62320" class="csl-entry">
<div class="csl-left-margin">36. </div>
<div class="csl-right-inline">Maculins T, Verschueren E, Hinkle T, et al
(2021) Multiplexed proteomics of autophagy-deficient murine macrophages
reveals enhanced antimicrobial immunity via the oxidative stress
response. eLife 10: <a href="https://doi.org/10.7554/elife.62320" class="external-link">https://doi.org/10.7554/elife.62320</a>
</div>
</div>
<div id="ref-10.21105/joss.01686" class="csl-entry">
<div class="csl-left-margin">37. </div>
<div class="csl-right-inline">Wickham H, Averick M, Bryan J, et al (2019)
Welcome to the tidyverse. Journal of Open Source Software 4:1686. <a href="https://doi.org/10.21105/joss.01686" class="external-link">https://doi.org/10.21105/joss.01686</a>
</div>
</div>
<div id="ref-10.32614/cran.package.ggseqlogo" class="csl-entry">
<div class="csl-left-margin">38. </div>
<div class="csl-right-inline">(2017) <a href="https://doi.org/10.32614/cran.package.ggseqlogo" class="external-link">Ggseqlogo: A
"ggplot2" extension for drawing publication-ready sequence logos</a>.
CRAN: Contributed Packages</div>
</div>
<div id="ref-10.1021/acs.jproteome.4c00911" class="csl-entry">
<div class="csl-left-margin">39. </div>
<div class="csl-right-inline">Wolski WE, Grossmann J, Schwarz L, et al (2025)
Prolfquapp a user-friendly command-line tool simplifying differential
expression analysis in quantitative proteomics. Journal of Proteome
Research 24:955–965. <a href="https://doi.org/10.1021/acs.jproteome.4c00911" class="external-link">https://doi.org/10.1021/acs.jproteome.4c00911</a>
</div>
</div>
<div id="ref-10.5281/zenodo.15845243" class="csl-entry">
<div class="csl-left-margin">40. </div>
<div class="csl-right-inline">Witold Wolski (2025) <a href="https://doi.org/10.5281/zenodo.15845243" class="external-link">Prolfqua/prolfquappPTMreaders:
0.1.0</a>
</div>
</div>
<div id="ref-10.5281/zenodo.15850770" class="csl-entry">
<div class="csl-left-margin">41. </div>
<div class="csl-right-inline">Dittmann A, Grossmann J, Wolski WE (2025) <a href="https://doi.org/10.5281/zenodo.15850770" class="external-link">FragPipe v22.0 analysis
outputs for phosphoproteomics &amp; total proteome of ATG16L1-deficient
murine macrophages (maculins et al., eLife 2021)</a>
</div>
</div>
<div id="ref-10.5281/zenodo.15830988" class="csl-entry">
<div class="csl-left-margin">42. </div>
<div class="csl-right-inline">Wolski WE, Grossmann J, Dittmann A (2025) <a href="https://doi.org/10.5281/zenodo.15830988" class="external-link">Complete computational
workflow for integrated PTM and total proteome analysis: Distinguishing
expression from usage changes</a>
</div>
</div>
<div id="ref-10.1038/s41586-022-05575-3" class="csl-entry">
<div class="csl-left-margin">43. </div>
<div class="csl-right-inline">
<span class="nocase">Johnson JL, Yaron TM,
Huntsman EM, et al</span> (2023) An atlas of substrate specificities for
the human serine/threonine kinome. Nature 613:759–766. <a href="https://doi.org/10.1038/s41586-022-05575-3" class="external-link">https://doi.org/10.1038/s41586-022-05575-3</a>
</div>
</div>
<div id="ref-10.1073/pnas.0506580102" class="csl-entry">
<div class="csl-left-margin">44. </div>
<div class="csl-right-inline">Subramanian A, Tamayo P, Mootha VK, et al
(2005) Gene set enrichment analysis: A knowledge-based approach for
interpreting genome-wide expression profiles. Proceedings of the
National Academy of Sciences 102:15545–15550. <a href="https://doi.org/10.1073/pnas.0506580102" class="external-link">https://doi.org/10.1073/pnas.0506580102</a>
</div>
</div>
<div id="ref-10.5281/zenodo.18349420" class="csl-entry">
<div class="csl-left-margin">45. </div>
<div class="csl-right-inline">Wolski WE (2025) <a href="https://doi.org/10.5281/zenodo.18349420" class="external-link">Wolski/ptm-pipeline:
0.1.1</a>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="figures">Figures<a class="anchor" aria-label="anchor" href="#figures"></a>
</h2>
<p>(ref:fig1Q64337) Multi-panel N-to-C expression plot showing
differential expression of total protein abundance (light yellow
rectangle) and phosphorylation sites (vertical lines, color coded by
type of residue) along protein sequences across all contrasts. Each
panel represents a different experimental contrast, enabling direct
comparison of protein and PTM expression changes across conditions. The
vertical lines are either dashed or solid, depending on the site’s
imputation status. The x-axis represents amino acid position from N to C
terminus, while the y-axis shows
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold changes. Significantly regulated sites (FDR &lt; 0.05 and FDR &lt;
0.01) are highlighted with one or two red asterisks, respectively.</p>
<div class="figure">
<img src="MiMBIntegratedPTM_files/figure-html/fig1Q64337-1.png" class="r-plt" alt="(ref:fig1Q64337)" width="4200"><p class="caption">
(ref:fig1Q64337)
</p>
</div>
<p>(ref:fig2usageQ64337) Multi-panel N-to-C usage plot showing
differential usage of phosphorylation sites (vertical lines, color-coded
by type of residue) along the protein sequences across all contrasts.
Each panel represents a different experimental contrast, enabling direct
comparison of protein-normalized PTM changes across conditions. The
vertical lines are either dashed or solid, depending on the site’s
imputation status. The x-axis represents amino acid position from N to C
terminus, while the y-axis shows
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold changes. Significantly regulated sites (FDR &lt; 0.05 and FDR &lt;
0.01) are highlighted with one or two red asterisks, respectively.</p>
<div class="figure">
<img src="MiMBIntegratedPTM_files/figure-html/fig2usageQ64337-1.png" class="r-plt" alt="(ref:fig2usageQ64337)" width="4200"><p class="caption">
(ref:fig2usageQ64337)
</p>
</div>
<p>(ref:fig3densityCorrected) Density plot of the total proteome
corrected PTM site abundances.</p>
<div class="figure">
<img src="MiMBIntegratedPTM_files/figure-html/fig3densityCorrected-1.png" class="r-plt" alt="(ref:fig3densityCorrected)" width="3000"><p class="caption">
(ref:fig3densityCorrected)
</p>
</div>
<p>(ref:fig4FDRcorrfirst) Volcano plot showing the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>10</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>F</mi><mi>D</mi><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">-\log_{10}(FDR)</annotation></semantics></math>
as a function of the PTM site
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><annotation encoding="application/x-tex">\log_2</annotation></semantics></math>
fold change.</p>
<div class="figure">
<img src="MiMBIntegratedPTM_files/figure-html/fig4FDRcorrfirst-1.png" class="r-plt" alt="(ref:fig4FDRcorrfirst)" width="3000"><p class="caption">
(ref:fig4FDRcorrfirst)
</p>
</div>
<p>(ref:fig5seqlogoST) Sequence logo plots showing amino acid motifs
surrounding significantly regulated phosphorylation at serine and
threonine residues. Each row represents a contrast with three columns:
upregulated sites (left), downregulated sites (center), and the
difference (right). In the difference column, letters above the baseline
indicate amino acids enriched in upregulated sites, while letters below
the baseline indicate enrichment in downregulated sites. Letter height
corresponds to relative frequency at each position surrounding the
phosphorylation site (position 8).</p>
<div class="figure">
<img src="MiMBIntegratedPTM_files/figure-html/fig5seqlogoST-1.png" class="r-plt" alt="(ref:fig5seqlogoST)" width="3600"><p class="caption">
(ref:fig5seqlogoST)
</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="tables">Tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h2>
<table class="table">
<caption>Annotation table created from FragPipe outputs, with a set of
columns required by prolfquapp</caption>
<thead><tr class="header">
<th align="left">channel</th>
<th align="left">Name</th>
<th align="left">group</th>
<th align="left">subject</th>
<th align="left">CONTROL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KO_Early_1</td>
<td align="left">KO_Early_1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">KO_Early_2</td>
<td align="left">KO_Early_2</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">KO_Late_1</td>
<td align="left">KO_Late_1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">KO_Late_2</td>
<td align="left">KO_Late_2</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">KO_Uninfect_1</td>
<td align="left">KO_Uninfect_1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">KO_Uninfect_2</td>
<td align="left">KO_Uninfect_2</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<table class="table table" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Annotation table with explanatory variables and contrasts.
</caption>
<thead><tr>
<th style="text-align:left;">
channel
</th>
<th style="text-align:left;">
Name
</th>
<th style="text-align:left;">
Group
</th>
<th style="text-align:left;">
ContrastName
</th>
<th style="text-align:left;">
Contrast
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
KO_Early_1
</td>
<td style="text-align:left;">
KO_Early_1
</td>
<td style="text-align:left;">
KO_Early
</td>
<td style="text-align:left;">
KO_vs_WT
</td>
<td style="text-align:left;">
( (G_KO_Uninfect + G_KO_Late + G_KO_Early)/3 - (G_WT_Uninfect +
G_WT_Late + G_WT_Early)/3 )
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_Early_2
</td>
<td style="text-align:left;">
KO_Early_2
</td>
<td style="text-align:left;">
KO_Early
</td>
<td style="text-align:left;">
KO_vs_WT_at_Uninfect
</td>
<td style="text-align:left;">
G_KO_Uninfect - G_WT_Uninfect
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_Late_1
</td>
<td style="text-align:left;">
KO_Late_1
</td>
<td style="text-align:left;">
KO_Late
</td>
<td style="text-align:left;">
KO_vs_WT_at_Late
</td>
<td style="text-align:left;">
G_KO_Late - G_WT_Late
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_Late_2
</td>
<td style="text-align:left;">
KO_Late_2
</td>
<td style="text-align:left;">
KO_Late
</td>
<td style="text-align:left;">
KO_vs_WT_at_Early
</td>
<td style="text-align:left;">
G_KO_Early - G_WT_Early
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_Uninfect_1
</td>
<td style="text-align:left;">
KO_Uninfect_1
</td>
<td style="text-align:left;">
KO_Uninfect
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_Uninfect_2
</td>
<td style="text-align:left;">
KO_Uninfect_2
</td>
<td style="text-align:left;">
KO_Uninfect
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Match rates between PTM sites and proteins.</caption>
<thead><tr class="header">
<th align="left">Contrast</th>
<th align="right">Total Sites</th>
<th align="right">Matched Sites</th>
<th align="right">Match Rate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KO_vs_WT</td>
<td align="right">21733</td>
<td align="right">21000</td>
<td align="right">96.6</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Early</td>
<td align="right">21733</td>
<td align="right">21000</td>
<td align="right">96.6</td>
</tr>
<tr class="odd">
<td align="left">KO_vs_WT_at_Late</td>
<td align="right">21733</td>
<td align="right">21000</td>
<td align="right">96.6</td>
</tr>
<tr class="even">
<td align="left">KO_vs_WT_at_Uninfect</td>
<td align="right">21733</td>
<td align="right">21000</td>
<td align="right">96.6</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Consensus phosphorylation motifs of representative
serine/threonine kinases. Motifs are defined relative to the
phosphorylated residue (S/T at position 0). X = any residue; positions
are relative to the phospho-acceptor serine/threonine (S/T).</caption>
<thead><tr class="header">
<th align="left">Kinase</th>
<th align="left">Consensus_motif</th>
<th align="left">Positional_notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">PKA/PKG</td>
<td align="left">R-R-X-S/T</td>
<td align="left">Arg at -3 and -2</td>
</tr>
<tr class="even">
<td align="left">PKC</td>
<td align="left">R-X-S/T-X-R</td>
<td align="left">Arg at -3 and +2</td>
</tr>
<tr class="odd">
<td align="left">CK2</td>
<td align="left">S/T-X-X-E/D</td>
<td align="left">Acidic residue at +3</td>
</tr>
<tr class="even">
<td align="left">MAPK</td>
<td align="left">P-X-S/T-P</td>
<td align="left">Pro at -2 and +1</td>
</tr>
</tbody>
</table>
<table class="table table" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Number of significantly regulated sites, for each contrast, amino acid
residue, and up- or down-regulation.
</caption>
<thead><tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:left;">
regulation
</th>
<th style="text-align:left;">
modAA
</th>
<th style="text-align:right;">
Freq
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
KO_vs_WT
</td>
<td style="text-align:left;">
downregulated
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
309
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Early
</td>
<td style="text-align:left;">
downregulated
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
170
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Late
</td>
<td style="text-align:left;">
downregulated
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
221
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Uninfect
</td>
<td style="text-align:left;">
downregulated
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
72
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT
</td>
<td style="text-align:left;">
upregulated
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
499
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Early
</td>
<td style="text-align:left;">
upregulated
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
236
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Late
</td>
<td style="text-align:left;">
upregulated
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
315
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Uninfect
</td>
<td style="text-align:left;">
upregulated
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
140
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT
</td>
<td style="text-align:left;">
downregulated
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
85
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Early
</td>
<td style="text-align:left;">
downregulated
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Late
</td>
<td style="text-align:left;">
downregulated
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
79
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Uninfect
</td>
<td style="text-align:left;">
downregulated
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT
</td>
<td style="text-align:left;">
upregulated
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
97
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Early
</td>
<td style="text-align:left;">
upregulated
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
52
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Late
</td>
<td style="text-align:left;">
upregulated
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
65
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Uninfect
</td>
<td style="text-align:left;">
upregulated
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT
</td>
<td style="text-align:left;">
downregulated
</td>
<td style="text-align:left;">
Y
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Early
</td>
<td style="text-align:left;">
downregulated
</td>
<td style="text-align:left;">
Y
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Late
</td>
<td style="text-align:left;">
downregulated
</td>
<td style="text-align:left;">
Y
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Uninfect
</td>
<td style="text-align:left;">
downregulated
</td>
<td style="text-align:left;">
Y
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT
</td>
<td style="text-align:left;">
upregulated
</td>
<td style="text-align:left;">
Y
</td>
<td style="text-align:right;">
42
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Early
</td>
<td style="text-align:left;">
upregulated
</td>
<td style="text-align:left;">
Y
</td>
<td style="text-align:right;">
43
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Late
</td>
<td style="text-align:left;">
upregulated
</td>
<td style="text-align:left;">
Y
</td>
<td style="text-align:right;">
41
</td>
</tr>
<tr>
<td style="text-align:left;">
KO_vs_WT_at_Uninfect
</td>
<td style="text-align:left;">
upregulated
</td>
<td style="text-align:left;">
Y
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonas Grossmann, Witold Wolski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
