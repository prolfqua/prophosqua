<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo • prophosqua</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo"><meta name="description" content="The function computes position weight matrices (PWMs) for both upregulated
and downregulated sites, then calculates their difference (Up - Down).
Positive values indicate amino acids enriched in upregulated sites, while
negative values indicate enrichment in downregulated sites.
This approach is particularly useful for:
Identifying kinases with opposing activity changes
Detecting motif shifts between conditions
Highlighting position-specific amino acid preferences

"><meta property="og:description" content="The function computes position weight matrices (PWMs) for both upregulated
and downregulated sites, then calculates their difference (Up - Down).
Positive values indicate amino acids enriched in upregulated sites, while
negative values indicate enrichment in downregulated sites.
This approach is particularly useful for:
Identifying kinases with opposing activity changes
Detecting motif shifts between conditions
Highlighting position-specific amino acid preferences

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">prophosqua</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Supplementary_Material_v3.html">Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot Difference Sequence Logo (Upregulated - Downregulated)</h1>

      <div class="d-none name"><code>plot_diff_logo.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function computes position weight matrices (PWMs) for both upregulated
and downregulated sites, then calculates their difference (Up - Down).
Positive values indicate amino acids enriched in upregulated sites, while
negative values indicate enrichment in downregulated sites.</p>
<p>This approach is particularly useful for:</p><ul><li><p>Identifying kinases with opposing activity changes</p></li>
<li><p>Detecting motif shifts between conditions</p></li>
<li><p>Highlighting position-specific amino acid preferences</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_diff_logo</span><span class="op">(</span><span class="va">sig_sites</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sig-sites">sig_sites<a class="anchor" aria-label="anchor" href="#arg-sig-sites"></a></dt>
<dd><p>A data frame containing significant phosphorylation sites
with the following required columns:</p><dl><dt>contrast</dt>
<dd><p>Character. The name of the experimental contrast
    (e.g., "KO_vs_WT")</p></dd>

  <dt>regulation</dt>
<dd><p>Character. Either "upregulated" or "downregulated"</p></dd>

  <dt>SequenceWindow</dt>
<dd><p>Character. The amino acid sequence window
    surrounding the phosphorylation site (typically 15 amino acids
    centered on the modified residue)</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot2 object created by <code>ggseqlogo</code> showing difference
  logos for each contrast. Returns <code>NULL</code> if no contrasts have both
  upregulated and downregulated sequences.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Creates a difference sequence logo plot that visualizes the difference in
amino acid frequencies between upregulated and downregulated phosphorylation
sites. This visualization helps identify kinase-specific motifs that are
differentially regulated between experimental conditions.</p>

<p>The difference PWM is calculated as:
$$PWM_{diff} = PWM_{up} - PWM_{down}$$</p>
<p>For each position in the sequence window, the function calculates the
frequency of each of the 20 standard amino acids. The difference in
frequencies is then visualized using the 'custom' method in ggseqlogo,
where:</p><ul><li><p>Letters above the baseline (positive values) are enriched in
    upregulated sites</p></li>
<li><p>Letters below the baseline (negative values) are enriched in
    downregulated sites</p></li>
<li><p>Letter height corresponds to the magnitude of the frequency
    difference</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/ggseqlogo/man/ggseqlogo.html" class="external-link">ggseqlogo</a></code> for the underlying plotting function</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create example data with phosphorylation site motifs</span></span></span>
<span class="r-in"><span><span class="va">sig_sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"KO_vs_WT"</span>, <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  regulation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"upregulated"</span>, <span class="st">"downregulated"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  SequenceWindow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># Upregulated: Proline-directed (CDK-like: S/T-P-x-K)</span></span></span>
<span class="r-in"><span>    <span class="st">"AAATPASPLTPGKRA"</span>, <span class="st">"GGGKSPVSPLTPGKR"</span>, <span class="st">"AAATPASPLTPGKRA"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"LLLSQVSPKTPAAAA"</span>, <span class="st">"AAATPASPLTPGKRA"</span>, <span class="st">"GGGKSPVSPLTPGKR"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"VVKTPASPLTPGKRA"</span>, <span class="st">"AAATPASPLTPGKRA"</span>, <span class="st">"LLLSQVSPKTPAAAA"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"GGGKSPVSPLTPGKR"</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># Downregulated: Basophilic (PKA-like: R-R-x-S)</span></span></span>
<span class="r-in"><span>    <span class="st">"LRRRRSLAAAGKPAA"</span>, <span class="st">"GGRRRASVAAAGKPA"</span>, <span class="st">"LRRRRSLAAAGKPAA"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"GKRRRSSLAAAGKPA"</span>, <span class="st">"LRRRRSLAAAGKPAA"</span>, <span class="st">"GGRRRASVAAAGKPA"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"DKRRRSSLAAAGKPA"</span>, <span class="st">"LRRRRSLAAAGKPAA"</span>, <span class="st">"GKRRRSSLAAAGKPA"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"GGRRRASVAAAGKPA"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate difference logo</span></span></span>
<span class="r-in"><span><span class="va">diff_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_diff_logo</span><span class="op">(</span><span class="va">sig_sites</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`aes_string()` was deprecated in ggplot2 3.0.0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Please use tidy evaluation idioms with `aes()`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> See also `vignette("ggplot2-in-packages")` for more information.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">ggseqlogo</span> package.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/omarwagih/ggseqlogo/issues&gt;</span>.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">diff_plot</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_diff_logo-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Witold Wolski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

