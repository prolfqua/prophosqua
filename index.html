<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>prophosqua does analyze and combine TMTlabeled phospho-proteomics data and total proteomics data â€¢ prophosqua</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="prophosqua does analyze and combine TMTlabeled phospho-proteomics data and total proteomics data">
<meta name="description" content="Prophosqua implements a workflow for e.g. TMT-labeled samples where two datasets are acquired and individually searched with FragPipe-MS-Fragger for example. The abundances are individually statistically evaluated for both datasets as a first step. While for the total proteome the abundance data is rolled-up to protein level the phospho-enriched dataset is kept phospho-site centric and statistically evaluated at this level. For differential expression calling we use the prolfqua R-package which handles all important steps starting from normalising and transforming quantitative channels, to aggregating site-centric phospho-enriched dataset, to rolling-up peptide quantities to protein level as well as using linear models and contrasting different conditions also with multiple factors. Doing this for both datasets in the same way we can join these together. This allows then further phospho-site adjustment with respect to the protein change in a simple way but also efficiently identifying phospho-sites that are differentially phosphorylated.">
<meta property="og:description" content="Prophosqua implements a workflow for e.g. TMT-labeled samples where two datasets are acquired and individually searched with FragPipe-MS-Fragger for example. The abundances are individually statistically evaluated for both datasets as a first step. While for the total proteome the abundance data is rolled-up to protein level the phospho-enriched dataset is kept phospho-site centric and statistically evaluated at this level. For differential expression calling we use the prolfqua R-package which handles all important steps starting from normalising and transforming quantitative channels, to aggregating site-centric phospho-enriched dataset, to rolling-up peptide quantities to protein level as well as using linear models and contrasting different conditions also with multiple factors. Doing this for both datasets in the same way we can join these together. This allows then further phospho-site adjustment with respect to the protein change in a simple way but also efficiently identifying phospho-sites that are differentially phosphorylated.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">prophosqua</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Supplementary_Material_v3.html">Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="articles/index.html">More articles...</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="prophosqua">prophosqua<a class="anchor" aria-label="anchor" href="#prophosqua"></a>
</h1></div>
<p><strong>Integration of phosphoproteome and total proteome data for comprehensive PTM analysis</strong></p>
<p>The <code>prophosqua</code> package provides tools for integrating and analyzing post-translational modification (PTM) data with total proteome measurements. It enables researchers to distinguish between changes in protein abundance and changes in modification site usage, providing deeper insights into cellular signaling and regulation.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>prophosqua</code> builds upon the <code>prolfqua</code> and <code>prolfquapp</code> packages to provide:</p>
<ul>
<li>
<strong>Differential PTM Feature Expression (DPE)</strong> - Analysis of modification site abundance changes</li>
<li>
<strong>Differential PTM Feature Usage (DPU)</strong> - Analysis of modification site usage relative to total protein</li>
<li>
<strong>N-to-C plots</strong> - Visualization of phosphorylation sites along protein backbones</li>
<li>
<strong>Sequence logo analysis</strong> - Identification of kinase recognition motifs</li>
<li>
<strong>Statistical integration</strong> - Combined analysis of phosphoproteome and total proteome data</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<p>This package depends on several other packages that should be installed first:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install prolfqua (core proteomics analysis package)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'protviz/prozor'</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'prolfqua/prolfqua'</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Install prolfquapp (proteomics analysis workflow package)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'prolfqua/prolfquapp'</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>For detailed installation instructions and system requirements, see: - <a href="https://github.com/prolfqua/prolfqua" class="external-link">prolfqua GitHub repository</a> - <a href="https://github.com/prolfqua/prolfquapp" class="external-link">prolfquapp GitHub repository</a></p>
</div>
<div class="section level3">
<h3 id="install-prophosqua">Install prophosqua<a class="anchor" aria-label="anchor" href="#install-prophosqua"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'prolfqua/prophosqua'</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="basic-workflow">Basic Workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Run differential expression analysis</strong> using <code>prolfquapp</code> for both total proteome and PTM data</li>
<li>
<strong>Integrate the results</strong> using <code><a href="reference/test_diff.html">prophosqua::test_diff()</a></code>
</li>
<li>
<strong>Visualize the data</strong> with N-to-C plots and sequence logos</li>
<li>
<strong>Generate comprehensive reports</strong> with statistical summaries</li>
</ol>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">prophosqua</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load your data</span></span>
<span><span class="va">tot_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_and_preprocess_data.html">load_and_preprocess_data</a></span><span class="op">(</span><span class="va">total_proteome_file</span>, <span class="va">required_cols</span><span class="op">)</span></span>
<span><span class="va">phospho_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_and_preprocess_data.html">load_and_preprocess_data</a></span><span class="op">(</span><span class="va">ptm_file</span>, <span class="va">required_cols</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Integrate analysis</span></span>
<span><span class="va">combined_test_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/test_diff.html">test_diff</a></span><span class="op">(</span><span class="va">phospho_res</span>, <span class="va">tot_res</span>, join_column <span class="op">=</span> <span class="va">join_column</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create visualizations</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/n_to_c_usage.html">n_to_c_usage</a></span><span class="op">(</span><span class="va">combined_test_diff</span>, <span class="va">contrast_name</span>, FDR_threshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="vignettes-and-documentation">Vignettes and Documentation<a class="anchor" aria-label="anchor" href="#vignettes-and-documentation"></a>
</h2>
<p>The package includes comprehensive vignettes that demonstrate the complete analysis workflow:</p>
<div class="section level3">
<h3 id="rendering-vignettes">Rendering Vignettes<a class="anchor" aria-label="anchor" href="#rendering-vignettes"></a>
</h3>
<p>The following code renders the vignettes and copies them to the example directory:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Render the differential expression analysis vignette</span></span>
<span></span>
<span><span class="va">wd</span> <span class="op">&lt;-</span> <span class="st">"inst/PTM_analysis_example"</span></span>
<span></span>
<span></span>
<span><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span><span class="st">"vignettes/QCReport.qmd"</span>,</span>
<span>params<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>wd<span class="op">=</span><span class="va">wd</span>,</span>
<span>psm<span class="op">=</span><span class="st">"ptm_example-main/qc_example_data/QCmini/psm.tsv"</span>,</span>
<span>fasta<span class="op">=</span><span class="st">"ptm_example-main/qc_example_data/fgcz_3702_UP000006548_AraUniprot_1spg_d_20231024.fasta"</span>,</span>
<span>workunit<span class="op">=</span><span class="st">"exampleQC"</span>,</span>
<span>projectid<span class="op">=</span><span class="st">"ABCD1234"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="st">"vignettes/QCReport.html"</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>,<span class="st">"QCReport.html"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Render the PTM integration and visualization vignette  </span></span>
<span><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span><span class="st">"vignettes/Supplementary_Material_v2.Rmd"</span>,</span>
<span>params<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>wd <span class="op">=</span> <span class="va">wd</span>, dodea <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, output_format<span class="op">=</span><span class="fu">bookdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/bookdown/reference/html_document2.html" class="external-link">pdf_document2</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="st">"vignettes/Supplementary_Material_v2.pdf"</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>,<span class="st">"Supplementary_Material_v2.pdf"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span><span class="st">"vignettes/Supplementary_Material_v2.Rmd"</span>,</span>
<span>params<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>wd <span class="op">=</span> <span class="va">wd</span>, dodea <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, output_format<span class="op">=</span><span class="fu">bookdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/bookdown/reference/html_document2.html" class="external-link">html_document2</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="st">"vignettes/Supplementary_Material_v2.html"</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>,<span class="st">"Supplementary_Material_v2.html"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This code: 1. <strong>Renders R Markdown files</strong> to HTML using <code><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">rmarkdown::render()</a></code> 2. <strong>Copies the HTML files</strong> to the <code>inst/PTM_analysis_example/</code> directory for easy access 3. <strong>Creates interactive reports</strong> with code folding and navigation</p>
</div>
<div class="section level3">
<h3 id="available-vignettes">Available Vignettes<a class="anchor" aria-label="anchor" href="#available-vignettes"></a>
</h3>
<ul>
<li>
<strong><code>Run_DEA_prolfquapp.Rmd</code></strong> - Complete workflow for differential expression analysis</li>
<li>
<strong><code>Visualize_PTM_features.Rmd</code></strong> - Integration and visualization of PTM data</li>
<li>
<strong>Interactive reports</strong> - Available in the <code>inst/PTM_analysis_example/</code> directory</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="related-publications">Related Publications<a class="anchor" aria-label="anchor" href="#related-publications"></a>
</h2>
<div class="section level3">
<h3 id="core-dependencies">Core Dependencies<a class="anchor" aria-label="anchor" href="#core-dependencies"></a>
</h3>
<ul>
<li>
<strong>prolfqua</strong>: <a href="https://www.sciencedirect.com/science/article/pii/S1535947622002857" class="external-link">Proteomics data analysis in R</a> - MSstatsPTM publication</li>
<li>
<strong>prolfquapp</strong>: <a href="https://www.sciencedirect.com/science/article/pii/S1535947623002190" class="external-link">Proteomics analysis workflow package</a> - msqrob2PTM publication</li>
</ul>
</div>
<div class="section level3">
<h3 id="related-work">Related Work<a class="anchor" aria-label="anchor" href="#related-work"></a>
</h3>
<ul>
<li>
<a href="https://www.sciencedirect.com/science/article/pii/S1535947622002857" class="external-link">MSstatsPTM</a> - Statistical analysis of PTM data</li>
<li>
<a href="https://www.sciencedirect.com/science/article/pii/S1535947623002190" class="external-link">msqrob2PTM</a> - Robust statistical methods for PTM analysis</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="github-repositories">GitHub Repositories<a class="anchor" aria-label="anchor" href="#github-repositories"></a>
</h2>
<ul>
<li>
<a href="https://github.com/prolfqua/prolfqua" class="external-link">prolfqua</a> - Core proteomics analysis package</li>
<li>
<a href="https://github.com/prolfqua/prolfquapp" class="external-link">prolfquapp</a> - Proteomics analysis workflow package</li>
<li>
<a href="https://github.com/prolfqua/prophosqua" class="external-link">prophosqua</a> - PTM integration and analysis package</li>
</ul>
</div>
<div class="section level2">
<h2 id="poster">Poster<a class="anchor" aria-label="anchor" href="#poster"></a>
</h2>
<p><a href="img/SIBDays24_Poster_Prophosqua_Grossmann.pdf">Prophosqua Poster from SIBDays 2024</a></p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use this package in your research, please cite:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bibtex"><code class="sourceCode bibtex"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="va">@article</span>{<span class="ot">prophosqua2024</span>,</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="dt">title</span>={prophosqua: Integration of phosphoproteome and total proteome data},</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="dt">author</span>={Functional Genomics Center Zurich},</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="dt">journal</span>={Bioinformatics},</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="dt">year</span>={2024}</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>Contributions are welcome! Please visit our <a href="https://github.com/prolfqua/prophosqua" class="external-link">GitHub repository</a> for: - Issue reporting - Feature requests - Code contributions - Documentation improvements</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>This package is released under the <a href="LICENSE">MIT License</a>.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing prophosqua</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Witold Wolski <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://doi.org/10.5281/zenodo.15845272" class="external-link"><img src="https://zenodo.org/badge/784111954.svg" alt="DOI"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Witold Wolski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
