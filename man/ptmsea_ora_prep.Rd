% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ptmsea.R
\name{ptmsea_ora_prep}
\alias{ptmsea_ora_prep}
\title{Prepare data for PTM-SEA ORA analysis}
\usage{
ptmsea_ora_prep(
  data,
  ptmsigdb_sites,
  score_col,
  fc_col = NULL,
  seq_window_col = "SequenceWindow",
  threshold = 0.05,
  trim_to = c("11", "13", "15")
)
}
\arguments{
\item{data}{data.frame with flanking sequences, scores, and optionally fold changes}

\item{ptmsigdb_sites}{Character vector. Site IDs from PTMsigDB (stripped, without ;u/;d).
Use \code{unique(gsub(";[ud]$", "", unlist(pathways)))}.}

\item{score_col}{Character. Column for significance score (e.g., "FDR_I").}

\item{fc_col}{Character or NULL. Column for fold change. If provided, returns
separate enriched_up and enriched_down. Default NULL.}

\item{seq_window_col}{Character. Column for flanking sequences. Default "SequenceWindow".}

\item{threshold}{Numeric. Significance threshold for score_col. Default 0.05.}

\item{trim_to}{Character. Trim width: "11" (default), "13", or "15".}
}
\value{
List with enriched (or enriched_up/enriched_down if fc_col) and background.
}
\description{
Prepares enriched and background site lists for over-representation analysis.
When fc_col is provided, significant sites are split into up and down sets.
Only sites that intersect with PTMsigDB are included.
}
