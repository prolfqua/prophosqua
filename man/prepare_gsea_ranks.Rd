% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ptmsea.R
\name{prepare_gsea_ranks}
\alias{prepare_gsea_ranks}
\title{Prepare ranked lists for GSEA analysis}
\usage{
prepare_gsea_ranks(
  data,
  stat_col,
  seq_col = "SequenceWindow",
  contrast_col = "contrast",
  to_uppercase = TRUE,
  add_suffix = NULL
)
}
\arguments{
\item{data}{Data frame with phosphosite data containing statistics per contrast}

\item{stat_col}{Character. Column name for ranking statistic (e.g., "statistic.site"
for DPA or "tstatistic_I" for DPU)}

\item{seq_col}{Character. Column name for sequence windows. Default "SequenceWindow"}

\item{contrast_col}{Character. Column name for contrasts. Default "contrast"}

\item{to_uppercase}{Logical. Convert sequences to uppercase. Default TRUE}

\item{add_suffix}{Character or NULL. Suffix to add to sequences (e.g., "-p" for
PTMsigDB format). Default NULL (no suffix)}
}
\value{
Named list of named numeric vectors, one per contrast. Each vector
  contains statistics named by sequence, sorted in descending order.
}
\description{
Creates named numeric vectors suitable for clusterProfiler::GSEA from
phosphoproteomics data with multiple contrasts. This is a general-purpose
function that works with any GSEA analysis (Kinase Library, motif enrichment,
etc.). For PTMsigDB-specific preparation with trimming and "-p" suffix,
see \code{\link{ptmsea_data_prep}}.
}
\details{
For each contrast, the function:
\enumerate{
  \item Filters to the specified contrast
  \item Processes sequences (uppercase, trim whitespace)
  \item Removes rows with NA statistics
  \item Keeps first occurrence of duplicate sequences
  \item Sorts by statistic (descending) for GSEA
}
}
\examples{
# Example with mock data
data <- data.frame(
  contrast = rep(c("A_vs_B", "C_vs_D"), each = 5),
  SequenceWindow = c("AAASAAAA", "BBBSBBB", "CCCSCCCC", "DDDSDDDD", "EEESEEEE",
                     "AAASAAAA", "FFFSFFF", "GGGSGGGG", "HHHSHHHH", "IIISIII"),
  statistic.site = c(2.5, 1.8, -0.5, -1.2, 0.3, 1.9, 2.1, -0.8, 0.1, -1.5),
  stringsAsFactors = FALSE
)

# Prepare ranks for Kinase Library GSEA (no suffix needed)
ranks <- prepare_gsea_ranks(data, stat_col = "statistic.site")
names(ranks)  # contrast names
head(ranks[[1]])  # ranked sequences for first contrast

# Prepare ranks for PTMsigDB (with "-p" suffix)
ranks_ptm <- prepare_gsea_ranks(data, stat_col = "statistic.site", add_suffix = "-p")

}
\seealso{
\code{\link{ptmsea_data_prep}} for PTMsigDB-specific preparation with trimming
}
