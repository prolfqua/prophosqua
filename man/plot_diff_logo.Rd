% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seqLogoDiff.R
\name{plot_diff_logo}
\alias{plot_diff_logo}
\title{Plot Difference Sequence Logo (Upregulated - Downregulated)}
\usage{
plot_diff_logo(sig_sites)
}
\arguments{
\item{sig_sites}{A data frame containing significant phosphorylation sites
with the following required columns:
\describe{
  \item{contrast}{Character. The name of the experimental contrast
    (e.g., "KO_vs_WT")}
  \item{regulation}{Character. Either "upregulated" or "downregulated"}
  \item{SequenceWindow}{Character. The amino acid sequence window
    surrounding the phosphorylation site (typically 15 amino acids
    centered on the modified residue)}
}}
}
\value{
A ggplot2 object created by \code{ggseqlogo} showing difference
  logos for each contrast. Returns \code{NULL} if no contrasts have both
  upregulated and downregulated sequences.
}
\description{
The function computes position weight matrices (PWMs) for both upregulated
and downregulated sites, then calculates their difference (Up - Down).
Positive values indicate amino acids enriched in upregulated sites, while
negative values indicate enrichment in downregulated sites.

This approach is particularly useful for:
\itemize{
  \item Identifying kinases with opposing activity changes
  \item Detecting motif shifts between conditions
  \item Highlighting position-specific amino acid preferences
}
}
\details{
Creates a difference sequence logo plot that visualizes the difference in
amino acid frequencies between upregulated and downregulated phosphorylation
sites. This visualization helps identify kinase-specific motifs that are
differentially regulated between experimental conditions.


The difference PWM is calculated as:
\deqn{PWM_{diff} = PWM_{up} - PWM_{down}}

For each position in the sequence window, the function calculates the
frequency of each of the 20 standard amino acids. The difference in
frequencies is then visualized using the 'custom' method in ggseqlogo,
where:
\itemize{
  \item Letters above the baseline (positive values) are enriched in
    upregulated sites
  \item Letters below the baseline (negative values) are enriched in
    downregulated sites
  \item Letter height corresponds to the magnitude of the frequency
    difference
}
}
\examples{
# Create example data with phosphorylation site motifs
sig_sites <- data.frame(
  contrast = rep("KO_vs_WT", 20),
  regulation = rep(c("upregulated", "downregulated"), each = 10),
  SequenceWindow = c(
    # Upregulated: Proline-directed (CDK-like: S/T-P-x-K)
    "AAATPASPLTPGKRA", "GGGKSPVSPLTPGKR", "AAATPASPLTPGKRA",
    "LLLSQVSPKTPAAAA", "AAATPASPLTPGKRA", "GGGKSPVSPLTPGKR",
    "VVKTPASPLTPGKRA", "AAATPASPLTPGKRA", "LLLSQVSPKTPAAAA",
    "GGGKSPVSPLTPGKR",

    # Downregulated: Basophilic (PKA-like: R-R-x-S)
    "LRRRRSLAAAGKPAA", "GGRRRASVAAAGKPA", "LRRRRSLAAAGKPAA",
    "GKRRRSSLAAAGKPA", "LRRRRSLAAAGKPAA", "GGRRRASVAAAGKPA",
    "DKRRRSSLAAAGKPA", "LRRRRSLAAAGKPAA", "GKRRRSSLAAAGKPA",
    "GGRRRASVAAAGKPA"
  )
)

# Generate difference logo
diff_plot <- plot_diff_logo(sig_sites)
print(diff_plot)

}
\seealso{
\code{\link[ggseqlogo]{ggseqlogo}} for the underlying plotting function
}
