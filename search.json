[{"path":"https://prolfqua.github.io/prophosqua/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"Project-specific instructions Claude Code.","code":""},{"path":"https://prolfqua.github.io/prophosqua/CLAUDE.html","id":"rules","dir":"","previous_headings":"","what":"Rules","title":"CLAUDE.md","text":"modify DESCRIPTION NAMESPACE unless explicitly asked One function, one task! Keep functions minimal focused.","code":""},{"path":"https://prolfqua.github.io/prophosqua/CLAUDE.html","id":"vignettes","dir":"","previous_headings":"","what":"Vignettes","title":"CLAUDE.md","text":"edit vignettes vignettes/, NEVER doc/ doc/ contains built output — regenerated vignettes/ via make build-vignettes devtools::build_vignettes() Workflow: edit vignettes/*.Rmd -> build vignettes -> doc/ updated automatically","code":""},{"path":"https://prolfqua.github.io/prophosqua/CLAUDE.html","id":"development","dir":"","previous_headings":"","what":"Development","title":"CLAUDE.md","text":"Use Makefile package development tasks: make test - run testthat tests make check-fast - R CMD check without vignettes (quick validation) make check - full R CMD check make document - generate roxygen2 docs make build - build tarball make install - install package locally make lint - run lintr make format - format air make clean - remove build artifacts","code":""},{"path":"https://prolfqua.github.io/prophosqua/TODO.html","id":null,"dir":"","previous_headings":"","what":"TODO: DRY prophosqua and ptm-pipeline","title":"TODO: DRY prophosqua and ptm-pipeline","text":"Date: 2026-01-22","code":""},{"path":"https://prolfqua.github.io/prophosqua/TODO.html","id":"problem","dir":"","previous_headings":"","what":"Problem","title":"TODO: DRY prophosqua and ptm-pipeline","text":"Significant overlap prophosqua vignettes ptm-pipeline templates:","code":""},{"path":"https://prolfqua.github.io/prophosqua/TODO.html","id":"key-differences","dir":"","previous_headings":"Problem","what":"Key Differences","title":"TODO: DRY prophosqua and ptm-pipeline","text":"prophosqua vignettes: Use package example data, run full analysis, basic clusterProfiler plots ptm-pipeline templates: Use YAML params, read Excel/CSV, enhanced visualization via enrichment_viz_utils.R","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/TODO.html","id":"id_1-move-visualization-functions-to-prophosqua","dir":"","previous_headings":"Recommended Solution","what":"1. Move visualization functions to prophosqua","title":"TODO: DRY prophosqua and ptm-pipeline","text":"Create R/enrichment_viz.R functions ptm-pipeline/template/src/enrichment_viz_utils.R:","code":"# Functions to move: plot_enrichment_dotplot() plot_enrichment_volcano() plot_enrichment_heatmap() export_gsea_plots_pdf() extract_gsea_results() summarize_enrichment_results()"},{"path":"https://prolfqua.github.io/prophosqua/TODO.html","id":"id_2-simplify-prophosqua-vignettes","dir":"","previous_headings":"Recommended Solution","what":"2. Simplify prophosqua vignettes","title":"TODO: DRY prophosqua and ptm-pipeline","text":"Keep vignettes minimal documentation: - Load example data - Run one analysis - Show one plot using new viz functions Remove duplicate DPA/DPU sections - just show API usage.","code":""},{"path":"https://prolfqua.github.io/prophosqua/TODO.html","id":"id_3-ptm-pipeline-templates-become-thin-wrappers","dir":"","previous_headings":"Recommended Solution","what":"3. ptm-pipeline templates become thin wrappers","title":"TODO: DRY prophosqua and ptm-pipeline","text":"","code":"library(prophosqua)  # 1. Load data (parameterized) data <- readxl::read_xlsx(params$xlsx_file)  # 2. Run analysis (prophosqua) results <- run_ptmsea(...)  # 3. Visualize (prophosqua - moved there) plot_enrichment_heatmap(results, ...)  # 4. Export (template-specific) writexl::write_xlsx(...)"},{"path":"https://prolfqua.github.io/prophosqua/TODO.html","id":"implementation-steps","dir":"","previous_headings":"","what":"Implementation Steps","title":"TODO: DRY prophosqua and ptm-pipeline","text":"Copy enrichment_viz_utils.R prophosqua/R/enrichment_viz.R Add roxygen documentation @export tags Update NAMESPACE (devtools::document) Refactor Analysis_PTMSEA.Rmd vignette use new functions Test vignette builds Update ptm-pipeline templates use prophosqua::plot_* functions Remove enrichment_viz_utils.R ptm-pipeline (keep fallback) Repeat vignette pairs","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/TODO.html","id":"prophosqua-vignettes","dir":"","previous_headings":"Files Reference","what":"prophosqua vignettes","title":"TODO: DRY prophosqua and ptm-pipeline","text":"/Users/wolski/projects/prophosqua/vignettes/Analysis_PTMSEA.Rmd /Users/wolski/projects/prophosqua/vignettes/Analysis_Motif_Enrichment.Rmd /Users/wolski/projects/prophosqua/vignettes/Analysis_KinaseLibrary.Rmd /Users/wolski/projects/prophosqua/vignettes/Vis_MEA.Rmd","code":""},{"path":"https://prolfqua.github.io/prophosqua/TODO.html","id":"ptm-pipeline-templates","dir":"","previous_headings":"Files Reference","what":"ptm-pipeline templates","title":"TODO: DRY prophosqua and ptm-pipeline","text":"/Users/wolski/projects/ptm-pipeline/template/src/Analysis_PTMSEA.Rmd /Users/wolski/projects/ptm-pipeline/template/src/Analysis_MEA.Rmd /Users/wolski/projects/ptm-pipeline/template/src/Analysis_KinaseLibrary_GSEA.Rmd /Users/wolski/projects/ptm-pipeline/template/src/enrichment_viz_utils.R","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"report demonstrates kinase activity inference using Kinase Library motif predictions. Unlike PTMsigDB (uses curated kinase-substrate relationships), Kinase Library predicts kinase-substrate assignments based position-specific scoring matrices (PSSMs) derived peptide library screens. use term2gene.csv file generated scan-motifs CLI, contains kinase-sequence assignments. Approach: GSEA (Gene Set Enrichment Analysis) using ranked phosphosite statistics.","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"load-data-and-kinase-library-predictions","dir":"Articles","previous_headings":"","what":"Load Data and Kinase Library Predictions","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"Differential Analysis Data Kinase Library Predictions","code":"library(clusterProfiler) library(dplyr) library(tidyr) library(readxl) library(ggplot2) library(enrichplot) library(purrr) library(forcats) library(writexl) library(patchwork) library(DT) library(prophosqua) if (pipeline_mode) {   # Pipeline mode: load from files   # Use explicit sheet param if provided, otherwise use analysis type as sheet name   if (!is.null(params$sheet)) {     sheet_name <- params$sheet   } else {     # Default: use analysis type as sheet name (works for combined PTM_results.xlsx)     sheet_name <- params$analysis_type   }    # Load differential analysis data   data <- read_xlsx(params$xlsx_file, sheet = sheet_name)   output_dir <- if (!is.null(params$output_dir)) params$output_dir else dirname(params$xlsx_file)    # Define config for stat_col (used in GSEA ranking)   # Combined PTM_results.xlsx uses standardized column names   config <- list(     sheet = sheet_name,     stat_col = \"statistic.site\"   ) } else {   # Vignette mode: use example data (subset to 1 contrast for speed)   data(\"combined_test_diff_example\", package = \"prophosqua\")   data <- combined_test_diff_example |>     filter(contrast == unique(contrast)[1])   output_dir <- tempdir()    # Define config for vignette mode   config <- list(     sheet = \"DPA\",     stat_col = \"statistic.site\"   ) }  # Ensure SequenceWindow column exists if (!\"SequenceWindow\" %in% names(data) && \"PTM_FlankingRegion\" %in% names(data)) {   data <- data |> rename(SequenceWindow = PTM_FlankingRegion) }  data_info <- tibble(   Property = c(\"Rows\", \"Columns\", \"Contrasts\"),   Value = c(nrow(data), ncol(data),             paste(unique(data$contrast), collapse = \", \")) ) knitr::kable(data_info, caption = \"Differential Analysis Data\") # Load term2gene - try multiple sources term2gene_file <- params$term2gene_file  if (is.null(term2gene_file) || !file.exists(term2gene_file)) {   # Try bundled resource (compressed)   bundled_zip <- system.file(\"extdata\", \"term2gene.csv.zip\", package = \"prophosqua\")   if (file.exists(bundled_zip)) {     temp_dir <- tempdir()     unzip(bundled_zip, exdir = temp_dir)     term2gene_file <- file.path(temp_dir, \"term2gene.csv\")     message(\"Using bundled term2gene from prophosqua package\")   } }  if (is.null(term2gene_file) || !file.exists(term2gene_file)) {   stop(\"term2gene file not found. Provide via params$term2gene_file or install prophosqua with bundled data.\") }  # Load term2gene from scan-motifs output term2gene <- read.csv(term2gene_file, stringsAsFactors = FALSE)  kl_info <- tibble(   Property = c(\"Total assignments\", \"Unique kinases\", \"Unique sequences\"),   Value = c(nrow(term2gene), n_distinct(term2gene$term), n_distinct(term2gene$gene)) ) knitr::kable(kl_info, caption = \"Kinase Library Predictions\") # IMPORTANT: Kinase Library sequences have lowercase letters for phosphorylated residues # (e.g., \"PETITIRsGPPSPLP\"). Convert to uppercase to match our data. term2gene <- term2gene |>   mutate(gene = toupper(gene))  # Keep as TERM2GENE format for clusterProfiler GSEA term2gene_df <- term2gene |>   select(term, gene)  # Vignette mode: subsample to 50 kinase sets for speed if (!pipeline_mode) {   set.seed(42)   keep_sets <- sample(unique(term2gene_df$term), min(50, n_distinct(term2gene_df$term)))   term2gene_df <- term2gene_df |> filter(term %in% keep_sets)   message(\"Vignette mode: subsampled to \", length(keep_sets), \" kinase sets\") }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"kinase-substrate-assignment-statistics","dir":"Articles","previous_headings":"","what":"Kinase-Substrate Assignment Statistics","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"Assignment Statistics Kinase Set Size Distribution","code":"our_sequences <- data |>   pull(SequenceWindow) |>   trimws() |>   toupper() |>   unique() assigned_sequences <- unique(term2gene$gene) overlap_seqs <- intersect(our_sequences, assigned_sequences)  assignment_stats <- tibble(   Metric = c(\"Phosphosites in differential analysis\",              \"Sites with kinase assignments\",              \"Sites usable for GSEA\",              \"Coverage (%)\"),   Value = c(length(our_sequences),             length(assigned_sequences),             length(overlap_seqs),             round(100 * length(overlap_seqs) / length(our_sequences), 1)) ) knitr::kable(assignment_stats, caption = \"Assignment Statistics\") # Calculate kinase set sizes from term2gene kinase_sizes <- term2gene_df |>   count(term, name = \"size\")  kinase_overlap <- term2gene_df |>   filter(gene %in% our_sequences) |>   count(term, name = \"overlap\")  kinase_stats <- tibble(   Metric = c(\"Number of kinases\", \"Mean substrates/kinase\", \"Median substrates/kinase\",              \"Range (min-max)\", \"Mean substrates in our data\",              \"Kinases with >= 15 substrates\"),   Value = c(nrow(kinase_sizes),             round(mean(kinase_sizes$size)),             median(kinase_sizes$size),             paste(min(kinase_sizes$size), \"-\", max(kinase_sizes$size)),             round(mean(kinase_overlap$overlap, na.rm = TRUE)),             sum(kinase_overlap$overlap >= 15, na.rm = TRUE)) ) knitr::kable(kinase_stats, caption = \"Kinase Set Size Distribution\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"prepare-ranked-lists","dir":"Articles","previous_headings":"","what":"Prepare Ranked Lists","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"DPA Ranks Prepared","code":"# Prepare ranked lists using prophosqua function ranks <- prepare_gsea_ranks(   data,   stat_col = config$stat_col,   seq_col = \"SequenceWindow\",   contrast_col = \"contrast\" )  ranks_info <- tibble(   Contrast = names(ranks),   Sites = map_int(ranks, length) ) knitr::kable(ranks_info, caption = paste(params$analysis_type, \"Ranks Prepared\"))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"gsea-analysis","dir":"Articles","previous_headings":"","what":"GSEA Analysis","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"DPA GSEA Results Summary","code":"gsea_results <- names(ranks) |>   set_names() |>   map(function(ct) {     GSEA(       geneList = ranks[[ct]],       TERM2GENE = term2gene_df,       minGSSize = params$min_size,       maxGSSize = params$max_size,       pvalueCutoff = 0.25,       nPermSimple = params$n_perm,       verbose = FALSE     )   })  gsea_info <- tibble(   Contrast = names(gsea_results),   `Significant Kinases (FDR < 0.25)` = map_int(gsea_results, ~sum(.x@result$p.adjust < 0.25, na.rm = TRUE)) ) knitr::kable(gsea_info, caption = paste(params$analysis_type, \"GSEA Results Summary\")) has_gsea_results <- sum(map_int(gsea_results, ~nrow(.x@result))) > 0 cat(\"\\n\\n# No GSEA Results\\n\\n\") cat(\"No kinase gene sets passed the size filter (min_size=\", params$min_size, \").\\n\") cat(\"This typically means too few phosphosites overlap with kinase library assignments.\\n\\n\") cat(\"**Coverage was:\", length(overlap_seqs), \"sites out of\", length(our_sequences), \"**\\n\\n\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"results-by-contrast","dir":"Articles","previous_headings":"","what":"Results by Contrast","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"","code":"# Extract all results into data frame using shared function all_clean <- extract_gsea_results(gsea_results) |>   mutate(kinase = ID)  for (ctr in unique(all_clean$contrast)) {   cat(\"\\n\\n## \", ctr, \"\\n\\n\")    ctr_data <- all_clean |> filter(contrast == ctr)   n_sig <- sum(ctr_data$p.adjust < 0.1, na.rm = TRUE)   cat(\"**Significant kinases (FDR < 0.1):** \", n_sig, \"\\n\\n\")    # Using shared dotplot function   p <- plot_enrichment_dotplot(     ctr_data,     item_col = \"kinase\",     fdr_col = \"p.adjust\",     title = paste0(params$analysis_type, \" - \", ctr),     subtitle = \"Top 30 kinases by FDR\"   )   print(p)   cat(\"\\n\\n\")    # Significant kinases table   cat(\"**Significant Kinases (FDR < 0.1):**\\n\\n\")   sig_table <- ctr_data |>     filter(p.adjust < 0.1) |>     select(kinase, NES, pvalue, FDR = p.adjust, setSize) |>     arrange(FDR) |>     mutate(across(where(is.numeric), ~round(.x, 4)))   print(htmltools::tagList(     DT::datatable(sig_table,                   extensions = 'Buttons',                   options = list(pageLength = 15, scrollX = TRUE,                                  dom = 'Bfrtip', buttons = c('copy', 'csv', 'excel')))   ))   cat(\"\\n\\n\") }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"ko_vs_wt","dir":"Articles","previous_headings":"Results by Contrast","what":"KO_vs_WT","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"Significant kinases (FDR < 0.1): 26  Significant Kinases (FDR < 0.1):","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"merged-dotplot","dir":"Articles","previous_headings":"clusterProfiler Dotplots","what":"Merged Dotplot","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"","code":"merged <- merge_result(gsea_results) dotplot(merged, showCategory = 15,         title = paste(params$analysis_type, \"GSEA - Kinase Library (FDR < 0.25)\")) +   theme(axis.text.x = element_text(angle = 45, hjust = 1))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"individual-contrasts","dir":"Articles","previous_headings":"clusterProfiler Dotplots","what":"Individual Contrasts","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"","code":"plots <- names(gsea_results) |>   map(function(ct) {     res <- gsea_results[[ct]]@result     # Skip if no results     if (nrow(res) == 0 || sum(!is.na(res$NES)) == 0) {       return(ggplot() +         annotate(\"text\", x = 0.5, y = 0.5, label = paste(ct, \"\\nNo significant kinases\")) +         theme_void() + ggtitle(ct))     }     dotplot(gsea_results[[ct]], showCategory = 15, title = ct) +       theme(axis.text.y = element_text(size = 8))   }) wrap_plots(plots, ncol = 2)"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"nes-heatmap","dir":"Articles","previous_headings":"clusterProfiler Dotplots","what":"NES Heatmap","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"","code":"# Using shared heatmap function plot_enrichment_heatmap(   all_clean,   item_col = \"ID\",   fdr_col = \"p.adjust\",   fdr_filter = 0.25,   n_top = 30,   title = paste(params$analysis_type, \"- Top Kinases by NES\") )"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"volcano-plot","dir":"Articles","previous_headings":"","what":"Volcano Plot","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"","code":"# Using shared volcano function plot_enrichment_volcano(   all_clean,   item_col = \"ID\",   fdr_col = \"p.adjust\",   title = paste(params$analysis_type, \"- GSEA Volcano Plots\") )"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"diagnostics","dir":"Articles","previous_headings":"","what":"Diagnostics","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"Raw p-value Distribution ( DPA )","code":"pval_diag <- names(gsea_results) |>   map_dfr(function(ct) {     res <- gsea_results[[ct]]@result     tibble(       Contrast = ct,       `Min p-value` = signif(min(res$pvalue, na.rm = TRUE), 3),       `p < 0.05` = sum(res$pvalue < 0.05, na.rm = TRUE),       `p < 0.01` = sum(res$pvalue < 0.01, na.rm = TRUE),       Total = nrow(res)     )   }) knitr::kable(pval_diag, caption = paste(\"Raw p-value Distribution (\", params$analysis_type, \")\"))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"export-all-gsea-plots-to-pdf","dir":"Articles","previous_headings":"","what":"Export All GSEA Plots to PDF","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"","code":"# Export all GSEA enrichment plots to PDF using shared function pdf_file <- file.path(output_dir, paste0(\"GSEA_plots_\", params$analysis_type, \".pdf\")) n_plots <- export_gsea_plots_pdf(gsea_results, pdf_file) cat(\"Exported\", n_plots, \"GSEA plots to:\", pdf_file, \"\\n\") # Vignette mode: skip PDF export n_plots <- sum(map_int(gsea_results, ~nrow(.x@result))) message(\"Vignette mode: PDF export skipped. Would export \", n_plots, \" plots.\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"gsea-enrichment-plots","dir":"Articles","previous_headings":"","what":"GSEA Enrichment Plots","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"Showing top 3 plots per contrast.","code":"for (ct in names(gsea_results)) {   cat(\"\\n\\n### \", ct, \" {.tabset}\\n\\n\")    res <- gsea_results[[ct]]   top10 <- res@result |>     as_tibble() |>     arrange(pvalue) |>     head(params$top_genesets) |>     pull(ID)    for (i in seq_along(top10)) {     geneset <- top10[i]     cat(\"\\n\\n#### \", geneset, \"\\n\\n\")      row <- res@result |>       as_tibble() |>       filter(ID == geneset)     nes_val <- round(row$NES, 2)     fdr <- signif(row$p.adjust, 2)      p <- gseaplot2(res, geneSetID = geneset,       title = paste0(geneset, \" (NES=\", nes_val, \", FDR=\", fdr, \")\"))     print(p)     cat(\"\\n\\n\")   } }"},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"all-results","dir":"Articles","previous_headings":"","what":"All Results","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"","code":"# All kinases across all contrasts all_results_dt <- names(gsea_results) |>   map_dfr(function(ct) {     gsea_results[[ct]]@result |>       as_tibble() |>       mutate(contrast = ct) |>       select(contrast, kinase = ID, NES, pvalue, FDR = p.adjust, setSize)   }) |>   arrange(contrast, FDR) |>   mutate(across(where(is.numeric), ~round(.x, 4)))  DT::datatable(all_results_dt,   filter = \"top\",   extensions = 'Buttons',   options = list(pageLength = 15, scrollX = TRUE,                  dom = 'Bfrtip', buttons = c('copy', 'csv', 'excel')),   caption = \"All kinases across all contrasts\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"export-results","dir":"Articles","previous_headings":"","what":"Export Results","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"","code":"dir.create(output_dir, recursive = TRUE, showWarnings = FALSE)  # Combine all results all_results_export <- names(gsea_results) |>   map_dfr(function(ct) {     gsea_results[[ct]]@result |>       as_tibble() |>       mutate(contrast = ct) |>       select(contrast, kinase = ID, NES, pvalue, FDR = p.adjust, setSize)   })  # Export to Excel export_list <- list(   all_results = all_results_export |> arrange(contrast, FDR),   significant = all_results_export |> filter(FDR < 0.1) |> arrange(contrast, FDR),   summary = gsea_info )  xlsx_file <- file.path(output_dir, paste0(\"KinaseLib_GSEA_\", params$analysis_type, \".xlsx\")) writexl::write_xlsx(export_list, xlsx_file) cat(\"Exported Excel:\", xlsx_file, \"\\n\")  # Export RDS with full clusterProfiler result objects rds_file <- file.path(output_dir, paste0(\"KinaseLib_GSEA_\", params$analysis_type, \".rds\")) saveRDS(gsea_results, rds_file) cat(\"Exported RDS:\", rds_file, \"\\n\") message(\"Vignette mode: File export skipped.\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"session-info","dir":"Articles","previous_headings":"Export Results","what":"Session Info","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Tahoe 26.3 ##  ## Matrix products: default ## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: Europe/Zurich ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ##  [1] prophosqua_0.3.0       DT_0.34.0              patchwork_1.3.2        ##  [4] writexl_1.5.4          forcats_1.0.1          purrr_1.2.1            ##  [7] enrichplot_1.30.3      ggplot2_4.0.2          readxl_1.4.5           ## [10] tidyr_1.3.2            dplyr_1.2.0            clusterProfiler_4.18.1 ##  ## loaded via a namespace (and not attached): ##   [1] DBI_1.2.3               gson_0.1.0              rlang_1.1.7             ##   [4] magrittr_2.0.4          DOSE_4.4.0              otel_0.2.0              ##   [7] compiler_4.5.2          RSQLite_2.4.5           png_0.1-8               ##  [10] systemfonts_1.3.1       vctrs_0.7.1             reshape2_1.4.5          ##  [13] stringr_1.6.0           pkgconfig_2.0.3         crayon_1.5.3            ##  [16] fastmap_1.2.0           XVector_0.50.0          labeling_0.4.3          ##  [19] rmarkdown_2.30          ragg_1.5.0              bit_4.6.0               ##  [22] xfun_0.55               ggseqlogo_0.2.2         cachem_1.1.0            ##  [25] aplot_0.2.9             jsonlite_2.0.0          blob_1.2.4              ##  [28] BiocParallel_1.44.0     parallel_4.5.2          R6_2.6.1                ##  [31] bslib_0.9.0             stringi_1.8.7           RColorBrewer_1.1-3      ##  [34] cellranger_1.1.0        jquerylib_0.1.4         GOSemSim_2.36.0         ##  [37] Rcpp_1.1.1              Seqinfo_1.0.0           bookdown_0.46           ##  [40] knitr_1.51              ggtangle_0.0.9          R.utils_2.13.0          ##  [43] IRanges_2.44.0          Matrix_1.7-4            splines_4.5.2           ##  [46] igraph_2.2.1            tidyselect_1.2.1        qvalue_2.42.0           ##  [49] yaml_2.3.12             codetools_0.2-20        lattice_0.22-7          ##  [52] tibble_3.3.1            plyr_1.8.9              withr_3.0.2             ##  [55] treeio_1.34.0           Biobase_2.70.0          KEGGREST_1.50.0         ##  [58] S7_0.2.1                evaluate_1.0.5          gridGraphics_0.5-1      ##  [61] desc_1.4.3              Biostrings_2.78.0       pillar_1.11.1           ##  [64] ggtree_4.0.1            stats4_4.5.2            ggfun_0.2.0             ##  [67] generics_0.1.4          S4Vectors_0.48.0        scales_1.4.0            ##  [70] tidytree_0.4.6          glue_1.8.0              gdtools_0.4.4           ##  [73] lazyeval_0.2.2          tools_4.5.2             data.table_1.18.0       ##  [76] fgsea_1.36.0            ggiraph_0.9.2           fs_1.6.6                ##  [79] fastmatch_1.1-6         cowplot_1.2.0           grid_4.5.2              ##  [82] ape_5.8-1               crosstalk_1.2.2         AnnotationDbi_1.72.0    ##  [85] nlme_3.1-168            cli_3.6.5               rappdirs_0.3.3          ##  [88] textshaping_1.0.4       fontBitstreamVera_0.1.1 gtable_0.3.6            ##  [91] R.methodsS3_1.8.2       yulab.utils_0.2.2       fontquiver_0.2.1        ##  [94] sass_0.4.10             digest_0.6.39           BiocGenerics_0.56.0     ##  [97] ggrepel_0.9.6           ggplotify_0.1.3         htmlwidgets_1.6.4       ## [100] farver_2.1.2            memoise_2.0.1           htmltools_0.5.9         ## [103] pkgdown_2.2.0           R.oo_1.27.1             lifecycle_1.0.5         ## [106] httr_1.4.7              GO.db_3.22.0            fontLiberation_0.1.0    ## [109] bit64_4.6.0-1"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_MEA.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Motif Enrichment Analysis (MEA) Visualization","text":"Motif Enrichment Analysis (MEA) results DPA analysis using kinase-library package. MEA identifies kinases whose known substrate motifs enriched extremes ranked phosphoproteomics data, indicating altered kinase activity.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_MEA.html","id":"load-mea-results","dir":"Articles","previous_headings":"","what":"Load MEA Results","title":"Motif Enrichment Analysis (MEA) Visualization","text":"MEA Summary - DPA","code":"if (pipeline_mode) {   # Pipeline mode: load from kinaselib directory   mea_files <- list.files(params$kinaselib_dir, pattern = \"^mea_.*\\\\.csv$\", full.names = TRUE)    if (length(mea_files) == 0) {     stop(\"No MEA result files found in: \", params$kinaselib_dir)   }    # Load all MEA results   mea_results <- mea_files |>     set_names(gsub(\"^mea_|\\\\.csv$\", \"\", basename(mea_files))) |>     map_dfr(~ read.csv(.x, stringsAsFactors = FALSE), .id = \"contrast\")    output_dir <- params$kinaselib_dir } else {   # Vignette mode: use bundled example data   bundled_zip <- system.file(\"extdata\", \"mea_results.zip\", package = \"prophosqua\")    if (!file.exists(bundled_zip)) {     stop(\"Bundled MEA example data not found. Run in pipeline mode with actual data.\")   }    temp_dir <- tempdir()   unzip(bundled_zip, exdir = temp_dir)   mea_files <- list.files(temp_dir, pattern = \"^mea_.*\\\\.csv$\", full.names = TRUE)    mea_results <- mea_files |>     set_names(gsub(\"^mea_|\\\\.csv$\", \"\", basename(mea_files))) |>     map_dfr(~ read.csv(.x, stringsAsFactors = FALSE), .id = \"contrast\")    output_dir <- tempdir()   message(\"Using bundled MEA example data from prophosqua package\") }  # Standardize column names (MEA output uses Kinase, we need kinase) if (\"Kinase\" %in% names(mea_results)) {   mea_results <- mea_results |> rename(kinase = Kinase) } if (\"p.value\" %in% names(mea_results)) {   mea_results <- mea_results |> rename(pvalue = `p.value`) } else if (\"p-value\" %in% names(mea_results)) {   mea_results <- mea_results |> rename(pvalue = `p-value`) } # Rename size column if present if (\"Subs.fraction\" %in% names(mea_results)) {   mea_results <- mea_results |> mutate(size = as.numeric(sub(\"/.*\", \"\", `Subs.fraction`))) } else if (\"Subs fraction\" %in% names(mea_results)) {   mea_results <- mea_results |> mutate(size = as.numeric(sub(\"/.*\", \"\", `Subs fraction`))) }  cat(\"Loaded\", nrow(mea_results), \"results from\", length(mea_files), \"contrasts\\n\") ## Loaded 622 results from 2 contrasts cat(\"Contrasts:\", paste(unique(mea_results$contrast), collapse = \", \"), \"\\n\") ## Contrasts: KO_vs_WT_at_Early, KO_vs_WT # Clean and prepare results using shared helper mea_clean <- prepare_enrichment_data(mea_results, \"FDR\", 0.1)  # Summary summary_df <- mea_clean |>   group_by(contrast) |>   summarize(     total_kinases = n(),     sig_up = sum(FDR < 0.1 & NES > 0, na.rm = TRUE),     sig_down = sum(FDR < 0.1 & NES < 0, na.rm = TRUE),     .groups = \"drop\"   )  knitr::kable(summary_df, caption = paste(\"MEA Summary -\", params$analysis_type))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_MEA.html","id":"results-by-contrast","dir":"Articles","previous_headings":"","what":"Results by Contrast","title":"Motif Enrichment Analysis (MEA) Visualization","text":"","code":"for (ctr in unique(mea_clean$contrast)) {   cat(\"\\n\\n## \", ctr, \"\\n\\n\")    ctr_data <- mea_clean |> filter(contrast == ctr)   n_sig <- sum(ctr_data$FDR < 0.1, na.rm = TRUE)   cat(\"**Significant kinases (FDR < 0.1):** \", n_sig, \"\\n\\n\")    # Top kinases dotplot using shared function   p <- plot_enrichment_dotplot(     ctr_data,     item_col = \"kinase\",     fdr_col = \"FDR\",     title = paste0(params$analysis_type, \" - \", ctr),     subtitle = \"Top 30 kinases by FDR\"   )   print(p)   cat(\"\\n\\n\")    # Significant kinases table   cat(\"### Significant Kinases\\n\\n\")   sig_table <- ctr_data |>     filter(FDR < 0.1) |>     select(kinase, NES, pvalue, FDR, n_substrates = size) |>     arrange(FDR) |>     mutate(across(where(is.numeric), ~round(.x, 4)))   print(htmltools::tagList(     DT::datatable(sig_table,                   extensions = 'Buttons',                   options = list(pageLength = 15, scrollX = TRUE,                                  dom = 'Bfrtip', buttons = c('copy', 'csv', 'excel')))   ))   cat(\"\\n\\n\") }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_MEA.html","id":"ko_vs_wt_at_early","dir":"Articles","previous_headings":"Results by Contrast","what":"KO_vs_WT_at_Early","title":"Motif Enrichment Analysis (MEA) Visualization","text":"Significant kinases (FDR < 0.1): 173","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_MEA.html","id":"ko_vs_wt","dir":"Articles","previous_headings":"Results by Contrast","what":"KO_vs_WT","title":"Motif Enrichment Analysis (MEA) Visualization","text":"Significant kinases (FDR < 0.1): 137","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_MEA.html","id":"summary-heatmap","dir":"Articles","previous_headings":"","what":"Summary Heatmap","title":"Motif Enrichment Analysis (MEA) Visualization","text":"","code":"# Using shared heatmap function plot_enrichment_heatmap(   mea_clean,   item_col = \"kinase\",   fdr_col = \"FDR\",   n_top = 30,   title = paste0(\"MEA Summary Heatmap - \", params$analysis_type) )"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_MEA.html","id":"volcano-plot","dir":"Articles","previous_headings":"","what":"Volcano Plot","title":"Motif Enrichment Analysis (MEA) Visualization","text":"","code":"# Using shared volcano function plot_enrichment_volcano(   mea_clean,   item_col = \"kinase\",   fdr_col = \"FDR\",   title = paste0(\"MEA Volcano Plots - \", params$analysis_type) )"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_MEA.html","id":"diagnostics","dir":"Articles","previous_headings":"","what":"Diagnostics","title":"Motif Enrichment Analysis (MEA) Visualization","text":"Raw p-value Distribution - DPA","code":"pval_diag <- mea_clean |>   group_by(contrast) |>   summarise(     `Min p-value` = signif(min(pvalue, na.rm = TRUE), 3),     `p < 0.05` = sum(pvalue < 0.05, na.rm = TRUE),     `p < 0.01` = sum(pvalue < 0.01, na.rm = TRUE),     Total = n(),     .groups = \"drop\"   ) |>   rename(Contrast = contrast) knitr::kable(pval_diag, caption = paste(\"Raw p-value Distribution -\", params$analysis_type))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_MEA.html","id":"all-results","dir":"Articles","previous_headings":"","what":"All Results","title":"Motif Enrichment Analysis (MEA) Visualization","text":"","code":"# All kinases across all contrasts all_results_dt <- mea_clean |>   select(contrast, kinase, NES, pvalue, FDR, size) |>   arrange(contrast, FDR) |>   mutate(across(where(is.numeric), ~round(.x, 4)))  DT::datatable(all_results_dt,   filter = \"top\",   extensions = 'Buttons',   options = list(pageLength = 15, scrollX = TRUE,                  dom = 'Bfrtip', buttons = c('copy', 'csv', 'excel')),   caption = \"All kinases across all contrasts\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_MEA.html","id":"export-results","dir":"Articles","previous_headings":"","what":"Export Results","title":"Motif Enrichment Analysis (MEA) Visualization","text":"","code":"# Export to Excel export_list <- list(   all_results = mea_clean |>     select(contrast, kinase, NES, pvalue, FDR, size) |>     arrange(contrast, FDR),   significant = mea_clean |>     filter(FDR < 0.1) |>     select(contrast, kinase, NES, pvalue, FDR, size) |>     arrange(contrast, FDR),   summary = summary_df )  xlsx_file <- file.path(output_dir, paste0(\"MEA_\", params$analysis_type, \"_results.xlsx\")) writexl::write_xlsx(export_list, xlsx_file)  rds_file <- file.path(output_dir, paste0(\"MEA_\", params$analysis_type, \"_results.rds\")) saveRDS(mea_clean, rds_file)  cat(\"Exported:\\n -\", xlsx_file, \"\\n -\", rds_file, \"\\n\") message(\"Vignette mode: File export skipped.\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_MEA.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Motif Enrichment Analysis (MEA) Visualization","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Tahoe 26.3 ##  ## Matrix products: default ## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: Europe/Zurich ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] prophosqua_0.3.0 writexl_1.5.4    forcats_1.0.1    purrr_1.2.1      ## [5] ggplot2_4.0.2    tidyr_1.3.2      DT_0.34.0        dplyr_1.2.0      ##  ## loaded via a namespace (and not attached): ##  [1] gtable_0.3.6       jsonlite_2.0.0     compiler_4.5.2     tidyselect_1.2.1   ##  [5] jquerylib_0.1.4    systemfonts_1.3.1  scales_1.4.0       textshaping_1.0.4  ##  [9] yaml_2.3.12        fastmap_1.2.0      R6_2.6.1           labeling_0.4.3     ## [13] patchwork_1.3.2    generics_0.1.4     knitr_1.51         htmlwidgets_1.6.4  ## [17] tibble_3.3.1       bookdown_0.46      desc_1.4.3         RColorBrewer_1.1-3 ## [21] bslib_0.9.0        pillar_1.11.1      rlang_1.1.7        cachem_1.1.0       ## [25] xfun_0.55          S7_0.2.1           fs_1.6.6           sass_0.4.10        ## [29] otel_0.2.0         cli_3.6.5          withr_3.0.2        pkgdown_2.2.0      ## [33] magrittr_2.0.4     crosstalk_1.2.2    digest_0.6.39      grid_4.5.2         ## [37] lifecycle_1.0.5    vctrs_0.7.1        evaluate_1.0.5     glue_1.8.0         ## [41] farver_2.1.2       ggseqlogo_0.2.2    ragg_1.5.0         rmarkdown_2.30     ## [45] tools_4.5.2        pkgconfig_2.0.3    htmltools_0.5.9"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"PTM-SEA Analysis","text":"PTM-SEA (Post-Translational Modification Signature Enrichment Analysis) DPA analysis. PTM-SEA uses flanking sequences PTMsigDB signatures infer kinase activities phosphoproteomics data via ClusterProfiler’s GSEA. Analysis Type: DPA DPA: Differential PTM Abundance - raw phosphosite changes (includes protein abundance effects) DPU: Differential PTM Usage - protein-normalized changes (true stoichiometry changes) CF: CorrectFirst - alternative protein-correction approach","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"load-libraries-and-data","dir":"Articles","previous_headings":"","what":"Load Libraries and Data","title":"PTM-SEA Analysis","text":"Input Data Summary","code":"library(prophosqua) library(clusterProfiler) library(dplyr) library(DT) library(enrichplot) library(fgsea) library(forcats) library(purrr) library(readxl) library(writexl) library(ggplot2) if (pipeline_mode) {   # Pipeline mode: load from Excel file   data <- readxl::read_xlsx(params$xlsx_file, sheet = params$sheet)   output_dir <- if (!is.null(params$output_dir)) params$output_dir else dirname(params$xlsx_file) } else {   # Vignette mode: use example data (subset to 1 contrast for speed)   data(\"combined_test_diff_example\", package = \"prophosqua\")   data <- combined_test_diff_example |>     dplyr::filter(contrast == unique(contrast)[1])   output_dir <- tempdir() }  data_info <- tibble(   Property = c(\"Mode\", \"Sheet\", \"Stat Column\", \"Rows\", \"Columns\", \"Contrasts\"),   Value = c(     if (pipeline_mode) basename(params$xlsx_file) else \"Example data\",     params$sheet, params$stat_column,     nrow(data), ncol(data),     paste(unique(data$contrast), collapse = \", \")   ) ) knitr::kable(data_info, caption = \"Input Data Summary\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"load-ptmsigdb-signatures","dir":"Articles","previous_headings":"","what":"Load PTMsigDB Signatures","title":"PTM-SEA Analysis","text":"PTMsigDB Signature Database Summary","code":"# Load PTMsigDB - try multiple sources ptmsigdb_file <- params$ptmsigdb_file  if (is.null(ptmsigdb_file) || !file.exists(ptmsigdb_file)) {   # Try bundled resource (compressed)   bundled_zip <- system.file(\"extdata\", \"ptmsigdb_kinase.rds.zip\", package = \"prophosqua\")   if (file.exists(bundled_zip)) {     temp_dir <- tempdir()     unzip(bundled_zip, exdir = temp_dir)     ptmsigdb_file <- file.path(temp_dir, \"ptmsigdb_filtered_KINASE_15mer.rds\")     message(\"Using bundled PTMsigDB from prophosqua package\")   } }  if (is.null(ptmsigdb_file) || !file.exists(ptmsigdb_file)) {   stop(\"PTMsigDB file not found. Provide via params$ptmsigdb_file or install prophosqua with bundled data.\") }  # Load pathways if (grepl(\"\\\\.rds$\", ptmsigdb_file)) {   pathways <- readRDS(ptmsigdb_file)   message(\"Loaded \", length(pathways), \" pathways from RDS\") } else {   pathways <- fgsea::gmtPathways(ptmsigdb_file)   message(\"Loaded \", length(pathways), \" pathways from GMT\") }  # Count categories n_kinase <- sum(grepl(\"^KINASE-\", names(pathways))) n_path <- sum(grepl(\"^PATH-\", names(pathways)))  # Summary table ptmsigdb_summary <- tibble(   Property = c(\"Source File\", \"Total Signatures\", \"KINASE signatures\", \"PATH signatures\", \"Unique Sites\"),   Value = c(basename(ptmsigdb_file), length(pathways), n_kinase, n_path,             length(unique(unlist(pathways)))) ) knitr::kable(ptmsigdb_summary, caption = \"PTMsigDB Signature Database Summary\") # Vignette mode: subsample to 50 pathway sets for speed if (!pipeline_mode) {   set.seed(42)   keep_sets <- sample(names(pathways), min(50, length(pathways)))   pathways <- pathways[keep_sets]   message(\"Vignette mode: subsampled to \", length(keep_sets), \" pathway sets\") }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"overlap-statistics","dir":"Articles","previous_headings":"","what":"Overlap Statistics","title":"PTM-SEA Analysis","text":"Overlap Statistics (15-mer)","code":"# Our data: unique flanking sequences (trimmed to match pathways) our_sequences <- data |>   pull(SequenceWindow) |>   trimws() |>   toupper() |>   unique() our_sequences_trimmed <- our_sequences |>   map_chr(~prophosqua:::trim_flanking_seq(.x, trim_to = params$trim_to)) our_site_ids <- paste0(our_sequences_trimmed, \"-p\") n_our_sites <- n_distinct(our_site_ids)  # PTMsigDB: unique site IDs (strip ;u/;d for comparison) ptmsigdb_ids_raw <- pathways |>   unlist() |>   unique() ptmsigdb_ids_stripped <- ptmsigdb_ids_raw |>   gsub(\";[ud]$\", \"\", x = _) |>   unique() n_ptmsigdb_sites <- length(ptmsigdb_ids_stripped)  # Overlap overlap_ids <- intersect(unique(our_site_ids), ptmsigdb_ids_stripped) n_overlap <- length(overlap_ids)  overlap_stats <- tibble(   Metric = c(\"Our data (unique sequences)\", \"PTMsigDB (unique site IDs)\", \"Overlap\",              \"% of our sites in PTMsigDB\", \"% of PTMsigDB sites in our data\"),   Value = c(n_our_sites, n_ptmsigdb_sites, n_overlap,             round(100 * n_overlap / n_our_sites, 2),             round(100 * n_overlap / n_ptmsigdb_sites, 2)) ) knitr::kable(overlap_stats, caption = paste0(\"Overlap Statistics (\", params$trim_to, \"-mer)\"))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"prepare-rank-data","dir":"Articles","previous_headings":"","what":"Prepare Rank Data","title":"PTM-SEA Analysis","text":"DPA Contrasts Prepared","code":"# Prepare ranks using prophosqua (trim_to must match pathways) prep <- ptmsea_data_prep(   data = data,   stat_column = params$stat_column,   seq_window_col = \"SequenceWindow\",   contrast_col = \"contrast\",   trim_to = as.character(params$trim_to) )  prep_info <- tibble(   Contrast = names(prep$ranks),   Sites = map_int(prep$ranks, length) ) knitr::kable(prep_info, caption = paste(params$analysis_type, \"Contrasts Prepared\")) # Count dropped sequences (handle empty lists/NULL values) n_dropped <- 0 if (length(prep$dropped) > 0) {   n_dropped <- sum(map_int(prep$dropped, ~{     if (is.null(.x) || length(.x) == 0) return(0L)     if (is.data.frame(.x)) return(nrow(.x))     return(length(.x))   })) }  if (n_dropped > 0) {   message(\"Note: \", n_dropped, \" duplicate sequences were dropped.\") }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"run-ptm-sea-gsea","dir":"Articles","previous_headings":"","what":"Run PTM-SEA (GSEA)","title":"PTM-SEA Analysis","text":"DPA PTM-SEA Results Summary","code":"results <- run_ptmsea(   ranks_list = prep$ranks,   pathways = pathways,   min_size = params$min_size,   max_size = params$max_size,   n_perm = params$n_perm,   pvalueCutoff = 0.25  # Relaxed for visualization; filter later )  results_info <- tibble(   Contrast = names(results),   `Total Pathways` = map_int(results, ~nrow(.x@result)),   `FDR < 0.1` = map_int(results, ~sum(.x@result$p.adjust < 0.1, na.rm = TRUE)),   `FDR < 0.05` = map_int(results, ~sum(.x@result$p.adjust < 0.05, na.rm = TRUE)) ) knitr::kable(results_info, caption = paste(params$analysis_type, \"PTM-SEA Results Summary\")) has_ptmsea_results <- sum(results_info$`Total Pathways`) > 0 cat(\"\\n\\n# No PTM-SEA Results\\n\\n\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"no-ptm-sea-results","dir":"Articles","previous_headings":"","what":"No PTM-SEA Results","title":"PTM-SEA Analysis","text":"pathways passed size filter (min_size=10). typically means phosphosites input data overlap PTMsigDB signatures. Overlap : 282 sites 21683 Consider using larger dataset lowering min_size.","code":"cat(\"No pathways passed the size filter (min_size=10). This typically means too few\\n\") cat(\"phosphosites in the input data overlap with PTMsigDB signatures.\\n\\n\") cat(\"**Overlap was:\", n_overlap, \"sites out of\", n_our_sites, \"**\\n\\n\") cat(\"Consider using a larger dataset or lowering `min_size`.\\n\\n\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"results-by-contrast","dir":"Articles","previous_headings":"","what":"Results by Contrast","title":"PTM-SEA Analysis","text":"","code":"# Extract all results into data frame using shared function all_clean <- extract_gsea_results(results) |>   mutate(     pathway = ID,     pathway_short = gsub(\"^(KINASE|PERT|PATH|DISEASE)-PSP_\", \"\", ID) |>       substr(1, 40)   )  for (ctr in unique(all_clean$contrast)) {   cat(\"\\n\\n## \", ctr, \"\\n\\n\")    ctr_data <- all_clean |> filter(contrast == ctr)   n_sig <- sum(ctr_data$p.adjust < 0.1, na.rm = TRUE)   cat(\"**Significant pathways (FDR < 0.1):** \", n_sig, \"\\n\\n\")    # Using shared dotplot function   p <- plot_enrichment_dotplot(     ctr_data,     item_col = \"pathway_short\",     fdr_col = \"p.adjust\",     title = paste0(params$analysis_type, \" - \", ctr),     subtitle = \"Top 30 pathways by FDR\"   )   print(p)   cat(\"\\n\\n\")    # Significant pathways table   cat(\"### Significant Pathways\\n\\n\")   sig_table <- ctr_data |>     filter(p.adjust < 0.1) |>     select(pathway_short, NES, pvalue, FDR = p.adjust, setSize) |>     arrange(FDR) |>     mutate(across(where(is.numeric), ~round(.x, 4)))   print(htmltools::tagList(     DT::datatable(sig_table,                   extensions = 'Buttons',                   options = list(pageLength = 15, scrollX = TRUE,                                  dom = 'Bfrtip', buttons = c('copy', 'csv', 'excel')))   ))   cat(\"\\n\\n\") }"},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"combined-dotplot","dir":"Articles","previous_headings":"clusterProfiler Dotplots","what":"Combined Dotplot","title":"PTM-SEA Analysis","text":"","code":"merged_results <- merge_result(results) dotplot(merged_results, showCategory = 15,         title = paste(params$analysis_type, \"PTM-SEA (All Contrasts)\")) +   theme(axis.text.x = element_text(angle = 45, hjust = 1))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"individual-contrasts","dir":"Articles","previous_headings":"clusterProfiler Dotplots","what":"Individual Contrasts","title":"PTM-SEA Analysis","text":"","code":"for (ct in names(results)) {   cat(\"\\n\\n### \", ct, \"\\n\\n\")    res <- results[[ct]]    # Check if there are any results to plot (dotplot fails on empty data)   n_results <- nrow(res@result)   if (n_results == 0) {     cat(\"No pathways met the pvalue cutoff for this contrast.\\n\\n\")     next   }    p <- dotplot(res, showCategory = 15, title = ct) +     theme(axis.text.y = element_text(size = 8))   print(p)    # Show top pathways table   top_res <- res@result |>     as_tibble() |>     filter(p.adjust < 0.25) |>     arrange(pvalue) |>     head(10) |>     select(ID, NES, pvalue, p.adjust, setSize) |>     mutate(       NES = round(NES, 3),       pvalue = signif(pvalue, 3),       p.adjust = signif(p.adjust, 3)     )   print(htmltools::tagList(     DT::datatable(top_res,                   extensions = 'Buttons',                   options = list(pageLength = 10, scrollX = TRUE,                                  dom = 'Bfrtip', buttons = c('copy', 'csv', 'excel')),                   caption = paste(\"Top Pathways -\", ct))   ))   cat(\"\\n\\n\") }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"summary-heatmap","dir":"Articles","previous_headings":"","what":"Summary Heatmap","title":"PTM-SEA Analysis","text":"","code":"stopifnot(  \"No GSEA results - check min_size parameter and sequence overlap\" = nrow(all_clean) > 0 )  # Using shared heatmap function with pathway_short labels plot_enrichment_heatmap(   all_clean,   item_col = \"ID\",   fdr_col = \"p.adjust\",   n_top = 25,   item_label_col = \"pathway_short\",   title = paste0(\"PTM-SEA Summary - \", params$analysis_type) )"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"volcano-plot","dir":"Articles","previous_headings":"","what":"Volcano Plot","title":"PTM-SEA Analysis","text":"","code":"# Using shared volcano function plot_enrichment_volcano(   all_clean,   item_col = \"pathway_short\",   fdr_col = \"p.adjust\",   title = paste(params$analysis_type, \"- PTM-SEA Volcano Plots\") )"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"export-all-gsea-plots-to-pdf","dir":"Articles","previous_headings":"","what":"Export All GSEA Plots to PDF","title":"PTM-SEA Analysis","text":"","code":"# Export all GSEA enrichment plots to PDF using shared function pdf_file <- file.path(output_dir, paste0(\"GSEA_plots_\", params$analysis_type, \".pdf\")) n_gsea_plots <- export_gsea_plots_pdf(   results, pdf_file,   prefix_pattern = \"^(KINASE|PERT|PATH|DISEASE)-PSP_\" ) cat(\"Exported\", n_gsea_plots, \"GSEA plots to:\", pdf_file, \"\\n\") # Vignette mode: skip PDF export n_gsea_plots <- sum(map_int(results, ~nrow(.x@result))) message(\"Vignette mode: PDF export skipped. Would export \", n_gsea_plots, \" plots.\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"gsea-enrichment-plots","dir":"Articles","previous_headings":"","what":"GSEA Enrichment Plots","title":"PTM-SEA Analysis","text":"Showing top 3 plots per contrast.","code":"for (ct in names(results)) {   cat(\"\\n\\n## \", ct, \" {.tabset}\\n\\n\")    res <- results[[ct]]   top10 <- res@result |>     as_tibble() |>     arrange(pvalue) |>     head(params$top_genesets) |>     pull(ID)    for (i in seq_along(top10)) {     geneset <- top10[i]     pathway_short <- gsub(\"^(KINASE|PERT|PATH|DISEASE)-PSP_\", \"\", geneset)     cat(\"\\n\\n### \", pathway_short, \"\\n\\n\")      row <- res@result |>       as_tibble() |>       filter(ID == geneset)     nes_val <- round(row$NES, 2)     fdr <- signif(row$p.adjust, 2)      p <- gseaplot2(res, geneSetID = geneset,       title = paste0(pathway_short, \" (NES=\", nes_val, \", FDR=\", fdr, \")\"))     print(p)     cat(\"\\n\\n\")   } }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"all-results","dir":"Articles","previous_headings":"","what":"All Results","title":"PTM-SEA Analysis","text":"","code":"# All pathways across all contrasts all_clean_dt <- all_clean |>   select(contrast, pathway = ID, NES, pvalue, FDR = p.adjust, setSize) |>   arrange(contrast, FDR) |>   mutate(across(where(is.numeric), ~round(.x, 4)))  DT::datatable(all_clean_dt,   filter = \"top\",   extensions = 'Buttons',   options = list(pageLength = 15, scrollX = TRUE,                  dom = 'Bfrtip', buttons = c('copy', 'csv', 'excel')),   caption = \"All pathways across all contrasts\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"export-results","dir":"Articles","previous_headings":"","what":"Export Results","title":"PTM-SEA Analysis","text":"","code":"# Create output directory dir.create(output_dir, recursive = TRUE, showWarnings = FALSE)  # Prepare export data export_data <- all_clean |> arrange(contrast, pvalue)  export_list <- list(all_clean = export_data)  # Add per-contrast sheets for (ct in unique(export_data$contrast)) {   sheet_name <- gsub(\"[^a-zA-Z0-9_]\", \"_\", substr(ct, 1, 31))   export_list[[sheet_name]] <- export_data |> filter(contrast == ct) }  # Add significant results sheet export_list[[\"significant_FDR10\"]] <- export_data |> filter(p.adjust < 0.1)  # Write Excel xlsx_file <- file.path(output_dir, paste0(\"PTMSEA_\", params$analysis_type, \"_results.xlsx\")) writexl::write_xlsx(export_list, xlsx_file)  # Save RDS with full results objects rds_file <- file.path(output_dir, paste0(\"PTMSEA_\", params$analysis_type, \"_results.rds\")) saveRDS(results, rds_file)  # Export summary export_summary <- tibble(   Output = c(\"Excel results\", \"RDS object\"),   File = c(xlsx_file, rds_file),   Size = c(     paste(round(file.size(xlsx_file) / 1024, 1), \"KB\"),     paste(round(file.size(rds_file) / 1024, 1), \"KB\")   ) ) knitr::kable(export_summary, caption = \"Exported Files\") message(\"Vignette mode: File export skipped.\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"PTM-SEA Analysis","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Tahoe 26.3 ##  ## Matrix products: default ## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: Europe/Zurich ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ##  [1] ggplot2_4.0.2          writexl_1.5.4          readxl_1.4.5           ##  [4] purrr_1.2.1            forcats_1.0.1          fgsea_1.36.0           ##  [7] enrichplot_1.30.3      DT_0.34.0              dplyr_1.2.0            ## [10] clusterProfiler_4.18.1 prophosqua_0.3.0       ##  ## loaded via a namespace (and not attached): ##   [1] DBI_1.2.3               gson_0.1.0              rlang_1.1.7             ##   [4] magrittr_2.0.4          DOSE_4.4.0              otel_0.2.0              ##   [7] compiler_4.5.2          RSQLite_2.4.5           png_0.1-8               ##  [10] systemfonts_1.3.1       vctrs_0.7.1             reshape2_1.4.5          ##  [13] stringr_1.6.0           pkgconfig_2.0.3         crayon_1.5.3            ##  [16] fastmap_1.2.0           XVector_0.50.0          rmarkdown_2.30          ##  [19] ragg_1.5.0              bit_4.6.0               xfun_0.55               ##  [22] ggseqlogo_0.2.2         cachem_1.1.0            aplot_0.2.9             ##  [25] jsonlite_2.0.0          blob_1.2.4              BiocParallel_1.44.0     ##  [28] parallel_4.5.2          R6_2.6.1                bslib_0.9.0             ##  [31] stringi_1.8.7           RColorBrewer_1.1-3      cellranger_1.1.0        ##  [34] jquerylib_0.1.4         GOSemSim_2.36.0         Rcpp_1.1.1              ##  [37] Seqinfo_1.0.0           bookdown_0.46           knitr_1.51              ##  [40] ggtangle_0.0.9          R.utils_2.13.0          IRanges_2.44.0          ##  [43] Matrix_1.7-4            splines_4.5.2           igraph_2.2.1            ##  [46] tidyselect_1.2.1        qvalue_2.42.0           yaml_2.3.12             ##  [49] codetools_0.2-20        lattice_0.22-7          tibble_3.3.1            ##  [52] plyr_1.8.9              withr_3.0.2             treeio_1.34.0           ##  [55] Biobase_2.70.0          KEGGREST_1.50.0         S7_0.2.1                ##  [58] evaluate_1.0.5          gridGraphics_0.5-1      desc_1.4.3              ##  [61] Biostrings_2.78.0       pillar_1.11.1           ggtree_4.0.1            ##  [64] stats4_4.5.2            ggfun_0.2.0             generics_0.1.4          ##  [67] S4Vectors_0.48.0        scales_1.4.0            tidytree_0.4.6          ##  [70] glue_1.8.0              gdtools_0.4.4           lazyeval_0.2.2          ##  [73] tools_4.5.2             data.table_1.18.0       ggiraph_0.9.2           ##  [76] fs_1.6.6                fastmatch_1.1-6         cowplot_1.2.0           ##  [79] grid_4.5.2              tidyr_1.3.2             ape_5.8-1               ##  [82] AnnotationDbi_1.72.0    nlme_3.1-168            patchwork_1.3.2         ##  [85] cli_3.6.5               rappdirs_0.3.3          textshaping_1.0.4       ##  [88] fontBitstreamVera_0.1.1 gtable_0.3.6            R.methodsS3_1.8.2       ##  [91] yulab.utils_0.2.2       fontquiver_0.2.1        sass_0.4.10             ##  [94] digest_0.6.39           BiocGenerics_0.56.0     ggrepel_0.9.6           ##  [97] ggplotify_0.1.3         htmlwidgets_1.6.4       farver_2.1.2            ## [100] memoise_2.0.1           htmltools_0.5.9         pkgdown_2.2.0           ## [103] R.oo_1.27.1             lifecycle_1.0.5         httr_1.4.7              ## [106] GO.db_3.22.0            fontLiberation_0.1.0    bit64_4.6.0-1"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_n_to_c.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"PTM Analysis - N-to-C Plots","text":"document generates N--C plots DPA analysis. DPA (Differential PTM Abundance): Raw PTM signal changes without protein abundance correction. Shows site-level protein-level fold changes.","code":"desc <- switch(params$analysis_type,   \"dpa\" = \"**DPA (Differential PTM Abundance)**: Raw PTM signal changes without protein abundance correction. Shows both site-level and protein-level fold changes.\",   \"dpu\" = \"**DPU (Differential PTM Usage)**: Protein-normalized PTM changes (model-first approach). Reflects genuine modification stoichiometry changes.\",   \"cf\" = \"**CF (CorrectFirst)**: Alternative protein-correction approach where abundances are normalized before statistical modeling.\" ) cat(desc)"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_n_to_c.html","id":"data-loading","dir":"Articles","previous_headings":"","what":"Data Loading","title":"PTM Analysis - N-to-C Plots","text":"Data Summary","code":"if (pipeline_mode) {   message(\"Loading data from: \", params$xlsx_file, \" (sheet: \", params$sheet, \")\")   data <- readxl::read_xlsx(params$xlsx_file, sheet = params$sheet)   output_dir <- if (!is.null(params$output_dir)) params$output_dir else dirname(params$xlsx_file) } else {   # Vignette mode: use example data (subset to 1 contrast for speed)   data(\"combined_test_diff_example\", package = \"prophosqua\")   data <- combined_test_diff_example |>     dplyr::filter(contrast == unique(contrast)[1])   output_dir <- tempdir()   max_fig <- 5   message(\"Using example data from prophosqua package\") }  data_info <- tibble(   Property = c(\"Mode\", \"Sheet\", \"Analysis Type\", \"Rows\", \"Contrasts\"),   Value = c(     if (pipeline_mode) basename(params$xlsx_file) else \"Example data\",     params$sheet, toupper(params$analysis_type),     nrow(data), paste(unique(data$contrast), collapse = \", \")   ) ) knitr::kable(data_info, caption = \"Data Summary\") # Prepare data for plotting using shared function plot_data <- prepare_ntoc_data(data, params$analysis_type)  all_contrasts <- unique(plot_data$contrast) cat(\"Found\", length(all_contrasts), \"contrasts:\", paste(all_contrasts, collapse = \", \"), \"\\n\") ## Found 1 contrasts: KO_vs_WT"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_n_to_c.html","id":"generate-n-to-c-plots","dir":"Articles","previous_headings":"","what":"Generate N-to-C Plots","title":"PTM Analysis - N-to-C Plots","text":"Filtering criteria: Proteins included contain least one PTM site FDR < 0.05 |log2 fold change| > 0.6.","code":"if (params$analysis_type == \"dpa\") {   # DPA: Use expression plotting (shows protein + site)   plot_result <- n_to_c_expression_multicontrast(     plot_data,     FDR_threshold = params$fdr,     fc_threshold = params$fc,     max_plots = max_fig   ) } else {   # DPU/CF: Use usage plotting (shows site only)   plot_result <- n_to_c_usage_multicontrast(     plot_data,     FDR_threshold = params$fdr,     fc_threshold = params$fc,     max_plots = max_fig   ) }  n_plots <- nrow(plot_result) stopifnot(\"No significant sites found. Adjust fdr/log2fc thresholds in config.\" = n_plots > 0) cat(\"Generated\", n_plots, \"multi-contrast plots\\n\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_n_to_c.html","id":"example-plots","dir":"Articles","previous_headings":"Generate N-to-C Plots","what":"Example Plots","title":"PTM Analysis - N-to-C Plots","text":"Showing example plots HTML report: one protein protein-level data one WITHOUT (available). Note: 5 proteins protein-level data, 0 proteins .","code":"if (n_plots > 0 && params$analysis_type == \"dpa\") {   # For DPA: show examples of proteins with and without protein-level data   # Find proteins with matched protein data (has diff.protein)   matched_proteins <- plot_data |>     dplyr::filter(!is.na(diff.protein)) |>     dplyr::pull(protein_Id) |>     unique()    # Find proteins without matched protein data   unmatched_proteins <- plot_data |>     dplyr::filter(is.na(diff.protein)) |>     dplyr::pull(protein_Id) |>     unique()    # Get indices in plot_result for each type   matched_idx <- which(plot_result$protein_Id %in% matched_proteins)   unmatched_idx <- which(plot_result$protein_Id %in% unmatched_proteins)    examples_to_show <- c()    # Add one matched protein if available   if (length(matched_idx) > 0) {     examples_to_show <- c(examples_to_show, matched_idx[1])   }    # Add one unmatched protein if available   if (length(unmatched_idx) > 0) {     examples_to_show <- c(examples_to_show, unmatched_idx[1])   }    # Fallback: if no examples found, use first 2   if (length(examples_to_show) == 0) {     examples_to_show <- seq_len(min(2, n_plots))   }    cat(\"\\n\\n**Note:** \", length(matched_idx), \" proteins have protein-level data, \",       length(unmatched_idx), \" proteins do not.\\n\\n\", sep = \"\")    for (i in examples_to_show) {     has_protein <- plot_result$protein_Id[i] %in% matched_proteins     label <- if (has_protein) \"(with protein data)\" else \"(NO protein data)\"     cat(\"\\n\\n### \", plot_result$protein_Id[i], \" \", label, \"\\n\\n\", sep = \"\")     print(plot_result$plot[[i]])     cat(\"\\n\\n\")   } } else if (n_plots > 0) {   # DPU/CF: just show first 2   n_examples <- min(2, n_plots)   for (i in seq_len(n_examples)) {     cat(\"\\n\\n### \", plot_result$protein_Id[i], \"\\n\\n\")     print(plot_result$plot[[i]])     cat(\"\\n\\n\")   } } else {   cat(\"No significant proteins found with the current filtering criteria.\\n\") }"},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_n_to_c.html","id":"export-plots","dir":"Articles","previous_headings":"","what":"Export Plots","title":"PTM Analysis - N-to-C Plots","text":"","code":"# Use explicit output_dir if provided, otherwise use xlsx directory pdf_dir <- output_dir  if (!dir.exists(pdf_dir)) {   dir.create(pdf_dir, recursive = TRUE) }  # Determine output filename based on analysis type pdf_name <- switch(params$analysis_type,   \"dpa\" = \"Site_differential_Expression_MultiContrast.pdf\",   \"dpu\" = \"Site_differential_UsageChange_MultiContrast.pdf\",   \"cf\"  = \"Site_differential_CorrectFirst_MultiContrast.pdf\" )  pdf_path <- file.path(pdf_dir, pdf_name)  if (n_plots > 0) {   pdf(pdf_path, width = 14, height = 10)   for (i in seq_len(n_plots)) {     print(plot_result$plot[[i]])   }   dev.off()   cat(\"Exported\", n_plots, \"plots to:\", pdf_path, \"\\n\") } else {   cat(\"No plots to export.\\n\") } message(\"Vignette mode: PDF export skipped.\") pdf_path <- NULL"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_n_to_c.html","id":"results-summary","dir":"Articles","previous_headings":"","what":"Results Summary","title":"PTM Analysis - N-to-C Plots","text":"Analysis Summary","code":"summary_info <- tibble(   Metric = c(\"Analysis Type\", \"Total Proteins\", \"Plots Generated\",              \"Shown in HTML\", \"FDR Threshold\", \"FC Threshold\"),   Value = c(toupper(params$analysis_type), n_distinct(plot_data$protein_Id),             n_plots, min(2, n_plots), params$fdr, params$fc) ) knitr::kable(summary_info, caption = \"Analysis Summary\") if (pipeline_mode && n_plots > 0) {   cat(\"\\nPDF exported to:\", pdf_path, \"\\n\") }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_n_to_c.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"PTM Analysis - N-to-C Plots","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Tahoe 26.3 ##  ## Matrix products: default ## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: Europe/Zurich ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] patchwork_1.3.2  readxl_1.4.5     dplyr_1.2.0      prophosqua_0.3.0 ##  ## loaded via a namespace (and not attached): ##  [1] gtable_0.3.6       jsonlite_2.0.0     compiler_4.5.2     tidyselect_1.2.1   ##  [5] jquerylib_0.1.4    systemfonts_1.3.1  scales_1.4.0       textshaping_1.0.4  ##  [9] yaml_2.3.12        fastmap_1.2.0      ggplot2_4.0.2      R6_2.6.1           ## [13] labeling_0.4.3     generics_0.1.4     knitr_1.51         htmlwidgets_1.6.4  ## [17] forcats_1.0.1      tibble_3.3.1       bookdown_0.46      desc_1.4.3         ## [21] RColorBrewer_1.1-3 bslib_0.9.0        pillar_1.11.1      rlang_1.1.7        ## [25] cachem_1.1.0       xfun_0.55          S7_0.2.1           fs_1.6.6           ## [29] sass_0.4.10        otel_0.2.0         cli_3.6.5          withr_3.0.2        ## [33] pkgdown_2.2.0      magrittr_2.0.4     digest_0.6.39      grid_4.5.2         ## [37] lifecycle_1.0.5    vctrs_0.7.1        evaluate_1.0.5     glue_1.8.0         ## [41] cellranger_1.1.0   farver_2.1.2       ggseqlogo_0.2.2    ragg_1.5.0         ## [45] purrr_1.2.1        rmarkdown_2.30     tools_4.5.2        pkgconfig_2.0.3    ## [49] htmltools_0.5.9"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_seqlogo.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"PTM Analysis - Sequence Logo","text":"document performs sequence logo analysis significantly regulated sites DPA analysis. Sequence motifs help identify active kinases driving PTM changes. DPA (Differential PTM Abundance): Raw PTM signal changes. Sequence motifs may reflect abundance stoichiometry effects.","code":"desc <- switch(params$sheet,   \"DPA\" = \"**DPA (Differential PTM Abundance)**: Raw PTM signal changes. Sequence motifs may reflect both abundance and stoichiometry effects.\",   \"DPU\" = \"**DPU (Differential PTM Usage)**: Protein-normalized changes. Sequence motifs reflect genuine kinase activity changes.\",   \"CF\" = \"**CF (CorrectFirst)**: Alternative normalization. Sequence motifs reflect activity changes with different correction approach.\" ) cat(desc)"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_seqlogo.html","id":"data-loading","dir":"Articles","previous_headings":"","what":"Data Loading","title":"PTM Analysis - Sequence Logo","text":"Data Summary","code":"if (pipeline_mode) {   message(\"Loading data from: \", params$xlsx_file, \" (sheet: \", params$sheet, \")\")   data <- readxl::read_xlsx(params$xlsx_file, sheet = params$sheet) } else {   # Vignette mode: use example data   data(\"combined_test_diff_example\", package = \"prophosqua\")   data <- combined_test_diff_example   message(\"Using example data from prophosqua package\") }  data_info <- tibble(   Property = c(\"Mode\", \"Sheet\", \"Rows\", \"Contrasts\"),   Value = c(     if (pipeline_mode) basename(params$xlsx_file) else \"Example data\",     params$sheet,     nrow(data), paste(unique(data$contrast), collapse = \", \")   ) ) knitr::kable(data_info, caption = \"Data Summary\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_seqlogo.html","id":"filter-significant-sites","dir":"Articles","previous_headings":"","what":"Filter Significant Sites","title":"PTM Analysis - Sequence Logo","text":"Filter sites |log2FC| > 0.6 FDR < 0.05.","code":"# Use shared filtering function with sequence validation significant_sites <- data |>   dplyr::filter(!is.na(posInProtein)) |>   filter_significant_sites(     fdr_threshold = params$fdr,     fc_threshold = params$fc,     require_sequence = TRUE   )  cat(\"Found\", nrow(significant_sites), \"significant sites\\n\") ## Found 7410 significant sites"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_seqlogo.html","id":"count-significant-sites","dir":"Articles","previous_headings":"Filter Significant Sites","what":"Count Significant Sites","title":"PTM Analysis - Sequence Logo","text":"Number significantly regulated sites contrast, residue, regulation direction (DPA).","code":"stopifnot(\"No significant sites found. Adjust fdr/log2fc thresholds in config.\" = nrow(significant_sites) > 0)  tx <- as.data.frame(with(significant_sites, table(contrast, regulation, modAA))) capt <- paste0(\"Number of significantly regulated sites by contrast, residue, and regulation direction (\", params$sheet, \").\")  knitr::kable(tx, caption = capt)"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_seqlogo.html","id":"validate-sequence-window","dir":"Articles","previous_headings":"Filter Significant Sites","what":"Validate Sequence Window","title":"PTM Analysis - Sequence Logo","text":"Ensure central residue matches modified amino acid.","code":"# Use shared validation function significant_sites <- validate_sequence_window(significant_sites)  cat(\"After validation:\", nrow(significant_sites), \"sites remain\\n\") ## After validation: 7261 sites remain"},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_seqlogo.html","id":"generate-sequence-logos","dir":"Articles","previous_headings":"Sequence Logo Analysis","what":"Generate Sequence Logos","title":"PTM Analysis - Sequence Logo","text":"Sequence logos significantly regulated sites contrast regulation direction.","code":"seq_list <- significant_sites |>   dplyr::mutate(.grp = paste(contrast, regulation, sep = \"_\")) |>   dplyr::group_by(.grp) |>   dplyr::summarize(     seqs = list(toupper(SequenceWindow)),     .groups = \"drop\"   ) |>   with(setNames(seqs, .grp))  if (length(seq_list) > 0) {   ggseqlogo(     seq_list,     ncol = 2,     seq_type = \"aa\",     method = \"probability\"   ) } else {   cat(\"No significant sites found for sequence logo generation.\\n\") }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_seqlogo.html","id":"difference-logo-analysis","dir":"Articles","previous_headings":"","what":"Difference Logo Analysis","title":"PTM Analysis - Sequence Logo","text":"Visualize difference amino acid enrichment upregulated downregulated sites. Difference Logos (Upregulated - Downregulated)","code":"p_diff <- prophosqua::plot_diff_logo(significant_sites)  if (!is.null(p_diff)) {   print(p_diff) } else {   cat(\"No contrasts with both upregulated and downregulated sites found for difference logo.\\n\") }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_seqlogo.html","id":"results-summary","dir":"Articles","previous_headings":"","what":"Results Summary","title":"PTM Analysis - Sequence Logo","text":"Analysis Summary","code":"summary_info <- tibble(   Metric = c(\"Analysis Type\", \"FDR Threshold\", \"FC Threshold\",              \"Total Significant Sites\", \"Upregulated\", \"Downregulated\"),   Value = c(params$sheet, params$fdr, params$fc,             nrow(significant_sites),             sum(significant_sites$regulation == \"upregulated\"),             sum(significant_sites$regulation == \"downregulated\")) ) knitr::kable(summary_info, caption = \"Analysis Summary\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_seqlogo.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"PTM Analysis - Sequence Logo","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Tahoe 26.3 ##  ## Matrix products: default ## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: Europe/Zurich ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] prophosqua_0.3.0 readxl_1.4.5     ggseqlogo_0.2.2  dplyr_1.2.0      ##  ## loaded via a namespace (and not attached): ##  [1] gtable_0.3.6       jsonlite_2.0.0     compiler_4.5.2     tidyselect_1.2.1   ##  [5] jquerylib_0.1.4    systemfonts_1.3.1  scales_1.4.0       textshaping_1.0.4  ##  [9] yaml_2.3.12        fastmap_1.2.0      ggplot2_4.0.2      R6_2.6.1           ## [13] labeling_0.4.3     patchwork_1.3.2    generics_0.1.4     knitr_1.51         ## [17] forcats_1.0.1      htmlwidgets_1.6.4  tibble_3.3.1       bookdown_0.46      ## [21] desc_1.4.3         bslib_0.9.0        pillar_1.11.1      RColorBrewer_1.1-3 ## [25] rlang_1.1.7        cachem_1.1.0       xfun_0.55          S7_0.2.1           ## [29] fs_1.6.6           sass_0.4.10        otel_0.2.0         cli_3.6.5          ## [33] withr_3.0.2        pkgdown_2.2.0      magrittr_2.0.4     digest_0.6.39      ## [37] grid_4.5.2         lifecycle_1.0.5    vctrs_0.7.1        evaluate_1.0.5     ## [41] glue_1.8.0         cellranger_1.1.0   farver_2.1.2       ragg_1.5.0         ## [45] purrr_1.2.1        rmarkdown_2.30     tools_4.5.2        pkgconfig_2.0.3    ## [49] htmltools_0.5.9"},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"abstract","dir":"Articles","previous_headings":"","what":"Abstract","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Post-translational modifications (PTMs), particularly phosphorylation, regulate protein function substoichiometric levels, making quantitative analysis technically challenging. critical limitation PTM studies distinguishing changes modification abundance due altered protein expression versus genuine changes modification stoichiometry (fraction protein molecules modified). chapter presents comprehensive workflow integrating Tandem-Mass-Tag (TMT)-based quantitative proteomics specialized computational analysis distinguish differential PTM abundance (DPA) differential PTM usage (DPU) using prolfqua, prolfquapp, prophosqua R packages. workflow introduces robust statistical framework integrated PTM-protein analysis, comprehensive visualization tools including N-terminus C-terminus (N--C) plots protein-centric PTM mapping, sequence motif analysis kinase prediction. integrated approach enables researchers identify actual signaling changes PTM studies, prioritize functionally relevant modification sites, understand pathway-level regulation disease contexts, generate robust datasets suitable publication high-impact journals.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"key-words","dir":"Articles","previous_headings":"","what":"Key Words","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Post-translational modifications, phosphoproteomics, TMT labeling, differential PTM abundance analysis, differential PTM usage analysis, mass spectrometry, data integration, kinase activity","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"biological-significance-of-post-translational-modifications","dir":"Articles","previous_headings":"Introduction","what":"Biological Significance of Post-Translational Modifications","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Protein phosphorylation reversible PTM modulates protein’s conformation, enzymatic activity, subcellular localization, binding interactions. modification can reversed rapidly, acts molecular switch cellular signaling networks. result, cells respond environmental cues without requiring new protein synthesis. Dysregulation phosphorylation implicated cancer, neurodegeneration, metabolic disorders [1]. Large-scale phosphoproteomic profiling high-throughput mass spectrometry (MS) (e.g., TMT-based workflows) therefore crucial dissecting disease-associated signaling alterations identifying candidate therapeutic targets.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"technical-challenges-in-ptm-analysis","dir":"Articles","previous_headings":"Introduction","what":"Technical Challenges in PTM Analysis","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"analysis PTMs, phosphorylation, presents significant analytical challenges due low abundance modified peptides. Typically, phosphorylated peptides represent less 1–5% total peptide population [2]. Additionally, phosphopeptides generally exhibit poorer ionization efficiency MS-based proteomics compared non-modified peptides, complicating detection quantification. low abundance challenging ionization behavior necessitate specialized experimental workflows computational strategies achieve accurate quantification [3]. key analytical challenge distinguishing genuine changes PTM levels, due altered kinase phosphatase activity, changes caused altered protein abundance [4, 5]. Without proper correction, confounding factor can lead researchers misinterpret PTM data, incorrectly attributing higher phosphorylation signals solely increased modification efficiency pathway activation, rather elevated protein expression [6]. Controlling confounder critical discern rapid, signaling-driven phosphorylation events slower, transcriptionally translationally regulated changes protein abundance. phosphorylation substoichiometric, small fraction protein molecules carry modification; therefore, enrichment required isolate phosphopeptides. Enrichment steps (Immobilized Metal Affinity Chromatography (IMAC) Metal Oxide Affinity Chromatography (MOAC)) introduce additional sample handling technical variability [6–8]. Therefore, stage, digestion cleanup MS acquisition, must carefully optimized improve reproducibility [9]. Effective experimental design combined tailored normalization strategies therefore essential recover reliable, biologically meaningful PTM signals. Isobaric TMT labeling enables multiplexed PTM analysis 35 samples single run, reducing inter-sample variability missing values improve statistical power [10, 11]. Phosphopeptides typically enriched IMAC Metal Oxide Affinity Chromatography (MOAC), provide complementary selectivity broaden coverage [12, 13]. Adding offline fractionation liquid chromatography–tandem mass spectrometry (LC–MS/MS) increases phosphosite depth distributes peptide load, improving quantification consistency across fractions conditions [14]. TMT-based proteomics, plex refers complete set isobarically tagged samples analyzed together single LC–MS/MS run. total number samples exceeds available TMT channels, plex include least one biological replicate every experimental group common reference pooled channel normalization [15]. Replicates group distributed across different plexes rather clustered within single run, preventing group’s replicates confined one batch. samples fit within channel capacity single plex, balancing measures inherently satisfied run.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"computational-tools-and-workflows","dir":"Articles","previous_headings":"Introduction","what":"Computational Tools and Workflows","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"computational landscape quantitative protein PTM analysis undergone significant evolution, numerous specialized software platforms supporting bottom-proteomics workflows. Following MS data acquisition, spectra undergo database searching identify peptide sequences, subsequently followed protein inference determine protein identities based identified peptides. ecosystem PTM analysis includes several well-established data-dependent acquisition (DDA)-TMT compatible software suites, free commercial, Andromeda integrated within MaxQuant [16], Proteome Discoverer (Thermo Fisher Scientific), FragPipe [17], PeptideShaker [18]. Among analytical steps following peptide identification, PTM site localization scoring represents particularly crucial computational challenge. Site localization determines confidence modification can assigned specific amino acid residue within peptide sequence. process especially challenging peptides contain multiple potential modification sites, necessitating algorithms evaluate quality specificity site-determining fragment ions. Specialized tools developed explicitly robust PTM site localization, including PTMProphet [19], PhosphoRS [20], Ascore [21]. Accurate localization essential, incorrect site assignments can lead biological misinterpretations, particularly signaling pathway analyses kinase-substrate predictions. DDA workflows, FragPipe [22] represents widely adopted integrated platform comprehensively addresses PTM analysis, including site localization challenges. FragPipe integrates MSFragger search engine [23], enabling highly sensitive peptide identification, employs PTMProphet [24] functionality site localization scoring. also generates detailed quantitative outputs, including site-level quantification reports multisite feature reports group peptides sharing identical modification patterns. detailed description FragPipe workflow provided experimental methods section (see Section @ref(fragpipeparams)). discussion focused primarily DDA workflows, data-independent acquisition (DIA)-based approaches represent alternative strategies distinct computational considerations PTM analysis. Specialized DIA platforms Spectronaut [25], [26] DIA-NN [27] offer PTM support dedicated site-localization scoring algorithms site-level quantification capabilities. Unlike DDA, DIA workflows require specialized computational approaches extract quantify modification-specific information highly multiplexed fragmentation spectra. Spectronaut DIA-NN incorporate advanced statistical frameworks designed explicitly PTM identification quantification DIA workflows.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"data-analysis-frameworks","dir":"Articles","previous_headings":"Introduction","what":"Data Analysis Frameworks","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Proteomic data analysis can conducted multiple levels granularity, providing distinct analytical perspectives. peptidoform represents specific peptide sequence particular set modifications, site-level analysis aggregates signals residue position across multiple peptides. Differential analysis can therefore target either peptidoforms individual modification sites, approach offering unique advantages different research questions. FragPipe introduces additional analytical concept multisite features, refers set identified peptide-forms sharing set modification sites investigation, regardless sequence derivatives, cleavage state, whether modifications unambiguously localized. approach groups peptidoforms different sequences, can arise missed cleavages alternative cleavage patterns, identical possible modification sites multisite feature, providing balanced approach peptidoform specificity site-level aggregation. Discarding peptidoforms ambiguous localization result loss large fraction PTM information. Furthermore, multisite features preserve information phosphorylation sites occur together peptide molecule, revealing co-modification patterns indicate coordinated regulation kinases functional relationships sites. Traditional site-level analysis treats phosphorylation site independently, losing valuable information specific combinations sites modified together biological samples. Site-level reports collapse signals peptidoforms mapping PTM amino acid residue single quantitative value, ensuring site exactly one intensity measurement per sample. downstream analysis, site-level intensities integrate seamlessly site-centric enrichment tools kinase-activity inference platforms (PhosR [28], PTM-SEA [29], RoKAI [30], etc.), streamlining biological interpretation network reconstruction analyses [31].","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"statistical-analysis-of-ptm-data","dir":"Articles","previous_headings":"Introduction","what":"Statistical Analysis of PTM Data","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Statistical analysis PTM data requires specialized methods due confounding effects PTM levels protein abundances. Several statistical packages emerged address critical issue integrating PTM-feature quantifications protein abundance data. Notable examples include MSstatsPTM [4] msqrob2PTM [5], explicitly model modified peptide protein-level changes distinguish genuine PTM regulation protein abundance effects accurately. msqrob2PTM framework exemplifies statistical approaches now available PTM analysis, defining two complementary analytical strategies: DPA DPU [5]. DPA directly models log2log^2 intensities modified peptide (peptidoform), detecting absolute changes PTM levels experimental conditions. contrast, DPU adjusts PTM intensities corresponding protein-level changes, effectively testing changes relative usage stoichiometry modification site. dual approach enables researchers distinguish PTM changes driven protein abundance differences (DPA) versus reflecting genuine changes modification efficiency regulatory activity (DPU). two frameworks differ analytical approaches addressing confounding PTM changes protein abundance. MSstatsPTM employs “model correct” strategy, separately fitting linear models modified unmodified peptide data, combining statistical inferences post-modeling. contrast, msqrob2PTM follows “correct model” approach, first adjusting PTM intensities corresponding protein abundances data level, subsequently performing statistical testing normalized values. option, discussed [32], model PTM total proteome data factorial design jointly includes biologically relevant explanatory variable, e.g., genotype, “component” indicator, .e., modified peptide total proteome parent protein, fits linear model interaction. tests statistical significance interaction term flag modified peptides whose dynamics deviate corresponding total proteome protein abundance. , package limma used fit model perform testing. three methodologies ultimately estimate PTM abundance changes corrected protein-level effects, method can yield different test results due varying assumptions relationship PTMs protein abundances within sample, well differences variance degrees freedom estimated. MSstatsPTM fits PTM protein separate models, computes adjusted effect difference estimated contrasts: Δadj=ΔPTM−Δprotein\\Delta_{adj} = \\Delta_{PTM} - \\Delta_{protein} standard error combined quadrature test statistic, Welch’s approximation estimate degrees freedom, yields p-values adjusted fold change directly contrast scale. MSstatsPTM assumes correlation PTM protein abundances within samples. single-model approach [32] uses limma moderated (empirical-Bayes) variances interaction contrast within one fit, shrinks feature-wise variances toward common prior; dfdf moderated accordingly. single-model formulation can capture shared covariance adding sample blocking/random effect. Still, illustrated [32], baseline model omits sample term, effectively treating PTM protein measurements independent. msqrob2PTM assumes PTM protein abundances within sample correlated therefore corrects PTM abundances matched protein abundances. , modelling, corrected PTM intensities used. three pipelines target PTM-vs-protein effect different modeling paths make different assumptions within-sample covariance, differ variance moderation. Therefore, even raw data contrasts, can expect differences estimated effects, standard errors, p-values. offer researchers additional flexibility, developed prophosqua [33], R package designed streamline statistical analysis phosphoproteomics PTM datasets. Using prophosqua prolfqua package [34], MStatsPTM model-first msqrob2PTM correct first approaches can executed obtain protein-corrected PTM data provide intuitive visualizations comprehensive exploratory analysis.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"the-protein-assignment-problem-in-differential-ptm-feature-usage","dir":"Articles","previous_headings":"Introduction","what":"The Protein Assignment Problem in Differential PTM-feature Usage","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Identification quantification tools need assign peptides proteins, .e., find leading representative protein identifier (ID). assignment may dataset-specific may differ PTM total proteome dataset. Therefore, using protein IDs match PTM features proteins total run may lead loss information due differing representative IDs [35]. example, phosphopeptide might assigned, protein inference, protein isoform PTM dataset. contrast, total proteome dataset, protein abundance quantified isoform B, prevents proper integration DPU analysis. robust solution involves matching stripped peptide sequences PTM dataset peptide sequences proteins quantified total proteome dataset, bypassing protein ID dependency entirely. peptides shared among multiple protein isoforms, averaged protein abundance across matching isoforms provides stable reference normalization. sequence-based matching approach requires additional computational implementation, reduces loss valuable information due protein assignment differences datasets.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"chapter-overview-and-learning-objectives","dir":"Articles","previous_headings":"Introduction","what":"Chapter Overview and Learning Objectives","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"chapter introduces analytical workflow addresses biological challenge accurately distinguishing DPA DPU. Distinguishing protein-level effects genuine modification-specific changes critical meaningful interpretation PTM data. workflow emphasizes reproducibility, automation, biological interpretation. DPA tests raw PTM signal changes experimental conditions, identifying modification abundance changes regardless underlying protein-level effects. analysis captures total impact experimental perturbations PTM levels, including direct modification effects indirect effects mediated changes protein abundance. DPU evaluates protein-normalized PTM changes, explicitly identifying modification sites stoichiometry genuinely altered independent protein abundance. analysis pinpoints sites experimental conditions directly impact modification efficiency, kinase activity, phosphatase activity, thereby highlighting specific regulatory events. Learning objectives include: 1. Conducting integrated statistical analysis PTM total proteome data using prolfquapp prophosqua R packages 2. Interpreting DPA vs. DPU results biological insights generating publication-quality visualizations 3. Performing sequence motif analysis kinase prediction pathway reconstruction","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"demonstration-dataset","dir":"Articles","previous_headings":"Materials","what":"Demonstration Dataset","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"protocol utilizes Atg16l1 macrophage dataset Maculins et al. [36] demonstrate bioinformatics workflow integrated statistical analysis. dataset comprises TMT-11-plex measurements six conditions (WT/KO × uninfected/early/late infection) phospho-enriched total proteome samples, making ideal illustrating principles integrated PTM analysis. original publication, authors also performed ubiquitin remnant enrichment, although focus phosphoproteome total proteome datasets demonstration purposes. dataset previously used MSstatsPTM publication [4], providing additional validation analytical approaches. discussed , TMT enables high-precision quantification across many conditions, particularly combined fractionation. contrast, DIA well suited avoiding fractionation scaling larger sample numbers (see Note @ref(notelfq)).","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"system-requirements","dir":"Articles","previous_headings":"Materials","what":"System Requirements","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Search quantification software: FragPipe 22.0 (free download academic use fragpipe.nesvilab.org; system requirements: 32GB+ RAM, 50GB+ storage) Statistical platform: R version ≥\\ge 4.0.0 (https://www.r-project.org/) RStudio (https://posit.co/) System requirements: 16GB+ RAM, 20 GB+ storage Expected runtime: 10 minutes 1 hours depending dataset size number fractions","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"r-packages","dir":"Articles","previous_headings":"Materials","what":"R packages","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"relevant R packages used analysis : tidyverse [37] - Data manipulation visualization tools ggseqlogo [38] - Sequence motif visualization prolfqua [34] - Core statistical framework proteomics data analysis prolfquapp [39] - Streamlined differential expression analysis pipeline prolfquappPTMreaders [40] - Specialized readers PTM data formats prophosqua [33] - Integration visualization PTM protein data detailed installation instructions, see package documentation github.com/fgcz/prolfqua, github.com/prolfqua/prolfquapp, github.com/prolfqua/prophosqua.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"mass-spectrometry-data-processing","dir":"Articles","previous_headings":"Materials","what":"Mass Spectrometry Data Processing","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Raw MS data acquired using DDA combined TMT labeling processed using specialized software : Search spectra protein sequence database including species-specific sequences, common contaminants, decoy sequences extract reporter ion intensities compute site localization probabilities section (see Methods @ref(fragpipeparams)) describes detail parameterized FragPipe software [17].","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"methods","dir":"Articles","previous_headings":"","what":"Methods","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"key challenge, analysing PTMs, distinguish changes PTM abundance due altered protein expression reflect change modification stoichiometry (.e., fraction protein pool modified). protocol provides step--step computational workflow analyze PTM data context total protein abundance changes. leverage R packages prolfquapp [39] streamlined differential expression analysis [34] prophosqua [33] integration, analysis, visualization PTM total proteome data. workflow comprises three parts: 1) analysing raw mass spectrometric data FragPipe, 2) performing differential expression analysis PTM-enriched total proteome datasets, 3) integrating PTM total proteome data.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"fragpipeparams","dir":"Articles","previous_headings":"Methods","what":"Analysing TMT raw data with FragPipe","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"used TMT 11-plex phospho workflow FragPipe 22.0 [17] MSFragger (version 4.1) [23]. Database searching performed species-specific protein sequence database supplemented common contaminants reversed decoy sequences. search parameters included: Fixed modifications: Carbamidomethylation cysteine (+57.0215 Da) TMT labeling lysine residues peptide N-termini (+229.1629 Da) Variable modifications: Phosphorylation serine, threonine, tyrosine residues (+79.9663 Da) Oxidation methionine (+15.9949 Da) Acetylation protein N-termini (+42.0106 Da) Reporter ions quantified IonQuant (version 1.10.27), downstream processing TMTIntegrator (version 1.10.27). TMTIntegrator [22] performs quantification normalization specifically tailored multiplexed TMT experiments. Selected TMTIntegrator parameters : Best PSM selection: Outlier removal enabled: Allow overlabel/underlabel: Use MS1 intensity: Aggregation method: Median phospho-enriched samples, PTM sites scored using PTMProphet [24] localization scores ≥\\ge 0.75 retained. FragPipe workflow parameters stored configuration files (fragpipe.workflow). workflow file used parametrize FragPipe can downloaded [41]. FragPipe provides two types PTM-features reports phospho-enriched samples: Multisite features: groups peptidoforms sharing identical modification sites, described Section @ref(data-analysis-frameworks). Site-level reports collapse signals peptidoforms mapping amino acid position single quantitative value per PTM site, ensuring site exactly one intensity per sample. downstream analysis, site-level intensities can fed site-centric enrichment kinase-activity inference tools (PhosR, PTM-SEA, RoKAI, etc.), streamlining biological interpretation network reconstruction. essential step data preprocessing quality control (QC) quantified samples, involves estimating missed cleavage rates labeling efficiency (see Note @ref(automatedqc)).","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"data-setup-for-statistical-analysis","dir":"Articles","previous_headings":"Methods","what":"Data Setup for Statistical Analysis","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"following sections demonstrate computational workflow R code snippets implement step integrated PTM analysis. code examples also available within prophosqua package [33] can easily adapted different datasets modifying file paths experimental parameters. first step download example PTM dataset, serves comprehensive demonstration integrated PTM analysis. dataset derived Atg16l1 macrophage study Maculins et al. [36], investigates role autophagy bacterial infection responses. dataset contains total proteome PTM-enriched measurements well-designed factorial experiment following characteristics: Experimental design: 2×32\\times 3 factorial (Genotype: WT/KO; Timepoint: Uninfected/Early/Late infection) Biological context: Macrophage responses Shigella infection wild-type vs Atg16l1-knockout cells Technical approach: TMT 11-plex labeling precise quantification across conditions Data types: Total proteome protein-level phospho-enriched phospho-site quantification results. dataset particularly valuable demonstrating PTM analysis concepts Atg16l1 knockout creates direct protein abundance changes (loss Atg16l1 ) secondary effects autophagy-related signaling pathways. first step involves obtaining FragPipe 22 mass spectrometry output files [41] setting analysis environment R. Depending sample type, different FragPipe output files required: total proteome samples: psm.tsv files, containing peptide-spectrum match (PSM) information phospho-enriched samples: abundance_single-site.tsv files individual modification site analysis dataset available Zenodo 10.5281/zenodo.15879865. code downloads data, extracts folder, removes zip archive.","code":"need_download <- !dir.exists(\"PTM_example\") zenodo_url <- \"https://zenodo.org/records/15879865/files/PTM_experiment_FP_22_Maculins_and_QC.zip\"  destfile <- basename(zenodo_url) # Download, unzip and delete download.file(zenodo_url, destfile, mode = \"wb\") unzip(destfile, exdir = \".\") unlink(destfile)"},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"setting-up-prolfquapp-scripts","dir":"Articles","previous_headings":"Methods","what":"Setting up prolfquapp scripts","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"section demonstrates perform differential expression analysis (DEA) total proteome PTM-enriched proteome data using prolfquapp package. analysis provides foundation subsequent integration preprocessing, normalizing data, establishing proteins PTM-features show significant changes experimental conditions. prolfquapp [39] package provides set shell scripts automate analysis workflow. scripts copied working directory running command Linux shell used subsequent steps.","code":"R --vanilla -e \"library(prolfquapp); copy_shell_script(workdir = '.')\""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"contrasts","dir":"Articles","previous_headings":"Methods","what":"Creating sample annotation","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Sample annotation foundation meaningful DEA, serving bridge raw mass spectrometry files biological interpretation. annotation file maps raw data file corresponding experimental conditions (WT KO) additional explanatory variables, Time. start reading sample names FragPipe output files using prolfqua_dataset.sh script create dataset annotation file compatible prolfquapp, maps sample names experimental conditions (see Table @ref(tab:showAnnotTable)). use R extract experimental factors, Genotype Timepoint, channel labels using tidyr::separate function. channel names encode experimental conditions, explanatory variables must provided adding columns annotation file using text editor. call annotation_add_contrasts function prolfqua [34] generate factorial contrasts automatically. annotation_add_contrasts function adds two key columns sample annotation: ContrastName: descriptive name statistical contrast Contrast: mathematical formula defining contrast terms group means Note setting argument interactions=FALSE annotation_add_contrasts function disables generation interaction contrasts factor level combinations. Interaction contrasts assess whether effect one factor depends level another, thereby capturing non‑additive interplay factors. file dataset_with_contrasts.tsv final dataset file used DEA (see Table @ref(tab:showannotation)). experimental design protocol (2×32\\times3 factorial: Genotype [KO/WT] ×\\times Time [Uninfected/Early/Late]), function generated four distinct contrasts: KO_vs_WT (Main effect): ( (G_KO_Uninfect + G_KO_Late + G_KO_Early)/3 - (G_WT_Uninfect + G_WT_Late + G_WT_Early)/3 ) - Compares overall genotype effects across timepoints KO_vs_WT_at_Uninfect: G_KO_Uninfect - G_WT_Uninfect - Compares genotypes specifically uninfected condition KO_vs_WT_at_Late: G_KO_Late - G_WT_Late - Compares genotypes specifically late infection condition KO_vs_WT_at_Early: G_KO_Early - G_WT_Early - Compares genotypes specifically early infection condition want compare timepoints instead genotypes, set: primary_col=\"Timepoint\" secondary_col = \"Genotype\".","code":"./prolfqua_dataset.sh --indir PTM_example/data_total/FP_22/ \\ --dataset \"PTM_example/data_total/dataset.tsv\" \\ --software prolfquapp.FP_TMT annot <- readr::read_tsv(\"PTM_example/data_total/dataset.tsv\") annot <- annot |> tidyr::separate(\"Name\", c(\"Genotype\", \"Timepoint\", NA),                                   sep = \"_\", remove = FALSE) annot$group <- NULL annot$subject <- NULL annot$CONTROL <- NULL annot2 <- prolfqua::annotation_add_contrasts(   annot, primary_col = \"Genotype\", secondary_col = \"Timepoint\" ,   decreasing = TRUE, interactions = FALSE)$annot  write_tsv(annot2, \"dataset_with_contrasts.tsv\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"execution-of-differential-abundance-analysis","dir":"Articles","previous_headings":"Methods","what":"Execution of Differential Abundance Analysis","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"performing DEA, generate YAML configuration file using prolfqua_yaml.sh script. configuration file (config.yaml) defines key analysis parameters, including normalization method (variance stabilization normalization (VSN) default), protein summarization strategy (Tukey’s median polish default), quality-filtering thresholds q-value cutoffs peptide protein-level evidence. sample annotation configuration files prepared, DEA executed via prolfqua_dea.sh script. script reads experimental design (sample IDs, group labels, contrasts) alongside configuration file. Single-site protein intensities log⁡2\\log_2-transformed variance-stabilized modeling, improving homoscedasticity across conditions. Linear models fitted contrasts tested using prolfqua R-package’s contrast API. Rather imputing missing values, model adjusts degrees freedom based number actual observations per feature, naturally -weights features high missingness improves reliability fold-change p-value estimates. Empirical Bayes variance moderation applied stabilize variance estimates, particularly sample size limited. First, run DEA analysis total proteome quantification results. script uses FragPipe psm.tsv file input, aggregates reporter ions abundances peptide level, estimates protein abundances. code demonstrates prolfqua_dea.sh shell script can executed Linux command line. prolfqua_dea application expects following paramater: -: Specifies input directory FragPipe results -d: Uses annotated dataset file -y: Applies configuration settings config.yaml file. -w: Sets name work unit -s: Specifies software format (FragPipe TMT) running DEA, results stored time-stamped directory. code constructs path results directory using prolfquapp::zipdir_name() function, follows standard naming convention DEA results. DEA single-site output enriched phosphoproteome examines changes individual modification sites performed running code . analysis provides site-specific information particular amino acids modified different conditions. abundance_single-site_None.tsv file generated FragPipe used input. Please note using -s argument, point correct reader function prolfquappPTMreaders R package read FragPipe single-site output. data type, prolfquapp generates comprehensive suite outputs: Dynamic HTML reports containing interactive PCA plots, boxplots, volcano plots, heatmaps quality control exploratory analysis XLSX tables (DE_.xlsx) summarizing log⁡2\\log_2 fold changes, moderated t-statistics, raw p-values, Benjamini–Hochberg–adjusted p-values GSEA rank files (GSEA_.rnk) downstream gene-set enrichment analysis SummarizedExperiment objects (.rds) seamless import Shiny-based visualization tools results can integrated using prophosqua package combined analysis total proteome PTM data. However, essential note scenarios performing differential PTM-feature abundance analysis practical option (see Note @ref(useofDPADPU)).","code":"./prolfqua_yaml.sh -y config.yaml ./prolfqua_dea.sh -i PTM_example/data_total/FP_22 \\ -d dataset_with_contrasts.tsv \\ -y config.yaml \\ -w total_proteome \\ -s prolfquapp.FP_TMT prolfquapp::zipdir_name(\"DEA\", workunit_id = \"total_proteome\") ## [1] \"DEA_20260216_WUtotal_proteome_vsn\" ./prolfqua_dea.sh -i PTM_example/data_ptm/FP_22 \\ -d dataset_with_contrasts.tsv \\ -y config.yaml \\ -w phospho_STY \\ -s prolfquappPTMreaders.FP_singlesite"},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"integrated-ptm-analysis-using-prophosqua","dir":"Articles","previous_headings":"Methods","what":"Integrated PTM Analysis using prophosqua","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"prophosqua package [33] provides tools integrating analyzing PTM data total proteome measurements. enables researchers distinguish changes protein abundance changes usage modification sites. section explains load results differential abundance analysis, integrate PTM total proteome data, determine differential PTM-feature usage. Differential expression results prolfquapp, provided Excel format, total proteome multi- single-site PTM analyses imported R. datasets integrated performing left join protein identifiers, merging PTM-level statistics corresponding protein-level values condition. start defining project name analysis type. also create results directory store PTM/total proteome integration results: code , define paths DEA results XLSX files stored prolfquapp. need specify workunit names date DEA analysis run. Finally, load differential expression results R session. data integration step critical enabling DPU analysis represents one important technical aspects workflow. step joins phosphorylation site data total protein data create unified dataset PTM-feature linked corresponding protein-level measurements. left_join operation used ensures PTM-features retained analysis, even parent proteins detected total proteome experiment. approach maximizes information content allowing protein normalization possible, also reporting PTM-features mapped total proteome measurements. also need check match rate PTM sites proteins, , number PTM sites protein match divided total number PTM sites. Currently, prolfquapp matches PTM protein features using exact protein IDs, introduces limitation: discrepancies representative protein identifiers PTM-enriched total proteome datasets may result loss mapping information (see Note @ref(matchrates)). Table @ref(tab:b5matchrate) shows match rates contrast.","code":"library(prophosqua) wu_id <- \"CustomPhosphoAnalysis\" fgcz_project <- \"PTM_analysis\" oid_fgcz <- \"fgcz_project\" datetoday <- format(Sys.Date(), \"%Y%m%d\")  project_dir <- \".\" descri <- wu_id res_dir <- file.path(   project_dir,   paste0(fgcz_project, \"_\", datetoday, \"_singlesite_\", descri) ) if (!dir.exists(res_dir)) {   dir.create(res_dir, recursive = TRUE) } # Use today's date if running DEA, otherwise use existing results datedea <- if(do_dea) datetoday else \"20251214\"  tot_file <- prophosqua::dea_xlsx_path(project_dir, \"total_proteome\", datedea) ptm_file <- prophosqua::dea_xlsx_path(project_dir, \"phospho_STY\", datedea)  # Directory paths stopifnot(file.exists(tot_file)) stopifnot(file.exists(ptm_file)) required_cols <- c(\"protein_Id\", \"protein_length\", \"contrast\") tot_res <- prophosqua::load_and_preprocess_data(tot_file, required_cols) tot_res <- prophosqua::filter_contaminants(tot_res) phospho_res <- prophosqua::load_and_preprocess_data(ptm_file, required_cols) phospho_res <- prophosqua::filter_contaminants(phospho_res) join_column <- c(   \"protein_Id\" = \"protein_Id\",   \"contrast\" = \"contrast\",   \"description\" = \"description\",   \"protein_length\" = \"protein_length\" ) suffix_a <- \".site\" suffix_b <- \".protein\"  combined_site_prot <- dplyr::left_join(   phospho_res,   tot_res,   by = join_column,   suffix = c(suffix_a, suffix_b) ) # Calculate match rate by contrast match_rates <- combined_site_prot |>   group_by(contrast) |>   summarize(     total_sites = n(),     matched_sites = sum(!is.na(diff.protein)),     match_rate = round(matched_sites / total_sites * 100, 1)   )"},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"visualizing-ptm-feature-abundance-dpa","dir":"Articles","previous_headings":"Methods","what":"Visualizing PTM-feature Abundance (DPA)","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"DPA tests raw PTM-feature signal change conditions, without correction parent protein’s expression level. analysis used flag PTM-feature whose abundance changes, even parent protein also - -regulated. DPA results visualized using N--C plots, generated prophosqua [33] n_to_c_expression_multicontrast function. multi-panel plots map log⁡2\\log_2 fold changes individual modification sites along primary sequence protein log⁡2\\log_2 fold change protein abundance total proteome experiment across contrasts simultaneously. representation provides clear visual summary site-specific overall protein expression changes across multiple experimental comparisons. N--C expression plot (see Figure @ref(fig:fig1Q64337)) shows protein SQSTM1 (UniProt id Q64337) phosphorylation sites upregulated KO vs WT comparison across different timepoints. generating N--C plots computationally intensive, generate plots proteins least one significant phosphorylation site contrast. False Discovery Rate (FDR) threshold determining significance can adjusted n_to_c_expression_multicontrast n_to_c_usage_multicontrast functions, allowing researchers balance computational efficiency comprehensive visualization based specific considerations. significant PTM sites detected despite biological expectations, one possible reason insufficient statistical power, can mitigated increasing sample size (see Note @ref(nosignificantPTM)). next code snippet exports 100100N--C expression plots PDF file analysis presentation (see also Note @ref(compperf) limit number N--C plots written file).","code":"plot_data <- n_to_c_expression_multicontrast(   combined_site_prot, FDR_threshold = 0.01,   max_plots = 100, include_proteins = c(\"Q64337\")) x1 <- which(grepl(\"Q64337\", plot_data$protein_Id)) fig1_plot <- plot_data$plot[[x1[1]]] pdf(file.path(res_dir, \"Site_differential_Expression_multicontrast.pdf\"),     width = 14, height = 10) for (i in seq_len(min(100, nrow(plot_data)))) {   print(plot_data$plot[[i]]) } dev.off()"},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"analysis-of-differential-ptm-feature-usage-dpu---model-first","dir":"Articles","previous_headings":"Methods","what":"Analysis of Differential PTM-feature Usage (DPU) - model-first","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"DPU tests protein-normalized changes PTM-features. analysis essential determining whether fraction protein modified specific site changes conditions. isolates changes modification stoichiometry changes overall protein abundance. model-first approach, DPU calculated subtracting total proteome protein log⁡2\\log_2 fold change PTM-feature’s log⁡2\\log_2 fold change. associated p-values recalculated using method combines variance PTM protein-level models, implemented prophosqua [33] test_diff function, MSstatsPTM R-package [4]. analysis involves three key mathematical components: Effect Size Calculation (ΔI\\Delta_I) Standard Error Propagation (SEISE_I) Degrees Freedom Calculation (dfIdf_I) differential PTM usage effect size calculated difference PTM total proteome protein log⁡2\\log_2 fold changes comparison: ΔI=log⁡2FCPTM−log⁡2FCProtein\\Delta_I = \\log_2FC_{PTM} - \\log_2FC_{Protein} difference represents protein-normalized change PTM abundance, : Positive values - indicate increased modification stoichiometry (higher fraction protein modified) Negative values - indicate decreased modification stoichiometry (lower fraction protein modified) Zero values - indicate change modification stoichiometry relative protein expression combined standard error accounts uncertainty PTM protein measurements: SEI=SEPTM2+SEProtein2SE_I = \\sqrt{SE_{PTM}^2 + SE_{Protein}^2} error propagation ensures statistical significance usage changes reflects uncertainty datasets, providing robust assessment reliability observed changes. effective degrees freedom combined test calculated using Welch’s approximation: dfI=(SEPTM2+SEProtein2)2SEPTM4DFPTM+SEProtein4DFProteindf_I = \\frac{(SE_{PTM}^2 + SE_{Protein}^2)^2}{\\frac{SE_{PTM}^4}{DF_{PTM}} + \\frac{SE_{Protein}^4}{DF_{Protein}}} , provides appropriate degrees freedom. Welch approximation essential two datasets different experimental designs sample sizes. Using calculated parameters, t-statistic computed: t=ΔISEIt = \\frac{\\Delta_I}{SE_I} p-value determined using t-distribution dfIdf_I degrees freedom. Multiple testing correction (e.g., Benjamini-Hochberg FDR) applied across tested sites. test_diff function calculates difference differences PTM total proteome data, revealing site-specific usage changes. PTM-feature usage log⁡2\\log_2 fold changes, p-values, FDR estimates added dataframe combined_test_diff. DPU results visualized using N--C plots generated prophosqua::n_to_c_usage_multicontrast, display protein-normalized PTM-feature abundance changes across contrasts simultaneously highlight sites significant changes usage. multi-panel plots reveal sites used less actively, independent total protein changes, enabling comparison across experimental conditions. Atg16l1 macrophage dataset [36], SQSTM1 (uniprot id Q64337) protein levels markedly increased Atg16l1-knockout (KO) versus wild-type (WT), reflecting loss autophagy-mediated turnover. Phosphosite analysis reveals raw phosphopeptide intensities Ser28Ser_{28}, Ser308Ser_{308}, Ser368Ser_{368} similarly elevated cKO compared WT (DPA), consistent higher protein abundance (see Figure @ref(fig:fig1Q64337)). However, applying DPU normalization, subtracts total proteome protein log⁡2\\log_2 fold change site’s phospho log⁡2\\log_2 fold change, apparent phosphorylation increases substantially reduced, indicating phosphosite abundance changes arise protein accumulation rather genuine changes modification stoichiometry (see Figure @ref(fig:fig2usageQ64337)). example highlights DPU effectively isolates regulatory events SQSTM1 confounding protein-level effects. Additionally, individual high-confidence DPA/DPU sites carefully inspected technical quality, including verification protein coverage assessment missing values across treatment groups (see Note @ref(qcrecommend)). evaluating statistical significance DPU analysis, essential avoid overinterpreting results (see Note @ref(overinterpret)). Statistical significance guarantee biological relevance; effect sizes considered alongside FDR values prioritizing sites investigation. Key findings validated orthogonal methods confirm biological relevance.","code":"combined_test_diff <- prophosqua::test_diff(phospho_res, tot_res, join_column = join_column) plot_data_usage <- n_to_c_usage_multicontrast(   combined_test_diff, FDR_threshold = 0.05,   max_plots = 100, include_proteins = c(\"Q64337\")) x1_usage <- which(grepl(\"Q64337\", plot_data_usage$protein_Id)) fig2_plot <- plot_data_usage$plot[[x1_usage[1]]]"},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"protein-ptm-integration-report-generation","dir":"Articles","previous_headings":"Methods","what":"Protein PTM Integration Report Generation","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"integrated analysis results compiled comprehensive HTML report using R markdown template _Overview_PhosphoAndIntegration_site.Rmd. report includes: Overview statistics identified phosphorylation sites Interactive scatter plots comparing protein vs PTM-feature changes Volcano plots highlighting differential PTM-feature usage report includes data tables allow searching specific protein phosphorylation feature, highlighting scatter plot showing total proteome protein log2(FC)log_2(FC) function PTM-site log2(FC)log_2(FC), well volcano plots. analyzing interactive reports, different combinations DPA DPU results provide distinct biological insights guide interpretation. instance, DPA+ indicates changes driven primarily protein abundance alterations, PTM increases reflect higher protein levels rather enhanced modification efficiency (see Note @ref(dpuvsdpa)). generate HTML report, begin creating report configuration includes project ID, order ID, work unit description displayed interactive HTML report. Next, can render interactive HTML report comprehensive analysis results, including tables, plots, statistical summaries. report available download Zenodo [42]. addition, analysis results exported Excel file analysis sharing. Excel file contains two worksheets: combinedSiteProteinData: Contains merged PTM protein-level data used DPA analysis. combinedStats: Contains differential PTM-feature usage statistics (DPU), including log⁡2\\log_2 fold changes, p-values, FDR estimates phosphorylation site. Excel format facilitates downstream analysis, data sharing collaborators, integration bioinformatics tools. file automatically saved timestamped filename results directory. produced XLSX file can downloaded [42]. comprehensive integrated analysis framework provides key advantages PTM research, including ability distinguish genuine signaling changes protein abundance effects (see Note @ref(keyinsight)).","code":"drumm <- prolfquapp::make_DEA_config_R6(   PROJECTID = fgcz_project,   ORDERID = oid_fgcz,   WORKUNITID = descri ) # Copy integration files prophosqua::copy_phospho_integration() ## [1] \"/Users/wolski/projects/prophosqua/inst/PTM_example_analysis_v2/_Overview_PhosphoAndIntegration_site.Rmd\" ## [2] \"/Users/wolski/projects/prophosqua/inst/PTM_example_analysis_v2/bibliography2025.bib\" # Render HTML report rmarkdown::render(   \"_Overview_PhosphoAndIntegration_site.Rmd\",   params = list(     data = combined_test_diff,     grp = drumm   ),   output_format = bookdown::html_document2(     toc = TRUE,     toc_float = TRUE   ),   envir = new.env(parent = globalenv()) ) # Copy HTML report to results directory (uses existing if not re-rendered) if (file.exists(\"_Overview_PhosphoAndIntegration_site.html\")) {   file.copy(     from = \"_Overview_PhosphoAndIntegration_site.html\",     to = file.path(res_dir, \"Result_phosphoAndTotalIntegration.html\"),     overwrite = TRUE   ) } ## [1] TRUE excel_result_list <- list(   combinedStats = combined_test_diff,   combinedSiteProteinData = combined_site_prot ) writexl::write_xlsx(   excel_result_list,   path = file.path(     res_dir,     \"Result_phosphoAndTotalIntegration.xlsx\"   ) )  # Save example data for package (as .rda for data() loading) combined_test_diff_example <- combined_test_diff save(combined_test_diff_example,      file = here::here(\"data\", \"combined_test_diff_example.rda\"),      compress = \"xz\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"estimating-ptm-feature-usage-by-the-correct-first-approach","dir":"Articles","previous_headings":"Methods","what":"Estimating PTM-feature usage by the correct first approach","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"show estimate DPU using correct first approach. first correct PTM site abundances, using total proteome, model differential usage changes. analysis starts loading prolfquapp outputs. time, read transformed normalized total proteome protein abundances. also loading normalized single-site abundances. addition loading data, create prolfqua::LFQData object using LFQData$new constructor. LFQData object provides numerous methods analyzing visualizing quantitative proteomics data [34]. merge data single-site total proteome protein abundances protein identifier sample. subtract total proteome protein abundances single-site abundances. Density plot (see Figure @ref(fig:fig3densityCorrected)) shows distribution corrected single-site abundances. Next, fit linear model PTM, explains corrected PTM site abundances using grouping samples. model fitted site using prolfqua::build_model function. compute contrasts, construct array contrasts annotation table, built Section @ref(contrasts). following code fragment computes contrasts linear models. presence missing values, PTMs fitted model. Therefore, also estimate contrast using ContrastsMissing method, estimates missing values based inferred limit detection (details, see [34]). Finally, can create volcano plot DPU results using ctr_plotter variable, instance prolfqua::ContrastsPlotter class (see Figure @ref(fig:fig4FDRcorrfirst)). enable downstream analyses sequence motif analysis PTM-SEA, need enrich contrast results sequence window information. phospho_res dataframe loaded earlier contains annotation data need. ctr_df_annotated dataframe now contains DPU statistics (log⁡2\\log_2 fold changes, p-values, FDR) sequence annotations needed motif analysis kinase activity inference.","code":"tot_res_dir <- prophosqua::dea_res_dir(project_dir, \"total_proteome\", datedea) ldata <- arrow::read_parquet(file.path(tot_res_dir,\"lfqdata_normalized.parquet\")) ldata <- ldata |> filter(!grepl(\"^rev_\",protein_Id) ) tot_d <- ldata |>   dplyr::select(channel, protein_Id, normalized_abundance) ptm_res_dir <- prophosqua::dea_res_dir(project_dir, \"phospho_STY\", datedea) ldata <- arrow::read_parquet(file.path(ptm_res_dir,\"lfqdata_normalized.parquet\")) list <- yaml::read_yaml(file.path(ptm_res_dir,\"lfqdata.yaml\")) config <- prolfqua::list_to_AnalysisConfiguration(list) ptm_data <- prolfqua::LFQData$new(ldata,config) ptm_data$data <- dplyr::inner_join(   ptm_data$data, tot_d,   by = c(\"channel\", \"protein_Id\"), suffix = c(\".site\",\".total\")) ptm_data$data <- ptm_data$data |>    dplyr::mutate(ptm_usage = normalized_abundance.site - normalized_abundance.total) ptm_data$config$table$set_response(\"ptm_usage\") pl <- ptm_data$get_Plotter() fig3_plot <- pl$intensity_distribution_density() strategy_lm <- prolfqua::strategy_lm(\"ptm_usage ~ G_\") models <- prolfqua::build_model(data = ptm_data, model_strategy = strategy_lm) contrasts <- annot2$Contrast  names(contrasts) <- annot2$ContrastName contrasts <- contrasts[!is.na(contrasts)] ctr <- prolfqua::Contrasts$new(models, contrasts) x <- ctr$get_contrasts() ctr_m <- prolfqua::ContrastsMissing$new(ptm_data, contrasts) ctr_all <- prolfqua::merge_contrasts_results(ctr, ctr_m)$merged ctr_mod <- prolfqua::ContrastsModerated$new(ctr_all) ctr_df <- ctr_mod$get_contrasts() ctr_plotter <- ctr_all$get_Plotter() fig4_plot <- ctr_plotter$volcano()$FDR # Select relevant columns from phospho_res for joining site_annotations <- phospho_res |>   dplyr::select(     site_Id = protein_Id,     SequenceWindow,     posInProtein,     modAA,     description,     protein_length   ) |>   dplyr::distinct()  # Join to contrast results ctr_df_annotated <- ctr_df |>   dplyr::left_join(site_annotations, by = c(\"modelName\" = \"site_Id\"))  # Rename columns to match the model-first output format ctr_df_annotated <- ctr_df_annotated |>   dplyr::rename(     diff_diff = diff,     FDR_I = FDR   )  # Save correct-first results alongside model-first output saveRDS(ctr_df_annotated,         file.path(res_dir, \"ctr_df_annotated_correctfirst.rds\"))"},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"sequence-logo-analysis-of-modified-sites","dir":"Articles","previous_headings":"Methods","what":"Sequence Logo Analysis of Modified Sites","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"section guides biological interpretation PTM changes analyzing sequence motifs surrounding significantly modified sites identify potential kinase recognition patterns. analysis bridges gap statistical significance biological mechanism (see Note @ref(overinterpret)) leveraging well-established principle kinases recognize specific amino acid sequence patterns around target sites. Protein kinases exhibit sequence specificity, preferentially phosphorylating sites match recognition motifs. motifs typically encompass positions -5 +4 relative phosphorylation site, specific positions critical others. analyzing sequence patterns significantly regulated sites, can: Identify active kinases: Sites share similar motifs likely represent targets kinase kinase family. Table @ref(tab:tablesites) shows examples kinase-specific sequence motives. Understand pathway activation: Different kinase families associated different signaling pathways Predict functional consequences: Kinase-specific phosphorylation often predictable effects protein function Generate testable hypotheses: Motif predictions can guide follow-experiments kinase inhibitors knockdowns identify potential kinases responsible observed phosphorylation changes, sequence motif analysis performed significantly regulated PTM sites identified DPU analysis. contrast, amino acid sequences flanking significantly regulated sites (.e., FDR<0.01FDR < 0.01 |log⁡2(FC)|>0.58|\\log_2(FC)| > 0.58) extracted grouped regulation status (.e., upregulated downregulated). ggseqlogo R package used generate sequence logo plots group. plots visualize conserved amino acid patterns around modification site, facilitating comparison known kinase recognition motifs enabling inference upstream regulatory kinases (see Table @ref(tab:tablesites)). analysis focuses sites strong statistical evidence ensure motif patterns reflect genuine biological changes rather technical artifacts. dataset, stringent filtering yields many sites (see Table @ref(tab:tableSignificantContrasts)). However, datasets, number sites might insufficient creating sequence logos (see Note @ref(nosignificantPTM)). start filtering DPU data |log⁡2(FC)|>0.58|\\log_2(FC)| > 0.58 FDR≤0.05FDR \\le 0.05. Table @ref(tab:tableSignificantContrasts) summarizes number PTM-features contrast, modification site, - -regulation. observe serine (S) threonine (T), many - downregulated sites, tyrosine (Y), . generating sequence logos, must ensure sequence windows properly centered phosphorylation site. code validates 8th character (center position) sequence window matches reported modified amino acid (Note @ref(seqwindow)). generate sequence logos sites significantly regulated serine threonine phosphorylation. plots organized contrast 3-column layout showing upregulated sites, downregulated sites, difference (- ). difference column highlights amino acids enriched upregulated sites (positive, baseline) versus downregulated sites (negative, baseline), helping identify kinase-specific motifs (see Figure @ref(fig:fig5seqlogoST)). analysis helps identify signaling pathways kinases responsible observed changes phosphorylation experimental conditions. motif analysis yields weak absent sequence patterns, several factors may require optimization, including number significant sites, sequence window size used motif extraction (see Note @ref(motiflimit)).","code":"log_2FC_threshold <- 0.58   significant_sites <- combined_test_diff |>   dplyr::filter(     FDR_I < 0.05,      abs(diff_diff) > log_2FC_threshold,      !is.na(posInProtein),      !grepl(\"^_\", SequenceWindow),     !grepl(\"_$\", SequenceWindow)   ) |>   dplyr::mutate(     regulation = dplyr::case_when(       diff_diff > 0 ~ \"upregulated\",       diff_diff < 0 ~ \"downregulated\",       TRUE ~ \"no_change\"     )   ) significant_sites$seventh_chars <- toupper(substr(significant_sites$SequenceWindow, 8, 8)) significant_sites <- significant_sites |> filter(seventh_chars == modAA) sig_sites_ST <- significant_sites |>   dplyr::filter(modAA == \"S\" | modAA == \"T\")  fig5_plot <- plot_seqlogo_with_diff(sig_sites_ST)"},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"kinase-activity-inference-using-ptm-pipeline","dir":"Articles","previous_headings":"Methods","what":"Kinase Activity Inference Using ptm-pipeline","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Kinase activity can inferred phosphoproteomics data testing whether known predicted substrates kinase coordinately shifted ranked list regulated phosphosites. Two complementary resources defining kinase–substrate sets () curated signatures PTMsigDB (distributed via MSigDB’s PTMsig collection) (ii) motif specificity models Kinase Library. PTMsigDB / MSigDB PTMsig collection. PTMsig collection (PTMsigDB) provides literature-curated, PTM site–specific signature sets site-centric enrichment analysis, including kinase–substrate signatures, perturbation signatures (e.g., growth factor inhibitor treatment), pathway-related site signatures. , “signature” refers named set many phosphosites (analogous gene set classic GSEA), single sequence window. maximize compatibility across search engines protein database versions, PTMsigDB distributes signatures using multiple site identifier schemes, commonly phosphosite-centered flanking sequences (typically ±7\\pm 7 amino acids around modified residue; 15-mers) well UniProt-centric residue identifiers (optionally PhosphoSitePlus site-group IDs). PTMsigDB provides organism-specific releases human, mouse, rat; original PTMsigDB publication, total number available signature sets order hundreds (reported ≈490\\approx 490), counts vary database version organism. Kinase Library. comprehensive, model-based resource Kinase Library [43], profiled substrate sequence preferences 303 human Ser/Thr kinases (covering >84% predicted active) provides position-specific scoring matrices (PSSMs). Unlike curated substrate lists require exact matches previously observed sites, PSSMs assign quantitative compatibility score observed sequence window, enabling kinase–substrate relationships inferred without perfect matching. makes straightforward construct “kinase substrate sets” applying score threshold selecting top-ranked sites per kinase, can used input signatures enrichment testing. PTM Signature Enrichment Analysis (PTM-SEA) using GSEA. kinase–substrate sets defined (PTMsigDB, motif/PSSM scoring, ), kinase activity can inferred quantitatively using PTM-SEA [29], adapts Gene Set Enrichment Analysis (GSEA) framework [44] site-centric data. Phosphosites (sequence-window identifiers) ranked differential signal (e.g., log⁡2\\log_2 fold change t-statistic). GSEA tests whether members kinase’s substrate set tend occur near top bottom ranked list expected null model uniform distribution. enrichment score computed walking ranked list, increasing running sum set member encountered decreasing otherwise. Positive enrichment consistent increased kinase activity (substrates preferentially upregulated), negative enrichment consistent reduced activity. Practical considerations coverage. PTMsigDB signatures provide high-confidence, literature-supported kinase assignments, constrained database coverage identifier matching (including need consistent site definitions sequence context). constraints become pronounced outside human (lesser extent mouse/rat). contrast, motif-based scanning (e.g., basophilic motifs R-x-x-S/T PKA/CaMKII-like kinases) Kinase Library PSSMs generalize observed sequence window, enabling broader application across datasets curated substrate evidence sparse—trading direct experimental validation individual site level. ptm-pipeline [45], kinase activity inference implemented automated workflow uses prolfquapp/prophosqua generate differential phosphorylation abundance (DPA) differential phosphorylation usage (DPU) results “model” “correct-first” strategies. performs GSEA-based PTM-SEA using kinase substrate signatures PTMsigDB well Kinase Library–derived sets generated PSSM scoring phosphosite sequence windows. workflow provided command-line tool executed via Snakemake pipeline. source code available github.com/wolski/ptm-pipeline.","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"notelfq","dir":"Articles","previous_headings":"Notes","what":"Label-free quantification vs. TMT-based approach","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"TMT-based quantification offers several advantages, including higher throughput, reduced missing values, improved quantitative precision, also enabling efficient use fractionation since samples represented within fraction. contrast, label-free approaches avoid labeling-related artifacts, can handle unlimited number samples, typically lower per-sample costs. Fractionation strategies benefit particularly TMT, samples can compared directly within fraction reliable cross-fraction integration. contrast, data-independent acquisition (DIA) often preferred avoiding fractionation altogether. Overall, recommend TMT studies requiring high precision across multiple conditions, particularly fractionation can leveraged increase depth. contrast, label-free DIA workflows well-suited discovery-phase studies experiments number samples exceeds multiplexing capacity.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"automatedqc","dir":"Articles","previous_headings":"Notes","what":"Automated QC reporting with FragPipe TMT QC script","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"prophosqua[33] package vignette QCReport.qmd can used generate comprehensive TMT labeling efficiency report, directly FragPipe PSM psm.tsv output file. script evaluates labeling completeness peptide PSM levels N-terminal lysine modifications, calculates missed cleavage rates tryptic digestion efficiency, provides quantitative balance assessment across TMT channels. Key metrics include percentage modified N-termini lysine residues (expected ≥95%\\ge 95\\%), missed cleavage rates lysine arginine residues, relative abundance distributions across channels detect loading imbalances. assess labeling efficiency, TMT labeling lysine residues peptide N-termini must specified variable modification search.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"useofDPADPU","dir":"Articles","previous_headings":"Notes","what":"Use of the integrated DPA/DPU approach","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"integrated DPA/DPU approach suitable biological system study exhibits substantial changes protein expression. cases, distinguishing signaling effects expression-driven effects essential, including protein abundance measurements part study design allows two sources variation effectively separated. contrast, enriched phosphoproteome measurements without corresponding protein data can considered protein expression expected remain stable across conditions, example, experiments short timescales transcriptional translational changes unlikely. strategy may also justified budget limitations make comprehensive protein quantification infeasible.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"matchrates","dir":"Articles","previous_headings":"Notes","what":"Match Rates","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"evaluating integration PTM protein datasets, match rates 80%80\\% generally indicate good consistency. contrast, lower rates may reflect differences protein assignment PTM-enriched total proteome analyses. cases match rates fall 60%60\\%, underlying cause often inconsistent protein identifiers two datasets. address , essential verify analyses utilized FASTA database identical protein inference settings, particular attention database versions inclusion contaminant sequences. preventative measure, identical search parameters databases always applied total proteome PTM analyses, sequence-based matching can improve alignment across datasets.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"nosignificantPTM","dir":"Articles","previous_headings":"Notes","what":"No significant PTM sites detected despite biological expectation","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"absence significant PTM sites, even biological regulation expected, can arise several factors. Error propagation PTM protein measurements may amplify overall uncertainty, masking accurate signals. Insufficient statistical power another common cause, emphasizing need least three biological replicates per group , possible, increasing sample size reducing technical variability. cases, stringent statistical thresholds may obscure true positives, adopting permissive cutoff (e.g., FDR = 0.25 instead 0.05) exploratory analysis can informative. Normalization problems, batch effects inconsistent sample loading, may also contribute checked carefully. Outliers data can distort inference, making useful inspect density scatter plots, example, prolfquapp reports. Finally, examining distribution p-values quality-control summaries can help assess whether statistical model adequately explains variance data. significant differential peptidoform usage (DPU) sites detected despite clear changes PTMs, one possible explanation PTM changes proportional changes parent protein, indicating alteration modification stoichiometry. many cases, represents valid biological result rather technical issue, advisable verify inspecting individual examples protein PTM changes closely correlated. Alternatively, outcome may suggest experimental perturbation primarily influences protein expression rather signaling activity.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"compperf","dir":"Articles","previous_headings":"Notes","what":"Computational Performance Issues","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Long processing times N--C plots often occur generating individual plots hundreds proteins computationally intensive. practical solution limit plot generation proteins particular interest, small FDR values substantial log⁡2\\log_2 fold changes, rather producing plots detected proteins.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"qcrecommend","dir":"Articles","previous_headings":"Notes","what":"Quality Control Recommendations","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"focusing specific phosphorylation sites, essential validate key findings carefully inspecting high-confidence DPU sites ensure technical biological plausibility. example, can achieved verifying number missing values treatment group. addition, protein coverage verified, since meaningful interpretation phosphorylation changes requires corresponding proteins sufficient coverage total proteome. number peptides identified per protein, reported prolfquapp output, can serve filtering criterion.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"overinterpret","dir":"Articles","previous_headings":"Notes","what":"Overinterpretation of statistical significance","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Overinterpretation statistical significance can occur FDR estimates reported without considering design experiment biological context. statistically significant finding necessarily imply biological relevance; therefore, essential evaluate effect sizes alongside p-values assess magnitude potential impact change. Key findings also validated orthogonal methods ensure reflect genuine biological regulation rather statistical technical artifacts.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"dpuvsdpa","dir":"Articles","previous_headings":"Notes","what":"DPA vs DPU Interpretation","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Conflicting results DPA DPU analyses can due : DPA+ : Changes driven protein abundance alterations DPU+ : True signaling changes stable protein levels DPA+ DPU+: Amplified signaling (protein modification efficiency increase) DPA- DPU+: Compensatory regulation (modification increases despite protein decrease) discrepancies DPA DPU often informative rather problematic. Sites significant DPA DPU typically reflect protein-driven changes, whereas DPU-sites indicate genuine signaling regulation independent protein abundance. assess biological plausibility, results cross-referenced known biology supporting literature.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"keyinsight","dir":"Articles","previous_headings":"Notes","what":"Key Insights from This Analysis","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"integrated analysis distinguishes PTM feature abundance usage changes, enabling site-specific insights phosphorylation PTMs regulated. linking DPA DPU results, clarifies whether observed changes reflect protein-level expression signaling pathway activity, highlights key regulatory sites functional validation. Visualization sequence context rigorous statistical modeling support interpretation, allowing researchers generate mechanistic hypotheses, identify pathway-level regulation, prioritize targeted follow-experiments.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"seqwindow","dir":"Articles","previous_headings":"Notes","what":"Extracting sequence windows with prophosqua","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Although FragPipe reports sequence windows single-site report, observed extracted windows correctly aligned, making filtering step necessary. upstream quantification applications report modified amino acid position protein sequence. cases, prophosqua function get_sequence_windows can used. function expects dataframe two columns: protein sequences position modified amino acid. details, see prophosqua documentation [33].","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"motiflimit","dir":"Articles","previous_headings":"Notes","what":"Motif Analysis Limitations","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Weak absent sequence motifs significantly regulated sites can arise several reasons. One possibility significant sites detected, limits statistical power motif discovery. cases, can helpful lower threshold specifically motif analysis increase number sites included. Mixed kinase activities may also obscure motifs, separating upregulated downregulated sites often clarifies distinct regulatory patterns. Additionally, regulation may occur non-canonical mechanisms, phosphatases protein–protein interactions, rather specific kinase recognition motifs. technical considerations, choice sequence window size (e.g., ±5\\pm 5 versus ±7\\pm 7 amino acids), biological factors like PTM crosstalk, can also influence motif detection interpretation. Overall, weak motif signals can result insufficient number significant sites, presence multiple overlapping regulatory activities, regulation mechanisms rely canonical sequence motifs. address issues, one can lower significance threshold motif analysis capture sites. clear kinase sequence pattern emerges, keep mind regulation may involve non-kinase pathways, underscores importance considering statistical biological explanations interpreting motif analysis results.","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"figures","dir":"Articles","previous_headings":"","what":"Figures","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"(ref:fig1Q64337) Multi-panel N--C expression plot showing differential expression total protein abundance (light yellow rectangle) phosphorylation sites (vertical lines, color coded type residue) along protein sequences across contrasts. panel represents different experimental contrast, enabling direct comparison protein PTM expression changes across conditions. vertical lines either dashed solid, depending site’s imputation status. x-axis represents amino acid position N C terminus, y-axis shows log⁡2\\log_2 fold changes. Significantly regulated sites (FDR < 0.05 FDR < 0.01) highlighted one two red asterisks, respectively. (ref:fig1Q64337) (ref:fig2usageQ64337) Multi-panel N--C usage plot showing differential usage phosphorylation sites (vertical lines, color-coded type residue) along protein sequences across contrasts. panel represents different experimental contrast, enabling direct comparison protein-normalized PTM changes across conditions. vertical lines either dashed solid, depending site’s imputation status. x-axis represents amino acid position N C terminus, y-axis shows log⁡2\\log_2 fold changes. Significantly regulated sites (FDR < 0.05 FDR < 0.01) highlighted one two red asterisks, respectively. (ref:fig2usageQ64337) (ref:fig3densityCorrected) Density plot total proteome corrected PTM site abundances. (ref:fig3densityCorrected) (ref:fig4FDRcorrfirst) Volcano plot showing −log⁡10(FDR)-\\log_{10}(FDR) function PTM site log⁡2\\log_2 fold change. (ref:fig4FDRcorrfirst) (ref:fig5seqlogoST) Sequence logo plots showing amino acid motifs surrounding significantly regulated phosphorylation serine threonine residues. row represents contrast three columns: upregulated sites (left), downregulated sites (center), difference (right). difference column, letters baseline indicate amino acids enriched upregulated sites, letters baseline indicate enrichment downregulated sites. Letter height corresponds relative frequency position surrounding phosphorylation site (position 8). (ref:fig5seqlogoST)","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.html","id":"tables","dir":"Articles","previous_headings":"","what":"Tables","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Annotation table created FragPipe outputs, set columns required prolfquapp Annotation table explanatory variables contrasts. Match rates PTM sites proteins. Consensus phosphorylation motifs representative serine/threonine kinases. Motifs defined relative phosphorylated residue (S/T position 0). X = residue; positions relative phospho-acceptor serine/threonine (S/T). Number significantly regulated sites, contrast, amino acid residue, - -regulation.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"configuration","dir":"Articles","previous_headings":"","what":"Configuration","title":"FragPipe TMT QC","text":"section shows key parameters used QC analysis. report can parameterized analyze different datasets providing custom file paths identifiers. project information QC use first psm file.","code":"using : ptm_example-main/qc_example_data/QCmini/psm.tsv"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"fasta-database-summary","dir":"Articles","previous_headings":"","what":"FASTA Database Summary","title":"FragPipe TMT QC","text":"FASTA database contains protein sequences used peptide identification. Understanding composition search database crucial interpreting identification results assessing potential biases. Key metrics evaluate: Human: ~20,000 proteins Mouse: ~22,000 proteins Yeast: ~6,000 proteins E. coli: ~4,400 proteins Arabidopsis: ~27,000 protein coding genes, ~35,000 proteins Decoy sequences: Reverse sequences (REV_) used estimate false discovery rates Amino acid composition: reflect expected composition sample organism FASTA database 55907 sequences including decoys, 27953 without decoys. amino acid frequency distribution shows composition search database, consistent expected proteome composition.","code":"nr sequences:  27953  length summary:     Min. 1st Qu.  Median    Mean 3rd Qu.    Max.      5.0   198.0   348.0   404.8   520.0  5400.0  AA frequencies:       [,1]  A  712383  B       5  C  213335  D  608123  E  760476  F  484702  G  730135  H  256377  I  601507  K  720098  L 1078566  M  277709  N  498002  P  543057  Q  395258  R  609817  S 1031163  T  577392  V  754323  W  140645  X      15  Y  321973  Z       3"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"data-processing-overview","dir":"Articles","previous_headings":"","what":"Data Processing Overview","title":"FragPipe TMT QC","text":"analysis processes peptide-spectrum matches (PSMs) FragPipe specific quality filters ensure reliable quantification. Quality filters applied: Peptide Prophet probability > 0.9: Ensures high confidence identifications Abundance threshold > 0: Removes PSMs without quantitative information Purity threshold = 0: isolation purity filtering (PSMs included) analysis using PSM (Spectra) reported psm.tsv file peptide prophet probability greater 0.90.9, abundance value channels greater 00. filtering enabled. reduces number PSM 5436 5275. reduction PSM count reflects stringency quality filters. typical reduction 1-10%\\% expected indicates proper quality control.","code":"Rows: 5436 Columns: 55 ── Column specification ──────────────────────────────────────────────────────── Delimiter: \"\\t\" chr (14): Spectrum, Spectrum File, Peptide, Modified Peptide, Prev AA, Next ... dbl (38): Peptide Length, Charge, Retention, Observed Mass, Calibrated Obser... lgl  (3): Observed Modifications, Is Unique, Quan Usage  ℹ Use `spec()` to retrieve the full column specification for this data. ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. Rows: 5436 Columns: 55 ── Column specification ──────────────────────────────────────────────────────── Delimiter: \"\\t\" chr (14): Spectrum, Spectrum File, Peptide, Modified Peptide, Prev AA, Next ... dbl (38): Peptide Length, Charge, Retention, Observed Mass, Calibrated Obser... lgl  (3): Observed Modifications, Is Unique, Quan Usage  ℹ Use `spec()` to retrieve the full column specification for this data. ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. INFO [2025-12-14 21:01:32] get_annot : ptm_example-main/qc_example_data/fgcz_3702_UP000006548_AraUniprot_1spg_d_20231024.fasta INFO [2025-12-14 21:01:33] get_annot : finished reading INFO [2025-12-14 21:01:34] get_annot : extract headers INFO [2025-12-14 21:01:34] get_annot : all seq : 55907 INFO [2025-12-14 21:01:34] removing decoy sequences usin patter : ^REV_|^rev_ INFO [2025-12-14 21:01:34] get_annot nr seq after decoy removal: 27954 INFO [2025-12-14 21:01:34] get_annot : isUniprot : TRUE INFO [2025-12-14 21:01:34] get_annot : extracted gene names INFO [2025-12-14 21:01:34] get_annot : protein length INFO [2025-12-14 21:01:35] get_annot : nr of tryptic peptides per protein computed. Warning in prolfquapp::dataset_protein_annot(psm, c(protein_Id = \"Protein\"), : deprecated! use build_protein_annot uniprot database : TRUE Warning: Expected 2 pieces. Missing pieces filled with `NA` in 20 rows [54, 59, 92, 99, 178, 287, 288, 307, 357, 379, 475, 476, 554, 611, 754, 892, 893, 940, 967, 1021]. creating sampleName from fileName column Warning in prolfqua::setup_analysis(psm, config): no isotopeLabel column specified in the data, adding column isotopeLabel automatically and setting to 'light'. Warning in prolfqua::setup_analysis(psm, config): no nr_children column specified in the data, adding column nr_children and setting to 1. completing cases completing cases done setup done"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"identification-summary","dir":"Articles","previous_headings":"","what":"Identification Summary","title":"FragPipe TMT QC","text":"metrics provide overview depth breadth proteomic analysis. Higher numbers generally indicate better sample preparation instrument performance. Understanding hierarchy: Proteins: Unique protein groups identified Peptides: Unique peptide sequences (without modifications) Peptidoforms: Unique peptides specific modifications Precursors: Unique peptide-charge state combinations PSMs: Total peptide-spectrum matches Table: Nr proteins, peptides, peptidoforms, precursors, spectrum peptide matches overall. ratio levels can indicate data quality: PSMs/Peptides ratio: Higher ratios suggest good reproducibility Peptidoforms/Peptides ratio: Indicates extent post-translational modifications Peptides/Proteins ratio: Reflects proteolytic efficiency peptide diversity  Figure: Number proteins, peptides, peptidoforms, ions precursor per channel. plot shows identification counts across different TMT channels. Ideally, channels show similar identification numbers, indicating consistent sample preparation labeling efficiency. Table: Nr proteins, peptides, peptidoforms, precursors, spectrum peptide matches per channel. Quality indicators: Consistent counts across channels: Good sample preparation Large variations: May indicate labeling issues sample degradation Outlier channels: investigated technical problems","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"modifications-summary","dir":"Articles","previous_headings":"","what":"Modifications Summary","title":"FragPipe TMT QC","text":"Post-translational modifications (PTMs) chemical modifications provide insights sample treatment biological state. TMT labeling introduces specific modifications monitored labeling efficiency. Key modifications monitor: TMT labels: N-term(229.1629), K(229.1629) TMT10plex Oxidation: M(15.9949) - common artifact Carbamylation: N-term/K modifications urea treatment Number type modifications observed data.  Number type modification observed data. modification landscape reflects intentional chemical treatments (TMT labeling) unintentional modifications (oxidation, deamidation). High numbers TMT modifications indicate successful labeling.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"labelling-efficiency","dir":"Articles","previous_headings":"","what":"Labelling Efficiency","title":"FragPipe TMT QC","text":"TMT labeling efficiency critical accurate quantification. Incomplete labeling leads quantitative errors reduced dynamic range. Monitoring labeling efficiency: N-terminal labeling: approach 100% peptides Lysine labeling: >95% high-quality samples Unlabeled peptides: May co-elute interfere quantification N-terminal labeling efficiency typically high (>95%) ’s kinetically favored. Total number peptides : 3947 Number peptides modified N-term : 3904 Percent peptides modified N-term: 99 % Expected range: 95-100%. Values 95% may indicate: Suboptimal labeling conditions Sample degradation Buffer incompatibility Total number PSMs : 5275 Number PSMs modified N-term : 5227 Percent PSMs modified N-term: 99 % PSM-level statistics weight peptides identification frequency, providing insight abundant species sample. Lysine labeling challenging N-terminal labeling sensitive reaction conditions. Total number peptides Lysine: 2339 Number peptides modified Lysine residues : 2339 Percent peptides modified Lysine residues: 100 % Expected range: 95-99%. Lower values may indicate: Insufficient reagent concentration Competing reactions (e.g., formaldehyde crosslinking) pH optimization needed Total number PSMs Lysine: 3200 Number PSMs modified Lysine residues : 3200 Percent PSMs modified Lysine residues: 100 % Total number Lysine residues: 2344 Number modified Lysine residues : 2339 Percent modified Lysine residues: 100 % Total number Lysine residues: 3205 Number modified Lysine residues : 3200 Percent modified Lysine residues taking number PSMs account: 100 %","code":"Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"modSeq\"` instead of `.data$modSeq` Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"n\"` instead of `.data$n` Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"n1\"` instead of `.data$n1`"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"n-term","dir":"Articles","previous_headings":"","what":"N-term","title":"FragPipe TMT QC","text":"N-terminal labeling efficiency typically high (>95%) ’s kinetically favored. Total number peptides : 3947 Number peptides modified N-term : 3904 Percent peptides modified N-term: 99 % Expected range: 95-100%. Values 95% may indicate: Suboptimal labeling conditions Sample degradation Buffer incompatibility Total number PSMs : 5275 Number PSMs modified N-term : 5227 Percent PSMs modified N-term: 99 % PSM-level statistics weight peptides identification frequency, providing insight abundant species sample.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"peptides","dir":"Articles","previous_headings":"Labelling Efficiency","what":"Peptides","title":"FragPipe TMT QC","text":"Total number peptides : 3947 Number peptides modified N-term : 3904 Percent peptides modified N-term: 99 % Expected range: 95-100%. Values 95% may indicate: Suboptimal labeling conditions Sample degradation Buffer incompatibility","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"psms","dir":"Articles","previous_headings":"Labelling Efficiency","what":"PSM’s","title":"FragPipe TMT QC","text":"Total number PSMs : 5275 Number PSMs modified N-term : 5227 Percent PSMs modified N-term: 99 % PSM-level statistics weight peptides identification frequency, providing insight abundant species sample.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"lysine-modification","dir":"Articles","previous_headings":"","what":"Lysine Modification","title":"FragPipe TMT QC","text":"Lysine labeling challenging N-terminal labeling sensitive reaction conditions. Total number peptides Lysine: 2339 Number peptides modified Lysine residues : 2339 Percent peptides modified Lysine residues: 100 % Expected range: 95-99%. Lower values may indicate: Insufficient reagent concentration Competing reactions (e.g., formaldehyde crosslinking) pH optimization needed Total number PSMs Lysine: 3200 Number PSMs modified Lysine residues : 3200 Percent PSMs modified Lysine residues: 100 % Total number Lysine residues: 2344 Number modified Lysine residues : 2339 Percent modified Lysine residues: 100 % Total number Lysine residues: 3205 Number modified Lysine residues : 3200 Percent modified Lysine residues taking number PSMs account: 100 %","code":"Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"modSeq\"` instead of `.data$modSeq` Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"n\"` instead of `.data$n` Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"n1\"` instead of `.data$n1`"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"peptides-1","dir":"Articles","previous_headings":"Labelling Efficiency","what":"Peptides","title":"FragPipe TMT QC","text":"Total number peptides Lysine: 2339 Number peptides modified Lysine residues : 2339 Percent peptides modified Lysine residues: 100 % Expected range: 95-99%. Lower values may indicate: Insufficient reagent concentration Competing reactions (e.g., formaldehyde crosslinking) pH optimization needed","code":"Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"modSeq\"` instead of `.data$modSeq`"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"psms-with-lysine","dir":"Articles","previous_headings":"Labelling Efficiency","what":"PSM’s with Lysine","title":"FragPipe TMT QC","text":"Total number PSMs Lysine: 3200 Number PSMs modified Lysine residues : 3200 Percent PSMs modified Lysine residues: 100 %","code":"Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"n\"` instead of `.data$n` Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"n1\"` instead of `.data$n1`"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"peptidoforms","dir":"Articles","previous_headings":"Labelling Efficiency","what":"Peptidoforms","title":"FragPipe TMT QC","text":"Total number Lysine residues: 2344 Number modified Lysine residues : 2339 Percent modified Lysine residues: 100 %","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"total-number-of-lysine-residues-in-psms","dir":"Articles","previous_headings":"Labelling Efficiency","what":"Total number of Lysine residues in PSM’s","title":"FragPipe TMT QC","text":"Total number Lysine residues: 3205 Number modified Lysine residues : 3200 Percent modified Lysine residues taking number PSMs account: 100 %","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"quantitative-information-per-channel","dir":"Articles","previous_headings":"","what":"Quantitative information per channel","title":"FragPipe TMT QC","text":"TMT quantification relies consistent labeling equal loading across channels. plots help identify technical issues bias quantitative comparisons. Quality indicators: Similar total abundances: Good sample preparation loading Outlier channels: May indicate pipetting errors sample loss Systematic patterns: suggest batch effects labeling issues  Total abundance per channel (Sum abundances). Total abundance reflects sample amount ionization efficiency. Large variations (>2-fold) investigated.  Ralative chanell 126 total abundance per chanel. Normalization reference channel (126) helps identify systematic biases. Values typically within 0.5-2.0 fold reference.  Density abundance values per channel. abundance distribution similar across channels. Shifted distributions may indicate: - Unequal sample loading - Different sample complexity - Technical artifacts specific channels","code":"Warning: `aes_string()` was deprecated in ggplot2 3.0.0. ℹ Please use tidy evaluation idioms with `aes()`. ℹ See also `vignette(\"ggplot2-in-packages\")` for more information. ℹ The deprecated feature was likely used in the prolfqua package.   Please report the issue at <https://github.com/wolski/prolfqua/issues>."},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"missed-cleavage","dir":"Articles","previous_headings":"","what":"Missed cleavage","title":"FragPipe TMT QC","text":"Missed cleavage analysis provides insights proteolytic efficiency sample quality. Excessive missed cleavages can reduce identification rates affect quantification accuracy. Missed cleavage site: residue trypsin cleaved . Factors affecting missed cleavages: Protein denaturation: Incomplete unfolding reduces accessibility Digestion time/temperature: Insufficient conditions lead incomplete digestion Enzyme activity: Old inhibited trypsin reduces efficiency Chemical modifications: Modified residues may resist cleavage determine number missed cleavages compute: - number potential cleavage sites (.e., number K R residues) - number actual cleavage sites (K R peptide C-terminus) - Modified residues may resist cleavage compute total number K residues, number K cleavage sites (nr potential cleavage sites). compute number K C-term number K residues 3205 number unmodified K C term 0 number modified K C term 3025 number K C term 3025 number modified K: 3200 Missed cleavage sites : number K residues - number K C term = 180, % number K residues : 6 Expected range: 5-15% missed cleavages typical. Higher rates may indicate: Incomplete protein denaturation Insufficient digestion time Trypsin inhibitors present High protein concentration number R residues 2401 number unmodified R C term 2189 number modified R C term 0 number R C term 2189 number modified R: 0 Missed cleavage sites : number R residues - number R C term = 212, % number R residues : 9 Arginine cleavage generally efficient lysine cleavage. Similar missed cleavage rates K R suggest consistent digestion conditions.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"missed-lysine-residues","dir":"Articles","previous_headings":"","what":"Missed Lysine residues","title":"FragPipe TMT QC","text":"compute total number K residues, number K cleavage sites (nr potential cleavage sites). compute number K C-term number K residues 3205 number unmodified K C term 0 number modified K C term 3025 number K C term 3025 number modified K: 3200 Missed cleavage sites : number K residues - number K C term = 180, % number K residues : 6 Expected range: 5-15% missed cleavages typical. Higher rates may indicate: Incomplete protein denaturation Insufficient digestion time Trypsin inhibitors present High protein concentration","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"missed-arginine-residues","dir":"Articles","previous_headings":"","what":"Missed Arginine residues","title":"FragPipe TMT QC","text":"number R residues 2401 number unmodified R C term 2189 number modified R C term 0 number R C term 2189 number modified R: 0 Missed cleavage sites : number R residues - number R C term = 212, % number R residues : 9 Arginine cleavage generally efficient lysine cleavage. Similar missed cleavage rates K R suggest consistent digestion conditions.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"FragPipe TMT QC","text":"R version 4.5.2 (2025-10-31) Platform: aarch64-apple-darwin20 locale: en_US.UTF-8||en_US.UTF-8||en_US.UTF-8||C||en_US.UTF-8||en_US.UTF-8 attached base packages: stats, graphics, grDevices, utils, datasets, methods base attached packages: (v.1.0.2), ggseqlogo(v.0.2), lubridate(v.1.9.4), forcats(v.1.0.1), stringr(v.1.6.0), dplyr(v.1.1.4), purrr(v.1.2.0), readr(v.2.1.6), tidyr(v.1.3.1), tibble(v.3.3.0), ggplot2(v.4.0.1), tidyverse(v.2.0.0), prophosqua(v.0.1.0) prolfquapp(v.0.1.8) loaded via namespace (attached): AhoCorasickTrie(v.0.1.3), gtable(v.0.3.6), xfun(v.0.54), prozor(v.0.3.1), htmlwidgets(v.1.6.4), ggrepel(v.0.9.6), lattice(v.0.22-7), tzdb(v.0.5.0), vctrs(v.0.6.5), tools(v.4.5.2), generics(v.0.1.4), parallel(v.4.5.2), pkgconfig(v.2.0.3), pheatmap(v.1.0.13), Matrix(v.1.7-4), data.table(v.1.17.8), RColorBrewer(v.1.1-3), S7(v.0.2.1), lifecycle(v.1.0.4), prolfqua(v.1.4.0), compiler(v.4.5.2), farver(v.2.1.2), codetools(v.0.2-20), htmltools(v.0.5.9), lazyeval(v.0.2.2), yaml(v.2.3.11), plotly(v.4.11.0), pillar(v.1.11.1), crayon(v.1.5.3), seqinr(v.4.2-36), MASS(v.7.3-65), cachem(v.1.1.0), tidyselect(v.1.2.1), conflicted(v.1.2.0), digest(v.0.6.39), stringi(v.1.8.7), pander(v.0.6.6), labeling(v.0.4.3), ade4(v.1.7-23), rprojroot(v.2.1.1), fastmap(v.1.2.0), grid(v.4.5.2), cli(v.3.6.5), logger(v.0.4.1), magrittr(v.2.0.4), patchwork(v.1.3.2), withr(v.3.0.2), scales(v.1.4.0), bit64(v.4.6.0-1), timechange(v.0.3.0), httr(v.1.4.7), rmarkdown(v.2.30), bit(v.4.6.0), gridExtra(v.2.3), hms(v.1.1.4), memoise(v.2.0.1), evaluate(v.1.0.5), knitr(v.1.50), viridisLite(v.0.4.2), dtplyr(v.1.3.2), rlang(v.1.1.6), Rcpp(v.1.1.0), docopt(v.0.7.2), glue(v.1.8.0), vroom(v.1.6.7), jsonlite(v.2.0.0) R6(v.2.6.1)","code":""},{"path":"https://prolfqua.github.io/prophosqua/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jonas Grossmann. Author. Witold Wolski. Author, maintainer.","code":""},{"path":"https://prolfqua.github.io/prophosqua/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Grossmann J, Wolski W (2026). prophosqua: Integrate TMT-Labeled Phosphoproteomics Total Proteomics Data. R package version 0.3.0, https://prolfqua.github.io/prophosqua.","code":"@Manual{,   title = {prophosqua: Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data},   author = {Jonas Grossmann and Witold Wolski},   year = {2026},   note = {R package version 0.3.0},   url = {https://prolfqua.github.io/prophosqua}, }"},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"prophosqua","dir":"","previous_headings":"","what":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"Integration phosphoproteome total proteome data comprehensive PTM analysis prophosqua package provides tools integrating analyzing post-translational modification (PTM) data total proteome measurements. enables researchers distinguish changes protein abundance changes modification site usage, providing deeper insights cellular signaling regulation.","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"integrated PTM analysis carried using prophosqua, implements three complementary statistical approaches: DPA (Differential PTM Abundance): tests changes PTM-site intensity conditions. DPU (Differential PTM Usage): tests whether ratio PTM-site total protein intensity changes, identifying regulation independent protein abundance. CorrectFirst: applies protein-level correction testing PTM sites, alternative approach distinguish PTM-specific regulation protein expression changes. Building prolfqua prolfquapp packages, prophosqua additionally provides: N--C plots - Visualization phosphorylation sites along protein backbones Sequence logo analysis - Identification kinase recognition motifs PTM-SEA - Post-translational modification set enrichment analysis Kinase activity inference - Kinase library-based analysis phosphoproteomics data Motif enrichment analysis - MEA visualization Enrichment visualization - Dot plots, heatmaps, volcano plots enrichment results","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"prerequisites","dir":"","previous_headings":"Installation","what":"Prerequisites","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"package depends several packages installed first: detailed installation instructions system requirements, see: - prolfqua GitHub repository - prolfquapp GitHub repository","code":"# Install prolfqua (core proteomics analysis package) library(devtools) devtools::install_github('protviz/prozor', dependencies = TRUE) devtools::install_github('prolfqua/prolfqua', dependencies = TRUE) # Install prolfquapp (proteomics analysis workflow package) devtools::install_github('prolfqua/prolfquapp', dependencies = TRUE, build_vignettes=TRUE)"},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"install-prophosqua","dir":"","previous_headings":"Installation","what":"Install prophosqua","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"","code":"library(devtools) devtools::install_github('prolfqua/prophosqua', dependencies = TRUE, build_vignettes=TRUE)"},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"basic-workflow","dir":"","previous_headings":"Usage","what":"Basic Workflow","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"Run differential expression analysis using prolfquapp total proteome PTM data Integrate results using prophosqua::test_diff() Visualize data N--C plots sequence logos Generate comprehensive reports statistical summaries","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"example","dir":"","previous_headings":"Usage","what":"Example","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"","code":"library(prophosqua)  # Load your data tot_res <- load_and_preprocess_data(total_proteome_file, required_cols) phospho_res <- load_and_preprocess_data(ptm_file, required_cols)  # Integrate analysis combined_test_diff <- test_diff(phospho_res, tot_res, join_column = join_column)  # Create visualizations plot_data <- n_to_c_usage(combined_test_diff, contrast_name, FDR_threshold = 0.05)"},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"vignettes","dir":"","previous_headings":"","what":"Vignettes","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"package includes vignettes demonstrating analysis workflow: MiMBIntegratedPTM.Rmd - Integrated analysis PTM total proteome (DPA, DPU, CorrectFirst) Analysis_n_to_c.Rmd - N--C plots PTM site visualization Analysis_seqlogo.Rmd - Sequence logo analysis Analysis_PTMSEA.Rmd - PTM-SEA analysis Analysis_KinaseLibrary.Rmd - Kinase activity inference phosphoproteomics data Analysis_MEA.Rmd - Motif enrichment analysis visualization QCReport.qmd - FragPipe TMT quality control report","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"use package research, please cite: Wolski W, Dittmann , Panse C, Kunz L, Grossmann J. “Integrated Analysis Post-Translational Modifications Total Proteome: Methods Distinguishing Abundance Usage Changes.” Methods Molecular Biology, 2025 (submitted). Grossmann J, Wolski W. “prolfqua/prophosqua: 0.1.0.” Zenodo, 2025. DOI: 10.5281/zenodo.15845272","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"related-packages","dir":"","previous_headings":"","what":"Related Packages","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"prolfqua - Core proteomics analysis package prolfquapp - Proteomics analysis workflow package","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"build-pkgdown-site-locally","dir":"","previous_headings":"Building and Deploying Documentation","what":"Build pkgdown site locally","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"","code":"pkgdown::build_site()"},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"deploy-to-github-pages","dir":"","previous_headings":"Building and Deploying Documentation","what":"Deploy to GitHub Pages","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"enable GitHub Pages repo settings (Settings -> Pages -> Source: gh-pages branch). Site: https://prolfqua.github.io/prophosqua","code":"# Using ghp-import (via uv) uvx ghp-import -n -p -f docs"},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"Contributions welcome! Please visit GitHub repository : - Issue reporting - Feature requests - Code contributions","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"package released MIT License.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/calculate_optimal_layout.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate optimal grid layout for multi-panel plots — calculate_optimal_layout","title":"Calculate optimal grid layout for multi-panel plots — calculate_optimal_layout","text":"Calculate optimal grid layout multi-panel plots","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/calculate_optimal_layout.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate optimal grid layout for multi-panel plots — calculate_optimal_layout","text":"","code":"calculate_optimal_layout(n_panels)"},{"path":"https://prolfqua.github.io/prophosqua/reference/calculate_optimal_layout.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate optimal grid layout for multi-panel plots — calculate_optimal_layout","text":"n_panels Number panels arrange","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/calculate_optimal_layout.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate optimal grid layout for multi-panel plots — calculate_optimal_layout","text":"List ncol nrow grid layout","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/combined_test_diff_example.html","id":null,"dir":"Reference","previous_headings":"","what":"Example phosphoproteomics differential expression results — combined_test_diff_example","title":"Example phosphoproteomics differential expression results — combined_test_diff_example","text":"Combined differential expression results phosphoproteomics analysis Atg16l1 knockout vs wild-type macrophages. Contains site-level (DPA) protein-corrected (DPU) statistics 4 contrasts.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/combined_test_diff_example.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example phosphoproteomics differential expression results — combined_test_diff_example","text":"","code":"combined_test_diff_example"},{"path":"https://prolfqua.github.io/prophosqua/reference/combined_test_diff_example.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example phosphoproteomics differential expression results — combined_test_diff_example","text":"tibble 105,824 rows 56 columns including: protein_Id UniProt protein identifier gene_name.site Gene symbol modAA Modified amino acid (S, T, Y) posInProtein Position modification protein SequenceWindow Flanking sequence around modification site contrast Comparison name (e.g., KO_vs_WT) diff.site Log2 fold change site (DPA) statistic.site t-statistic site p.value.site p-value site FDR.site FDR-adjusted p-value site diff_diff Protein-corrected log2 fold change (DPU) tstatistic_I t-statistic DPU pValue_I p-value DPU FDR_I FDR-adjusted p-value DPU","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/combined_test_diff_example.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example phosphoproteomics differential expression results — combined_test_diff_example","text":"Maculins et al. (2020) eLife, doi:10.7554/elife.62320","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/copy_phospho_integration.html","id":null,"dir":"Reference","previous_headings":"","what":"copy Markdown and runscript for FragPipe combined_protein.tsv — copy_phospho_integration","title":"copy Markdown and runscript for FragPipe combined_protein.tsv — copy_phospho_integration","text":"copy Markdown runscript FragPipe combined_protein.tsv","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/copy_phospho_integration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"copy Markdown and runscript for FragPipe combined_protein.tsv — copy_phospho_integration","text":"","code":"copy_phospho_integration(workdir = getwd())"},{"path":"https://prolfqua.github.io/prophosqua/reference/copy_phospho_integration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"copy Markdown and runscript for FragPipe combined_protein.tsv — copy_phospho_integration","text":"workdir directory copy file - default current working directory.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dea_res_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Get DEA results directory path — dea_res_dir","title":"Get DEA results directory path — dea_res_dir","text":"Constructs path DEA results directory based project structure.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dea_res_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get DEA results directory path — dea_res_dir","text":"","code":"dea_res_dir(project_dir, WU, date)"},{"path":"https://prolfqua.github.io/prophosqua/reference/dea_res_dir.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get DEA results directory path — dea_res_dir","text":"project_dir Path project directory WU Work unit identifier (e.g., \"phospho\", \"prot\") date Date string used folder naming (e.g., \"20240101\")","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dea_res_dir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get DEA results directory path — dea_res_dir","text":"Character string full path results directory","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dea_xlsx_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Get DEA xlsx file path — dea_xlsx_path","title":"Get DEA xlsx file path — dea_xlsx_path","text":"Constructs path DEA results Excel file based project structure.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dea_xlsx_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get DEA xlsx file path — dea_xlsx_path","text":"","code":"dea_xlsx_path(project_dir, WU, date)"},{"path":"https://prolfqua.github.io/prophosqua/reference/dea_xlsx_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get DEA xlsx file path — dea_xlsx_path","text":"project_dir Path project directory WU Work unit identifier (e.g., \"phospho\", \"prot\") date Date string used folder naming (e.g., \"20240101\")","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dea_xlsx_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get DEA xlsx file path — dea_xlsx_path","text":"Character string full path Excel file","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dot-test_diff_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Test if differences of differences are significant (internal) — .test_diff_diff","title":"Test if differences of differences are significant (internal) — .test_diff_diff","text":"Test differences differences significant (internal)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dot-test_diff_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test if differences of differences are significant (internal) — .test_diff_diff","text":"","code":".test_diff_diff(   dataframe_a,   dataframe_b,   by,   diff = c(\"diff\"),   std_err = c(\"std.error\"),   df = c(\"df\"),   suffix_a = \".site\",   suffix_b = \".protein\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/dot-test_diff_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test if differences of differences are significant (internal) — .test_diff_diff","text":"dataframe_a First data frame (e.g., site-level results) dataframe_b Second data frame (e.g., protein-level results) Columns join diff Column name difference values std_err Column name standard error values df Column name degrees freedom suffix_a Suffix columns dataframe_a suffix_b Suffix columns dataframe_b","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dot-test_diff_diff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test if differences of differences are significant (internal) — .test_diff_diff","text":"Data frame diff_diff test results","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.html","id":null,"dir":"Reference","previous_headings":"","what":"Download PTMsigDB signatures — download_ptmsigdb","title":"Download PTMsigDB signatures — download_ptmsigdb","text":"Downloads caches PTMsigDB GMT files Broad Institute ssGSEA2.0 repository. PTMsigDB v2.0.0 uses flanking sequences (15 amino acids centered phosphosite), making analysis species-invariant within vertebrates.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download PTMsigDB signatures — download_ptmsigdb","text":"","code":"download_ptmsigdb(   species = \"mouse\",   version = \"v2.0.0\",   output_dir = \".\",   force_download = FALSE )"},{"path":"https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download PTMsigDB signatures — download_ptmsigdb","text":"species Character. Species signatures (\"mouse\" \"human\"). Default \"mouse\". version Character. PTMsigDB version. Default \"v2.0.0\". output_dir Character. Directory cached files. Default current directory. force_download Logical. Force re-download even cached. Default FALSE.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download PTMsigDB signatures — download_ptmsigdb","text":"Character path cached GMT file.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Download PTMsigDB signatures — download_ptmsigdb","text":"Krug et al. (2019) Curated Resource Phosphosite-specific Signature Analysis. Mol Cell Proteomics. doi:10.1074/mcp.TIR118.000943","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download PTMsigDB signatures — download_ptmsigdb","text":"","code":"if (FALSE) { # \\dontrun{ gmt_path <- download_ptmsigdb(species = \"mouse\", output_dir = \"ptmsea_cache\") pathways <- fgsea::gmtPathways(gmt_path) } # }"},{"path":"https://prolfqua.github.io/prophosqua/reference/enrichment_visualization.html","id":null,"dir":"Reference","previous_headings":"","what":"Enrichment Visualization Functions — enrichment_visualization","title":"Enrichment Visualization Functions — enrichment_visualization","text":"Visualization functions PTMSEA, KinaseLibrary GSEA, MEA analyses. functions provide consistent plotting styles across enrichment analyses.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Example dataset exampleN_C_dat — exampleN_C_dat","title":"Example dataset exampleN_C_dat — exampleN_C_dat","text":"simple example dataset demonstrating groups numeric values.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example dataset exampleN_C_dat — exampleN_C_dat","text":"","code":"exampleN_C_dat"},{"path":"https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example dataset exampleN_C_dat — exampleN_C_dat","text":"## `exampleN_C_dat`","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat_no_prot.html","id":null,"dir":"Reference","previous_headings":"","what":"Example dataset exampleN_C_dat_no_prot — exampleN_C_dat_no_prot","title":"Example dataset exampleN_C_dat_no_prot — exampleN_C_dat_no_prot","text":"simple example dataset demonstrating groups numeric values.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat_no_prot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example dataset exampleN_C_dat_no_prot — exampleN_C_dat_no_prot","text":"","code":"exampleN_C_dat_no_prot"},{"path":"https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat_no_prot.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example dataset exampleN_C_dat_no_prot — exampleN_C_dat_no_prot","text":"## `exampleN_C_dat_no_prot`","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/explode_multisites.html","id":null,"dir":"Reference","previous_headings":"","what":"Explode multisites into individual rows — explode_multisites","title":"Explode multisites into individual rows — explode_multisites","text":"phosphosite goes row multiple sites present.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/explode_multisites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Explode multisites into individual rows — explode_multisites","text":"","code":"explode_multisites(combined_site)"},{"path":"https://prolfqua.github.io/prophosqua/reference/explode_multisites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Explode multisites into individual rows — explode_multisites","text":"combined_site Data frame PhosSites column (semicolon-delimited)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/explode_multisites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Explode multisites into individual rows — explode_multisites","text":"Data frame one row per site, modAA posInProtein columns","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/export_gsea_plots_pdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Export GSEA enrichment plots to PDF — export_gsea_plots_pdf","title":"Export GSEA enrichment plots to PDF — export_gsea_plots_pdf","text":"Exports clusterProfiler GSEA plots significant gene sets PDF file. Requires enrichplot package.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/export_gsea_plots_pdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export GSEA enrichment plots to PDF — export_gsea_plots_pdf","text":"","code":"export_gsea_plots_pdf(   results,   output_file,   fdr_threshold = 0.25,   width = 10,   height = 6,   prefix_pattern = NULL )"},{"path":"https://prolfqua.github.io/prophosqua/reference/export_gsea_plots_pdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export GSEA enrichment plots to PDF — export_gsea_plots_pdf","text":"results Named list clusterProfiler GSEA result objects output_file Path output PDF file fdr_threshold FDR threshold including plots (default: 0.25) width PDF width inches (default: 10) height PDF height inches (default: 6) prefix_pattern Regex pattern strip pathway names titles (default: NULL)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/export_gsea_plots_pdf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export GSEA enrichment plots to PDF — export_gsea_plots_pdf","text":"Number plots exported","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/export_gsea_plots_pdf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Export GSEA enrichment plots to PDF — export_gsea_plots_pdf","text":"","code":"if (FALSE) { # \\dontrun{ # Requires clusterProfiler GSEA results export_gsea_plots_pdf(gsea_results, \"enrichment_plots.pdf\") } # }"},{"path":"https://prolfqua.github.io/prophosqua/reference/extract_gsea_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract results from clusterProfiler GSEA objects — extract_gsea_results","title":"Extract results from clusterProfiler GSEA objects — extract_gsea_results","text":"Converts list clusterProfiler GSEA result objects tidy tibble.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/extract_gsea_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract results from clusterProfiler GSEA objects — extract_gsea_results","text":"","code":"extract_gsea_results(results)"},{"path":"https://prolfqua.github.io/prophosqua/reference/extract_gsea_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract results from clusterProfiler GSEA objects — extract_gsea_results","text":"results Named list clusterProfiler GSEA result objects","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/extract_gsea_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract results from clusterProfiler GSEA objects — extract_gsea_results","text":"tibble columns: ID, NES, pvalue, p.adjust, setSize, contrast","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/extract_gsea_results.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract results from clusterProfiler GSEA objects — extract_gsea_results","text":"","code":"if (FALSE) { # \\dontrun{ # Requires clusterProfiler GSEA results df <- extract_gsea_results(gsea_results) } # }"},{"path":"https://prolfqua.github.io/prophosqua/reference/filter_contaminants.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter contaminant proteins from data — filter_contaminants","title":"Filter contaminant proteins from data — filter_contaminants","text":"Removes rows matching FGCZ contaminants, contam_ prefix, rev_ prefix.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/filter_contaminants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter contaminant proteins from data — filter_contaminants","text":"","code":"filter_contaminants(data, protein_id_col = \"protein_Id\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/filter_contaminants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter contaminant proteins from data — filter_contaminants","text":"data Data frame protein data protein_id_col Name protein ID column (default: \"protein_Id\")","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/filter_contaminants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter contaminant proteins from data — filter_contaminants","text":"Filtered data frame","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/filter_significant_sites.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter significant PTM sites — filter_significant_sites","title":"Filter significant PTM sites — filter_significant_sites","text":"Filters phosphosite data FDR fold-change thresholds adds regulation column indicating direction change. prepares data downstream analysis like sequence logo visualization plot_diff_logo plot_seqlogo_with_diff.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/filter_significant_sites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter significant PTM sites — filter_significant_sites","text":"","code":"filter_significant_sites(   data,   fdr_col = \"FDR.site\",   diff_col = \"diff.site\",   fdr_threshold = 0.05,   fc_threshold = 0.6,   require_sequence = FALSE )"},{"path":"https://prolfqua.github.io/prophosqua/reference/filter_significant_sites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter significant PTM sites — filter_significant_sites","text":"data Data frame PTM results containing FDR fold-change columns fdr_col Character. Name FDR/adjusted p-value column. Default \"FDR.site\" diff_col Character. Name log2 fold-change column. Default \"diff.site\" fdr_threshold Numeric. FDR cutoff (sites FDR < threshold kept). Default 0.05 fc_threshold Numeric. Absolute log2 fold-change cutoff (sites |FC| > threshold kept). Default 0.6 (approximately 1.5-fold change) require_sequence Logical. TRUE, filter rows invalid SequenceWindow (NA starting/ending underscore). Default FALSE","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/filter_significant_sites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter significant PTM sites — filter_significant_sites","text":"Filtered data frame added 'regulation' column containing   \"upregulated\" \"downregulated\" based sign fold-change","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/filter_significant_sites.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Filter significant PTM sites — filter_significant_sites","text":"function performs two operations: Filters significant sites based FDR fold-change thresholds Adds 'regulation' column based sign fold-change resulting data frame suitable use plot_diff_logo plot_seqlogo_with_diff expect 'regulation' column.","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/reference/filter_significant_sites.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter significant PTM sites — filter_significant_sites","text":"","code":"# Example with mock data data <- data.frame(   contrast = rep(\"A_vs_B\", 6),   SequenceWindow = c(\"AAASAAAA\", \"BBBSBBB\", \"CCCSCCCC\",                      \"DDDSDDDD\", \"EEESEEEE\", \"FFFSFFF\"),   FDR.site = c(0.01, 0.03, 0.08, 0.02, 0.15, 0.04),   diff.site = c(1.2, -0.8, 0.5, -1.5, 0.3, 0.9),   stringsAsFactors = FALSE )  # Filter with default thresholds (FDR < 0.05, |FC| > 0.6) sig_sites <- filter_significant_sites(data) sig_sites$regulation #> [1] \"upregulated\"   \"downregulated\" \"downregulated\" \"upregulated\"    # Use with DPU column names data_dpu <- data.frame(   contrast = \"A_vs_B\",   SequenceWindow = c(\"AAASAAAA\", \"BBBSBBB\"),   FDR_I = c(0.01, 0.03),   diff_diff = c(1.2, -0.8) ) sig_dpu <- filter_significant_sites(data_dpu, fdr_col = \"FDR_I\", diff_col = \"diff_diff\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/get_pwm.html","id":null,"dir":"Reference","previous_headings":"","what":"Create PWM from amino acid sequences — get_pwm","title":"Create PWM from amino acid sequences — get_pwm","text":"Internal helper function compute position weight matrix (PWM) vector amino acid sequences.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_pwm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create PWM from amino acid sequences — get_pwm","text":"","code":"get_pwm(sequences)"},{"path":"https://prolfqua.github.io/prophosqua/reference/get_pwm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create PWM from amino acid sequences — get_pwm","text":"sequences Character vector amino acid sequences (must length)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_pwm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create PWM from amino acid sequences — get_pwm","text":"matrix amino acids rows positions columns","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_sequence_windows.html","id":null,"dir":"Reference","previous_headings":"","what":"extract sequence windows, from sequence at pos in protein — get_sequence_windows","title":"extract sequence windows, from sequence at pos in protein — get_sequence_windows","text":"extract sequence windows, sequence pos protein","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_sequence_windows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"extract sequence windows, from sequence at pos in protein — get_sequence_windows","text":"","code":"get_sequence_windows(   unique_prot_pep_seq,   flank_size = 7,   sequence = \"sequence\",   pos_in_protein = \"pos_in_protein\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/get_sequence_windows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"extract sequence windows, from sequence at pos in protein — get_sequence_windows","text":"unique_prot_pep_seq data.frame sequence pos protein flank_size size window extract sequence name column sequence pos_in_protein name column position protein","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_sequence_windows.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"extract sequence windows, from sequence at pos in protein — get_sequence_windows","text":"","code":"# Create sample data sample_data <- data.frame(   protein_id = c(\"P12345\", \"P12345\", \"Q67890\"),   sequence = c(\"MKFLVLLFNILCLFPVLAADNH\", \"MKFLVLLFNILCLFPVLAADNH\", \"AEQKLISEEDLLRKRREQLKHKLEQL\"),   pos_in_protein = c(5, 12, 8),   peptide = c(\"FLV\", \"ILC\", \"EED\") )  # Extract sequence windows with default flank size (7) result <- get_sequence_windows(sample_data) expected <- c(\"XXXMKFLVLLFNILC\", \"VLLFNILCLFPVLAA\", \"AEQKLISEEDLLRKR\") stopifnot(all(result$sequence_window == expected))  # Extract sequence windows with custom flank size result_small <- get_sequence_windows(sample_data, flank_size = 3) stopifnot(all(result_small$sequence_window == c( \"KFLVLLF\",  \"NILCLFP\",  \"LISEEDL\")))  # Extract sequence windows with different column names sample_data2 <- data.frame(   prot_seq = \"MKTAYIAKQRQISFVKSHFSRQLEERLGLIEVQAPILSRVGDGTQDNLSGAEKAVQVKVKALPDAQFEVVHSLAKWKRIY\",   position = c(10, 25, 40) )  result2 <- get_sequence_windows(sample_data2,                                flank_size = 5,                                sequence = \"prot_seq\",                                pos_in_protein = \"position\") print(result2$sequence_window) #> [1] \"YIAKQRQISFV\" \"SRQLEERLGLI\" \"PILSRVGDGTQ\""},{"path":"https://prolfqua.github.io/prophosqua/reference/load_and_preprocess_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Load and preprocess DEA data from Excel — load_and_preprocess_data","title":"Load and preprocess DEA data from Excel — load_and_preprocess_data","text":"Reads Excel file validates required columns present.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/load_and_preprocess_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load and preprocess DEA data from Excel — load_and_preprocess_data","text":"","code":"load_and_preprocess_data(   file_path,   required_cols,   sheet_name = \"diff_exp_analysis\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/load_and_preprocess_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load and preprocess DEA data from Excel — load_and_preprocess_data","text":"file_path Path Excel file required_cols Character vector required column names sheet_name Name sheet read (default: \"diff_exp_analysis\")","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/load_and_preprocess_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load and preprocess DEA data from Excel — load_and_preprocess_data","text":"Data frame loaded data","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/make_fasta_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Make FASTA database summary — make_fasta_summary","title":"Make FASTA database summary — make_fasta_summary","text":"Generates database statistics including number sequences amino acid frequencies. Extracted prozor package reduce dependencies.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/make_fasta_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make FASTA database summary — make_fasta_summary","text":"","code":"make_fasta_summary(resDB, old = FALSE, as_string = TRUE)"},{"path":"https://prolfqua.github.io/prophosqua/reference/make_fasta_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make FASTA database summary — make_fasta_summary","text":"resDB list sequences prozor::readPeptideFasta old Logical; use old (slower) method AA frequency calculation as_string Logical; return formatted string (TRUE) list (FALSE)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/make_fasta_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make FASTA database summary — make_fasta_summary","text":"as_string=TRUE, array strings pass cat().   as_string=FALSE, list nrSequences, lengthSummary, aafreq.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/make_fasta_summary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make FASTA database summary — make_fasta_summary","text":"","code":"if (FALSE) { # \\dontrun{ fasta <- prozor::readPeptideFasta(\"path/to/file.fasta\") cat(make_fasta_summary(fasta)) } # }"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_c_integrated_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Example dataset n_c_integrated_df — n_c_integrated_df","title":"Example dataset n_c_integrated_df — n_c_integrated_df","text":"simple example dataset demonstrating groups numeric values.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_c_integrated_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example dataset n_c_integrated_df — n_c_integrated_df","text":"","code":"n_c_integrated_df"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_c_integrated_df.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example dataset n_c_integrated_df — n_c_integrated_df","text":"## `n_c_integrated_df`","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot protein and PTM expression — n_to_c_expression","title":"Plot protein and PTM expression — n_to_c_expression","text":"Plot protein PTM expression","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot protein and PTM expression — n_to_c_expression","text":"","code":"n_to_c_expression(   combined_site_prot_long,   contrast_name,   FDR_threshold = 0.05,   fc_threshold = 0,   impute_flag = \"Imputed_Mean_moderated\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot protein and PTM expression — n_to_c_expression","text":"combined_site_prot_long data frame combined site protein data contrast_name name contrast plot FDR_threshold FDR threshold filtering significant sites (default 0.05) fc_threshold Fold change threshold filtering (default 0) impute_flag Flag imputed values (default \"Imputed_Mean_moderated\")","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot protein and PTM expression — n_to_c_expression","text":"data frame protein_Id, protein_length, contrast, data, plot","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression_multicontrast.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot protein and PTM expression across all contrasts in multi-panel layout — n_to_c_expression_multicontrast","title":"Plot protein and PTM expression across all contrasts in multi-panel layout — n_to_c_expression_multicontrast","text":"Plot protein PTM expression across contrasts multi-panel layout","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression_multicontrast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot protein and PTM expression across all contrasts in multi-panel layout — n_to_c_expression_multicontrast","text":"","code":"n_to_c_expression_multicontrast(   combined_site_prot_long,   FDR_threshold = 0.05,   fc_threshold = 0,   impute_flag = \"Imputed_Mean_moderated\",   max_plots = NULL,   include_proteins = NULL )"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression_multicontrast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot protein and PTM expression across all contrasts in multi-panel layout — n_to_c_expression_multicontrast","text":"combined_site_prot_long data frame combined site protein data FDR_threshold FDR threshold filtering significant sites (default 0.05) fc_threshold Fold change threshold filtering (default 0) impute_flag Flag imputed values (default \"Imputed_Mean_moderated\") max_plots Maximum number plots generate (default NULL = limit). specified, first max_plots proteins plotted. include_proteins Character vector protein IDs always include output, regardless max_plots limit (default NULL). proteins added even exceed max_plots limit.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression_multicontrast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot protein and PTM expression across all contrasts in multi-panel layout — n_to_c_expression_multicontrast","text":"data frame protein_Id, protein_length, n_contrasts, multi-panel plot","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression_multicontrast.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot protein and PTM expression across all contrasts in multi-panel layout — n_to_c_expression_multicontrast","text":"","code":"# data(combined_site_prot_data) # result <- n_to_c_expression_multicontrast(combined_site_prot_data, #   max_plots = 50, include_proteins = c(\"Q64337\")) # print(result$plot[[1]])  # Display first protein's multi-contrast plot"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"N to C plot using ggplot2 — n_to_c_plot","title":"N to C plot using ggplot2 — n_to_c_plot","text":"N C plot using ggplot2","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"N to C plot using ggplot2 — n_to_c_plot","text":"","code":"n_to_c_plot(   poi_matrix_min,   protein_name,   prot_length,   contrast,   thr_a = 0.05,   thr_b = 0.2,   color_protein = \"yellow\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"N to C plot using ggplot2 — n_to_c_plot","text":"poi_matrix_min data.frame phosphorylation data protein_name name protein prot_length protein length contrast name contrast thr_a significance threshold (strict), default 0.05 thr_b significance threshold (lenient), default 0.20 color_protein color protein-level bar (default: \"yellow\")","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"N to C plot using ggplot2 — n_to_c_plot","text":"","code":"data(exampleN_C_dat) # Prepare data for plotting poi_matrix_min <- prepare_n_to_c_data(exampleN_C_dat)  n_to_c_plot(subset(poi_matrix_min, protein_Id == \"A0A1I9LPZ1\"), \"A0A1I9LPZ1\", 2160, \"H1FC\")  n_to_c_plot(subset(poi_matrix_min, protein_Id == \"A0A178US29\"), \"A0A178US29\", 806, \"H1FC\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot_integrated.html","id":null,"dir":"Reference","previous_headings":"","what":"N to C plot for integrated (DPU) results — n_to_c_plot_integrated","title":"N to C plot for integrated (DPU) results — n_to_c_plot_integrated","text":"N C plot integrated (DPU) results","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot_integrated.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"N to C plot for integrated (DPU) results — n_to_c_plot_integrated","text":"","code":"n_to_c_plot_integrated(   poi_matrix_min,   protein_name,   prot_length,   contrast,   thr_a = 0.05,   thr_b = 0.2,   color_protein = \"yellow\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot_integrated.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"N to C plot for integrated (DPU) results — n_to_c_plot_integrated","text":"poi_matrix_min data.frame integrated phospho/protein data protein_name name protein prot_length protein length contrast name contrast thr_a significance threshold (strict), default 0.05 thr_b significance threshold (lenient), default 0.20 color_protein color protein-level bar (default: \"yellow\")","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot_integrated.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"N to C plot for integrated (DPU) results — n_to_c_plot_integrated","text":"","code":"data(n_c_integrated_df) n_c_integrated_df$imputation_status <- \"observed\" n_to_c_plot_integrated(n_c_integrated_df, \"A0A1I9LT44\", 539, \"WTFC\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot PTM occupation, use after adjusting for total proteome — n_to_c_usage","title":"Plot PTM occupation, use after adjusting for total proteome — n_to_c_usage","text":"Plot PTM occupation, use adjusting total proteome","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot PTM occupation, use after adjusting for total proteome — n_to_c_usage","text":"","code":"n_to_c_usage(   data_combined_diff,   contrast_name,   FDR_threshold = 0.05,   fc_threshold = 0,   impute_flag = \"Imputed_Mean_moderated\",   protein_Id = \"protein_Id\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot PTM occupation, use after adjusting for total proteome — n_to_c_usage","text":"data_combined_diff data frame combined differential analysis results contrast_name name contrast plot FDR_threshold FDR threshold filtering significant sites (default 0.05) fc_threshold Fold change threshold filtering (default 0) impute_flag Flag imputed values (default \"Imputed_Mean_moderated\") protein_Id Column name protein identifier (default \"protein_Id\")","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot PTM occupation, use after adjusting for total proteome — n_to_c_usage","text":"data frame protein_Id, protein_length, contrast, data, plot","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage_multicontrast.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot PTM usage across all contrasts in multi-panel layout — n_to_c_usage_multicontrast","title":"Plot PTM usage across all contrasts in multi-panel layout — n_to_c_usage_multicontrast","text":"Plot PTM usage across contrasts multi-panel layout","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage_multicontrast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot PTM usage across all contrasts in multi-panel layout — n_to_c_usage_multicontrast","text":"","code":"n_to_c_usage_multicontrast(   data_combined_diff,   FDR_threshold = 0.05,   fc_threshold = 0,   impute_flag = \"Imputed_Mean_moderated\",   protein_Id = \"protein_Id\",   max_plots = NULL,   include_proteins = NULL )"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage_multicontrast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot PTM usage across all contrasts in multi-panel layout — n_to_c_usage_multicontrast","text":"data_combined_diff data frame combined differential analysis results FDR_threshold FDR threshold filtering significant sites (default 0.05) fc_threshold Fold change threshold filtering (default 0) impute_flag Flag imputed values (default \"Imputed_Mean_moderated\") protein_Id Column name protein identifier (default \"protein_Id\") max_plots Maximum number plots generate (default NULL = limit). specified, first max_plots proteins plotted. include_proteins Character vector protein IDs always include output, regardless max_plots limit (default NULL). proteins added even exceed max_plots limit.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage_multicontrast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot PTM usage across all contrasts in multi-panel layout — n_to_c_usage_multicontrast","text":"data frame protein_Id, protein_length, n_contrasts, multi-panel plot","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage_multicontrast.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot PTM usage across all contrasts in multi-panel layout — n_to_c_usage_multicontrast","text":"","code":"# data(combined_diff_data) # result <- n_to_c_usage_multicontrast(combined_diff_data, #   max_plots = 50, include_proteins = c(\"Q64337\")) # print(result$plot[[1]])  # Display first protein's multi-contrast plot"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","title":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","text":"function computes position weight matrices (PWMs) upregulated downregulated sites, calculates difference (- ). Positive values indicate amino acids enriched upregulated sites, negative values indicate enrichment downregulated sites. approach particularly useful : Identifying kinases opposing activity changes Detecting motif shifts conditions Highlighting position-specific amino acid preferences","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","text":"","code":"plot_diff_logo(sig_sites)"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","text":"sig_sites data frame containing significant phosphorylation sites following required columns: contrast Character. name experimental contrast     (e.g., \"KO_vs_WT\") regulation Character. Either \"upregulated\" \"downregulated\" SequenceWindow Character. amino acid sequence window     surrounding phosphorylation site (typically 15 amino acids     centered modified residue)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","text":"ggplot2 object created ggseqlogo showing difference   logos contrast. Returns NULL contrasts   upregulated downregulated sequences.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","text":"Creates difference sequence logo plot visualizes difference amino acid frequencies upregulated downregulated phosphorylation sites. visualization helps identify kinase-specific motifs differentially regulated experimental conditions. difference PWM calculated : $$PWM_{diff} = PWM_{} - PWM_{}$$ position sequence window, function calculates frequency 20 standard amino acids. difference frequencies visualized using 'custom' method ggseqlogo, : Letters baseline (positive values) enriched     upregulated sites Letters baseline (negative values) enriched     downregulated sites Letter height corresponds magnitude frequency     difference","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","text":"","code":"# Create example data with phosphorylation site motifs sig_sites <- data.frame(   contrast = rep(\"KO_vs_WT\", 20),   regulation = rep(c(\"upregulated\", \"downregulated\"), each = 10),   SequenceWindow = c(     # Upregulated: Proline-directed (CDK-like: S/T-P-x-K)     \"AAATPASPLTPGKRA\", \"GGGKSPVSPLTPGKR\", \"AAATPASPLTPGKRA\",     \"LLLSQVSPKTPAAAA\", \"AAATPASPLTPGKRA\", \"GGGKSPVSPLTPGKR\",     \"VVKTPASPLTPGKRA\", \"AAATPASPLTPGKRA\", \"LLLSQVSPKTPAAAA\",     \"GGGKSPVSPLTPGKR\",      # Downregulated: Basophilic (PKA-like: R-R-x-S)     \"LRRRRSLAAAGKPAA\", \"GGRRRASVAAAGKPA\", \"LRRRRSLAAAGKPAA\",     \"GKRRRSSLAAAGKPA\", \"LRRRRSLAAAGKPAA\", \"GGRRRASVAAAGKPA\",     \"DKRRRSSLAAAGKPA\", \"LRRRRSLAAAGKPAA\", \"GKRRRSSLAAAGKPA\",     \"GGRRRASVAAAGKPA\"   ) )  # Generate difference logo diff_plot <- plot_diff_logo(sig_sites) #> Warning: `aes_string()` was deprecated in ggplot2 3.0.0. #> ℹ Please use tidy evaluation idioms with `aes()`. #> ℹ See also `vignette(\"ggplot2-in-packages\")` for more information. #> ℹ The deprecated feature was likely used in the ggseqlogo package. #>   Please report the issue at <https://github.com/omarwagih/ggseqlogo/issues>. print(diff_plot)"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_dotplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create enrichment dotplot for top items by FDR — plot_enrichment_dotplot","title":"Create enrichment dotplot for top items by FDR — plot_enrichment_dotplot","text":"Create enrichment dotplot top items FDR","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_dotplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create enrichment dotplot for top items by FDR — plot_enrichment_dotplot","text":"","code":"plot_enrichment_dotplot(   data,   item_col = \"kinase\",   fdr_col = \"FDR\",   n_top = 30,   title = NULL,   subtitle = \"Top 30 by FDR\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_dotplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create enrichment dotplot for top items by FDR — plot_enrichment_dotplot","text":"data Data frame columns: item (kinase/pathway), NES, p.adjust/FDR, contrast item_col Name item column (default: \"kinase\") fdr_col Name FDR column (default: \"FDR\") n_top Number top items show (default: 30) title Plot title subtitle Plot subtitle","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_dotplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create enrichment dotplot for top items by FDR — plot_enrichment_dotplot","text":"ggplot object","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_dotplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create enrichment dotplot for top items by FDR — plot_enrichment_dotplot","text":"","code":"# Kinase enrichment results (e.g., from KinaseLibrary) kinase_results <- data.frame(   kinase = c(\"PKACA\", \"AKT1\", \"MAPK1\", \"CDK1\", \"CSNK2A1\", \"GSK3B\"),   NES = c(2.1, 1.8, -1.5, 1.2, -0.8, 0.3),   FDR = c(0.001, 0.01, 0.02, 0.08, 0.15, 0.45) ) plot_enrichment_dotplot(kinase_results, n_top = 6, title = \"Kinase Enrichment\")   # Pathway enrichment with custom column names pathway_results <- data.frame(   pathway = c(\"Cell cycle\", \"Apoptosis\", \"MAPK signaling\"),   NES = c(1.9, -1.4, 1.1),   p.adjust = c(0.005, 0.03, 0.09) ) plot_enrichment_dotplot(pathway_results, item_col = \"pathway\",                         fdr_col = \"p.adjust\", n_top = 3)"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Create NES heatmap for top items across contrasts — plot_enrichment_heatmap","title":"Create NES heatmap for top items across contrasts — plot_enrichment_heatmap","text":"Create NES heatmap top items across contrasts","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create NES heatmap for top items across contrasts — plot_enrichment_heatmap","text":"","code":"plot_enrichment_heatmap(   data,   item_col = \"ID\",   fdr_col = \"p.adjust\",   fdr_filter = 0.15,   n_top = 25,   item_label_col = NULL,   title = NULL,   subtitle = NULL )"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create NES heatmap for top items across contrasts — plot_enrichment_heatmap","text":"data Data frame columns: item (ID/kinase), NES, p.adjust/FDR, contrast item_col Name item column (default: \"ID\") fdr_col Name FDR column (default: \"p.adjust\") fdr_filter FDR threshold selecting top items (default: 0.15) n_top Number top items show (default: 25) item_label_col Optional column shorter labels (default: NULL, uses item_col) title Plot title subtitle Plot subtitle","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create NES heatmap for top items across contrasts — plot_enrichment_heatmap","text":"ggplot object","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create NES heatmap for top items across contrasts — plot_enrichment_heatmap","text":"","code":"# PTMSEA results across multiple contrasts ptmsea_results <- data.frame(   ID = rep(c(\"KINASE-PSP_PKACA\", \"KINASE-PSP_AKT1\", \"KINASE-PSP_MAPK1\"), 3),   NES = c(2.1, 1.5, -1.2, 1.8, 0.9, -0.8, 1.2, 1.1, -1.5),   p.adjust = c(0.001, 0.02, 0.05, 0.005, 0.12, 0.18, 0.08, 0.09, 0.03),   contrast = rep(c(\"Early\", \"Mid\", \"Late\"), each = 3) ) plot_enrichment_heatmap(ptmsea_results, n_top = 3,                         title = \"PTMSEA Kinase Activity\")   # With custom item labels (shorter names) ptmsea_results$short_name <- gsub(\"KINASE-PSP_\", \"\", ptmsea_results$ID) plot_enrichment_heatmap(ptmsea_results, item_label_col = \"short_name\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_volcano.html","id":null,"dir":"Reference","previous_headings":"","what":"Create volcano plot for enrichment results — plot_enrichment_volcano","title":"Create volcano plot for enrichment results — plot_enrichment_volcano","text":"Create volcano plot enrichment results","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_volcano.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create volcano plot for enrichment results — plot_enrichment_volcano","text":"","code":"plot_enrichment_volcano(   data,   item_col = \"kinase\",   fdr_col = \"FDR\",   fdr_threshold = 0.1,   label_fdr_threshold = 0.05,   n_labels = 5,   title = NULL,   subtitle = NULL )"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_volcano.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create volcano plot for enrichment results — plot_enrichment_volcano","text":"data Data frame columns: NES, p.adjust/FDR, contrast, item (kinase/pathway) item_col Name item column labels (default: \"kinase\") fdr_col Name FDR column (default: \"FDR\") fdr_threshold FDR threshold significance line (default: 0.1) label_fdr_threshold FDR threshold labeling points (default: 0.05) n_labels Number top labels per contrast (default: 5) title Plot title subtitle Plot subtitle","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_volcano.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create volcano plot for enrichment results — plot_enrichment_volcano","text":"ggplot object","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_enrichment_volcano.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create volcano plot for enrichment results — plot_enrichment_volcano","text":"","code":"# Multi-contrast kinase enrichment results kinase_results <- data.frame(   kinase = rep(c(\"PKACA\", \"AKT1\", \"MAPK1\", \"CDK1\"), 2),   NES = c(2.1, 1.5, -1.8, 0.5, 1.2, -0.8, 1.9, -1.1),   FDR = c(0.001, 0.02, 0.01, 0.3, 0.05, 0.2, 0.008, 0.06),   contrast = rep(c(\"Treatment_vs_Control\", \"Timepoint_vs_Baseline\"), each = 4) ) plot_enrichment_volcano(kinase_results, title = \"Kinase Enrichment Volcano\")   # Customize labeling thresholds plot_enrichment_volcano(kinase_results, fdr_threshold = 0.05,                         label_fdr_threshold = 0.02, n_labels = 3)"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","title":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","text":"Creates 3-column sequence logo plot showing upregulated sites, downregulated sites, difference (- ) contrast. difference column uses independent y-axis scale appropriate showing positive negative frequency differences.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","text":"","code":"plot_seqlogo_with_diff(sig_sites)"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","text":"sig_sites data frame containing significant phosphorylation sites required columns: contrast, regulation, SequenceWindow.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","text":"patchwork object combining sequence logos 3 columns per   contrast row: upregulated, downregulated, difference logos.   Returns NULL contrasts upregulated   downregulated sequences.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","text":"contrast, three sequence logos displayed: Upregulated: Amino acid frequencies sites increased     phosphorylation (y-axis: 0-1) Downregulated: Amino acid frequencies sites decreased     phosphorylation (y-axis: 0-1) Difference: difference frequencies (- ),     positive values indicate enrichment upregulated sites (y-axis: symmetric     around 0)","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","text":"","code":"# Create example data with phosphorylation site motifs sig_sites <- data.frame(   contrast = rep(\"KO_vs_WT\", 20),   regulation = rep(c(\"upregulated\", \"downregulated\"), each = 10),   SequenceWindow = c(     # Upregulated: Proline-directed (CDK-like: S/T-P-x-K)     \"AAATPASPLTPGKRA\", \"GGGKSPVSPLTPGKR\", \"AAATPASPLTPGKRA\",     \"LLLSQVSPKTPAAAA\", \"AAATPASPLTPGKRA\", \"GGGKSPVSPLTPGKR\",     \"VVKTPASPLTPGKRA\", \"AAATPASPLTPGKRA\", \"LLLSQVSPKTPAAAA\",     \"GGGKSPVSPLTPGKR\",      # Downregulated: Basophilic (PKA-like: R-R-x-S)     \"LRRRRSLAAAGKPAA\", \"GGRRRASVAAAGKPA\", \"LRRRRSLAAAGKPAA\",     \"GKRRRSSLAAAGKPA\", \"LRRRRSLAAAGKPAA\", \"GGRRRASVAAAGKPA\",     \"DKRRRSSLAAAGKPA\", \"LRRRRSLAAAGKPAA\", \"GKRRRSSLAAAGKPA\",     \"GGRRRASVAAAGKPA\"   ) )  # Generate 3-column layout: Up, Down, Difference p <- plot_seqlogo_with_diff(sig_sites) print(p)"},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_enrichment_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare enrichment data with common computed columns — prepare_enrichment_data","title":"Prepare enrichment data with common computed columns — prepare_enrichment_data","text":"Adds neg_log_fdr, direction, significant columns enrichment results. shared helper used plot functions analyses.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_enrichment_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare enrichment data with common computed columns — prepare_enrichment_data","text":"","code":"prepare_enrichment_data(data, fdr_col = \"FDR\", fdr_threshold = 0.1)"},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_enrichment_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare enrichment data with common computed columns — prepare_enrichment_data","text":"data Data frame NES FDR columns fdr_col Name FDR column (default: \"FDR\") fdr_threshold FDR threshold significance (default: 0.1)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_enrichment_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare enrichment data with common computed columns — prepare_enrichment_data","text":"Data frame added neg_log_fdr, direction, significant columns","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_enrichment_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare enrichment data with common computed columns — prepare_enrichment_data","text":"","code":"# Basic usage with default FDR column df <- data.frame(NES = c(1.5, -1.2, 0.5, -0.3), FDR = c(0.01, 0.08, 0.05, 0.25)) result <- prepare_enrichment_data(df) result$direction   # \"Up\", \"Down\", \"Up\", \"Down\" #> [1] \"Up\"   \"Down\" \"Up\"   \"Down\" result$significant # TRUE, TRUE, TRUE, FALSE #> [1]  TRUE  TRUE  TRUE FALSE  # With custom FDR column name (e.g., from clusterProfiler) df2 <- data.frame(NES = c(2.0, -1.5), p.adjust = c(0.02, 0.12)) result2 <- prepare_enrichment_data(df2, fdr_col = \"p.adjust\")  # With stricter FDR threshold result3 <- prepare_enrichment_data(df, fdr_threshold = 0.05) result3$significant # TRUE, FALSE, TRUE, FALSE #> [1]  TRUE FALSE FALSE FALSE"},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_gsea_ranks.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare ranked lists for GSEA analysis — prepare_gsea_ranks","title":"Prepare ranked lists for GSEA analysis — prepare_gsea_ranks","text":"Creates named numeric vectors suitable clusterProfiler::GSEA phosphoproteomics data multiple contrasts. general-purpose function works GSEA analysis (Kinase Library, motif enrichment, etc.). PTMsigDB-specific preparation trimming \"-p\" suffix, see ptmsea_data_prep.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_gsea_ranks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare ranked lists for GSEA analysis — prepare_gsea_ranks","text":"","code":"prepare_gsea_ranks(   data,   stat_col,   seq_col = \"SequenceWindow\",   contrast_col = \"contrast\",   to_uppercase = TRUE,   add_suffix = NULL )"},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_gsea_ranks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare ranked lists for GSEA analysis — prepare_gsea_ranks","text":"data Data frame phosphosite data containing statistics per contrast stat_col Character. Column name ranking statistic (e.g., \"statistic.site\" DPA \"tstatistic_I\" DPU) seq_col Character. Column name sequence windows. Default \"SequenceWindow\" contrast_col Character. Column name contrasts. Default \"contrast\" to_uppercase Logical. Convert sequences uppercase. Default TRUE add_suffix Character NULL. Suffix add sequences (e.g., \"-p\" PTMsigDB format). Default NULL (suffix)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_gsea_ranks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare ranked lists for GSEA analysis — prepare_gsea_ranks","text":"Named list named numeric vectors, one per contrast. vector   contains statistics named sequence, sorted descending order.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_gsea_ranks.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare ranked lists for GSEA analysis — prepare_gsea_ranks","text":"contrast, function: Filters specified contrast Processes sequences (uppercase, trim whitespace) Removes rows NA statistics Keeps first occurrence duplicate sequences Sorts statistic (descending) GSEA","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_gsea_ranks.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare ranked lists for GSEA analysis — prepare_gsea_ranks","text":"","code":"# Example with mock data data <- data.frame(   contrast = rep(c(\"A_vs_B\", \"C_vs_D\"), each = 5),   SequenceWindow = c(\"AAASAAAA\", \"BBBSBBB\", \"CCCSCCCC\", \"DDDSDDDD\", \"EEESEEEE\",                      \"AAASAAAA\", \"FFFSFFF\", \"GGGSGGGG\", \"HHHSHHHH\", \"IIISIII\"),   statistic.site = c(2.5, 1.8, -0.5, -1.2, 0.3, 1.9, 2.1, -0.8, 0.1, -1.5),   stringsAsFactors = FALSE )  # Prepare ranks for Kinase Library GSEA (no suffix needed) ranks <- prepare_gsea_ranks(data, stat_col = \"statistic.site\") names(ranks)  # contrast names #> [1] \"A_vs_B\" \"C_vs_D\" head(ranks[[1]])  # ranked sequences for first contrast #> AAASAAAA  BBBSBBB EEESEEEE CCCSCCCC DDDSDDDD  #>      2.5      1.8      0.3     -0.5     -1.2   # Prepare ranks for PTMsigDB (with \"-p\" suffix) ranks_ptm <- prepare_gsea_ranks(data, stat_col = \"statistic.site\", add_suffix = \"-p\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_n_to_c_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare data for N-to-C plotting — prepare_n_to_c_data","title":"Prepare data for N-to-C plotting — prepare_n_to_c_data","text":"Prepare data N--C plotting","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_n_to_c_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare data for N-to-C plotting — prepare_n_to_c_data","text":"","code":"prepare_n_to_c_data(poi_matrix_min, model_site = \"model_site\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_n_to_c_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare data for N-to-C plotting — prepare_n_to_c_data","text":"poi_matrix_min data.frame phosphorylation data","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_n_to_c_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare data for N-to-C plotting — prepare_n_to_c_data","text":"data.frame prepared data plotting","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_n_to_c_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare data for N-to-C plotting — prepare_n_to_c_data","text":"","code":"# example code data(exampleN_C_dat) poi_matrix_min <- prepare_n_to_c_data(exampleN_C_dat)"},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_ntoc_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare data for N-to-C plotting — prepare_ntoc_data","title":"Prepare data for N-to-C plotting — prepare_ntoc_data","text":"Prepares PTM data N--C visualization ensuring required columns exist standardizing column names.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_ntoc_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare data for N-to-C plotting — prepare_ntoc_data","text":"","code":"prepare_ntoc_data(data, analysis_type = \"dpa\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_ntoc_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare data for N-to-C plotting — prepare_ntoc_data","text":"data Data frame PTM results analysis_type Character. Analysis type: \"dpa\", \"dpu\", \"cf\"","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_ntoc_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare data for N-to-C plotting — prepare_ntoc_data","text":"Data frame prepared N--C plotting functions","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_ntoc_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare data for N-to-C plotting — prepare_ntoc_data","text":"function handles different analysis types may different column naming conventions: DPA: Uses diff.site, FDR.site columns DPU: Uses diff_diff, FDR_I columns CF: Uses diff, FDR columns","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_data_prep.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare data for PTM-SEA analysis — ptmsea_data_prep","title":"Prepare data for PTM-SEA analysis — ptmsea_data_prep","text":"Converts phosphosite data list named vectors suitable GSEA. contrast produces one named vector names site IDs PTMsigDB format (SEQUENCE-p) values t-statistics (ranking metric).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_data_prep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare data for PTM-SEA analysis — ptmsea_data_prep","text":"","code":"ptmsea_data_prep(   data,   stat_column,   seq_window_col = \"SequenceWindow\",   contrast_col = \"contrast\",   trim_to = c(\"11\", \"13\", \"15\") )"},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_data_prep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare data for PTM-SEA analysis — ptmsea_data_prep","text":"data data.frame containing phosphosite data statistics per contrast stat_column Character. Column name ranking statistic. Use \"statistic.site\" DPA \"tstatistic_I\" DPU. seq_window_col Character. Column name sequence windows. Default \"SequenceWindow\". contrast_col Character. Column name contrasts. Default \"contrast\". trim_to Character. Trim flanking sequences width. Options: \"11\" (default), \"13\", \"15\" (trimming). Trimming increases overlap PTMsigDB.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_data_prep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare data for PTM-SEA analysis — ptmsea_data_prep","text":"List two elements: ranks: Named list named numeric vectors (one per contrast) dropped: Named list dropped duplicates (one per contrast duplicates)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_data_prep.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare data for PTM-SEA analysis — ptmsea_data_prep","text":"","code":"# Prepare mock data data <- data.frame(   contrast = c(\"A\", \"A\", \"B\", \"B\"),   SequenceWindow = c(\"AAAAAAASAAAAAAA\", \"BBBBBBBSBBBBBBB\", \"AAAAAAASAAAAAAA\", \"CCCCCCCSCCCCCCC\"),   statistic.site = c(2.5, 1.5, -2.0, -1.0),   stringsAsFactors = FALSE )  # Prepare DPA data using t-statistic for ranking prep_dpa <- ptmsea_data_prep(data, stat_column = \"statistic.site\") prep_dpa$ranks # ranked lists per contrast #> $A #> AAAAASAAAAA-p BBBBBSBBBBB-p  #>           2.5           1.5  #>  #> $B #> CCCCCSCCCCC-p AAAAASAAAAA-p  #>            -1            -2  #>  prep_dpa$dropped # duplicates that were dropped #> list()  # Trim to 13-mer to potentially increase PTMsigDB overlap prep_dpa_13 <- ptmsea_data_prep(data, stat_column = \"statistic.site\", trim_to = \"13\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_ora_prep.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare data for PTM-SEA ORA analysis — ptmsea_ora_prep","title":"Prepare data for PTM-SEA ORA analysis — ptmsea_ora_prep","text":"Prepares enriched background site lists -representation analysis. fc_col provided, significant sites split sets. sites intersect PTMsigDB included.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_ora_prep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare data for PTM-SEA ORA analysis — ptmsea_ora_prep","text":"","code":"ptmsea_ora_prep(   data,   ptmsigdb_sites,   score_col,   fc_col = NULL,   seq_window_col = \"SequenceWindow\",   threshold = 0.05,   trim_to = c(\"11\", \"13\", \"15\") )"},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_ora_prep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare data for PTM-SEA ORA analysis — ptmsea_ora_prep","text":"data data.frame flanking sequences, scores, optionally fold changes ptmsigdb_sites Character vector. Site IDs PTMsigDB (stripped, without ;u/;d). Use unique(gsub(\";[ud]$\", \"\", unlist(pathways))). score_col Character. Column significance score (e.g., \"FDR_I\"). fc_col Character NULL. Column fold change. provided, returns separate enriched_up enriched_down. Default NULL. seq_window_col Character. Column flanking sequences. Default \"SequenceWindow\". threshold Numeric. Significance threshold score_col. Default 0.05. trim_to Character. Trim width: \"11\" (default), \"13\", \"15\".","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_ora_prep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare data for PTM-SEA ORA analysis — ptmsea_ora_prep","text":"List enriched (enriched_up/enriched_down fc_col) background.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsigdb_to_term2gene.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert PTMsigDB pathways to TERM2GENE format — ptmsigdb_to_term2gene","title":"Convert PTMsigDB pathways to TERM2GENE format — ptmsigdb_to_term2gene","text":"Converts pathway list fgsea::gmtPathways() data.frame format required clusterProfiler::enricher.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsigdb_to_term2gene.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert PTMsigDB pathways to TERM2GENE format — ptmsigdb_to_term2gene","text":"","code":"ptmsigdb_to_term2gene(pathways)"},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsigdb_to_term2gene.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert PTMsigDB pathways to TERM2GENE format — ptmsigdb_to_term2gene","text":"pathways Named list pathways (fgsea::gmtPathways)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsigdb_to_term2gene.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert PTMsigDB pathways to TERM2GENE format — ptmsigdb_to_term2gene","text":"data.frame columns: term, gene","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PTM-SEA without direction — run_ptmsea","title":"Run PTM-SEA without direction — run_ptmsea","text":"Runs GSEA PTMsigDB pathways, ignoring direction suffixes (;u/;d).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PTM-SEA without direction — run_ptmsea","text":"","code":"run_ptmsea(   ranks_list,   pathways,   min_size = 3,   max_size = 500,   n_perm = 1000,   pvalueCutoff = 0.1 )"},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PTM-SEA without direction — run_ptmsea","text":"ranks_list Named list ranked vectors ptmsea_data_prep(). pathways List pathways fgsea::gmtPathways(). min_size Integer. Minimum pathway size. Default 3. max_size Integer. Maximum pathway size. Default 500. n_perm Integer. Number permutations. Default 1000. pvalueCutoff Numeric. Adjusted p-value cutoff. Default 0.1.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run PTM-SEA without direction — run_ptmsea","text":"Named list clusterProfiler gseaResult objects (one per contrast).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run PTM-SEA without direction — run_ptmsea","text":"","code":"# Mock ranked lists seqs <- paste0(\"SEQ\", 1:15, \"-p\") rank_vec <- setNames(rnorm(15), seqs) ranks_list <- list(contrast1 = sort(rank_vec, decreasing = TRUE))  # Mock pathways pathways <- list(   PathwayA = seqs[1:10],   PathwayB = seqs[6:15] )  # Run PTM-SEA (adjusting min_size for small mock data) results <- run_ptmsea(ranks_list, pathways, min_size = 1, pvalueCutoff = 1.0) #> Running PTM-SEA for 'contrast1' (15 sites, 15 overlap) #>"},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea_up_down.html","id":null,"dir":"Reference","previous_headings":"","what":"Run directional PTM-SEA analysis — run_ptmsea_up_down","title":"Run directional PTM-SEA analysis — run_ptmsea_up_down","text":"Splits PTMsigDB pathways direction (/) runs fgsea twice per contrast (ascending descending rank order).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea_up_down.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run directional PTM-SEA analysis — run_ptmsea_up_down","text":"","code":"run_ptmsea_up_down(   ranks_list,   pathways,   min_size = 3,   max_size = 500,   n_perm = 1000,   pvalueCutoff = 0.1 )"},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea_up_down.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run directional PTM-SEA analysis — run_ptmsea_up_down","text":"ranks_list Named list named numeric vectors ptmsea_data_prep(). pathways Named list pathway definitions (e.g., fgsea::gmtPathways()). min_size Integer. Minimum pathway size. Default 3. max_size Integer. Maximum pathway size. Default 500. n_perm Integer. Number permutations. Default 1000. pvalueCutoff Numeric. Adjusted p-value cutoff. Default 0.1.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea_up_down.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run directional PTM-SEA analysis — run_ptmsea_up_down","text":"Named list clusterProfiler gseaResult objects, named <contrast>_<ascending/descending>.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/split_ptmsigdb_pathways.html","id":null,"dir":"Reference","previous_headings":"","what":"Split PTMsigDB pathways by direction — split_ptmsigdb_pathways","title":"Split PTMsigDB pathways by direction — split_ptmsigdb_pathways","text":"Splits pathway gene sets - -regulated subsets based direction suffixes (;u ;d) used PTMsigDB.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/split_ptmsigdb_pathways.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split PTMsigDB pathways by direction — split_ptmsigdb_pathways","text":"","code":"split_ptmsigdb_pathways(pathways)"},{"path":"https://prolfqua.github.io/prophosqua/reference/split_ptmsigdb_pathways.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split PTMsigDB pathways by direction — split_ptmsigdb_pathways","text":"pathways Named list pathway gene vectors ;u/;d suffixes","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/split_ptmsigdb_pathways.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split PTMsigDB pathways by direction — split_ptmsigdb_pathways","text":"Named list _up _down pathway subsets","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/summarize_enrichment_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Create summary table for enrichment results — summarize_enrichment_results","title":"Create summary table for enrichment results — summarize_enrichment_results","text":"Generates summary table counts significant results different FDR thresholds.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/summarize_enrichment_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create summary table for enrichment results — summarize_enrichment_results","text":"","code":"summarize_enrichment_results(results, fdr_thresholds = c(0.1, 0.05))"},{"path":"https://prolfqua.github.io/prophosqua/reference/summarize_enrichment_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create summary table for enrichment results — summarize_enrichment_results","text":"results Named list clusterProfiler GSEA result objects data frame fdr_thresholds Vector FDR thresholds count (default: c(0.1, 0.05))","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/summarize_enrichment_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create summary table for enrichment results — summarize_enrichment_results","text":"tibble summary statistics","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/summarize_enrichment_results.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create summary table for enrichment results — summarize_enrichment_results","text":"","code":"# Summarize MEA/kinase enrichment data frame mea_results <- data.frame(   contrast = c(rep(\"Treatment_vs_Control\", 50), rep(\"Drug_vs_Vehicle\", 50)),   kinase = paste0(\"Kinase\", 1:100),   NES = rnorm(100),   FDR = runif(100, 0, 0.3) ) summarize_enrichment_results(mea_results) #> # A tibble: 2 × 4 #>   contrast             total `FDR < 0.1` `FDR < 0.05` #>   <chr>                <int>       <int>        <int> #> 1 Drug_vs_Vehicle         50          16           12 #> 2 Treatment_vs_Control    50          19           12 # Returns: contrast, total, FDR < 0.1, FDR < 0.05"},{"path":"https://prolfqua.github.io/prophosqua/reference/summarize_significant_sites.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize significant sites by group — summarize_significant_sites","title":"Summarize significant sites by group — summarize_significant_sites","text":"Generates summary statistics significant sites, counting - -regulated sites specified grouping variables.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/summarize_significant_sites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize significant sites by group — summarize_significant_sites","text":"","code":"summarize_significant_sites(data, group_cols = c(\"contrast\"))"},{"path":"https://prolfqua.github.io/prophosqua/reference/summarize_significant_sites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize significant sites by group — summarize_significant_sites","text":"data Data frame 'regulation' column (typically output filter_significant_sites) group_cols Character vector column names group . Default c(\"contrast\")","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/summarize_significant_sites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize significant sites by group — summarize_significant_sites","text":"tibble counts pivoted wide, showing upregulated   downregulated counts per group","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/reference/summarize_significant_sites.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize significant sites by group — summarize_significant_sites","text":"","code":"# Example with mock data data <- data.frame(   contrast = c(rep(\"A_vs_B\", 4), rep(\"C_vs_D\", 3)),   regulation = c(\"upregulated\", \"upregulated\", \"downregulated\", \"upregulated\",                  \"downregulated\", \"downregulated\", \"upregulated\") )  summarize_significant_sites(data) #> # A tibble: 2 × 3 #>   contrast downregulated upregulated #>   <chr>            <int>       <int> #> 1 A_vs_B               1           3 #> 2 C_vs_D               2           1"},{"path":"https://prolfqua.github.io/prophosqua/reference/test_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute MSstats-like test statistics for differential PTM usage — test_diff","title":"Compute MSstats-like test statistics for differential PTM usage — test_diff","text":"Joins site-level protein-level results, computes difference--differences, performs t-tests differential PTM usage.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/test_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute MSstats-like test statistics for differential PTM usage — test_diff","text":"","code":"test_diff(   phos_res,   tot_res,   join_column = c(\"protein_Id\", \"contrast\", \"description\", \"protein_length\",     \"nr_tryptic_peptides\") )"},{"path":"https://prolfqua.github.io/prophosqua/reference/test_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute MSstats-like test statistics for differential PTM usage — test_diff","text":"phos_res Data frame phospho site-level results tot_res Data frame protein-level results join_column Character vector columns join ","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/test_diff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute MSstats-like test statistics for differential PTM usage — test_diff","text":"Data frame combined results including diff_diff test statistics","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_flanking_seq.html","id":null,"dir":"Reference","previous_headings":"","what":"Trim flanking sequence to specified width — trim_flanking_seq","title":"Trim flanking sequence to specified width — trim_flanking_seq","text":"Trims flanking sequence centered phosphosite (position 8 15-mer). Removes equal amino acids N C termini.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_flanking_seq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trim flanking sequence to specified width — trim_flanking_seq","text":"","code":"trim_flanking_seq(seq, trim_to = 15L)"},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_flanking_seq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trim flanking sequence to specified width — trim_flanking_seq","text":"seq Character. Flanking sequence (15-mer expected). trim_to Integer. Target width: 15 (trim), 13, 11. Default 15.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_flanking_seq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trim flanking sequence to specified width — trim_flanking_seq","text":"Character. Trimmed sequence.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_ptmsigdb_pathways.html","id":null,"dir":"Reference","previous_headings":"","what":"Trim PTMsigDB pathways to shorter flanking sequences — trim_ptmsigdb_pathways","title":"Trim PTMsigDB pathways to shorter flanking sequences — trim_ptmsigdb_pathways","text":"Trims site IDs PTMsigDB pathways specified width. Use trimming data ptmsea_data_prep(trim_to=...) ensure sides match.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_ptmsigdb_pathways.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trim PTMsigDB pathways to shorter flanking sequences — trim_ptmsigdb_pathways","text":"","code":"trim_ptmsigdb_pathways(pathways, trim_to = c(\"11\", \"13\", \"15\"))"},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_ptmsigdb_pathways.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trim PTMsigDB pathways to shorter flanking sequences — trim_ptmsigdb_pathways","text":"pathways Named list pathways fgsea::gmtPathways(). trim_to Character. Target width: \"11\" (default), \"13\", \"15\" (trim).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_ptmsigdb_pathways.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trim PTMsigDB pathways to shorter flanking sequences — trim_ptmsigdb_pathways","text":"Named list pathways trimmed site IDs.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_ptmsigdb_pathways.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Trim PTMsigDB pathways to shorter flanking sequences — trim_ptmsigdb_pathways","text":"","code":"# Mock pathways pathways <- list(   PathwayA = c(\"AAAAAAASAAAAAAA-p\", \"BBBBBBBSBBBBBBB-p\"),   PathwayB = c(\"CCCCCCCSCCCCCCC-p\") )  # Trim to 11-mer pathways_11 <- trim_ptmsigdb_pathways(pathways, trim_to = \"11\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/validate_sequence_window.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate sequence window alignment — validate_sequence_window","title":"Validate sequence window alignment — validate_sequence_window","text":"Filters phosphosite data keep rows central residue SequenceWindow matches reported modified amino acid (modAA).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/validate_sequence_window.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate sequence window alignment — validate_sequence_window","text":"","code":"validate_sequence_window(   data,   seq_col = \"SequenceWindow\",   mod_col = \"modAA\",   center_pos = 8L )"},{"path":"https://prolfqua.github.io/prophosqua/reference/validate_sequence_window.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate sequence window alignment — validate_sequence_window","text":"data Data frame PTM results containing SequenceWindow modAA columns seq_col Character. Name sequence window column. Default \"SequenceWindow\" mod_col Character. Name modified amino acid column. Default \"modAA\" center_pos Integer. Position central residue (1-indexed). Default 8","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/validate_sequence_window.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate sequence window alignment — validate_sequence_window","text":"Filtered data frame valid sequence windows","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/validate_sequence_window.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Validate sequence window alignment — validate_sequence_window","text":"Sequence windows centered modified residue. function validates character center position matches reported modification site. converted uppercase comparison.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/validate_sequence_window.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validate sequence window alignment — validate_sequence_window","text":"","code":"data <- data.frame(   SequenceWindow = c(\"AAASAAAA\", \"BBBSBBB\", \"CCCACCC\"),   modAA = c(\"S\", \"S\", \"S\") ) validate_sequence_window(data) #> [1] SequenceWindow modAA          #> <0 rows> (or 0-length row.names) # Only first two rows kept (center matches S)"}]
