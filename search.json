[{"path":"https://prolfqua.github.io/prophosqua/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"Project-specific instructions Claude Code.","code":""},{"path":"https://prolfqua.github.io/prophosqua/CLAUDE.html","id":"rules","dir":"","previous_headings":"","what":"Rules","title":"CLAUDE.md","text":"modify DESCRIPTION NAMESPACE unless explicitly asked One function, one task! Keep functions minimal focused.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"vignette demonstrates kinase activity inference using Kinase Library motif predictions. Unlike PTMsigDB (uses curated kinase-substrate relationships), Kinase Library predicts kinase-substrate assignments based position-specific scoring matrices (PSSMs) derived peptide library screens. use term2gene.csv file generated scan_motifs_cli.py script, contains kinase-sequence assignments 90th percentile threshold. Approach: GSEA (Gene Set Enrichment Analysis) using ranked phosphosite statistics. analyze DPA (Differential PTM Abundance) DPU (Differential PTM Usage) results.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"load-data-and-kinase-library-predictions","dir":"Articles","previous_headings":"","what":"Load Data and Kinase Library Predictions","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"Example Data Kinase Library Predictions","code":"library(prophosqua) library(clusterProfiler) library(dplyr) library(enrichplot) library(purrr)  example_path <- here::here(\"data\", \"combined_test_diff_example.rds\") example_data <- readRDS(example_path)  data_info <- tibble(   Property = c(\"Rows\", \"Columns\", \"Contrasts\"),   Value = c(nrow(example_data), ncol(example_data),             paste(unique(example_data$contrast), collapse = \", \")) ) knitr::kable(data_info, caption = \"Example Data\") zip_path <- system.file(\"extdata\", \"term2gene.csv.zip\", package = \"prophosqua\") term2gene <- read.csv(unz(zip_path, \"term2gene.csv\"))  kl_info <- tibble(   Property = c(\"Total assignments\", \"Unique kinases\", \"Unique sequences\"),   Value = c(nrow(term2gene), n_distinct(term2gene$term), n_distinct(term2gene$gene)) ) knitr::kable(kl_info, caption = \"Kinase Library Predictions\") # IMPORTANT: Kinase Library sequences have lowercase letters for phosphorylated residues # (e.g., \"PETITIRsGPPSPLP\"). Convert to uppercase to match our data. term2gene <- term2gene |>   mutate(gene = toupper(gene))  # Keep as TERM2GENE format for clusterProfiler GSEA term2gene_df <- term2gene |>   select(term, gene)"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"kinase-substrate-assignment-statistics","dir":"Articles","previous_headings":"","what":"Kinase-Substrate Assignment Statistics","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"Assignment Statistics (90th percentile threshold) Kinase Set Size Distribution","code":"our_sequences <- example_data |>   pull(SequenceWindow) |>   trimws() |>   toupper() |>   unique() assigned_sequences <- unique(term2gene$gene) overlap_seqs <- intersect(our_sequences, assigned_sequences)  assignment_stats <- tibble(   Metric = c(\"Phosphosites in differential analysis\",              \"Sites with kinase assignments\",              \"Sites usable for GSEA\",              \"Coverage (%)\"),   Value = c(length(our_sequences),             length(assigned_sequences),             length(overlap_seqs),             round(100 * length(overlap_seqs) / length(our_sequences), 1)) ) knitr::kable(assignment_stats, caption = \"Assignment Statistics (90th percentile threshold)\") # Calculate kinase set sizes from term2gene kinase_sizes <- term2gene_df |>   count(term, name = \"size\")  kinase_overlap <- term2gene_df |>   filter(gene %in% our_sequences) |>   count(term, name = \"overlap\")  kinase_stats <- tibble(   Metric = c(\"Number of kinases\", \"Mean substrates/kinase\", \"Median substrates/kinase\",              \"Range (min-max)\", \"Mean substrates in our data\",              \"Kinases with >= 15 substrates\"),   Value = c(nrow(kinase_sizes),             round(mean(kinase_sizes$size)),             median(kinase_sizes$size),             paste(min(kinase_sizes$size), \"-\", max(kinase_sizes$size)),             round(mean(kinase_overlap$overlap)),             sum(kinase_overlap$overlap >= 15)) ) knitr::kable(kinase_stats, caption = \"Kinase Set Size Distribution\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"dpa-analysis-differential-ptm-abundance","dir":"Articles","previous_headings":"","what":"DPA Analysis (Differential PTM Abundance)","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"DPA uses raw phosphosite fold changes, include true signaling changes protein abundance effects.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"prepare-dpa-data","dir":"Articles","previous_headings":"DPA Analysis (Differential PTM Abundance)","what":"Prepare DPA Data","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"DPA Ranks Prepared","code":"# Prepare ranked lists using t-statistic # Names must match sequences in term2gene  contrasts <- unique(example_data$contrast)  dpa_ranks <- contrasts |>   set_names() |>   map(function(ct) {     example_data |>       filter(contrast == ct) |>       mutate(seq = toupper(trimws(SequenceWindow))) |>       filter(!is.na(statistic.site)) |>       distinct(seq, .keep_all = TRUE) |>       arrange(desc(statistic.site)) |>       (\\(df) setNames(df$statistic.site, df$seq))()   })  dpa_ranks_info <- tibble(   Contrast = names(dpa_ranks),   Sites = map_int(dpa_ranks, length) ) knitr::kable(dpa_ranks_info, caption = \"DPA Ranks Prepared\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"dpa-gsea","dir":"Articles","previous_headings":"DPA Analysis (Differential PTM Abundance)","what":"DPA: GSEA","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"DPA GSEA Results (FDR < 0.25)","code":"dpa_gsea_results <- names(dpa_ranks) |>   set_names() |>   map(function(ct) {     res <- GSEA(       geneList = dpa_ranks[[ct]],       TERM2GENE = term2gene_df,       minGSSize = 15,       maxGSSize = 5000,       pvalueCutoff = 0.25,       verbose = FALSE     )     if (nrow(res@result) == 0) {       stop(\"No GSEA results for contrast: \", ct,            \". Check minGSSize/maxGSSize parameters.\")     }     res   })  dpa_gsea_info <- tibble(   Contrast = names(dpa_gsea_results),   `Significant Kinases` = map_int(dpa_gsea_results, ~nrow(.x@result)) ) knitr::kable(dpa_gsea_info, caption = \"DPA GSEA Results (FDR < 0.25)\") merged_dpa <- merge_result(dpa_gsea_results) dotplot(merged_dpa, showCategory = 15,         title = \"DPA GSEA - Kinase Library (FDR < 0.25)\") +   ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, hjust = 1)) dpa_plots <- names(dpa_gsea_results) |>   map(function(ct) {     dotplot(dpa_gsea_results[[ct]], showCategory = 15, title = ct) +       ggplot2::theme(axis.text.y = ggplot2::element_text(size = 8))   }) patchwork::wrap_plots(dpa_plots, ncol = 2)"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"dpu-analysis-differential-ptm-usage","dir":"Articles","previous_headings":"","what":"DPU Analysis (Differential PTM Usage)","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"DPU uses protein-normalized phosphosite fold changes, representing true stoichiometry changes independent protein abundance.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"prepare-dpu-data","dir":"Articles","previous_headings":"DPU Analysis (Differential PTM Usage)","what":"Prepare DPU Data","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"DPU Ranks Prepared","code":"dpu_ranks <- contrasts |>   set_names() |>   map(function(ct) {     example_data |>       filter(contrast == ct) |>       mutate(seq = toupper(trimws(SequenceWindow))) |>       filter(!is.na(tstatistic_I)) |>       distinct(seq, .keep_all = TRUE) |>       arrange(desc(tstatistic_I)) |>       (\\(df) setNames(df$tstatistic_I, df$seq))()   })  dpu_ranks_info <- tibble(   Contrast = names(dpu_ranks),   Sites = map_int(dpu_ranks, length) ) knitr::kable(dpu_ranks_info, caption = \"DPU Ranks Prepared\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"dpu-gsea","dir":"Articles","previous_headings":"DPU Analysis (Differential PTM Usage)","what":"DPU: GSEA","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"DPU GSEA Results (FDR < 0.25)","code":"dpu_gsea_results <- names(dpu_ranks) |>   set_names() |>   map(function(ct) {     res <- GSEA(       geneList = dpu_ranks[[ct]],       TERM2GENE = term2gene_df,       minGSSize = 15,       maxGSSize = 5000,       pvalueCutoff = 0.25,       verbose = FALSE     )     if (nrow(res@result) == 0) {       stop(\"No GSEA results for contrast: \", ct,            \". Check minGSSize/maxGSSize parameters.\")     }     res   })  dpu_gsea_info <- tibble(   Contrast = names(dpu_gsea_results),   `Significant Kinases` = map_int(dpu_gsea_results, ~nrow(.x@result)) ) knitr::kable(dpu_gsea_info, caption = \"DPU GSEA Results (FDR < 0.25)\") merged_dpu <- merge_result(dpu_gsea_results) dotplot(merged_dpu, showCategory = 15,         title = \"DPU GSEA - Kinase Library (FDR < 0.25)\") +   ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, hjust = 1)) dpu_plots <- names(dpu_gsea_results) |>   map(function(ct) {     dotplot(dpu_gsea_results[[ct]], showCategory = 15, title = ct) +       ggplot2::theme(axis.text.y = ggplot2::element_text(size = 8))   }) patchwork::wrap_plots(dpu_plots, ncol = 2)"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"diagnostics","dir":"Articles","previous_headings":"","what":"Diagnostics","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"Raw p-value Distribution (DPA) Top 10 Kinases P-value (DPA, KO_vs_WT )","code":"pval_diag <- names(dpa_gsea_results) |>   map_dfr(function(ct) {     res <- dpa_gsea_results[[ct]]@result     tibble(       Contrast = ct,       `Min p-value` = signif(min(res$pvalue), 3),       `p < 0.05` = sum(res$pvalue < 0.05),       `p < 0.01` = sum(res$pvalue < 0.01),       Total = nrow(res)     )   }) knitr::kable(pval_diag, caption = \"Raw p-value Distribution (DPA)\") if (length(dpa_gsea_results) > 0) {   top_res <- dpa_gsea_results[[1]]@result |>     as_tibble() |>     arrange(pvalue) |>     head(10) |>     select(ID, enrichmentScore, NES, pvalue, p.adjust, setSize) |>     mutate(       enrichmentScore = round(enrichmentScore, 3),       NES = round(NES, 3),       pvalue = signif(pvalue, 3),       p.adjust = signif(p.adjust, 3)     )   knitr::kable(top_res,     caption = paste(\"Top 10 Kinases by P-value (DPA,\",                     names(dpa_gsea_results)[1], \")\")) }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"gsea-enrichment-plot-example","dir":"Articles","previous_headings":"Diagnostics","what":"GSEA Enrichment Plot (Example)","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"","code":"# Show single example for illustration (gseaplot2 objects don't combine well) ct <- names(dpa_gsea_results)[1] res <- dpa_gsea_results[[ct]] top_kinase <- res@result |>   as_tibble() |>   arrange(pvalue) |>   slice(1) |>   pull(ID)  row <- res@result |>   as_tibble() |>   filter(ID == top_kinase) nes_val <- round(row$NES, 2) fdr <- signif(row$p.adjust, 2)  gseaplot2(res, geneSetID = top_kinase,   title = paste0(ct, \" - \", top_kinase, \" (NES=\", nes_val, \", FDR=\", fdr, \")\"))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Kinase Library: Kinase Activity Inference from Phosphoproteomics Data","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Tahoe 26.1 ##  ## Matrix products: default ## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: Europe/Zurich ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] purrr_1.2.0            enrichplot_1.30.3      dplyr_1.1.4            ## [4] clusterProfiler_4.18.1 prophosqua_0.2.0       ##  ## loaded via a namespace (and not attached): ##   [1] DBI_1.2.3               gson_0.1.0              rlang_1.1.6             ##   [4] magrittr_2.0.4          DOSE_4.4.0              compiler_4.5.2          ##   [7] RSQLite_2.4.5           png_0.1-8               systemfonts_1.3.1       ##  [10] vctrs_0.6.5             reshape2_1.4.5          stringr_1.6.0           ##  [13] pkgconfig_2.0.3         crayon_1.5.3            fastmap_1.2.0           ##  [16] XVector_0.50.0          labeling_0.4.3          rmarkdown_2.30          ##  [19] ragg_1.5.0              bit_4.6.0               xfun_0.54               ##  [22] ggseqlogo_0.2           cachem_1.1.0            aplot_0.2.9             ##  [25] jsonlite_2.0.0          blob_1.2.4              BiocParallel_1.44.0     ##  [28] parallel_4.5.2          R6_2.6.1                bslib_0.9.0             ##  [31] stringi_1.8.7           RColorBrewer_1.1-3      jquerylib_0.1.4         ##  [34] GOSemSim_2.36.0         Rcpp_1.1.0              Seqinfo_1.0.0           ##  [37] bookdown_0.46           knitr_1.50              ggtangle_0.0.9          ##  [40] R.utils_2.13.0          IRanges_2.44.0          Matrix_1.7-4            ##  [43] splines_4.5.2           igraph_2.2.1            tidyselect_1.2.1        ##  [46] qvalue_2.42.0           yaml_2.3.11             codetools_0.2-20        ##  [49] lattice_0.22-7          tibble_3.3.0            plyr_1.8.9              ##  [52] withr_3.0.2             Biobase_2.70.0          treeio_1.34.0           ##  [55] KEGGREST_1.50.0         S7_0.2.1                evaluate_1.0.5          ##  [58] gridGraphics_0.5-1      desc_1.4.3              Biostrings_2.78.0       ##  [61] pillar_1.11.1           ggtree_4.0.1            stats4_4.5.2            ##  [64] ggfun_0.2.0             generics_0.1.4          rprojroot_2.1.1         ##  [67] S4Vectors_0.48.0        ggplot2_4.0.1           scales_1.4.0            ##  [70] tidytree_0.4.6          glue_1.8.0              gdtools_0.4.4           ##  [73] lazyeval_0.2.2          tools_4.5.2             data.table_1.17.8       ##  [76] fgsea_1.36.0            ggiraph_0.9.2           fs_1.6.6                ##  [79] fastmatch_1.1-6         cowplot_1.2.0           grid_4.5.2              ##  [82] tidyr_1.3.1             ape_5.8-1               AnnotationDbi_1.72.0    ##  [85] nlme_3.1-168            patchwork_1.3.2         cli_3.6.5               ##  [88] rappdirs_0.3.3          textshaping_1.0.4       fontBitstreamVera_0.1.1 ##  [91] gtable_0.3.6            R.methodsS3_1.8.2       yulab.utils_0.2.2       ##  [94] sass_0.4.10             digest_0.6.39           fontquiver_0.2.1        ##  [97] BiocGenerics_0.56.0     ggrepel_0.9.6           ggplotify_0.1.3         ## [100] htmlwidgets_1.6.4       farver_2.1.2            memoise_2.0.1           ## [103] htmltools_0.5.9         pkgdown_2.2.0           R.oo_1.27.1             ## [106] lifecycle_1.0.4         here_1.0.2              httr_1.4.7              ## [109] GO.db_3.22.0            fontLiberation_0.1.0    bit64_4.6.0-1"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_Motif_Enrichment.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Motif-Based Enrichment Analysis: Kinase Activity Inference","text":"PTM-SEA relies curated databases like PTMsigDB, many phosphosites map known substrates. Motif-based analysis provides complementary approach scanning sequence context observed phosphosites known kinase consensus motifs (e.g., matching R-x-x-S/T pattern Basophilic kinases). vignette demonstrates : 1. Load database kinase regex motifs. 2. Scan phosphoproteomics sequence windows matches. 3. Perform GSEA identify enriched kinase motifs contrasts.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_Motif_Enrichment.html","id":"load-data","dir":"Articles","previous_headings":"","what":"Load Data","title":"Motif-Based Enrichment Analysis: Kinase Activity Inference","text":"Example Data","code":"library(prophosqua) library(clusterProfiler) library(dplyr) library(enrichplot) library(fgsea) library(purrr)  # Load example data (same as PTM-SEA vignette) example_path <- here::here(\"data\", \"combined_test_diff_example.rds\") example_data <- readRDS(example_path)  data_info <- tibble(   Property = c(\"Rows\", \"Columns\", \"Contrasts\"),   Value = c(nrow(example_data), ncol(example_data),             paste(unique(example_data$contrast), collapse = \", \")) ) knitr::kable(data_info, caption = \"Example Data\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_Motif_Enrichment.html","id":"load-and-define-motifs","dir":"Articles","previous_headings":"","what":"Load and Define Motifs","title":"Motif-Based Enrichment Analysis: Kinase Activity Inference","text":"use get_kinase_motifs() retrieve default set consensus patterns (e.g., literature/Scansite/ELM). can also add . Kinase Motifs ( 17 total)","code":"# Load kinase motifs (internal database + optional user extensions) motif_db <- get_kinase_motifs()  # Example of adding a custom motif my_motif <- data.frame(   kinase_group = \"Custom\",   motif_name = \"MySpecialKinase\",   pattern = \"R..S..[DE]\",   description = \"Custom motif\",   stringsAsFactors = FALSE ) motif_db <- get_kinase_motifs(extra_motifs = my_motif)  knitr::kable(head(motif_db), caption = paste(\"Kinase Motifs (\", nrow(motif_db), \"total)\"))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_Motif_Enrichment.html","id":"motif-scanning","dir":"Articles","previous_headings":"","what":"Motif Scanning","title":"Motif-Based Enrichment Analysis: Kinase Activity Inference","text":"Instead relying exact PTMsigDB matches (often low overlap), scan observed sequence windows kinase motifs. Scanning Results Top 10 Motifs Match Count result motif_matches matches TERM2GENE format required clusterProfiler: - term: motif/kinase name. - gene: site ID (Sequence + “-p”).","code":"# Get unique sequences from our data # Ensure we use 15-mers if possible, or whatever length is appropriate. # Default scanning assumes the central residue (pos 8) is the phosphosite. our_sequences <- unique(toupper(trimws(example_data$SequenceWindow)))  # Scan for motifs # center_pos = 8 ensures we only count matches where the motif overlaps the actual phosphosite motif_matches <- scan_motifs(our_sequences, motif_db = motif_db, center_pos = 8)  scan_info <- tibble(   Metric = c(\"Total matches\", \"Unique sites\"),   Value = c(nrow(motif_matches), length(unique(motif_matches$gene))) ) knitr::kable(scan_info, caption = \"Scanning Results\") # Top motifs top_motifs <- motif_matches |>   count(term, name = \"Count\") |>   arrange(desc(Count)) |>   head(10) |>   rename(Motif = term) knitr::kable(top_motifs, caption = \"Top 10 Motifs by Match Count\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_Motif_Enrichment.html","id":"prepare-data-dpadpu","dir":"Articles","previous_headings":"","what":"Prepare Data (DPA/DPU)","title":"Motif-Based Enrichment Analysis: Kinase Activity Inference","text":"prepare data ranking just like standard PTM-SEA.","code":"# Prepare DPA data (Differential PTM Abundance) prep_dpa <- ptmsea_data_prep(   data = example_data,   stat_column = \"statistic.site\",   seq_window_col = \"SequenceWindow\",   contrast_col = \"contrast\",   trim_to = \"15\" )  # Prepare DPU data (Differential PTM Usage - protein normalized) prep_dpu <- ptmsea_data_prep(   data = example_data,   stat_column = \"tstatistic_I\",   seq_window_col = \"SequenceWindow\",   contrast_col = \"contrast\",   trim_to = \"15\" )  print(names(prep_dpu)) ## [1] \"ranks\"   \"dropped\""},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_Motif_Enrichment.html","id":"run-motif-gsea","dir":"Articles","previous_headings":"","what":"Run Motif GSEA","title":"Motif-Based Enrichment Analysis: Kinase Activity Inference","text":"use run_motif_gsea perform enrichment analysis. Significant Motif Sets (DPA)","code":"# Run GSEA using the scanned motif sets results_motif_dpa <- run_motif_gsea(   ranks_list = prep_dpa$ranks,   motif_term2gene = motif_matches, # generated by scan_motifs   pvalueCutoff = 1.0, # Return ALL results for visualization   min_size = 3,   max_size = 5000 # Allow large motif sets (critical!) )  gsea_summary <- names(results_motif_dpa) |>   map_dfr(function(name) {     res <- results_motif_dpa[[name]]     if (!is.null(res)) {       tibble(         Contrast = name,         `Significant (p < 0.1)` = sum(res@result$p.adjust < 0.1)       )     }   }) knitr::kable(gsea_summary, caption = \"Significant Motif Sets (DPA)\")"},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_Motif_Enrichment.html","id":"dotplot-of-significant-motifs","dir":"Articles","previous_headings":"Visualize Results","what":"Dotplot of Significant Motifs","title":"Motif-Based Enrichment Analysis: Kinase Activity Inference","text":"","code":"# Define significance threshold sig_threshold <- 0.1  if (length(results_motif_dpa) > 0) {   # Filter out null results   valid_res <- results_motif_dpa[!sapply(results_motif_dpa, is.null)]    if (length(valid_res) > 0) {     # Merge results across contrasts     merged_res <- merge_result(valid_res)      # Check if there are any significant results     has_significant <- any(merged_res@compareClusterResult$p.adjust < sig_threshold)      if (has_significant) {       # Dotplot showing significant motifs       p <- enrichplot::dotplot(merged_res, showCategory = 15) +         ggplot2::labs(title = \"Kinase Motif Enrichment (DPA)\",                       subtitle = paste(\"Showing motifs with p.adjust <\", sig_threshold)) +         ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, hjust = 1))       print(p)     }   } }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_Motif_Enrichment.html","id":"gsea-plot-example","dir":"Articles","previous_headings":"Visualize Results","what":"GSEA Plot (Example)","title":"Motif-Based Enrichment Analysis: Kinase Activity Inference","text":"","code":"# Show single example for illustration (gseaplot2 objects don't combine well) contrast_name <- names(results_motif_dpa)[1] res <- results_motif_dpa[[contrast_name]]  if (!is.null(res) && nrow(res@result) > 0) {   top_motif <- res@result |>     as_tibble() |>     arrange(pvalue) |>     slice(1)    nes <- round(top_motif$NES, 3)   padj <- signif(top_motif$p.adjust, 3)    enrichplot::gseaplot2(     res,     geneSetID = top_motif$ID,     title = paste0(contrast_name, \" - \", top_motif$ID,                    \" (NES=\", nes, \", p.adj=\", padj, \")\")   ) }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_Motif_Enrichment.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Motif-Based Enrichment Analysis: Kinase Activity Inference","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Tahoe 26.1 ##  ## Matrix products: default ## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: Europe/Zurich ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] purrr_1.2.0            fgsea_1.36.0           enrichplot_1.30.3      ## [4] dplyr_1.1.4            clusterProfiler_4.18.1 prophosqua_0.2.0       ##  ## loaded via a namespace (and not attached): ##   [1] DBI_1.2.3               gson_0.1.0              rlang_1.1.6             ##   [4] magrittr_2.0.4          DOSE_4.4.0              compiler_4.5.2          ##   [7] RSQLite_2.4.5           png_0.1-8               systemfonts_1.3.1       ##  [10] vctrs_0.6.5             reshape2_1.4.5          stringr_1.6.0           ##  [13] pkgconfig_2.0.3         crayon_1.5.3            fastmap_1.2.0           ##  [16] XVector_0.50.0          labeling_0.4.3          rmarkdown_2.30          ##  [19] ragg_1.5.0              bit_4.6.0               xfun_0.54               ##  [22] ggseqlogo_0.2           cachem_1.1.0            aplot_0.2.9             ##  [25] jsonlite_2.0.0          blob_1.2.4              BiocParallel_1.44.0     ##  [28] parallel_4.5.2          R6_2.6.1                bslib_0.9.0             ##  [31] stringi_1.8.7           RColorBrewer_1.1-3      jquerylib_0.1.4         ##  [34] GOSemSim_2.36.0         Rcpp_1.1.0              Seqinfo_1.0.0           ##  [37] bookdown_0.46           knitr_1.50              ggtangle_0.0.9          ##  [40] R.utils_2.13.0          IRanges_2.44.0          Matrix_1.7-4            ##  [43] splines_4.5.2           igraph_2.2.1            tidyselect_1.2.1        ##  [46] qvalue_2.42.0           yaml_2.3.11             codetools_0.2-20        ##  [49] lattice_0.22-7          tibble_3.3.0            plyr_1.8.9              ##  [52] withr_3.0.2             Biobase_2.70.0          treeio_1.34.0           ##  [55] KEGGREST_1.50.0         S7_0.2.1                evaluate_1.0.5          ##  [58] gridGraphics_0.5-1      desc_1.4.3              Biostrings_2.78.0       ##  [61] pillar_1.11.1           ggtree_4.0.1            stats4_4.5.2            ##  [64] ggfun_0.2.0             generics_0.1.4          rprojroot_2.1.1         ##  [67] S4Vectors_0.48.0        ggplot2_4.0.1           scales_1.4.0            ##  [70] tidytree_0.4.6          glue_1.8.0              gdtools_0.4.4           ##  [73] lazyeval_0.2.2          tools_4.5.2             data.table_1.17.8       ##  [76] ggiraph_0.9.2           fs_1.6.6                fastmatch_1.1-6         ##  [79] cowplot_1.2.0           grid_4.5.2              tidyr_1.3.1             ##  [82] ape_5.8-1               AnnotationDbi_1.72.0    nlme_3.1-168            ##  [85] patchwork_1.3.2         cli_3.6.5               rappdirs_0.3.3          ##  [88] textshaping_1.0.4       fontBitstreamVera_0.1.1 gtable_0.3.6            ##  [91] R.methodsS3_1.8.2       yulab.utils_0.2.2       sass_0.4.10             ##  [94] digest_0.6.39           fontquiver_0.2.1        BiocGenerics_0.56.0     ##  [97] ggrepel_0.9.6           ggplotify_0.1.3         htmlwidgets_1.6.4       ## [100] farver_2.1.2            memoise_2.0.1           htmltools_0.5.9         ## [103] pkgdown_2.2.0           R.oo_1.27.1             lifecycle_1.0.4         ## [106] here_1.0.2              httr_1.4.7              GO.db_3.22.0            ## [109] fontLiberation_0.1.0    bit64_4.6.0-1"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"PTM-SEA (Post-Translational Modification Signature Enrichment Analysis) uses curated phosphosite signatures PTMsigDB infer kinase activities phosphoproteomics data. vignette demonstrates three approaches: GSEA without direction - ignores ;u/;d suffixes PTMsigDB GSEA direction - splits pathways _up _down sets ORA direction - -representation analysis significant sites analyze DPA (Differential PTM Abundance) DPU (Differential PTM Usage) results.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"load-data-and-ptmsigdb","dir":"Articles","previous_headings":"","what":"Load Data and PTMsigDB","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"Example Data","code":"library(prophosqua) library(clusterProfiler) library(dplyr) library(enrichplot) library(fgsea) library(purrr)  # Load example data example_path <- here::here(\"data\", \"combined_test_diff_example.rds\") example_data <- readRDS(example_path)  data_info <- tibble(   Property = c(\"Rows\", \"Columns\", \"Contrasts\"),   Value = c(nrow(example_data), ncol(example_data),             paste(unique(example_data$contrast), collapse = \", \")) ) knitr::kable(data_info, caption = \"Example Data\") # Download PTMsigDB signatures gmt_path <- download_ptmsigdb(species = \"mouse\", output_dir = tempdir()) pathways_raw <- fgsea::gmtPathways(gmt_path)  # Trim pathways to 11-mer (default) to increase overlap with our data pathways <- trim_ptmsigdb_pathways(pathways_raw, trim_to = \"11\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"overlap-statistics","dir":"Articles","previous_headings":"","what":"Overlap Statistics","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"Understanding overlap data PTMsigDB crucial interpreting results. Overlap Statistics (11-mer) low overlap expected : PTMsigDB contains curated kinase-substrate relationships (~1,700 unique sites) phosphoproteomics data measures ~20,000+ sites measured sites known kinase annotation","code":"# Our data: unique flanking sequences (trimmed to 11-mer to match pathways) our_sequences <- example_data |>   pull(SequenceWindow) |>   trimws() |>   toupper() |>   unique() our_sequences_trimmed <- our_sequences |>   map_chr(~prophosqua:::trim_flanking_seq(.x, trim_to = 11L)) our_site_ids <- paste0(our_sequences_trimmed, \"-p\") n_our_sites <- n_distinct(our_site_ids)  # PTMsigDB: unique site IDs (strip ;u/;d for comparison) ptmsigdb_ids_raw <- pathways |>   unlist() |>   unique() ptmsigdb_ids_stripped <- ptmsigdb_ids_raw |>   gsub(\";[ud]$\", \"\", x = _) |>   unique() n_ptmsigdb_sites <- length(ptmsigdb_ids_stripped)  # Overlap overlap_ids <- intersect(unique(our_site_ids), ptmsigdb_ids_stripped) n_overlap <- length(overlap_ids)  overlap_stats <- tibble(   Metric = c(\"Our data (unique sequences)\", \"PTMsigDB (unique site IDs)\", \"Overlap\",              \"% of our sites\", \"% of PTMsigDB sites\"),   Value = c(n_our_sites, n_ptmsigdb_sites, n_overlap,             round(100 * n_overlap / n_our_sites, 2),             round(100 * n_overlap / n_ptmsigdb_sites, 2)) ) knitr::kable(overlap_stats, caption = \"Overlap Statistics (11-mer)\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"dpa-analysis-differential-ptm-abundance","dir":"Articles","previous_headings":"","what":"DPA Analysis (Differential PTM Abundance)","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"DPA uses raw phosphosite fold changes, include true signaling changes protein abundance effects.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"prepare-dpa-data","dir":"Articles","previous_headings":"DPA Analysis (Differential PTM Abundance)","what":"Prepare DPA Data","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"DPA Contrasts Prepared","code":"# Use t-statistic for ranking prep_dpa <- ptmsea_data_prep(   data = example_data,   stat_column = \"statistic.site\",   seq_window_col = \"SequenceWindow\",   contrast_col = \"contrast\" )  dpa_prep_info <- tibble(   Contrast = names(prep_dpa$ranks),   Sites = map_int(prep_dpa$ranks, length) ) knitr::kable(dpa_prep_info, caption = \"DPA Contrasts Prepared\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"dpa-gsea-without-direction","dir":"Articles","previous_headings":"DPA Analysis (Differential PTM Abundance)","what":"DPA: GSEA without Direction","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"Standard GSEA ignoring ;u/;d direction suffixes PTMsigDB. DPA GSEA (direction) Results","code":"results_dpa_nodir <- run_ptmsea(   ranks_list = prep_dpa$ranks,   pathways = pathways,   min_size = 3,   max_size = 500,   n_perm = 1000,   pvalueCutoff = 0.1 )  dpa_nodir_info <- tibble(   Contrast = names(results_dpa_nodir),   `Significant (FDR < 0.1)` = map_int(results_dpa_nodir, ~nrow(.x@result)) ) knitr::kable(dpa_nodir_info, caption = \"DPA GSEA (no direction) Results\") merged_dpa_nodir <- merge_result(results_dpa_nodir) dotplot(merged_dpa_nodir, showCategory = 10,         title = \"DPA GSEA (no direction) - Significant (FDR < 0.1)\") +   ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, hjust = 1))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"dpa-gsea-with-direction","dir":"Articles","previous_headings":"DPA Analysis (Differential PTM Abundance)","what":"DPA: GSEA with Direction","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"Splits pathways _up _down sets, runs ascending descending. DPA GSEA (direction) Results","code":"results_dpa_dir <- run_ptmsea_up_down(   ranks_list = prep_dpa$ranks,   pathways = pathways,   min_size = 3,   max_size = 500,   n_perm = 1000,   pvalueCutoff = 0.1 )  dpa_dir_info <- tibble(   Contrast = names(results_dpa_dir),   `Significant (FDR < 0.1)` = map_int(results_dpa_dir, ~nrow(.x@result)) ) knitr::kable(dpa_dir_info, caption = \"DPA GSEA (with direction) Results\") merged_dpa_dir <- merge_result(results_dpa_dir) dotplot(merged_dpa_dir, showCategory = 10,         title = \"DPA GSEA (with direction) - Significant (FDR < 0.1)\") +   ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, hjust = 1))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"dpu-analysis-differential-ptm-usage","dir":"Articles","previous_headings":"","what":"DPU Analysis (Differential PTM Usage)","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"DPU uses protein-normalized phosphosite fold changes, representing true stoichiometry changes independent protein abundance.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"prepare-dpu-data","dir":"Articles","previous_headings":"DPU Analysis (Differential PTM Usage)","what":"Prepare DPU Data","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"DPU Contrasts Prepared","code":"# Use t-statistic for DPU ranking prep_dpu <- ptmsea_data_prep(   data = example_data,   stat_column = \"tstatistic_I\",   seq_window_col = \"SequenceWindow\",   contrast_col = \"contrast\" )  dpu_prep_info <- tibble(   Contrast = names(prep_dpu$ranks),   Sites = map_int(prep_dpu$ranks, length) ) knitr::kable(dpu_prep_info, caption = \"DPU Contrasts Prepared\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"dpu-gsea-without-direction","dir":"Articles","previous_headings":"DPU Analysis (Differential PTM Usage)","what":"DPU: GSEA without Direction","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"DPU GSEA (direction) Results","code":"results_dpu_nodir <- run_ptmsea(   ranks_list = prep_dpu$ranks,   pathways = pathways,   min_size = 3,   max_size = 500,   n_perm = 1000,   pvalueCutoff = 0.1 )  dpu_nodir_info <- tibble(   Contrast = names(results_dpu_nodir),   `Significant (FDR < 0.1)` = map_int(results_dpu_nodir, ~nrow(.x@result)) ) knitr::kable(dpu_nodir_info, caption = \"DPU GSEA (no direction) Results\") merged_dpu_nodir <- merge_result(results_dpu_nodir) dotplot(merged_dpu_nodir, showCategory = 10,         title = \"DPU GSEA (no direction) - Significant (FDR < 0.1)\") +   ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, hjust = 1))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"dpu-gsea-with-direction","dir":"Articles","previous_headings":"DPU Analysis (Differential PTM Usage)","what":"DPU: GSEA with Direction","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"DPU GSEA (direction) Results","code":"results_dpu_dir <- run_ptmsea_up_down(   ranks_list = prep_dpu$ranks,   pathways = pathways,   min_size = 3,   max_size = 500,   n_perm = 1000,   pvalueCutoff = 0.1 )  dpu_dir_info <- tibble(   Contrast = names(results_dpu_dir),   `Significant (FDR < 0.1)` = map_int(results_dpu_dir, ~nrow(.x@result)) ) knitr::kable(dpu_dir_info, caption = \"DPU GSEA (with direction) Results\") merged_dpu_dir <- merge_result(results_dpu_dir) dotplot(merged_dpu_dir, showCategory = 10,         title = \"DPU GSEA (with direction) - Significant (FDR < 0.1)\") +   ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, hjust = 1))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"dpu-ora-with-direction","dir":"Articles","previous_headings":"DPU Analysis (Differential PTM Usage)","what":"DPU: ORA with Direction","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"-representation analysis significant sites contrasts. fc_col provided, sites split -regulated -regulated sets separate ORA tests. ORA Preparation Summary","code":"# Convert pathways to TERM2GENE format and strip direction suffixes term2gene <- ptmsigdb_to_term2gene(pathways) |>   mutate(gene = gsub(\";[ud]$\", \"\", gene))  # Get all PTMsigDB site IDs (stripped, without ;u/;d) ptmsigdb_sites <- unique(term2gene$gene)  # Run ORA for each contrast (up and down separately) contrasts <- unique(example_data$contrast)  ora_prep_list <- contrasts |>   set_names() |>   map(function(contrast_name) {     contrast_data <- example_data |>       filter(contrast == contrast_name)      prep_ora <- ptmsea_ora_prep(       data = contrast_data,       ptmsigdb_sites = ptmsigdb_sites,       score_col = \"FDR_I\",       fc_col = \"diff_diff\",       threshold = 0.1     )      tibble(       Contrast = contrast_name,       Up = length(prep_ora$enriched_up),       Down = length(prep_ora$enriched_down),       Background = length(prep_ora$background)     )   }) |>   bind_rows()  ora_results <- contrasts |>   map(function(contrast_name) {     contrast_data <- example_data |>       filter(contrast == contrast_name)      prep_ora <- ptmsea_ora_prep(       data = contrast_data,       ptmsigdb_sites = ptmsigdb_sites,       score_col = \"FDR_I\",       fc_col = \"diff_diff\",       threshold = 0.1     )      results <- list()      # ORA for up-regulated sites     if (length(prep_ora$enriched_up) > 0) {       ora_up <- enricher(         gene = prep_ora$enriched_up,         universe = prep_ora$background,         TERM2GENE = term2gene,         pvalueCutoff = 0.1       )       if (!is.null(ora_up) && nrow(ora_up@result) > 0) {         results[[paste0(contrast_name, \"_up\")]] <- ora_up       }     }      # ORA for down-regulated sites     if (length(prep_ora$enriched_down) > 0) {       ora_down <- enricher(         gene = prep_ora$enriched_down,         universe = prep_ora$background,         TERM2GENE = term2gene,         pvalueCutoff = 0.1       )       if (!is.null(ora_down) && nrow(ora_down@result) > 0) {         results[[paste0(contrast_name, \"_down\")]] <- ora_down       }     }      results   }) |>   list_flatten()  knitr::kable(ora_prep_list, caption = \"ORA Preparation Summary\") if (length(ora_results) > 0) {   merged_ora <- merge_result(ora_results)   if (nrow(merged_ora@compareClusterResult) > 0) {     print(dotplot(merged_ora, showCategory = 10,             title = \"DPU ORA (up/down separate) - Significant (FDR < 0.1)\") +       ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, hjust = 1)))   } }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"interpretation","dir":"Articles","previous_headings":"","what":"Interpretation","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"DPA results show kinase activity changes including protein abundance effects DPU results show kinase activity changes independent protein abundance Kinases appearing significant DPU DPA represent genuine signaling changes. Kinases appearing DPA DPU may driven protein abundance changes.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"PTM-SEA: Kinase Activity Inference from Phosphoproteomics Data","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Tahoe 26.1 ##  ## Matrix products: default ## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: Europe/Zurich ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] purrr_1.2.0            fgsea_1.36.0           enrichplot_1.30.3      ## [4] dplyr_1.1.4            clusterProfiler_4.18.1 prophosqua_0.2.0       ##  ## loaded via a namespace (and not attached): ##   [1] DBI_1.2.3               gson_0.1.0              rlang_1.1.6             ##   [4] magrittr_2.0.4          DOSE_4.4.0              compiler_4.5.2          ##   [7] RSQLite_2.4.5           png_0.1-8               systemfonts_1.3.1       ##  [10] vctrs_0.6.5             reshape2_1.4.5          stringr_1.6.0           ##  [13] pkgconfig_2.0.3         crayon_1.5.3            fastmap_1.2.0           ##  [16] XVector_0.50.0          labeling_0.4.3          rmarkdown_2.30          ##  [19] ragg_1.5.0              bit_4.6.0               xfun_0.54               ##  [22] ggseqlogo_0.2           cachem_1.1.0            aplot_0.2.9             ##  [25] jsonlite_2.0.0          blob_1.2.4              BiocParallel_1.44.0     ##  [28] parallel_4.5.2          R6_2.6.1                bslib_0.9.0             ##  [31] stringi_1.8.7           RColorBrewer_1.1-3      jquerylib_0.1.4         ##  [34] GOSemSim_2.36.0         Rcpp_1.1.0              Seqinfo_1.0.0           ##  [37] bookdown_0.46           knitr_1.50              ggtangle_0.0.9          ##  [40] R.utils_2.13.0          IRanges_2.44.0          Matrix_1.7-4            ##  [43] splines_4.5.2           igraph_2.2.1            tidyselect_1.2.1        ##  [46] qvalue_2.42.0           yaml_2.3.11             codetools_0.2-20        ##  [49] lattice_0.22-7          tibble_3.3.0            plyr_1.8.9              ##  [52] withr_3.0.2             Biobase_2.70.0          treeio_1.34.0           ##  [55] KEGGREST_1.50.0         S7_0.2.1                evaluate_1.0.5          ##  [58] gridGraphics_0.5-1      desc_1.4.3              Biostrings_2.78.0       ##  [61] pillar_1.11.1           ggtree_4.0.1            stats4_4.5.2            ##  [64] ggfun_0.2.0             generics_0.1.4          rprojroot_2.1.1         ##  [67] S4Vectors_0.48.0        ggplot2_4.0.1           scales_1.4.0            ##  [70] tidytree_0.4.6          glue_1.8.0              gdtools_0.4.4           ##  [73] lazyeval_0.2.2          tools_4.5.2             data.table_1.17.8       ##  [76] ggiraph_0.9.2           fs_1.6.6                fastmatch_1.1-6         ##  [79] cowplot_1.2.0           grid_4.5.2              tidyr_1.3.1             ##  [82] ape_5.8-1               AnnotationDbi_1.72.0    nlme_3.1-168            ##  [85] patchwork_1.3.2         cli_3.6.5               rappdirs_0.3.3          ##  [88] textshaping_1.0.4       fontBitstreamVera_0.1.1 gtable_0.3.6            ##  [91] R.methodsS3_1.8.2       yulab.utils_0.2.2       sass_0.4.10             ##  [94] digest_0.6.39           fontquiver_0.2.1        BiocGenerics_0.56.0     ##  [97] ggrepel_0.9.6           ggplotify_0.1.3         htmlwidgets_1.6.4       ## [100] farver_2.1.2            memoise_2.0.1           htmltools_0.5.9         ## [103] pkgdown_2.2.0           R.oo_1.27.1             lifecycle_1.0.4         ## [106] here_1.0.2              httr_1.4.7              GO.db_3.22.0            ## [109] fontLiberation_0.1.0    bit64_4.6.0-1"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"configuration","dir":"Articles","previous_headings":"","what":"Configuration","title":"FragPipe TMT QC","text":"section shows key parameters used QC analysis. report can parameterized analyze different datasets providing custom file paths identifiers. project information QC use first psm file.","code":"using : ptm_example-main/qc_example_data/QCmini/psm.tsv"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"fasta-database-summary","dir":"Articles","previous_headings":"","what":"FASTA Database Summary","title":"FragPipe TMT QC","text":"FASTA database contains protein sequences used peptide identification. Understanding composition search database crucial interpreting identification results assessing potential biases. Key metrics evaluate: Human: ~20,000 proteins Mouse: ~22,000 proteins Yeast: ~6,000 proteins E. coli: ~4,400 proteins Arabidopsis: ~27,000 protein coding genes, ~35,000 proteins Decoy sequences: Reverse sequences (REV_) used estimate false discovery rates Amino acid composition: reflect expected composition sample organism FASTA database 55907 sequences including decoys, 27953 without decoys. amino acid frequency distribution shows composition search database, consistent expected proteome composition.","code":"nr sequences:  27953  length summary:     Min. 1st Qu.  Median    Mean 3rd Qu.    Max.      5.0   198.0   348.0   404.8   520.0  5400.0  AA frequencies:       [,1]  A  712383  B       5  C  213335  D  608123  E  760476  F  484702  G  730135  H  256377  I  601507  K  720098  L 1078566  M  277709  N  498002  P  543057  Q  395258  R  609817  S 1031163  T  577392  V  754323  W  140645  X      15  Y  321973  Z       3"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"data-processing-overview","dir":"Articles","previous_headings":"","what":"Data Processing Overview","title":"FragPipe TMT QC","text":"analysis processes peptide-spectrum matches (PSMs) FragPipe specific quality filters ensure reliable quantification. Quality filters applied: Peptide Prophet probability > 0.9: Ensures high confidence identifications Abundance threshold > 0: Removes PSMs without quantitative information Purity threshold = 0: isolation purity filtering (PSMs included) analysis using PSM (Spectra) reported psm.tsv file peptide prophet probability greater 0.90.9, abundance value channels greater 00. filtering enabled. reduces number PSM 5436 5275. reduction PSM count reflects stringency quality filters. typical reduction 1-10%\\% expected indicates proper quality control.","code":"Rows: 5436 Columns: 55 ── Column specification ──────────────────────────────────────────────────────── Delimiter: \"\\t\" chr (14): Spectrum, Spectrum File, Peptide, Modified Peptide, Prev AA, Next ... dbl (38): Peptide Length, Charge, Retention, Observed Mass, Calibrated Obser... lgl  (3): Observed Modifications, Is Unique, Quan Usage  ℹ Use `spec()` to retrieve the full column specification for this data. ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. Rows: 5436 Columns: 55 ── Column specification ──────────────────────────────────────────────────────── Delimiter: \"\\t\" chr (14): Spectrum, Spectrum File, Peptide, Modified Peptide, Prev AA, Next ... dbl (38): Peptide Length, Charge, Retention, Observed Mass, Calibrated Obser... lgl  (3): Observed Modifications, Is Unique, Quan Usage  ℹ Use `spec()` to retrieve the full column specification for this data. ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. INFO [2025-12-14 21:01:32] get_annot : ptm_example-main/qc_example_data/fgcz_3702_UP000006548_AraUniprot_1spg_d_20231024.fasta INFO [2025-12-14 21:01:33] get_annot : finished reading INFO [2025-12-14 21:01:34] get_annot : extract headers INFO [2025-12-14 21:01:34] get_annot : all seq : 55907 INFO [2025-12-14 21:01:34] removing decoy sequences usin patter : ^REV_|^rev_ INFO [2025-12-14 21:01:34] get_annot nr seq after decoy removal: 27954 INFO [2025-12-14 21:01:34] get_annot : isUniprot : TRUE INFO [2025-12-14 21:01:34] get_annot : extracted gene names INFO [2025-12-14 21:01:34] get_annot : protein length INFO [2025-12-14 21:01:35] get_annot : nr of tryptic peptides per protein computed. Warning in prolfquapp::dataset_protein_annot(psm, c(protein_Id = \"Protein\"), : deprecated! use build_protein_annot uniprot database : TRUE Warning: Expected 2 pieces. Missing pieces filled with `NA` in 20 rows [54, 59, 92, 99, 178, 287, 288, 307, 357, 379, 475, 476, 554, 611, 754, 892, 893, 940, 967, 1021]. creating sampleName from fileName column Warning in prolfqua::setup_analysis(psm, config): no isotopeLabel column specified in the data, adding column isotopeLabel automatically and setting to 'light'. Warning in prolfqua::setup_analysis(psm, config): no nr_children column specified in the data, adding column nr_children and setting to 1. completing cases completing cases done setup done"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"identification-summary","dir":"Articles","previous_headings":"","what":"Identification Summary","title":"FragPipe TMT QC","text":"metrics provide overview depth breadth proteomic analysis. Higher numbers generally indicate better sample preparation instrument performance. Understanding hierarchy: Proteins: Unique protein groups identified Peptides: Unique peptide sequences (without modifications) Peptidoforms: Unique peptides specific modifications Precursors: Unique peptide-charge state combinations PSMs: Total peptide-spectrum matches Table: Nr proteins, peptides, peptidoforms, precursors, spectrum peptide matches overall. ratio levels can indicate data quality: PSMs/Peptides ratio: Higher ratios suggest good reproducibility Peptidoforms/Peptides ratio: Indicates extent post-translational modifications Peptides/Proteins ratio: Reflects proteolytic efficiency peptide diversity  Figure: Number proteins, peptides, peptidoforms, ions precursor per channel. plot shows identification counts across different TMT channels. Ideally, channels show similar identification numbers, indicating consistent sample preparation labeling efficiency. Table: Nr proteins, peptides, peptidoforms, precursors, spectrum peptide matches per channel. Quality indicators: Consistent counts across channels: Good sample preparation Large variations: May indicate labeling issues sample degradation Outlier channels: investigated technical problems","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"modifications-summary","dir":"Articles","previous_headings":"","what":"Modifications Summary","title":"FragPipe TMT QC","text":"Post-translational modifications (PTMs) chemical modifications provide insights sample treatment biological state. TMT labeling introduces specific modifications monitored labeling efficiency. Key modifications monitor: TMT labels: N-term(229.1629), K(229.1629) TMT10plex Oxidation: M(15.9949) - common artifact Carbamylation: N-term/K modifications urea treatment Number type modifications observed data.  Number type modification observed data. modification landscape reflects intentional chemical treatments (TMT labeling) unintentional modifications (oxidation, deamidation). High numbers TMT modifications indicate successful labeling.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"labelling-efficiency","dir":"Articles","previous_headings":"","what":"Labelling Efficiency","title":"FragPipe TMT QC","text":"TMT labeling efficiency critical accurate quantification. Incomplete labeling leads quantitative errors reduced dynamic range. Monitoring labeling efficiency: N-terminal labeling: approach 100% peptides Lysine labeling: >95% high-quality samples Unlabeled peptides: May co-elute interfere quantification N-terminal labeling efficiency typically high (>95%) ’s kinetically favored. Total number peptides : 3947 Number peptides modified N-term : 3904 Percent peptides modified N-term: 99 % Expected range: 95-100%. Values 95% may indicate: Suboptimal labeling conditions Sample degradation Buffer incompatibility Total number PSMs : 5275 Number PSMs modified N-term : 5227 Percent PSMs modified N-term: 99 % PSM-level statistics weight peptides identification frequency, providing insight abundant species sample. Lysine labeling challenging N-terminal labeling sensitive reaction conditions. Total number peptides Lysine: 2339 Number peptides modified Lysine residues : 2339 Percent peptides modified Lysine residues: 100 % Expected range: 95-99%. Lower values may indicate: Insufficient reagent concentration Competing reactions (e.g., formaldehyde crosslinking) pH optimization needed Total number PSMs Lysine: 3200 Number PSMs modified Lysine residues : 3200 Percent PSMs modified Lysine residues: 100 % Total number Lysine residues: 2344 Number modified Lysine residues : 2339 Percent modified Lysine residues: 100 % Total number Lysine residues: 3205 Number modified Lysine residues : 3200 Percent modified Lysine residues taking number PSMs account: 100 %","code":"Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"modSeq\"` instead of `.data$modSeq` Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"n\"` instead of `.data$n` Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"n1\"` instead of `.data$n1`"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"n-term","dir":"Articles","previous_headings":"","what":"N-term","title":"FragPipe TMT QC","text":"N-terminal labeling efficiency typically high (>95%) ’s kinetically favored. Total number peptides : 3947 Number peptides modified N-term : 3904 Percent peptides modified N-term: 99 % Expected range: 95-100%. Values 95% may indicate: Suboptimal labeling conditions Sample degradation Buffer incompatibility Total number PSMs : 5275 Number PSMs modified N-term : 5227 Percent PSMs modified N-term: 99 % PSM-level statistics weight peptides identification frequency, providing insight abundant species sample.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"peptides","dir":"Articles","previous_headings":"Labelling Efficiency","what":"Peptides","title":"FragPipe TMT QC","text":"Total number peptides : 3947 Number peptides modified N-term : 3904 Percent peptides modified N-term: 99 % Expected range: 95-100%. Values 95% may indicate: Suboptimal labeling conditions Sample degradation Buffer incompatibility","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"psms","dir":"Articles","previous_headings":"Labelling Efficiency","what":"PSM’s","title":"FragPipe TMT QC","text":"Total number PSMs : 5275 Number PSMs modified N-term : 5227 Percent PSMs modified N-term: 99 % PSM-level statistics weight peptides identification frequency, providing insight abundant species sample.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"lysine-modification","dir":"Articles","previous_headings":"","what":"Lysine Modification","title":"FragPipe TMT QC","text":"Lysine labeling challenging N-terminal labeling sensitive reaction conditions. Total number peptides Lysine: 2339 Number peptides modified Lysine residues : 2339 Percent peptides modified Lysine residues: 100 % Expected range: 95-99%. Lower values may indicate: Insufficient reagent concentration Competing reactions (e.g., formaldehyde crosslinking) pH optimization needed Total number PSMs Lysine: 3200 Number PSMs modified Lysine residues : 3200 Percent PSMs modified Lysine residues: 100 % Total number Lysine residues: 2344 Number modified Lysine residues : 2339 Percent modified Lysine residues: 100 % Total number Lysine residues: 3205 Number modified Lysine residues : 3200 Percent modified Lysine residues taking number PSMs account: 100 %","code":"Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"modSeq\"` instead of `.data$modSeq` Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"n\"` instead of `.data$n` Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"n1\"` instead of `.data$n1`"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"peptides-1","dir":"Articles","previous_headings":"Labelling Efficiency","what":"Peptides","title":"FragPipe TMT QC","text":"Total number peptides Lysine: 2339 Number peptides modified Lysine residues : 2339 Percent peptides modified Lysine residues: 100 % Expected range: 95-99%. Lower values may indicate: Insufficient reagent concentration Competing reactions (e.g., formaldehyde crosslinking) pH optimization needed","code":"Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"modSeq\"` instead of `.data$modSeq`"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"psms-with-lysine","dir":"Articles","previous_headings":"Labelling Efficiency","what":"PSM’s with Lysine","title":"FragPipe TMT QC","text":"Total number PSMs Lysine: 3200 Number PSMs modified Lysine residues : 3200 Percent PSMs modified Lysine residues: 100 %","code":"Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"n\"` instead of `.data$n` Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. ℹ Please use `\"n1\"` instead of `.data$n1`"},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"peptidoforms","dir":"Articles","previous_headings":"Labelling Efficiency","what":"Peptidoforms","title":"FragPipe TMT QC","text":"Total number Lysine residues: 2344 Number modified Lysine residues : 2339 Percent modified Lysine residues: 100 %","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"total-number-of-lysine-residues-in-psms","dir":"Articles","previous_headings":"Labelling Efficiency","what":"Total number of Lysine residues in PSM’s","title":"FragPipe TMT QC","text":"Total number Lysine residues: 3205 Number modified Lysine residues : 3200 Percent modified Lysine residues taking number PSMs account: 100 %","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"quantitative-information-per-channel","dir":"Articles","previous_headings":"","what":"Quantitative information per channel","title":"FragPipe TMT QC","text":"TMT quantification relies consistent labeling equal loading across channels. plots help identify technical issues bias quantitative comparisons. Quality indicators: Similar total abundances: Good sample preparation loading Outlier channels: May indicate pipetting errors sample loss Systematic patterns: suggest batch effects labeling issues  Total abundance per channel (Sum abundances). Total abundance reflects sample amount ionization efficiency. Large variations (>2-fold) investigated.  Ralative chanell 126 total abundance per chanel. Normalization reference channel (126) helps identify systematic biases. Values typically within 0.5-2.0 fold reference.  Density abundance values per channel. abundance distribution similar across channels. Shifted distributions may indicate: - Unequal sample loading - Different sample complexity - Technical artifacts specific channels","code":"Warning: `aes_string()` was deprecated in ggplot2 3.0.0. ℹ Please use tidy evaluation idioms with `aes()`. ℹ See also `vignette(\"ggplot2-in-packages\")` for more information. ℹ The deprecated feature was likely used in the prolfqua package.   Please report the issue at <https://github.com/wolski/prolfqua/issues>."},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"missed-cleavage","dir":"Articles","previous_headings":"","what":"Missed cleavage","title":"FragPipe TMT QC","text":"Missed cleavage analysis provides insights proteolytic efficiency sample quality. Excessive missed cleavages can reduce identification rates affect quantification accuracy. Missed cleavage site: residue trypsin cleaved . Factors affecting missed cleavages: Protein denaturation: Incomplete unfolding reduces accessibility Digestion time/temperature: Insufficient conditions lead incomplete digestion Enzyme activity: Old inhibited trypsin reduces efficiency Chemical modifications: Modified residues may resist cleavage determine number missed cleavages compute: - number potential cleavage sites (.e., number K R residues) - number actual cleavage sites (K R peptide C-terminus) - Modified residues may resist cleavage compute total number K residues, number K cleavage sites (nr potential cleavage sites). compute number K C-term number K residues 3205 number unmodified K C term 0 number modified K C term 3025 number K C term 3025 number modified K: 3200 Missed cleavage sites : number K residues - number K C term = 180, % number K residues : 6 Expected range: 5-15% missed cleavages typical. Higher rates may indicate: Incomplete protein denaturation Insufficient digestion time Trypsin inhibitors present High protein concentration number R residues 2401 number unmodified R C term 2189 number modified R C term 0 number R C term 2189 number modified R: 0 Missed cleavage sites : number R residues - number R C term = 212, % number R residues : 9 Arginine cleavage generally efficient lysine cleavage. Similar missed cleavage rates K R suggest consistent digestion conditions.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"missed-lysine-residues","dir":"Articles","previous_headings":"","what":"Missed Lysine residues","title":"FragPipe TMT QC","text":"compute total number K residues, number K cleavage sites (nr potential cleavage sites). compute number K C-term number K residues 3205 number unmodified K C term 0 number modified K C term 3025 number K C term 3025 number modified K: 3200 Missed cleavage sites : number K residues - number K C term = 180, % number K residues : 6 Expected range: 5-15% missed cleavages typical. Higher rates may indicate: Incomplete protein denaturation Insufficient digestion time Trypsin inhibitors present High protein concentration","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"missed-arginine-residues","dir":"Articles","previous_headings":"","what":"Missed Arginine residues","title":"FragPipe TMT QC","text":"number R residues 2401 number unmodified R C term 2189 number modified R C term 0 number R C term 2189 number modified R: 0 Missed cleavage sites : number R residues - number R C term = 212, % number R residues : 9 Arginine cleavage generally efficient lysine cleavage. Similar missed cleavage rates K R suggest consistent digestion conditions.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/QCReport.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"FragPipe TMT QC","text":"R version 4.5.2 (2025-10-31) Platform: aarch64-apple-darwin20 locale: en_US.UTF-8||en_US.UTF-8||en_US.UTF-8||C||en_US.UTF-8||en_US.UTF-8 attached base packages: stats, graphics, grDevices, utils, datasets, methods base attached packages: (v.1.0.2), ggseqlogo(v.0.2), lubridate(v.1.9.4), forcats(v.1.0.1), stringr(v.1.6.0), dplyr(v.1.1.4), purrr(v.1.2.0), readr(v.2.1.6), tidyr(v.1.3.1), tibble(v.3.3.0), ggplot2(v.4.0.1), tidyverse(v.2.0.0), prophosqua(v.0.1.0) prolfquapp(v.0.1.8) loaded via namespace (attached): AhoCorasickTrie(v.0.1.3), gtable(v.0.3.6), xfun(v.0.54), prozor(v.0.3.1), htmlwidgets(v.1.6.4), ggrepel(v.0.9.6), lattice(v.0.22-7), tzdb(v.0.5.0), vctrs(v.0.6.5), tools(v.4.5.2), generics(v.0.1.4), parallel(v.4.5.2), pkgconfig(v.2.0.3), pheatmap(v.1.0.13), Matrix(v.1.7-4), data.table(v.1.17.8), RColorBrewer(v.1.1-3), S7(v.0.2.1), lifecycle(v.1.0.4), prolfqua(v.1.4.0), compiler(v.4.5.2), farver(v.2.1.2), codetools(v.0.2-20), htmltools(v.0.5.9), lazyeval(v.0.2.2), yaml(v.2.3.11), plotly(v.4.11.0), pillar(v.1.11.1), crayon(v.1.5.3), seqinr(v.4.2-36), MASS(v.7.3-65), cachem(v.1.1.0), tidyselect(v.1.2.1), conflicted(v.1.2.0), digest(v.0.6.39), stringi(v.1.8.7), pander(v.0.6.6), labeling(v.0.4.3), ade4(v.1.7-23), rprojroot(v.2.1.1), fastmap(v.1.2.0), grid(v.4.5.2), cli(v.3.6.5), logger(v.0.4.1), magrittr(v.2.0.4), patchwork(v.1.3.2), withr(v.3.0.2), scales(v.1.4.0), bit64(v.4.6.0-1), timechange(v.0.3.0), httr(v.1.4.7), rmarkdown(v.2.30), bit(v.4.6.0), gridExtra(v.2.3), hms(v.1.1.4), memoise(v.2.0.1), evaluate(v.1.0.5), knitr(v.1.50), viridisLite(v.0.4.2), dtplyr(v.1.3.2), rlang(v.1.1.6), Rcpp(v.1.1.0), docopt(v.0.7.2), glue(v.1.8.0), vroom(v.1.6.7), jsonlite(v.2.0.0) R6(v.2.6.1)","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"abstract","dir":"Articles","previous_headings":"","what":"Abstract","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Post-translational modifications (PTMs), particularly phosphorylation, regulate protein function substoichiometric levels, making quantitative analysis technically challenging. critical limitation PTM studies distinguishing changes modification abundance due altered protein expression versus genuine changes modification stoichiometry (fraction protein molecules modified). chapter presents comprehensive workflow integrating Tandem-Mass-Tag (TMT)-based quantitative proteomics specialized computational analysis distinguish differential PTM abundance (DPA) differential PTM usage (DPU) using prolfqua, prolfquapp, prophosqua R packages. workflow introduces robust statistical framework integrated PTM-protein analysis, comprehensive visualization tools including N-terminus C-terminus (N--C) plots protein-centric PTM mapping, sequence motif analysis kinase prediction. integrated approach enables researchers identify actual signaling changes PTM studies, prioritize functionally relevant modification sites, understand pathway-level regulation disease contexts, generate robust datasets suitable publication high-impact journals.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"key-words","dir":"Articles","previous_headings":"","what":"Key Words","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Post-translational modifications, phosphoproteomics, TMT labeling, differential PTM abundance analysis, differential PTM usage analysis, mass spectrometry, data integration, kinase activity","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"biological-significance-of-post-translational-modifications","dir":"Articles","previous_headings":"Introduction","what":"Biological Significance of Post-Translational Modifications","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Protein phosphorylation reversible PTM modulates protein’s conformation, enzymatic activity, subcellular localization, binding interactions. modification can reversed rapidly, acts molecular switch cellular signaling networks. result, cells respond environmental cues without requiring new protein synthesis. Dysregulation phosphorylation implicated cancer, neurodegeneration, metabolic disorders [1]. Large-scale phosphoproteomic profiling high-throughput mass spectrometry (MS) (e.g., TMT-based workflows) therefore crucial dissecting disease-associated signaling alterations identifying candidate therapeutic targets.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"technical-challenges-in-ptm-analysis","dir":"Articles","previous_headings":"Introduction","what":"Technical Challenges in PTM Analysis","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"analysis PTMs, phosphorylation, presents significant analytical challenges due low abundance modified peptides. Typically, phosphorylated peptides represent less 1–5% total peptide population [2]. Additionally, phosphopeptides generally exhibit poorer ionization efficiency MS-based proteomics compared non-modified peptides, complicating detection quantification. low abundance challenging ionization behavior necessitate specialized experimental workflows computational strategies achieve accurate quantification [3]. key analytical challenge distinguishing genuine changes PTM levels, due altered kinase phosphatase activity, changes caused altered protein abundance [4, 5]. Without proper correction, confounding factor can lead researchers misinterpret PTM data, incorrectly attributing higher phosphorylation signals solely increased modification efficiency pathway activation, rather elevated protein expression [6]. Controlling confounder critical discern rapid, signaling-driven phosphorylation events slower, transcriptionally translationally regulated changes protein abundance. phosphorylation substoichiometric, small fraction protein molecules carry modification; therefore, enrichment required isolate phosphopeptides. Enrichment steps (Immobilized Metal Affinity Chromatography (IMAC) Metal Oxide Affinity Chromatography (MOAC)) introduce additional sample handling technical variability [6–8]. Therefore, stage, digestion cleanup MS acquisition, must carefully optimized improve reproducibility [9]. Effective experimental design combined tailored normalization strategies therefore essential recover reliable, biologically meaningful PTM signals. Isobaric TMT labeling enables multiplexed PTM analysis 35 samples single run, reducing inter-sample variability missing values improve statistical power [10, 11]. Phosphopeptides typically enriched IMAC Metal Oxide Affinity Chromatography (MOAC), provide complementary selectivity broaden coverage [12, 13]. Adding offline fractionation liquid chromatography–tandem mass spectrometry (LC–MS/MS) increases phosphosite depth distributes peptide load, improving quantification consistency across fractions conditions [14]. TMT-based proteomics, plex refers complete set isobarically tagged samples analyzed together single LC–MS/MS run. total number samples exceeds available TMT channels, plex include least one biological replicate every experimental group common reference pooled channel normalization [15]. Replicates group distributed across different plexes rather clustered within single run, preventing group’s replicates confined one batch. samples fit within channel capacity single plex, balancing measures inherently satisfied run.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"computational-tools-and-workflows","dir":"Articles","previous_headings":"Introduction","what":"Computational Tools and Workflows","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"computational landscape quantitative protein PTM analysis undergone significant evolution, numerous specialized software platforms supporting bottom-proteomics workflows. Following MS data acquisition, spectra undergo database searching identify peptide sequences, subsequently followed protein inference determine protein identities based identified peptides. ecosystem PTM analysis includes several well-established data-dependent acquisition (DDA)-TMT compatible software suites, free commercial, Andromeda integrated within MaxQuant [16], Proteome Discoverer (Thermo Fisher Scientific), FragPipe [17], PeptideShaker [18]. Among analytical steps following peptide identification, PTM site localization scoring represents particularly crucial computational challenge. Site localization determines confidence modification can assigned specific amino acid residue within peptide sequence. process especially challenging peptides contain multiple potential modification sites, necessitating algorithms evaluate quality specificity site-determining fragment ions. Specialized tools developed explicitly robust PTM site localization, including PTMProphet [19], PhosphoRS [20], Ascore [21]. Accurate localization essential, incorrect site assignments can lead biological misinterpretations, particularly signaling pathway analyses kinase-substrate predictions. DDA workflows, FragPipe [22] represents widely adopted integrated platform comprehensively addresses PTM analysis, including site localization challenges. FragPipe integrates MSFragger search engine [23], enabling highly sensitive peptide identification, employs PTMProphet [24] functionality site localization scoring. also generates detailed quantitative outputs, including site-level quantification reports multisite feature reports group peptides sharing identical modification patterns. detailed description FragPipe workflow provided experimental methods section (see Section @ref(fragpipeparams)). discussion focused primarily DDA workflows, data-independent acquisition (DIA)-based approaches represent alternative strategies distinct computational considerations PTM analysis. Specialized DIA platforms Spectronaut [25], [26] DIA-NN [27] offer PTM support dedicated site-localization scoring algorithms site-level quantification capabilities. Unlike DDA, DIA workflows require specialized computational approaches extract quantify modification-specific information highly multiplexed fragmentation spectra. Spectronaut DIA-NN incorporate advanced statistical frameworks designed explicitly PTM identification quantification DIA workflows.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"data-analysis-frameworks","dir":"Articles","previous_headings":"Introduction","what":"Data Analysis Frameworks","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Proteomic data analysis can conducted multiple levels granularity, providing distinct analytical perspectives. peptidoform represents specific peptide sequence particular set modifications, site-level analysis aggregates signals residue position across multiple peptides. Differential analysis can therefore target either peptidoforms individual modification sites, approach offering unique advantages different research questions. FragPipe introduces additional analytical concept multisite features, refers set identified peptide-forms sharing set modification sites investigation, regardless sequence derivatives, cleavage state, whether modifications unambiguously localized. approach groups peptidoforms different sequences, can arise missed cleavages alternative cleavage patterns, identical possible modification sites multisite feature, providing balanced approach peptidoform specificity site-level aggregation. Discarding peptidoforms ambiguous localization result loss large fraction PTM information. Furthermore, multisite features preserve information phosphorylation sites occur together peptide molecule, revealing co-modification patterns indicate coordinated regulation kinases functional relationships sites. Traditional site-level analysis treats phosphorylation site independently, losing valuable information specific combinations sites modified together biological samples. Site-level reports collapse signals peptidoforms mapping PTM amino acid residue single quantitative value, ensuring site exactly one intensity measurement per sample. downstream analysis, site-level intensities integrate seamlessly site-centric enrichment tools kinase-activity inference platforms (PhosR [28], PTM-SEA [29], RoKAI [30], etc.), streamlining biological interpretation network reconstruction analyses [31].","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"statistical-analysis-of-ptm-data","dir":"Articles","previous_headings":"Introduction","what":"Statistical Analysis of PTM Data","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Statistical analysis PTM data requires specialized methods due confounding effects PTM levels protein abundances. Several statistical packages emerged address critical issue integrating PTM-feature quantifications protein abundance data. Notable examples include MSstatsPTM [4] msqrob2PTM [5], explicitly model modified peptide protein-level changes distinguish genuine PTM regulation protein abundance effects accurately. msqrob2PTM framework exemplifies statistical approaches now available PTM analysis, defining two complementary analytical strategies: DPA DPU [5]. DPA directly models log2log^2 intensities modified peptide (peptidoform), detecting absolute changes PTM levels experimental conditions. contrast, DPU adjusts PTM intensities corresponding protein-level changes, effectively testing changes relative usage stoichiometry modification site. dual approach enables researchers distinguish PTM changes driven protein abundance differences (DPA) versus reflecting genuine changes modification efficiency regulatory activity (DPU). two frameworks differ analytical approaches addressing confounding PTM changes protein abundance. MSstatsPTM employs “model correct” strategy, separately fitting linear models modified unmodified peptide data, combining statistical inferences post-modeling. contrast, msqrob2PTM follows “correct model” approach, first adjusting PTM intensities corresponding protein abundances data level, subsequently performing statistical testing normalized values. option, discussed [32], model PTM total proteome data factorial design jointly includes biologically relevant explanatory variable, e.g., genotype, “component” indicator, .e., modified peptide total proteome parent protein, fits linear model interaction. tests statistical significance interaction term flag modified peptides whose dynamics deviate corresponding total proteome protein abundance. , package limma used fit model perform testing. three methodologies ultimately estimate PTM abundance changes corrected protein-level effects, method can yield different test results due varying assumptions relationship PTMs protein abundances within sample, well differences variance degrees freedom estimated. MSstatsPTM fits PTM protein separate models, computes adjusted effect difference estimated contrasts: Δadj=ΔPTM−Δprotein\\Delta_{adj} = \\Delta_{PTM} - \\Delta_{protein} standard error combined quadrature test statistic, Welch’s approximation estimate degrees freedom, yields p-values adjusted fold change directly contrast scale. MSstatsPTM assumes correlation PTM protein abundances within samples. single-model approach [32] uses limma moderated (empirical-Bayes) variances interaction contrast within one fit, shrinks feature-wise variances toward common prior; dfdf moderated accordingly. single-model formulation can capture shared covariance adding sample blocking/random effect. Still, illustrated [32], baseline model omits sample term, effectively treating PTM protein measurements independent. msqrob2PTM assumes PTM protein abundances within sample correlated therefore corrects PTM abundances matched protein abundances. , modelling, corrected PTM intensities used. three pipelines target PTM-vs-protein effect different modeling paths make different assumptions within-sample covariance, differ variance moderation. Therefore, even raw data contrasts, can expect differences estimated effects, standard errors, p-values. offer researchers additional flexibility, developed prophosqua [33], R package designed streamline statistical analysis phosphoproteomics PTM datasets. Using prophosqua prolfqua package [34], MStatsPTM model-first msqrob2PTM correct first approaches can executed obtain protein-corrected PTM data provide intuitive visualizations comprehensive exploratory analysis.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"the-protein-assignment-problem-in-differential-ptm-feature-usage","dir":"Articles","previous_headings":"Introduction","what":"The Protein Assignment Problem in Differential PTM-feature Usage","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Identification quantification tools need assign peptides proteins, .e., find leading representative protein identifier (ID). assignment may dataset-specific may differ PTM total proteome dataset. Therefore, using protein IDs match PTM features proteins total run may lead loss information due differing representative IDs [35]. example, phosphopeptide might assigned, protein inference, protein isoform PTM dataset. contrast, total proteome dataset, protein abundance quantified isoform B, prevents proper integration DPU analysis. robust solution involves matching stripped peptide sequences PTM dataset peptide sequences proteins quantified total proteome dataset, bypassing protein ID dependency entirely. peptides shared among multiple protein isoforms, averaged protein abundance across matching isoforms provides stable reference normalization. sequence-based matching approach requires additional computational implementation, reduces loss valuable information due protein assignment differences datasets.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"chapter-overview-and-learning-objectives","dir":"Articles","previous_headings":"Introduction","what":"Chapter Overview and Learning Objectives","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"chapter introduces analytical workflow addresses biological challenge accurately distinguishing DPA DPU. Distinguishing protein-level effects genuine modification-specific changes critical meaningful interpretation PTM data. workflow emphasizes reproducibility, automation, biological interpretation. DPA tests raw PTM signal changes experimental conditions, identifying modification abundance changes regardless underlying protein-level effects. analysis captures total impact experimental perturbations PTM levels, including direct modification effects indirect effects mediated changes protein abundance. DPU evaluates protein-normalized PTM changes, explicitly identifying modification sites stoichiometry genuinely altered independent protein abundance. analysis pinpoints sites experimental conditions directly impact modification efficiency, kinase activity, phosphatase activity, thereby highlighting specific regulatory events. Learning objectives include: 1. Conducting integrated statistical analysis PTM total proteome data using prolfquapp prophosqua R packages 2. Interpreting DPA vs. DPU results biological insights generating publication-quality visualizations 3. Performing sequence motif analysis kinase prediction pathway reconstruction","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"demonstration-dataset","dir":"Articles","previous_headings":"Materials","what":"Demonstration Dataset","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"protocol utilizes Atg16l1 macrophage dataset Maculins et al. [36] demonstrate bioinformatics workflow integrated statistical analysis. dataset comprises TMT-11-plex measurements six conditions (WT/KO × uninfected/early/late infection) phospho-enriched total proteome samples, making ideal illustrating principles integrated PTM analysis. original publication, authors also performed ubiquitin remnant enrichment, although focus phosphoproteome total proteome datasets demonstration purposes. dataset previously used MSstatsPTM publication [4], providing additional validation analytical approaches. discussed , TMT enables high-precision quantification across many conditions, particularly combined fractionation. contrast, DIA well suited avoiding fractionation scaling larger sample numbers (see Note @ref(notelfq)).","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"system-requirements","dir":"Articles","previous_headings":"Materials","what":"System Requirements","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Search quantification software: FragPipe 22.0 (free download academic use fragpipe.nesvilab.org; system requirements: 32GB+ RAM, 50GB+ storage) Statistical platform: R version ≥\\ge 4.0.0 (https://www.r-project.org/) RStudio (https://posit.co/) System requirements: 16GB+ RAM, 20 GB+ storage Expected runtime: 10 minutes 1 hours depending dataset size number fractions","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"r-packages","dir":"Articles","previous_headings":"Materials","what":"R packages","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"relevant R packages used analysis : tidyverse [37] - Data manipulation visualization tools ggseqlogo [38] - Sequence motif visualization prolfqua [34] - Core statistical framework proteomics data analysis prolfquapp [39] - Streamlined differential expression analysis pipeline prolfquappPTMreaders [40] - Specialized readers PTM data formats prophosqua [33] - Integration visualization PTM protein data detailed installation instructions, see package documentation github.com/fgcz/prolfqua, github.com/prolfqua/prolfquapp, github.com/prolfqua/prophosqua.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"mass-spectrometry-data-processing","dir":"Articles","previous_headings":"Materials","what":"Mass Spectrometry Data Processing","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Raw MS data acquired using DDA combined TMT labeling processed using specialized software : Search spectra protein sequence database including species-specific sequences, common contaminants, decoy sequences extract reporter ion intensities compute site localization probabilities section (see Methods @ref(fragpipeparams)) describes detail parameterized FragPipe software [17].","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"methods","dir":"Articles","previous_headings":"","what":"Methods","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"key challenge, analysing PTMs, distinguish changes PTM abundance due altered protein expression reflect change modification stoichiometry (.e., fraction protein pool modified). protocol provides step--step computational workflow analyze PTM data context total protein abundance changes. leverage R packages prolfquapp [39] streamlined differential expression analysis [34] prophosqua [33] integration, analysis, visualization PTM total proteome data. workflow comprises three parts: 1) analysing raw mass spectrometric data FragPipe, 2) performing differential expression analysis PTM-enriched total proteome datasets, 3) integrating PTM total proteome data.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"fragpipeparams","dir":"Articles","previous_headings":"Methods","what":"Analysing TMT raw data with FragPipe","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"used TMT 11-plex phospho workflow FragPipe 22.0 [17] MSFragger (version 4.1) [23]. Database searching performed species-specific protein sequence database supplemented common contaminants reversed decoy sequences. search parameters included: Fixed modifications: Carbamidomethylation cysteine (+57.0215 Da) TMT labeling lysine residues peptide N-termini (+229.1629 Da) Variable modifications: Phosphorylation serine, threonine, tyrosine residues (+79.9663 Da) Oxidation methionine (+15.9949 Da) Acetylation protein N-termini (+42.0106 Da) Reporter ions quantified IonQuant (version 1.10.27), downstream processing TMTIntegrator (version 1.10.27). TMTIntegrator [22] performs quantification normalization specifically tailored multiplexed TMT experiments. Selected TMTIntegrator parameters : Best PSM selection: Outlier removal enabled: Allow overlabel/underlabel: Use MS1 intensity: Aggregation method: Median phospho-enriched samples, PTM sites scored using PTMProphet [24] localization scores ≥\\ge 0.75 retained. FragPipe workflow parameters stored configuration files (fragpipe.workflow). workflow file used parametrize FragPipe can downloaded [41]. FragPipe provides two types PTM-features reports phospho-enriched samples: Multisite features: groups peptidoforms sharing identical modification sites, described Section @ref(data-analysis-frameworks). Site-level reports collapse signals peptidoforms mapping amino acid position single quantitative value per PTM site, ensuring site exactly one intensity per sample. downstream analysis, site-level intensities can fed site-centric enrichment kinase-activity inference tools (PhosR, PTM-SEA, RoKAI, etc.), streamlining biological interpretation network reconstruction. essential step data preprocessing quality control (QC) quantified samples, involves estimating missed cleavage rates labeling efficiency (see Note @ref(automatedqc)).","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"data-setup-for-statistical-analysis","dir":"Articles","previous_headings":"Methods","what":"Data Setup for Statistical Analysis","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"following sections demonstrate computational workflow R code snippets implement step integrated PTM analysis. code examples also available within prophosqua package [33] can easily adapted different datasets modifying file paths experimental parameters. first step download example PTM dataset, serves comprehensive demonstration integrated PTM analysis. dataset derived Atg16l1 macrophage study Maculins et al. [36], investigates role autophagy bacterial infection responses. dataset contains total proteome PTM-enriched measurements well-designed factorial experiment following characteristics: Experimental design: 2×32\\times 3 factorial (Genotype: WT/KO; Timepoint: Uninfected/Early/Late infection) Biological context: Macrophage responses Shigella infection wild-type vs Atg16l1-knockout cells Technical approach: TMT 11-plex labeling precise quantification across conditions Data types: Total proteome protein-level phospho-enriched phospho-site quantification results. dataset particularly valuable demonstrating PTM analysis concepts Atg16l1 knockout creates direct protein abundance changes (loss Atg16l1 ) secondary effects autophagy-related signaling pathways. first step involves obtaining FragPipe 22 mass spectrometry output files [41] setting analysis environment R. Depending sample type, different FragPipe output files required: total proteome samples: psm.tsv files, containing peptide-spectrum match (PSM) information phospho-enriched samples: abundance_single-site.tsv files individual modification site analysis dataset available Zenodo 10.5281/zenodo.15879865. code downloads data, extracts folder, removes zip archive.","code":"need_download <- !dir.exists(\"PTM_example\") zenodo_url <- \"https://zenodo.org/records/15879865/files/PTM_experiment_FP_22_Maculins_and_QC.zip\"  destfile <- basename(zenodo_url) # Download, unzip and delete download.file(zenodo_url, destfile, mode = \"wb\") unzip(destfile, exdir = \".\") unlink(destfile)"},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"setting-up-prolfquapp-scripts","dir":"Articles","previous_headings":"Methods","what":"Setting up prolfquapp scripts","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"section demonstrates perform differential expression analysis (DEA) total proteome PTM-enriched proteome data using prolfquapp package. analysis provides foundation subsequent integration preprocessing, normalizing data, establishing proteins PTM-features show significant changes experimental conditions. prolfquapp [39] package provides set shell scripts automate analysis workflow. scripts copied working directory running command Linux shell used subsequent steps.","code":"R --vanilla -e \"library(prolfquapp); copy_shell_script(workdir = '.')\""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"contrasts","dir":"Articles","previous_headings":"Methods","what":"Creating sample annotation","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Sample annotation foundation meaningful DEA, serving bridge raw mass spectrometry files biological interpretation. annotation file maps raw data file corresponding experimental conditions (WT KO) additional explanatory variables, Time. start reading sample names FragPipe output files using prolfqua_dataset.sh script create dataset annotation file compatible prolfquapp, maps sample names experimental conditions (see Table @ref(tab:showAnnotTable)). use R extract experimental factors, Genotype Timepoint, channel labels using tidyr::separate function. channel names encode experimental conditions, explanatory variables must provided adding columns annotation file using text editor. call annotation_add_contrasts function prolfqua [34] generate factorial contrasts automatically. annotation_add_contrasts function adds two key columns sample annotation: ContrastName: descriptive name statistical contrast Contrast: mathematical formula defining contrast terms group means Note setting argument interactions=FALSE annotation_add_contrasts function disables generation interaction contrasts factor level combinations. Interaction contrasts assess whether effect one factor depends level another, thereby capturing non‑additive interplay factors. file dataset_with_contrasts.tsv final dataset file used DEA (see Table @ref(tab:showannotation)). experimental design protocol (2×32\\times3 factorial: Genotype [KO/WT] ×\\times Time [Uninfected/Early/Late]), function generated four distinct contrasts: KO_vs_WT (Main effect): ( (G_KO_Uninfect + G_KO_Late + G_KO_Early)/3 - (G_WT_Uninfect + G_WT_Late + G_WT_Early)/3 ) - Compares overall genotype effects across timepoints KO_vs_WT_at_Uninfect: G_KO_Uninfect - G_WT_Uninfect - Compares genotypes specifically uninfected condition KO_vs_WT_at_Late: G_KO_Late - G_WT_Late - Compares genotypes specifically late infection condition KO_vs_WT_at_Early: G_KO_Early - G_WT_Early - Compares genotypes specifically early infection condition want compare timepoints instead genotypes, set: primary_col=\"Timepoint\" secondary_col = \"Genotype\".","code":"./prolfqua_dataset.sh --indir PTM_example/data_total/FP_22/ \\ --dataset \"PTM_example/data_total/dataset.tsv\" \\ --software prolfquapp.FP_TMT annot <- readr::read_tsv(\"PTM_example/data_total/dataset.tsv\") annot <- annot |> tidyr::separate(\"name\", c(\"Genotype\", \"Timepoint\", NA),                                   sep = \"_\", remove = FALSE) annot$group <- NULL annot$subject <- NULL annot$CONTROL <- NULL annot2 <- prolfqua::annotation_add_contrasts(   annot, primary_col = \"Genotype\", secondary_col = \"Timepoint\" ,   decreasing = TRUE, interactions = FALSE)$annot  write_tsv(annot2, \"dataset_with_contrasts.tsv\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"execution-of-differential-abundance-analysis","dir":"Articles","previous_headings":"Methods","what":"Execution of Differential Abundance Analysis","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"performing DEA, generate YAML configuration file using prolfqua_yaml.sh script. configuration file (config.yaml) defines key analysis parameters, including normalization method (variance stabilization normalization (VSN) default), protein summarization strategy (Tukey’s median polish default), quality-filtering thresholds q-value cutoffs peptide protein-level evidence. sample annotation configuration files prepared, DEA executed via prolfqua_dea.sh script. script reads experimental design (sample IDs, group labels, contrasts) alongside configuration file. Single-site protein intensities log⁡2\\log_2-transformed variance-stabilized modeling, improving homoscedasticity across conditions. Linear models fitted contrasts tested using prolfqua R-package’s contrast API. Rather imputing missing values, model adjusts degrees freedom based number actual observations per feature, naturally -weights features high missingness improves reliability fold-change p-value estimates. Empirical Bayes variance moderation applied stabilize variance estimates, particularly sample size limited. First, run DEA analysis total proteome quantification results. script uses FragPipe psm.tsv file input, aggregates reporter ions abundances peptide level, estimates protein abundances. code demonstrates prolfqua_dea.sh shell script can executed Linux command line. prolfqua_dea application expects following paramater: -: Specifies input directory FragPipe results -d: Uses annotated dataset file -y: Applies configuration settings config.yaml file. -w: Sets name work unit -s: Specifies software format (FragPipe TMT) running DEA, results stored time-stamped directory. code constructs path results directory using prolfquapp::zipdir_name() function, follows standard naming convention DEA results. DEA single-site output enriched phosphoproteome examines changes individual modification sites performed running code . analysis provides site-specific information particular amino acids modified different conditions. abundance_single-site_None.tsv file generated FragPipe used input. Please note using -s argument, point correct reader function prolfquappPTMreaders R package read FragPipe single-site output. data type, prolfquapp generates comprehensive suite outputs: Dynamic HTML reports containing interactive PCA plots, boxplots, volcano plots, heatmaps quality control exploratory analysis XLSX tables (DE_.xlsx) summarizing log⁡2\\log_2 fold changes, moderated t-statistics, raw p-values, Benjamini–Hochberg–adjusted p-values GSEA rank files (GSEA_.rnk) downstream gene-set enrichment analysis SummarizedExperiment objects (.rds) seamless import Shiny-based visualization tools results can integrated using prophosqua package combined analysis total proteome PTM data. However, essential note scenarios performing differential PTM-feature abundance analysis practical option (see Note @ref(useofDPADPU)).","code":"./prolfqua_yaml.sh -y config.yaml ./prolfqua_dea.sh -i PTM_example/data_total/FP_22 \\ -d dataset_with_contrasts.tsv \\ -y config.yaml \\ -w total_proteome \\ -s prolfquapp.FP_TMT prolfquapp::zipdir_name(\"DEA\", workunit_id = \"total_proteome\") ## [1] \"DEA_20251214_WUtotal_proteome_vsn\" ./prolfqua_dea.sh -i PTM_example/data_ptm/FP_22 \\ -d dataset_with_contrasts.tsv \\ -y config.yaml \\ -w singlesite_PTM \\ -s prolfquappPTMreaders.FP_singlesite"},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"integrated-ptm-analysis-using-prophosqua","dir":"Articles","previous_headings":"Methods","what":"Integrated PTM Analysis using prophosqua","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"prophosqua package [33] provides tools integrating analyzing PTM data total proteome measurements. enables researchers distinguish changes protein abundance changes usage modification sites. section explains load results differential abundance analysis, integrate PTM total proteome data, determine differential PTM-feature usage. Differential expression results prolfquapp, provided Excel format, total proteome multi- single-site PTM analyses imported R. datasets integrated performing left join protein identifiers, merging PTM-level statistics corresponding protein-level values condition. start defining project name analysis type. also create results directory store PTM/total proteome integration results: code , define paths DEA results XLSX files stored prolfquapp. need specify workunit names date DEA analysis run. Finally, load differential expression results R session. data integration step critical enabling DPU analysis represents one important technical aspects workflow. step joins phosphorylation site data total protein data create unified dataset PTM-feature linked corresponding protein-level measurements. left_join operation used ensures PTM-features retained analysis, even parent proteins detected total proteome experiment. approach maximizes information content allowing protein normalization possible, also reporting PTM-features mapped total proteome measurements. also need check match rate PTM sites proteins, , number PTM sites protein match divided total number PTM sites. Currently, prolfquapp matches PTM protein features using exact protein IDs, introduces limitation: discrepancies representative protein identifiers PTM-enriched total proteome datasets may result loss mapping information (see Note @ref(matchrates)). Table @ref(tab:b5matchrate) shows match rates contrast.","code":"library(prophosqua) wu_id <- \"CustomPhosphoAnalysis\" fgcz_project <- \"PTM_analysis\" oid_fgcz <- \"fgcz_project\" datetoday <- format(Sys.Date(), \"%Y%m%d\")  project_dir <- \".\" descri <- wu_id res_dir <- file.path(   project_dir,   paste0(fgcz_project, \"_\", datetoday, \"_singlesite_\", descri) ) if (!dir.exists(res_dir)) {   dir.create(res_dir, recursive = TRUE) } # Use today's date if running DEA, otherwise use existing results datedea <- if(do_dea) datetoday else \"20251207\"  tot_file <- prophosqua::dea_xlsx_path(project_dir, \"total_proteome\", datedea) ptm_file <- prophosqua::dea_xlsx_path(project_dir, \"singlesite_PTM\", datedea)  # Directory paths stopifnot(file.exists(tot_file)) stopifnot(file.exists(ptm_file)) required_cols <- c(\"protein_Id\", \"protein_length\", \"contrast\") tot_res <- prophosqua::load_and_preprocess_data(tot_file, required_cols) tot_res <- prophosqua::filter_contaminants(tot_res) phospho_res <- prophosqua::load_and_preprocess_data(ptm_file, required_cols) phospho_res <- prophosqua::filter_contaminants(phospho_res) join_column <- c(   \"fasta.id\" = \"protein_Id\",    \"contrast\",    \"description\",    \"protein_length\" ) suffix_a <- \".site\" suffix_b <- \".protein\"  combined_site_prot <- dplyr::left_join(   phospho_res,   tot_res,   by = join_column,   suffix = c(suffix_a, suffix_b) ) # Calculate match rate by contrast match_rates <- combined_site_prot |>   group_by(contrast) |>   summarize(     total_sites = n(),     matched_sites = sum(!is.na(diff.protein)),     match_rate = round(matched_sites / total_sites * 100, 1)   )"},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"visualizing-ptm-feature-abundance-dpa","dir":"Articles","previous_headings":"Methods","what":"Visualizing PTM-feature Abundance (DPA)","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"DPA tests raw PTM-feature signal change conditions, without correction parent protein’s expression level. analysis used flag PTM-feature whose abundance changes, even parent protein also - -regulated. DPA results visualized using N--C plots, generated prophosqua [33] n_to_c_expression_multicontrast function. multi-panel plots map log⁡2\\log_2 fold changes individual modification sites along primary sequence protein log⁡2\\log_2 fold change protein abundance total proteome experiment across contrasts simultaneously. representation provides clear visual summary site-specific overall protein expression changes across multiple experimental comparisons. N--C expression plot (see Figure @ref(fig:fig1Q64337)) shows protein SQSTM1 (UniProt id Q64337) phosphorylation sites upregulated KO vs WT comparison across different timepoints. generating N--C plots computationally intensive, generate plots proteins least one significant phosphorylation site contrast. False Discovery Rate (FDR) threshold determining significance can adjusted n_to_c_expression_multicontrast n_to_c_usage_multicontrast functions, allowing researchers balance computational efficiency comprehensive visualization based specific considerations. significant PTM sites detected despite biological expectations, one possible reason insufficient statistical power, can mitigated increasing sample size (see Note @ref(nosignificantPTM)). next code snippet exports 100100N--C expression plots PDF file analysis presentation (see also Note @ref(compperf) limit number N--C plots written file).","code":"plot_data <- n_to_c_expression_multicontrast(   combined_site_prot, FDR_threshold = 0.01,   max_plots = 100, include_proteins = c(\"Q64337\")) x1 <- which(plot_data$protein_Id == \"Q64337\") fig1_plot <- plot_data$plot[[x1]] pdf(file.path(res_dir, \"Site_differential_Expression_multicontrast.pdf\"),     width = 14, height = 10) for (i in seq_len(min(100, nrow(plot_data)))) {   print(plot_data$plot[[i]]) } dev.off()"},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"analysis-of-differential-ptm-feature-usage-dpu---model-first","dir":"Articles","previous_headings":"Methods","what":"Analysis of Differential PTM-feature Usage (DPU) - model-first","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"DPU tests protein-normalized changes PTM-features. analysis essential determining whether fraction protein modified specific site changes conditions. isolates changes modification stoichiometry changes overall protein abundance. model-first approach, DPU calculated subtracting total proteome protein log⁡2\\log_2 fold change PTM-feature’s log⁡2\\log_2 fold change. associated p-values recalculated using method combines variance PTM protein-level models, implemented prophosqua [33] test_diff function, MSstatsPTM R-package [4]. analysis involves three key mathematical components: Effect Size Calculation (ΔI\\Delta_I) Standard Error Propagation (SEISE_I) Degrees Freedom Calculation (dfIdf_I) differential PTM usage effect size calculated difference PTM total proteome protein log⁡2\\log_2 fold changes comparison: ΔI=log⁡2FCPTM−log⁡2FCProtein\\Delta_I = \\log_2FC_{PTM} - \\log_2FC_{Protein} difference represents protein-normalized change PTM abundance, : Positive values - indicate increased modification stoichiometry (higher fraction protein modified) Negative values - indicate decreased modification stoichiometry (lower fraction protein modified) Zero values - indicate change modification stoichiometry relative protein expression combined standard error accounts uncertainty PTM protein measurements: SEI=SEPTM2+SEProtein2SE_I = \\sqrt{SE_{PTM}^2 + SE_{Protein}^2} error propagation ensures statistical significance usage changes reflects uncertainty datasets, providing robust assessment reliability observed changes. effective degrees freedom combined test calculated using Welch’s approximation: dfI=(SEPTM2+SEProtein2)2SEPTM4DFPTM+SEProtein4DFProteindf_I = \\frac{(SE_{PTM}^2 + SE_{Protein}^2)^2}{\\frac{SE_{PTM}^4}{DF_{PTM}} + \\frac{SE_{Protein}^4}{DF_{Protein}}} , provides appropriate degrees freedom. Welch approximation essential two datasets different experimental designs sample sizes. Using calculated parameters, t-statistic computed: t=ΔISEIt = \\frac{\\Delta_I}{SE_I} p-value determined using t-distribution dfIdf_I degrees freedom. Multiple testing correction (e.g., Benjamini-Hochberg FDR) applied across tested sites. test_diff function calculates difference differences PTM total proteome data, revealing site-specific usage changes. PTM-feature usage log⁡2\\log_2 fold changes, p-values, FDR estimates added dataframe combined_test_diff. DPU results visualized using N--C plots generated prophosqua::n_to_c_usage_multicontrast, display protein-normalized PTM-feature abundance changes across contrasts simultaneously highlight sites significant changes usage. multi-panel plots reveal sites used less actively, independent total protein changes, enabling comparison across experimental conditions. Atg16l1 macrophage dataset [36], SQSTM1 (uniprot id Q64337) protein levels markedly increased Atg16l1-knockout (KO) versus wild-type (WT), reflecting loss autophagy-mediated turnover. Phosphosite analysis reveals raw phosphopeptide intensities Ser28Ser_{28}, Ser308Ser_{308}, Ser368Ser_{368} similarly elevated cKO compared WT (DPA), consistent higher protein abundance (see Figure @ref(fig:fig1Q64337)). However, applying DPU normalization, subtracts total proteome protein log⁡2\\log_2 fold change site’s phospho log⁡2\\log_2 fold change, apparent phosphorylation increases substantially reduced, indicating phosphosite abundance changes arise protein accumulation rather genuine changes modification stoichiometry (see Figure @ref(fig:fig2usageQ64337)). example highlights DPU effectively isolates regulatory events SQSTM1 confounding protein-level effects. Additionally, individual high-confidence DPA/DPU sites carefully inspected technical quality, including verification protein coverage assessment missing values across treatment groups (see Note @ref(qcrecommend)). evaluating statistical significance DPU analysis, essential avoid overinterpreting results (see Note @ref(overinterpret)). Statistical significance guarantee biological relevance; effect sizes considered alongside FDR values prioritizing sites investigation. Key findings validated orthogonal methods confirm biological relevance.","code":"combined_test_diff <- prophosqua::test_diff(phospho_res, tot_res, join_column = join_column) plot_data_usage <- n_to_c_usage_multicontrast(   combined_test_diff, FDR_threshold = 0.05,   max_plots = 100, include_proteins = c(\"Q64337\")) x1_usage <- which(plot_data_usage$protein_Id == \"Q64337\") fig2_plot <- plot_data_usage$plot[[x1_usage]]"},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"protein-ptm-integration-report-generation","dir":"Articles","previous_headings":"Methods","what":"Protein PTM Integration Report Generation","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"integrated analysis results compiled comprehensive HTML report using R markdown template _Overview_PhosphoAndIntegration_site.Rmd. report includes: Overview statistics identified phosphorylation sites Interactive scatter plots comparing protein vs PTM-feature changes Volcano plots highlighting differential PTM-feature usage report includes data tables allow searching specific protein phosphorylation feature, highlighting scatter plot showing total proteome protein log2(FC)log_2(FC) function PTM-site log2(FC)log_2(FC), well volcano plots. analyzing interactive reports, different combinations DPA DPU results provide distinct biological insights guide interpretation. instance, DPA+ indicates changes driven primarily protein abundance alterations, PTM increases reflect higher protein levels rather enhanced modification efficiency (see Note @ref(dpuvsdpa)). generate HTML report, begin creating report configuration includes project ID, order ID, work unit description displayed interactive HTML report. Next, can render interactive HTML report comprehensive analysis results, including tables, plots, statistical summaries. report available download Zenodo [42]. addition, analysis results exported Excel file analysis sharing. Excel file contains two worksheets: combinedSiteProteinData: Contains merged PTM protein-level data used DPA analysis. combinedStats: Contains differential PTM-feature usage statistics (DPU), including log⁡2\\log_2 fold changes, p-values, FDR estimates phosphorylation site. Excel format facilitates downstream analysis, data sharing collaborators, integration bioinformatics tools. file automatically saved timestamped filename results directory. produced XLSX file can downloaded [42]. comprehensive integrated analysis framework provides key advantages PTM research, including ability distinguish genuine signaling changes protein abundance effects (see Note @ref(keyinsight)).","code":"drumm <- prolfquapp::make_DEA_config_R6(   PROJECTID = fgcz_project,   ORDERID = oid_fgcz,   WORKUNITID = descri ) # Copy integration files prophosqua::copy_phospho_integration() ## [1] \"/Users/wolski/projects/prophosqua/inst/PTM_example_analysis_v2/_Overview_PhosphoAndIntegration_site.Rmd\" ## [2] \"/Users/wolski/projects/prophosqua/inst/PTM_example_analysis_v2/bibliography2025.bib\" # Render HTML report rmarkdown::render(   \"_Overview_PhosphoAndIntegration_site.Rmd\",   params = list(     data = combined_test_diff,     grp = drumm   ),   output_format = bookdown::html_document2(     toc = TRUE,     toc_float = TRUE   ),   envir = new.env(parent = globalenv()) ) # Copy HTML report to results directory (uses existing if not re-rendered) if (file.exists(\"_Overview_PhosphoAndIntegration_site.html\")) {   file.copy(     from = \"_Overview_PhosphoAndIntegration_site.html\",     to = file.path(res_dir, \"Result_phosphoAndTotalIntegration.html\"),     overwrite = TRUE   ) } ## [1] TRUE excel_result_list <- list(   combinedStats = combined_test_diff,   combinedSiteProteinData = combined_site_prot ) writexl::write_xlsx(   excel_result_list,   path = file.path(     res_dir,     \"Result_phosphoAndTotalIntegration.xlsx\"   ) )  # Save example data for PTM-SEA saveRDS(combined_test_diff,         here::here(\"data\", \"combined_test_diff_example.rds\"))"},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"estimating-ptm-feature-usage-by-the-correct-first-approach","dir":"Articles","previous_headings":"Methods","what":"Estimating PTM-feature usage by the correct first approach","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"show estimate DPU using correct first approach. first correct PTM site abundances, using total proteome, model differential usage changes. analysis starts loading prolfquapp outputs. time, read transformed normalized total proteome protein abundances. also loading normalized single-site abundances. addition loading data, create prolfqua::LFQData object using LFQData$new constructor. LFQData object provides numerous methods analyzing visualizing quantitative proteomics data [34]. merge data single-site total proteome protein abundances protein identifier sample. subtract total proteome protein abundances single-site abundances. Density plot (see Figure @ref(fig:fig3densityCorrected)) shows distribution corrected single-site abundances. Next, fit linear model PTM, explains corrected PTM site abundances using grouping samples. model fitted site using prolfqua::build_model function. compute contrasts, construct array contrasts annotation table, built Section @ref(contrasts). following code fragment computes contrasts linear models. presence missing values, PTMs fitted model. Therefore, also estimate contrast using ContrastsMissing method, estimates missing values based inferred limit detection (details, see [34]). Finally, can create volcano plot DPU results using ctr_plotter variable, instance prolfqua::ContrastsPlotter class (see Figure @ref(fig:fig4FDRcorrfirst)). enable downstream analyses sequence motif analysis PTM-SEA, need enrich contrast results sequence window information. phospho_res dataframe loaded earlier contains annotation data need. ctr_df_annotated dataframe now contains DPU statistics (log⁡2\\log_2 fold changes, p-values, FDR) sequence annotations needed motif analysis kinase activity inference.","code":"tot_res_dir <- prophosqua::dea_res_dir(project_dir, \"total_proteome\", datedea) ldata <- arrow::read_parquet(file.path(tot_res_dir,\"lfqdata_normalized.parquet\")) ldata <- ldata |> filter(!grepl(\"^rev_\",protein_Id) ) ldata <- prolfqua::get_UniprotID_from_fasta_header(ldata ) tot_d <- ldata |>    dplyr::select(channel, UniprotID, normalized_abundance) ptm_res_dir <- prophosqua::dea_res_dir(project_dir, \"singlesite_PTM\", datedea) ldata <- arrow::read_parquet(file.path(ptm_res_dir,\"lfqdata_normalized.parquet\")) list <- yaml::read_yaml(file.path(ptm_res_dir,\"lfqdata.yaml\")) config <- prolfqua::list_to_AnalysisConfiguration(list) ptm_data <- prolfqua::LFQData$new(ldata,config) ptm_data$data <- dplyr::inner_join(   ptm_data$data, tot_d,    by = c(\"channel\", protein_Id = \"UniprotID\"), suffix = c(\".site\",\".total\")) ptm_data$data <- ptm_data$data |>    dplyr::mutate(ptm_usage = normalized_abundance.site - normalized_abundance.total) ptm_data$config$table$set_response(\"ptm_usage\") pl <- ptm_data$get_Plotter() fig3_plot <- pl$intensity_distribution_density() strategy_lm <- prolfqua::strategy_lm(\"ptm_usage ~ G_\") models <- prolfqua::build_model(data = ptm_data, model_strategy = strategy_lm) contrasts <- annot2$Contrast  names(contrasts) <- annot2$ContrastName contrasts <- contrasts[!is.na(contrasts)] ctr <- prolfqua::Contrasts$new(models, contrasts) x <- ctr$get_contrasts() ctr_m <- prolfqua::ContrastsMissing$new(ptm_data, contrasts) ctr_all <- prolfqua::merge_contrasts_results(ctr, ctr_m)$merged ctr_df <- ctr_all$get_contrasts() ctr_plotter <- ctr_all$get_Plotter() fig4_plot <- ctr_plotter$volcano()$FDR # Select relevant columns from phospho_res for joining site_annotations <- phospho_res |>   dplyr::select(     site_Id = protein_Id,     SequenceWindow,     posInProtein,     modAA,     fasta.id,     description,     protein_length   ) |>   dplyr::distinct()  # Join to contrast results ctr_df_annotated <- ctr_df |>   dplyr::left_join(site_annotations, by = c(\"modelName\" = \"site_Id\"))  # Rename columns to match the model-first output format ctr_df_annotated <- ctr_df_annotated |>   dplyr::rename(     diff_diff = diff,     FDR_I = FDR   )"},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"sequence-logo-analysis-of-modified-sites","dir":"Articles","previous_headings":"Methods","what":"Sequence Logo Analysis of Modified Sites","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"section guides biological interpretation PTM changes analyzing sequence motifs surrounding significantly modified sites identify potential kinase recognition patterns. analysis bridges gap statistical significance biological mechanism (see Note @ref(overinterpret)) leveraging well-established principle kinases recognize specific amino acid sequence patterns around target sites. Protein kinases exhibit sequence specificity, preferentially phosphorylating sites match recognition motifs. motifs typically encompass positions -5 +4 relative phosphorylation site, specific positions critical others. analyzing sequence patterns significantly regulated sites, can: Identify active kinases: Sites share similar motifs likely represent targets kinase kinase family. Table @ref(tab:tablesites) shows examples kinase-specific sequence motives. Understand pathway activation: Different kinase families associated different signaling pathways Predict functional consequences: Kinase-specific phosphorylation often predictable effects protein function Generate testable hypotheses: Motif predictions can guide follow-experiments kinase inhibitors knockdowns identify potential kinases responsible observed phosphorylation changes, sequence motif analysis performed significantly regulated PTM sites identified DPU analysis. contrast, amino acid sequences flanking significantly regulated sites (.e., FDR<0.01FDR < 0.01 |log⁡2(FC)|>0.58|\\log_2(FC)| > 0.58) extracted grouped regulation status (.e., upregulated downregulated). ggseqlogo R package used generate sequence logo plots group. plots visualize conserved amino acid patterns around modification site, facilitating comparison known kinase recognition motifs enabling inference upstream regulatory kinases (see Table @ref(tab:tablesites)). analysis focuses sites strong statistical evidence ensure motif patterns reflect genuine biological changes rather technical artifacts. dataset, stringent filtering yields many sites (see Table @ref(tab:tableSignificantContrasts)). However, datasets, number sites might insufficient creating sequence logos (see Note @ref(nosignificantPTM)). start filtering DPU data |log⁡2(FC)|>0.58|\\log_2(FC)| > 0.58 FDR≤0.05FDR \\le 0.05. Table @ref(tab:tableSignificantContrasts) summarizes number PTM-features contrast, modification site, - -regulation. observe serine (S) threonine (T), many - downregulated sites, tyrosine (Y), . generating sequence logos, must ensure sequence windows properly centered phosphorylation site. code validates 8th character (center position) sequence window matches reported modified amino acid (Note @ref(seqwindow)). generate sequence logos sites significantly regulated serine threonine phosphorylation. plots organized contrast 3-column layout showing upregulated sites, downregulated sites, difference (- ). difference column highlights amino acids enriched upregulated sites (positive, baseline) versus downregulated sites (negative, baseline), helping identify kinase-specific motifs (see Figure @ref(fig:fig5seqlogoST)). analysis helps identify signaling pathways kinases responsible observed changes phosphorylation experimental conditions. motif analysis yields weak absent sequence patterns, several factors may require optimization, including number significant sites, sequence window size used motif extraction (see Note @ref(motiflimit)).","code":"log_2FC_threshold <- 0.58   significant_sites <- combined_test_diff |>   dplyr::filter(     FDR_I < 0.05,      abs(diff_diff) > log_2FC_threshold,      !is.na(posInProtein),      !grepl(\"^_\", SequenceWindow),     !grepl(\"_$\", SequenceWindow)   ) |>   dplyr::mutate(     regulation = dplyr::case_when(       diff_diff > 0 ~ \"upregulated\",       diff_diff < 0 ~ \"downregulated\",       TRUE ~ \"no_change\"     )   ) significant_sites$seventh_chars <- toupper(substr(significant_sites$SequenceWindow, 8, 8)) significant_sites <- significant_sites |> filter(seventh_chars == modAA) sig_sites_ST <- significant_sites |>   dplyr::filter(modAA == \"S\" | modAA == \"T\")  fig5_plot <- plot_seqlogo_with_diff(sig_sites_ST)"},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"kinase-activity-inference-using-ptm-sea","dir":"Articles","previous_headings":"Methods","what":"Kinase Activity Inference Using PTM-SEA","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Beyond sequence logo visualization, kinase activity can inferred quantitatively using PTM-SEA (Post-Translational Modification Signature Enrichment Analysis) [29]. approach applies Gene Set Enrichment Analysis (GSEA) methodology [43] phosphoproteomics data, treating phosphosites (flanking sequence windows) “genes” kinase substrate signatures “gene sets.” GSEA tests whether members defined set tend appear toward top bottom ranked list rather randomly distributed. PTM-SEA, phosphosites ranked differential abundance (e.g., log⁡2\\log_2 fold change t-statistic), null hypothesis states sites associated given kinase uniformly distributed across ranked list. algorithm calculates enrichment score walking ranked list incrementing running sum encountering set member, decrementing otherwise. Significant positive enrichment consistent increased kinase activity (substrates preferentially upregulated), negative enrichment consistent reduced activity. Defining kinase-substrate relationships, .e., determining whether phosphosite belongs particular kinase, can achieved several complementary approaches. Broad Institute’s PTMsigDB provides curated phosphosite-centered sequence windows (typically 15-mers) experimentally validated kinase assignments. However, requires exact sequence matching provides limited organism coverage: approximately 20,000 annotated sites human, 2,000 mouse, essentially none species. alternative, motif-based analysis uses regular expressions derived consensus phosphorylation motifs scan observed sequences. motifs typically derived aligning known kinase substrates identifying conserved residue positions. example, basophilic motif R-x-x-S/T characteristic PKA CaMKII emerges positively charged substrate-binding groove kinases. comprehensive resource Kinase Library [44], provides atlas substrate specificities human serine/threonine kinome. resource used synthetic peptide libraries profile substrate sequence specificity 303 Ser/Thr kinases, comprising 84%84\\% predicted active humans. Kinase Library enables position-specific scoring matrix (PSSM)-based prediction kinase-substrate relationships freely accessible kinase-library.phosphosite.org. combination curated PTMsigDB signatures, motif-based scanning, comprehensive kinase specificity atlases like Kinase Library provides robust inference kinase activity. PTMsigDB offers high confidence well-studied kinases experimentally validated substrates, motif analysis Kinase Library extend coverage broader phosphoproteome enable quantitative scoring kinase-substrate relationships. Detailed implementation examples provided prophosqua package vignettes Analysis_PTMSEA Analysis_Motif_Enrichment.","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"notelfq","dir":"Articles","previous_headings":"Notes","what":"Label-free quantification vs. TMT-based approach","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"TMT-based quantification offers several advantages, including higher throughput, reduced missing values, improved quantitative precision, also enabling efficient use fractionation since samples represented within fraction. contrast, label-free approaches avoid labeling-related artifacts, can handle unlimited number samples, typically lower per-sample costs. Fractionation strategies benefit particularly TMT, samples can compared directly within fraction reliable cross-fraction integration. contrast, data-independent acquisition (DIA) often preferred avoiding fractionation altogether. Overall, recommend TMT studies requiring high precision across multiple conditions, particularly fractionation can leveraged increase depth. contrast, label-free DIA workflows well-suited discovery-phase studies experiments number samples exceeds multiplexing capacity.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"automatedqc","dir":"Articles","previous_headings":"Notes","what":"Automated QC reporting with FragPipe TMT QC script","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"prophosqua[33] package vignette QCReport.qmd can used generate comprehensive TMT labeling efficiency report, directly FragPipe PSM psm.tsv output file. script evaluates labeling completeness peptide PSM levels N-terminal lysine modifications, calculates missed cleavage rates tryptic digestion efficiency, provides quantitative balance assessment across TMT channels. Key metrics include percentage modified N-termini lysine residues (expected ≥95%\\ge 95\\%), missed cleavage rates lysine arginine residues, relative abundance distributions across channels detect loading imbalances. assess labeling efficiency, TMT labeling lysine residues peptide N-termini must specified variable modification search.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"useofDPADPU","dir":"Articles","previous_headings":"Notes","what":"Use of the integrated DPA/DPU approach","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"integrated DPA/DPU approach suitable biological system study exhibits substantial changes protein expression. cases, distinguishing signaling effects expression-driven effects essential, including protein abundance measurements part study design allows two sources variation effectively separated. contrast, enriched phosphoproteome measurements without corresponding protein data can considered protein expression expected remain stable across conditions, example, experiments short timescales transcriptional translational changes unlikely. strategy may also justified budget limitations make comprehensive protein quantification infeasible.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"matchrates","dir":"Articles","previous_headings":"Notes","what":"Match Rates","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"evaluating integration PTM protein datasets, match rates 80%80\\% generally indicate good consistency. contrast, lower rates may reflect differences protein assignment PTM-enriched total proteome analyses. cases match rates fall 60%60\\%, underlying cause often inconsistent protein identifiers two datasets. address , essential verify analyses utilized FASTA database identical protein inference settings, particular attention database versions inclusion contaminant sequences. preventative measure, identical search parameters databases always applied total proteome PTM analyses, sequence-based matching can improve alignment across datasets.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"nosignificantPTM","dir":"Articles","previous_headings":"Notes","what":"No significant PTM sites detected despite biological expectation","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"absence significant PTM sites, even biological regulation expected, can arise several factors. Error propagation PTM protein measurements may amplify overall uncertainty, masking accurate signals. Insufficient statistical power another common cause, emphasizing need least three biological replicates per group , possible, increasing sample size reducing technical variability. cases, stringent statistical thresholds may obscure true positives, adopting permissive cutoff (e.g., FDR = 0.25 instead 0.05) exploratory analysis can informative. Normalization problems, batch effects inconsistent sample loading, may also contribute checked carefully. Outliers data can distort inference, making useful inspect density scatter plots, example, prolfquapp reports. Finally, examining distribution p-values quality-control summaries can help assess whether statistical model adequately explains variance data. significant differential peptidoform usage (DPU) sites detected despite clear changes PTMs, one possible explanation PTM changes proportional changes parent protein, indicating alteration modification stoichiometry. many cases, represents valid biological result rather technical issue, advisable verify inspecting individual examples protein PTM changes closely correlated. Alternatively, outcome may suggest experimental perturbation primarily influences protein expression rather signaling activity.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"compperf","dir":"Articles","previous_headings":"Notes","what":"Computational Performance Issues","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Long processing times N--C plots often occur generating individual plots hundreds proteins computationally intensive. practical solution limit plot generation proteins particular interest, small FDR values substantial log⁡2\\log_2 fold changes, rather producing plots detected proteins.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"qcrecommend","dir":"Articles","previous_headings":"Notes","what":"Quality Control Recommendations","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"focusing specific phosphorylation sites, essential validate key findings carefully inspecting high-confidence DPU sites ensure technical biological plausibility. example, can achieved verifying number missing values treatment group. addition, protein coverage verified, since meaningful interpretation phosphorylation changes requires corresponding proteins sufficient coverage total proteome. number peptides identified per protein, reported prolfquapp output, can serve filtering criterion.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"overinterpret","dir":"Articles","previous_headings":"Notes","what":"Overinterpretation of statistical significance","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Overinterpretation statistical significance can occur FDR estimates reported without considering design experiment biological context. statistically significant finding necessarily imply biological relevance; therefore, essential evaluate effect sizes alongside p-values assess magnitude potential impact change. Key findings also validated orthogonal methods ensure reflect genuine biological regulation rather statistical technical artifacts.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"dpuvsdpa","dir":"Articles","previous_headings":"Notes","what":"DPA vs DPU Interpretation","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Conflicting results DPA DPU analyses can due : DPA+ : Changes driven protein abundance alterations DPU+ : True signaling changes stable protein levels DPA+ DPU+: Amplified signaling (protein modification efficiency increase) DPA- DPU+: Compensatory regulation (modification increases despite protein decrease) discrepancies DPA DPU often informative rather problematic. Sites significant DPA DPU typically reflect protein-driven changes, whereas DPU-sites indicate genuine signaling regulation independent protein abundance. assess biological plausibility, results cross-referenced known biology supporting literature.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"keyinsight","dir":"Articles","previous_headings":"Notes","what":"Key Insights from This Analysis","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"integrated analysis distinguishes PTM feature abundance usage changes, enabling site-specific insights phosphorylation PTMs regulated. linking DPA DPU results, clarifies whether observed changes reflect protein-level expression signaling pathway activity, highlights key regulatory sites functional validation. Visualization sequence context rigorous statistical modeling support interpretation, allowing researchers generate mechanistic hypotheses, identify pathway-level regulation, prioritize targeted follow-experiments.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"seqwindow","dir":"Articles","previous_headings":"Notes","what":"Extracting sequence windows with prophosqua","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Although FragPipe reports sequence windows single-site report, observed extracted windows correctly aligned, making filtering step necessary. upstream quantification applications report modified amino acid position protein sequence. cases, prophosqua function get_sequence_windows can used. function expects dataframe two columns: protein sequences position modified amino acid. details, see prophosqua documentation [33].","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"motiflimit","dir":"Articles","previous_headings":"Notes","what":"Motif Analysis Limitations","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Weak absent sequence motifs significantly regulated sites can arise several reasons. One possibility significant sites detected, limits statistical power motif discovery. cases, can helpful lower threshold specifically motif analysis increase number sites included. Mixed kinase activities may also obscure motifs, separating upregulated downregulated sites often clarifies distinct regulatory patterns. Additionally, regulation may occur non-canonical mechanisms, phosphatases protein–protein interactions, rather specific kinase recognition motifs. technical considerations, choice sequence window size (e.g., ±5\\pm 5 versus ±7\\pm 7 amino acids), biological factors like PTM crosstalk, can also influence motif detection interpretation. Overall, weak motif signals can result insufficient number significant sites, presence multiple overlapping regulatory activities, regulation mechanisms rely canonical sequence motifs. address issues, one can lower significance threshold motif analysis capture sites. clear kinase sequence pattern emerges, keep mind regulation may involve non-kinase pathways, underscores importance considering statistical biological explanations interpreting motif analysis results.","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"figures","dir":"Articles","previous_headings":"","what":"Figures","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"(ref:fig1Q64337) Multi-panel N--C expression plot showing differential expression total protein abundance (light yellow rectangle) phosphorylation sites (vertical lines, color coded type residue) along protein sequences across contrasts. panel represents different experimental contrast, enabling direct comparison protein PTM expression changes across conditions. vertical lines either dashed solid, depending site’s imputation status. x-axis represents amino acid position N C terminus, y-axis shows log⁡2\\log_2 fold changes. Significantly regulated sites (FDR < 0.05 FDR < 0.01) highlighted one two red asterisks, respectively. (ref:fig1Q64337) (ref:fig2usageQ64337) Multi-panel N--C usage plot showing differential usage phosphorylation sites (vertical lines, color-coded type residue) along protein sequences across contrasts. panel represents different experimental contrast, enabling direct comparison protein-normalized PTM changes across conditions. vertical lines either dashed solid, depending site’s imputation status. x-axis represents amino acid position N C terminus, y-axis shows log⁡2\\log_2 fold changes. Significantly regulated sites (FDR < 0.05 FDR < 0.01) highlighted one two red asterisks, respectively. (ref:fig2usageQ64337) (ref:fig3densityCorrected) Density plot total proteome corrected PTM site abundances. (ref:fig3densityCorrected) (ref:fig4FDRcorrfirst) Volcano plot showing −log⁡10(FDR)-\\log_{10}(FDR) function PTM site log⁡2\\log_2 fold change. (ref:fig4FDRcorrfirst) (ref:fig5seqlogoST) Sequence logo plots showing amino acid motifs surrounding significantly regulated phosphorylation serine threonine residues. row represents contrast three columns: upregulated sites (left), downregulated sites (center), difference (right). difference column, letters baseline indicate amino acids enriched upregulated sites, letters baseline indicate enrichment downregulated sites. Letter height corresponds relative frequency position surrounding phosphorylation site (position 8). (ref:fig5seqlogoST)","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.html","id":"tables","dir":"Articles","previous_headings":"","what":"Tables","title":"Integrated Analysis of Post-Translational Modifications and Total Proteome: Methods for Distinguishing Abundance from Usage Changes","text":"Annotation table created FragPipe outputs, set columns required prolfquapp Annotation table explanatory variables contrasts. Match rates PTM sites proteins. Consensus phosphorylation motifs representative serine/threonine kinases. Motifs defined relative phosphorylated residue (S/T position 0). X = residue; positions relative phospho-acceptor serine/threonine (S/T). Number significantly regulated sites, contrast, amino acid residue, - -regulation.","code":"annot <- readr::read_tsv(\"PTM_example/data_total/dataset.tsv\") knitr::kable(head(annot), caption = \"Annotation table created from FragPipe outputs, with a set of columns required by prolfquapp\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Vis_MEA.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Visualizing Kinase Library MEA Results","text":"vignette demonstrates visualize Motif Enrichment Analysis (MEA) results Kinase Library CLI tools. ’ll create dotplots individual contrasts combined views across contrasts.","code":""},{"path":"https://prolfqua.github.io/prophosqua/articles/Vis_MEA.html","id":"load-libraries-and-data","dir":"Articles","previous_headings":"","what":"Load Libraries and Data","title":"Visualizing Kinase Library MEA Results","text":"Data Loaded","code":"library(dplyr) library(forcats) library(ggplot2) library(purrr) library(tidyr) # Load all MEA results from zip file in inst/extdata zip_path <- system.file(\"extdata\", \"mea_results.zip\", package = \"prophosqua\") mea_files <- unzip(zip_path, list = TRUE)$Name  # Read and combine all MEA results mea_results <- mea_files |>   map_dfr(function(f) {     contrast_name <- gsub(\"^mea_|\\\\.csv$\", \"\", f)     read.csv(unz(zip_path, f)) |>       mutate(contrast = contrast_name)   })  load_info <- tibble(   Metric = c(\"MEA result files\", \"Total rows\", \"Contrasts\"),   Value = c(length(mea_files), nrow(mea_results),             paste(unique(mea_results$contrast), collapse = \", \")) ) knitr::kable(load_info, caption = \"Data Loaded\") # Preview the data structure mea_results |>   select(Kinase, ES, NES, `p.value`, FDR, contrast) |>   head() ##   Kinase         ES       NES     p.value        FDR          contrast ## 1   AAK1 -0.2147255 -1.153435 0.031195841 0.06762887 KO_vs_WT_at_Early ## 2 ACVR2A  0.2177526  1.179734 0.029850746 0.02678547 KO_vs_WT_at_Early ## 3 ACVR2B  0.1979541  1.076529 0.174129353 0.20103144 KO_vs_WT_at_Early ## 4   AKT1 -0.2182856 -1.213511 0.001626016 0.02398590 KO_vs_WT_at_Early ## 5   AKT2 -0.2155801 -1.196881 0.001689189 0.03171077 KO_vs_WT_at_Early ## 6   AKT3 -0.2237104 -1.243654 0.001000000 0.01365129 KO_vs_WT_at_Early"},{"path":"https://prolfqua.github.io/prophosqua/articles/Vis_MEA.html","id":"data-preparation","dir":"Articles","previous_headings":"","what":"Data Preparation","title":"Visualizing Kinase Library MEA Results","text":"Significant Results (FDR < 0.1)","code":"# Clean up and prepare data for plotting mea_clean <- mea_results |>   rename(     kinase = Kinase,     pvalue = `p.value`   ) |>   mutate(     neg_log10_fdr = -log10(FDR + 1e-10),     neg_log10_pval = -log10(pvalue + 1e-10),     significant = FDR < 0.1,     direction = case_when(       NES > 0 ~ \"Up\",       NES < 0 ~ \"Down\",       TRUE ~ \"None\"     )   )  # Summary of significant results sig_summary <- mea_clean |>   filter(significant) |>   group_by(contrast, direction) |>   summarise(n = n(), .groups = \"drop\") |>   pivot_wider(names_from = direction, values_from = n, values_fill = 0) knitr::kable(sig_summary, caption = \"Significant Results (FDR < 0.1)\")"},{"path":"https://prolfqua.github.io/prophosqua/articles/Vis_MEA.html","id":"individual-contrast-dotplots","dir":"Articles","previous_headings":"","what":"Individual Contrast Dotplots","title":"Visualizing Kinase Library MEA Results","text":"","code":"# Function to create dotplot for a single contrast plot_mea_dotplot <- function(data, contrast_name, top_n = 20, fdr_cutoff = 0.25) {   plot_data <- data |>     filter(contrast == contrast_name, FDR < fdr_cutoff) |>     arrange(FDR) |>     head(top_n) |>     mutate(kinase = fct_reorder(kinase, -FDR))     if (nrow(plot_data) == 0) {     return(ggplot() +              annotate(\"text\", x = 0.5, y = 0.5,                       label = paste(\"No significant results for\", contrast_name,                                     \"\\n(FDR <\", fdr_cutoff, \")\")) +              theme_void())   }    ggplot(plot_data, aes(x = NES, y = kinase)) +     geom_point(aes(size = neg_log10_fdr, color = NES)) +     scale_color_gradient2(       low = \"blue\", mid = \"white\", high = \"red\", midpoint = 0,       name = \"NES\"     ) +     scale_size_continuous(name = \"-log10(FDR)\", range = c(2, 8)) +     geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +     labs(       title = paste(\"MEA Results:\", contrast_name),       subtitle = paste(\"Top\", min(top_n, nrow(plot_data)), \"kinases (FDR <\", fdr_cutoff, \")\"),       x = \"Normalized Enrichment Score (NES)\",       y = \"Kinase\"     ) +     theme_minimal() +     theme(       axis.text.y = element_text(size = 9),       plot.title = element_text(face = \"bold\"),       legend.position = \"right\"     ) } # Generate dotplot for each contrast contrasts <- unique(mea_clean$contrast)  walk(contrasts, function(ct) {   p <- plot_mea_dotplot(mea_clean, ct, top_n = 25, fdr_cutoff = 0.25)   print(p) })"},{"path":"https://prolfqua.github.io/prophosqua/articles/Vis_MEA.html","id":"combined-heatmap-across-all-contrasts","dir":"Articles","previous_headings":"","what":"Combined Heatmap Across All Contrasts","title":"Visualizing Kinase Library MEA Results","text":"","code":"# Get top kinases across all contrasts top_kinases <- mea_clean |>   filter(FDR < 0.25) |>   group_by(kinase) |>   summarise(     min_fdr = min(FDR),     mean_abs_nes = mean(abs(NES)),     n_contrasts = n()   ) |>   arrange(min_fdr) |>   head(30) |>   pull(kinase)  # Prepare data for heatmap heatmap_data <- mea_clean |>   filter(kinase %in% top_kinases) |>   select(kinase, contrast, NES, FDR) |>   mutate(     kinase = factor(kinase, levels = rev(top_kinases)),     significance = case_when(       FDR < 0.05 ~ \"***\",       FDR < 0.1 ~ \"**\",       FDR < 0.25 ~ \"*\",       TRUE ~ \"\"     )   )  # Create heatmap ggplot(heatmap_data, aes(x = contrast, y = kinase, fill = NES)) +   geom_tile(color = \"white\", linewidth = 0.5) +   geom_text(aes(label = significance), color = \"black\", size = 3) +   scale_fill_gradient2(     low = \"blue\", mid = \"white\", high = \"red\", midpoint = 0,     name = \"NES\",     limits = c(-max(abs(heatmap_data$NES)), max(abs(heatmap_data$NES)))   ) +   labs(     title = \"Kinase Activity Across Contrasts\",     subtitle = \"Top 30 kinases by FDR (* p<0.25, ** p<0.1, *** p<0.05)\",     x = \"Contrast\",     y = \"Kinase\"   ) +   theme_minimal() +   theme(     axis.text.x = element_text(angle = 45, hjust = 1, size = 10),     axis.text.y = element_text(size = 9),     plot.title = element_text(face = \"bold\"),     panel.grid = element_blank()   )"},{"path":"https://prolfqua.github.io/prophosqua/articles/Vis_MEA.html","id":"combined-dotplot-faceted","dir":"Articles","previous_headings":"","what":"Combined Dotplot (Faceted)","title":"Visualizing Kinase Library MEA Results","text":"","code":"# Top kinases for faceted plot plot_data_facet <- mea_clean |>   filter(kinase %in% top_kinases) |>   mutate(kinase = factor(kinase, levels = rev(top_kinases)))  ggplot(plot_data_facet, aes(x = NES, y = kinase)) +   geom_point(aes(size = neg_log10_fdr, color = NES, alpha = significant)) +   scale_color_gradient2(     low = \"blue\", mid = \"white\", high = \"red\", midpoint = 0,     name = \"NES\"   ) +   scale_size_continuous(name = \"-log10(FDR)\", range = c(1, 6)) +   scale_alpha_manual(values = c(\"TRUE\" = 1, \"FALSE\" = 0.3), guide = \"none\") +   geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\") +   facet_wrap(~contrast, ncol = 2) +   labs(     title = \"MEA Results Across All Contrasts\",     subtitle = \"Top 30 kinases by minimum FDR (transparent = FDR >= 0.1)\",     x = \"Normalized Enrichment Score (NES)\",     y = \"Kinase\"   ) +   theme_minimal() +   theme(     axis.text.y = element_text(size = 7),     strip.text = element_text(face = \"bold\", size = 10),     plot.title = element_text(face = \"bold\"),     legend.position = \"right\"   )"},{"path":"https://prolfqua.github.io/prophosqua/articles/Vis_MEA.html","id":"volcano-style-plot","dir":"Articles","previous_headings":"","what":"Volcano-style Plot","title":"Visualizing Kinase Library MEA Results","text":"","code":"# Volcano plot for each contrast ggplot(mea_clean, aes(x = NES, y = neg_log10_fdr)) +  geom_point(aes(color = significant), alpha = 0.6, size = 2) +   geom_hline(yintercept = -log10(0.1), linetype = \"dashed\", color = \"red\") +   geom_text(     data = mea_clean |>       filter(FDR < 0.05) |>       group_by(contrast) |>       slice_min(FDR, n = 5),     aes(label = kinase),     size = 2.5,     hjust = -0.1,     check_overlap = TRUE   ) +   scale_color_manual(     values = c(\"TRUE\" = \"red\", \"FALSE\" = \"gray50\"),     name = \"FDR < 0.1\"   ) +   facet_wrap(~contrast, scales = \"free\") +   labs(     title = \"MEA Volcano Plots\",     subtitle = \"Dashed line: FDR = 0.1; Labels: top 5 by FDR per contrast\",     x = \"Normalized Enrichment Score (NES)\",     y = \"-log10(FDR)\"   ) +   theme_minimal() +   theme(     strip.text = element_text(face = \"bold\"),     plot.title = element_text(face = \"bold\")   )"},{"path":"https://prolfqua.github.io/prophosqua/articles/Vis_MEA.html","id":"summary-table","dir":"Articles","previous_headings":"","what":"Summary Table","title":"Visualizing Kinase Library MEA Results","text":"Significant Kinases (FDR < 0.1)","code":"# Summary of significant kinases summary_table <- mea_clean |>   filter(FDR < 0.1) |>   select(contrast, kinase, NES, FDR) |>   arrange(contrast, FDR) |>   mutate(     NES = round(NES, 3),     FDR = signif(FDR, 3)   )  if (nrow(summary_table) > 0) {   knitr::kable(     summary_table,     caption = \"Significant Kinases (FDR < 0.1)\",     col.names = c(\"Contrast\", \"Kinase\", \"NES\", \"FDR\")   ) }"},{"path":"https://prolfqua.github.io/prophosqua/articles/Vis_MEA.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Visualizing Kinase Library MEA Results","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Tahoe 26.1 ##  ## Matrix products: default ## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: Europe/Zurich ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] tidyr_1.3.1   purrr_1.2.0   ggplot2_4.0.1 forcats_1.0.1 dplyr_1.1.4   ##  ## loaded via a namespace (and not attached): ##  [1] gtable_0.3.6       jsonlite_2.0.0     compiler_4.5.2     tidyselect_1.2.1   ##  [5] jquerylib_0.1.4    systemfonts_1.3.1  scales_1.4.0       textshaping_1.0.4  ##  [9] yaml_2.3.11        fastmap_1.2.0      R6_2.6.1           labeling_0.4.3     ## [13] generics_0.1.4     knitr_1.50         htmlwidgets_1.6.4  tibble_3.3.0       ## [17] bookdown_0.46      desc_1.4.3         bslib_0.9.0        pillar_1.11.1      ## [21] RColorBrewer_1.1-3 rlang_1.1.6        cachem_1.1.0       xfun_0.54          ## [25] fs_1.6.6           sass_0.4.10        S7_0.2.1           cli_3.6.5          ## [29] withr_3.0.2        pkgdown_2.2.0      magrittr_2.0.4     digest_0.6.39      ## [33] grid_4.5.2         lifecycle_1.0.4    vctrs_0.6.5        evaluate_1.0.5     ## [37] glue_1.8.0         farver_2.1.2       ragg_1.5.0         rmarkdown_2.30     ## [41] tools_4.5.2        pkgconfig_2.0.3    htmltools_0.5.9"},{"path":"https://prolfqua.github.io/prophosqua/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jonas Grossmann. Author. Witold Wolski. Author, maintainer.","code":""},{"path":"https://prolfqua.github.io/prophosqua/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Grossmann J, Wolski W (2025). prophosqua: Integrate TMT-Labeled Phosphoproteomics Total Proteomics Data. R package version 0.2.0, https://prolfqua.github.io/prophosqua.","code":"@Manual{,   title = {prophosqua: Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data},   author = {Jonas Grossmann and Witold Wolski},   year = {2025},   note = {R package version 0.2.0},   url = {https://prolfqua.github.io/prophosqua}, }"},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"prophosqua","dir":"","previous_headings":"","what":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"Integration phosphoproteome total proteome data comprehensive PTM analysis prophosqua package provides tools integrating analyzing post-translational modification (PTM) data total proteome measurements. enables researchers distinguish changes protein abundance changes modification site usage, providing deeper insights cellular signaling regulation.","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"prophosqua builds upon prolfqua prolfquapp packages provide: Differential PTM Feature Expression (DPE) - Analysis modification site abundance changes Differential PTM Feature Usage (DPU) - Analysis modification site usage relative total protein N--C plots - Visualization phosphorylation sites along protein backbones Sequence logo analysis - Identification kinase recognition motifs Statistical integration - Combined analysis phosphoproteome total proteome data","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"prerequisites","dir":"","previous_headings":"Installation","what":"Prerequisites","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"package depends several packages installed first: detailed installation instructions system requirements, see: - prolfqua GitHub repository - prolfquapp GitHub repository","code":"# Install prolfqua (core proteomics analysis package) library(devtools) devtools::install_github('protviz/prozor', dependencies = TRUE) devtools::install_github('prolfqua/prolfqua', dependencies = TRUE) # Install prolfquapp (proteomics analysis workflow package) devtools::install_github('prolfqua/prolfquapp', dependencies = TRUE)"},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"install-prophosqua","dir":"","previous_headings":"Installation","what":"Install prophosqua","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"","code":"library(devtools) devtools::install_github('prolfqua/prophosqua', dependencies = TRUE)"},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"basic-workflow","dir":"","previous_headings":"Usage","what":"Basic Workflow","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"Run differential expression analysis using prolfquapp total proteome PTM data Integrate results using prophosqua::test_diff() Visualize data N--C plots sequence logos Generate comprehensive reports statistical summaries","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"example","dir":"","previous_headings":"Usage","what":"Example","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"","code":"library(prophosqua)  # Load your data tot_res <- load_and_preprocess_data(total_proteome_file, required_cols) phospho_res <- load_and_preprocess_data(ptm_file, required_cols)  # Integrate analysis combined_test_diff <- test_diff(phospho_res, tot_res, join_column = join_column)  # Create visualizations plot_data <- n_to_c_usage(combined_test_diff, contrast_name, FDR_threshold = 0.05)"},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"vignettes-and-documentation","dir":"","previous_headings":"","what":"Vignettes and Documentation","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"package includes comprehensive vignettes demonstrate complete analysis workflow:","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"rendering-vignettes","dir":"","previous_headings":"Vignettes and Documentation","what":"Rendering Vignettes","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"following code renders vignettes copies example directory: code: 1. Renders R Markdown files HTML using rmarkdown::render() 2. Copies HTML files inst/PTM_analysis_example/ directory easy access 3. Creates interactive reports code folding navigation","code":"# Render the differential expression analysis vignette  wd <- \"inst/PTM_analysis_example\"   rmarkdown::render(\"vignettes/QCReport.qmd\", params=list(wd=wd, psm=\"ptm_example-main/qc_example_data/QCmini/psm.tsv\", fasta=\"ptm_example-main/qc_example_data/fgcz_3702_UP000006548_AraUniprot_1spg_d_20231024.fasta\", workunit=\"exampleQC\", projectid=\"ABCD1234\")) file.copy(\"vignettes/QCReport.html\", file.path(wd,\"QCReport.html\"))  # Render the PTM integration and visualization vignette   rmarkdown::render(\"vignettes/Supplementary_Material_v2.Rmd\", params=list(wd = wd, dodea = TRUE), output_format=bookdown::pdf_document2()) file.copy(\"vignettes/Supplementary_Material_v2.pdf\", file.path(wd,\"Supplementary_Material_v2.pdf\"))  rmarkdown::render(\"vignettes/Supplementary_Material_v2.Rmd\", params=list(wd = wd, dodea = FALSE), output_format=bookdown::html_document2()) file.copy(\"vignettes/Supplementary_Material_v2.html\", file.path(wd,\"Supplementary_Material_v2.html\"))"},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"available-vignettes","dir":"","previous_headings":"Vignettes and Documentation","what":"Available Vignettes","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"Run_DEA_prolfquapp.Rmd - Complete workflow differential expression analysis Visualize_PTM_features.Rmd - Integration visualization PTM data Interactive reports - Available inst/PTM_analysis_example/ directory","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"core-dependencies","dir":"","previous_headings":"Related Publications","what":"Core Dependencies","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"prolfqua: Proteomics data analysis R - MSstatsPTM publication prolfquapp: Proteomics analysis workflow package - msqrob2PTM publication","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"related-work","dir":"","previous_headings":"Related Publications","what":"Related Work","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"MSstatsPTM - Statistical analysis PTM data msqrob2PTM - Robust statistical methods PTM analysis","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"github-repositories","dir":"","previous_headings":"","what":"GitHub Repositories","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"prolfqua - Core proteomics analysis package prolfquapp - Proteomics analysis workflow package prophosqua - PTM integration analysis package","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"poster","dir":"","previous_headings":"","what":"Poster","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"Prophosqua Poster SIBDays 2024","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"use package research, please cite:","code":"@article{prophosqua2024,   title={prophosqua: Integration of phosphoproteome and total proteome data},   author={Functional Genomics Center Zurich},   journal={Bioinformatics},   year={2024} }"},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"build-pkgdown-site-locally","dir":"","previous_headings":"Building and Deploying Documentation","what":"Build pkgdown site locally","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"","code":"pkgdown::build_site()"},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"deploy-to-github-pages","dir":"","previous_headings":"Building and Deploying Documentation","what":"Deploy to GitHub Pages","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"enable GitHub Pages repo settings (Settings → Pages → Source: gh-pages branch). Site: https://prolfqua.github.io/prophosqua","code":"# Using ghp-import (via uv) uvx ghp-import -n -p -f docs"},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"Contributions welcome! Please visit GitHub repository : - Issue reporting - Feature requests - Code contributions - Documentation improvements","code":""},{"path":"https://prolfqua.github.io/prophosqua/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Integrate TMT-Labeled Phosphoproteomics and Total Proteomics Data","text":"package released MIT License.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/calculate_optimal_layout.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate optimal grid layout for multi-panel plots — calculate_optimal_layout","title":"Calculate optimal grid layout for multi-panel plots — calculate_optimal_layout","text":"Calculate optimal grid layout multi-panel plots","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/calculate_optimal_layout.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate optimal grid layout for multi-panel plots — calculate_optimal_layout","text":"","code":"calculate_optimal_layout(n_panels)"},{"path":"https://prolfqua.github.io/prophosqua/reference/calculate_optimal_layout.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate optimal grid layout for multi-panel plots — calculate_optimal_layout","text":"n_panels Number panels arrange","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/calculate_optimal_layout.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate optimal grid layout for multi-panel plots — calculate_optimal_layout","text":"List ncol nrow grid layout","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/copy_phospho_integration.html","id":null,"dir":"Reference","previous_headings":"","what":"copy Markdown and runscript for FragPipe combined_protein.tsv — copy_phospho_integration","title":"copy Markdown and runscript for FragPipe combined_protein.tsv — copy_phospho_integration","text":"copy Markdown runscript FragPipe combined_protein.tsv","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/copy_phospho_integration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"copy Markdown and runscript for FragPipe combined_protein.tsv — copy_phospho_integration","text":"","code":"copy_phospho_integration(workdir = getwd())"},{"path":"https://prolfqua.github.io/prophosqua/reference/copy_phospho_integration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"copy Markdown and runscript for FragPipe combined_protein.tsv — copy_phospho_integration","text":"workdir directory copy file - default current working directory.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dea_res_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"get xlsx path — dea_res_dir","title":"get xlsx path — dea_res_dir","text":"get xlsx path","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dea_res_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get xlsx path — dea_res_dir","text":"","code":"dea_res_dir(project_dir, WU, date)"},{"path":"https://prolfqua.github.io/prophosqua/reference/dea_xlsx_path.html","id":null,"dir":"Reference","previous_headings":"","what":"get xlsx path — dea_xlsx_path","title":"get xlsx path — dea_xlsx_path","text":"get xlsx path","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dea_xlsx_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get xlsx path — dea_xlsx_path","text":"","code":"dea_xlsx_path(project_dir, WU, date)"},{"path":"https://prolfqua.github.io/prophosqua/reference/derive_motifs_from_gmt.html","id":null,"dir":"Reference","previous_headings":"","what":"Derive motifs from PTMsigDB GMT file — derive_motifs_from_gmt","title":"Derive motifs from PTMsigDB GMT file — derive_motifs_from_gmt","text":"Analyzes GMT file (containing lists aligned substrate sequences kinase) generates \"consensus\" regular expression kinase based residue frequency.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/derive_motifs_from_gmt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Derive motifs from PTMsigDB GMT file — derive_motifs_from_gmt","text":"","code":"derive_motifs_from_gmt(   gmt_file,   freq_threshold = 0.3,   min_seqs = 10,   trim_to = 15 )"},{"path":"https://prolfqua.github.io/prophosqua/reference/derive_motifs_from_gmt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Derive motifs from PTMsigDB GMT file — derive_motifs_from_gmt","text":"gmt_file Path PTMsigDB GMT file (e.g., \"ptm.sig.db..flanking...gmt\"). freq_threshold Numeric (0-1). Minimum frequency residue (group) included regex. Default 0.3 (30 percent). min_seqs Integer. Minimum number sequences required derive motif kinase. Default 10. trim_to Integer. Width analyzed window (must odd). Default 15.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/derive_motifs_from_gmt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Derive motifs from PTMsigDB GMT file — derive_motifs_from_gmt","text":"data.frame columns: kinase_group, motif_name, pattern, description","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dot-test_diff_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Test if differences of differences are significant — .test_diff_diff","title":"Test if differences of differences are significant — .test_diff_diff","text":"Test differences differences significant","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/dot-test_diff_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test if differences of differences are significant — .test_diff_diff","text":"","code":".test_diff_diff(   dataframe_a,   dataframe_b,   by,   diff = c(\"diff\"),   std_err = c(\"std.error\"),   df = c(\"df\"),   suffix_a = \".site\",   suffix_b = \".protein\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.html","id":null,"dir":"Reference","previous_headings":"","what":"Download PTMsigDB signatures — download_ptmsigdb","title":"Download PTMsigDB signatures — download_ptmsigdb","text":"Downloads caches PTMsigDB GMT files Broad Institute ssGSEA2.0 repository. PTMsigDB v2.0.0 uses flanking sequences (15 amino acids centered phosphosite), making analysis species-invariant within vertebrates.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download PTMsigDB signatures — download_ptmsigdb","text":"","code":"download_ptmsigdb(   species = \"mouse\",   version = \"v2.0.0\",   output_dir = \".\",   force_download = FALSE )"},{"path":"https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download PTMsigDB signatures — download_ptmsigdb","text":"species Character. Species signatures (\"mouse\" \"human\"). Default \"mouse\". version Character. PTMsigDB version. Default \"v2.0.0\". output_dir Character. Directory cached files. Default current directory. force_download Logical. Force re-download even cached. Default FALSE.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download PTMsigDB signatures — download_ptmsigdb","text":"Character path cached GMT file.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Download PTMsigDB signatures — download_ptmsigdb","text":"Krug et al. (2019) Curated Resource Phosphosite-specific Signature Analysis. Mol Cell Proteomics. doi:10.1074/mcp.TIR118.000943","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download PTMsigDB signatures — download_ptmsigdb","text":"","code":"if (FALSE) { # \\dontrun{ gmt_path <- download_ptmsigdb(species = \"mouse\", output_dir = \"ptmsea_cache\") pathways <- fgsea::gmtPathways(gmt_path) } # }"},{"path":"https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Example dataset exampleN_C_dat — exampleN_C_dat","title":"Example dataset exampleN_C_dat — exampleN_C_dat","text":"simple example dataset demonstrating groups numeric values.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example dataset exampleN_C_dat — exampleN_C_dat","text":"","code":"exampleN_C_dat"},{"path":"https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example dataset exampleN_C_dat — exampleN_C_dat","text":"## `exampleN_C_dat`","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat_no_prot.html","id":null,"dir":"Reference","previous_headings":"","what":"Example dataset exampleN_C_dat_no_prot — exampleN_C_dat_no_prot","title":"Example dataset exampleN_C_dat_no_prot — exampleN_C_dat_no_prot","text":"simple example dataset demonstrating groups numeric values.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat_no_prot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example dataset exampleN_C_dat_no_prot — exampleN_C_dat_no_prot","text":"","code":"exampleN_C_dat_no_prot"},{"path":"https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat_no_prot.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example dataset exampleN_C_dat_no_prot — exampleN_C_dat_no_prot","text":"## `exampleN_C_dat_no_prot`","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/explode_multisites.html","id":null,"dir":"Reference","previous_headings":"","what":"each site goes into own row, if more then on site per multisite — explode_multisites","title":"each site goes into own row, if more then on site per multisite — explode_multisites","text":"site goes row, site per multisite","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/explode_multisites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"each site goes into own row, if more then on site per multisite — explode_multisites","text":"","code":"explode_multisites(combined_site)"},{"path":"https://prolfqua.github.io/prophosqua/reference/filter_contaminants.html","id":null,"dir":"Reference","previous_headings":"","what":"filter contaminants — filter_contaminants","title":"filter contaminants — filter_contaminants","text":"filter contaminants","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/filter_contaminants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filter contaminants — filter_contaminants","text":"","code":"filter_contaminants(data, protein_id_col = \"protein_Id\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/get_kinase_motifs.html","id":null,"dir":"Reference","previous_headings":"","what":"Get default list of kinase motifs — get_kinase_motifs","title":"Get default list of kinase motifs — get_kinase_motifs","text":"Returns data.frame common kinase motifs defined regular expressions. Patterns designed match 15-mer sequences centered phosphosite.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_kinase_motifs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get default list of kinase motifs — get_kinase_motifs","text":"","code":"get_kinase_motifs(extra_motifs = NULL)"},{"path":"https://prolfqua.github.io/prophosqua/reference/get_kinase_motifs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get default list of kinase motifs — get_kinase_motifs","text":"extra_motifs Optional data.frame append default list. Must columns: kinase_group, motif_name, pattern, description.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_kinase_motifs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get default list of kinase motifs — get_kinase_motifs","text":"data.frame columns: kinase_group, motif_name, pattern, description","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_kinase_motifs.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Get default list of kinase motifs — get_kinase_motifs","text":"list compiled \"starter set\" well-known consensus motifs literature (e.g. classical definitions PKA, PKC, CK2, CDK, etc.). contain entire proprietary PhosphoSitePlus database. Users access curated motif databases load using `read_kinase_motifs_csv` pass `extra_motifs`.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_kinase_motifs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get default list of kinase motifs — get_kinase_motifs","text":"","code":"motifs <- get_kinase_motifs() head(motifs) #>   kinase_group        motif_name          pattern #> 1   Basophilic PKA_AKT_consensus   R.R..[ST]..... #> 2   Basophilic       PKA_Classic         R.[ST].. #> 3   Basophilic       PKC_General      ..[ST].[RK] #> 4   Basophilic          Akt_RRxS       RR.[ST]... #> 5   Basophilic             CAMK2       R..[ST]... #> 6   Basophilic Substrate_RK_rich [RK][RK].[ST]... #>                                          description #> 1 R-x-R-x-x-S/T (PKA, AKT, etc. - strong basophilic) #> 2                              R-x-S/T (PKA classic) #> 3                            S/T-x-R/K (PKC general) #> 4                         R-R-x-S/T (Akt preference) #> 5                                 R-x-x-S/T (CaMKII) #> 6            Basic residues upstream (R/K-R/K-x-S/T)"},{"path":"https://prolfqua.github.io/prophosqua/reference/get_pwm.html","id":null,"dir":"Reference","previous_headings":"","what":"Create PWM from amino acid sequences — get_pwm","title":"Create PWM from amino acid sequences — get_pwm","text":"Internal helper function compute position weight matrix (PWM) vector amino acid sequences.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_pwm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create PWM from amino acid sequences — get_pwm","text":"","code":"get_pwm(sequences)"},{"path":"https://prolfqua.github.io/prophosqua/reference/get_pwm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create PWM from amino acid sequences — get_pwm","text":"sequences Character vector amino acid sequences (must length)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_pwm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create PWM from amino acid sequences — get_pwm","text":"matrix amino acids rows positions columns","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_sequence_windows.html","id":null,"dir":"Reference","previous_headings":"","what":"extract sequence windows, from sequence at pos in protein — get_sequence_windows","title":"extract sequence windows, from sequence at pos in protein — get_sequence_windows","text":"extract sequence windows, sequence pos protein","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_sequence_windows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"extract sequence windows, from sequence at pos in protein — get_sequence_windows","text":"","code":"get_sequence_windows(   unique_prot_pep_seq,   flank_size = 7,   sequence = \"sequence\",   pos_in_protein = \"pos_in_protein\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/get_sequence_windows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"extract sequence windows, from sequence at pos in protein — get_sequence_windows","text":"unique_prot_pep_seq data.frame sequence pos protein flank_size size window extract sequence name column sequence pos_in_protein name column position protein","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/get_sequence_windows.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"extract sequence windows, from sequence at pos in protein — get_sequence_windows","text":"","code":"# Create sample data library(tidyverse) #> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ── #> ✔ dplyr     1.1.4     ✔ readr     2.1.6 #> ✔ forcats   1.0.1     ✔ stringr   1.6.0 #> ✔ ggplot2   4.0.1     ✔ tibble    3.3.0 #> ✔ lubridate 1.9.4     ✔ tidyr     1.3.1 #> ✔ purrr     1.2.0      #> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ── #> ✖ dplyr::filter() masks stats::filter() #> ✖ dplyr::lag()    masks stats::lag() #> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors sample_data <- data.frame(   protein_id = c(\"P12345\", \"P12345\", \"Q67890\"),   sequence = c(\"MKFLVLLFNILCLFPVLAADNH\", \"MKFLVLLFNILCLFPVLAADNH\", \"AEQKLISEEDLLRKRREQLKHKLEQL\"),   pos_in_protein = c(5, 12, 8),   peptide = c(\"FLV\", \"ILC\", \"EED\") )  # Extract sequence windows with default flank size (7) result <- get_sequence_windows(sample_data) stopifnot(all(result$sequence_window == c( \"XXXMKFLVLLFNILC\", \"VLLFNILCLFPVLAA\", \"AEQKLISEEDLLRKR\")))  # Extract sequence windows with custom flank size result_small <- get_sequence_windows(sample_data, flank_size = 3) stopifnot(all(result_small$sequence_window == c( \"KFLVLLF\",  \"NILCLFP\",  \"LISEEDL\")))  # Extract sequence windows with different column names sample_data2 <- data.frame(   prot_seq = \"MKTAYIAKQRQISFVKSHFSRQLEERLGLIEVQAPILSRVGDGTQDNLSGAEKAVQVKVKALPDAQFEVVHSLAKWKRIY\",   position = c(10, 25, 40) )  result2 <- get_sequence_windows(sample_data2,                                flank_size = 5,                                sequence = \"prot_seq\",                                pos_in_protein = \"position\") print(result2$sequence_window) #> [1] \"YIAKQRQISFV\" \"SRQLEERLGLI\" \"PILSRVGDGTQ\""},{"path":"https://prolfqua.github.io/prophosqua/reference/load_and_preprocess_data.html","id":null,"dir":"Reference","previous_headings":"","what":"load_and_preprocess_data — load_and_preprocess_data","title":"load_and_preprocess_data — load_and_preprocess_data","text":"load_and_preprocess_data","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/load_and_preprocess_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"load_and_preprocess_data — load_and_preprocess_data","text":"","code":"load_and_preprocess_data(   file_path,   required_cols,   sheet_name = \"diff_exp_analysis\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/make_fasta_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Make FASTA database summary — make_fasta_summary","title":"Make FASTA database summary — make_fasta_summary","text":"Generates database statistics including number sequences amino acid frequencies. Extracted prozor package reduce dependencies.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/make_fasta_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make FASTA database summary — make_fasta_summary","text":"","code":"make_fasta_summary(resDB, old = FALSE, as_string = TRUE)"},{"path":"https://prolfqua.github.io/prophosqua/reference/make_fasta_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make FASTA database summary — make_fasta_summary","text":"resDB list sequences prozor::readPeptideFasta old Logical; use old (slower) method AA frequency calculation as_string Logical; return formatted string (TRUE) list (FALSE)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/make_fasta_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make FASTA database summary — make_fasta_summary","text":"as_string=TRUE, array strings pass cat().   as_string=FALSE, list nrSequences, lengthSummary, aafreq.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/make_fasta_summary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make FASTA database summary — make_fasta_summary","text":"","code":"if (FALSE) { # \\dontrun{ fasta <- prozor::readPeptideFasta(\"path/to/file.fasta\") cat(make_fasta_summary(fasta)) } # }"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_c_integrated_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Example dataset n_c_integrated_df — n_c_integrated_df","title":"Example dataset n_c_integrated_df — n_c_integrated_df","text":"simple example dataset demonstrating groups numeric values.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_c_integrated_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example dataset n_c_integrated_df — n_c_integrated_df","text":"","code":"n_c_integrated_df"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_c_integrated_df.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example dataset n_c_integrated_df — n_c_integrated_df","text":"## `n_c_integrated_df`","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot protein and PTM expression — n_to_c_expression","title":"Plot protein and PTM expression — n_to_c_expression","text":"Plot protein PTM expression","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot protein and PTM expression — n_to_c_expression","text":"","code":"n_to_c_expression(   combined_site_prot_long,   contrast_name,   FDR_threshold = 0.05,   fc_threshold = 0,   impute_flag = \"Imputed_Mean_moderated\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot protein and PTM expression — n_to_c_expression","text":"combined_site_prot_long data frame combined site protein data contrast_name name contrast plot FDR_threshold FDR threshold filtering significant sites (default 0.05) fc_threshold Fold change threshold filtering (default 0) impute_flag Flag imputed values (default \"Imputed_Mean_moderated\")","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot protein and PTM expression — n_to_c_expression","text":"data frame protein_Id, protein_length, contrast, data, plot","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression_multicontrast.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot protein and PTM expression across all contrasts in multi-panel layout — n_to_c_expression_multicontrast","title":"Plot protein and PTM expression across all contrasts in multi-panel layout — n_to_c_expression_multicontrast","text":"Plot protein PTM expression across contrasts multi-panel layout","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression_multicontrast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot protein and PTM expression across all contrasts in multi-panel layout — n_to_c_expression_multicontrast","text":"","code":"n_to_c_expression_multicontrast(   combined_site_prot_long,   FDR_threshold = 0.05,   fc_threshold = 0,   impute_flag = \"Imputed_Mean_moderated\",   max_plots = NULL,   include_proteins = NULL )"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression_multicontrast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot protein and PTM expression across all contrasts in multi-panel layout — n_to_c_expression_multicontrast","text":"combined_site_prot_long data frame combined site protein data FDR_threshold FDR threshold filtering significant sites (default 0.05) fc_threshold Fold change threshold filtering (default 0) impute_flag Flag imputed values (default \"Imputed_Mean_moderated\") max_plots Maximum number plots generate (default NULL = limit). specified, first max_plots proteins plotted. include_proteins Character vector protein IDs always include output, regardless max_plots limit (default NULL). proteins added even exceed max_plots limit.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression_multicontrast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot protein and PTM expression across all contrasts in multi-panel layout — n_to_c_expression_multicontrast","text":"data frame protein_Id, protein_length, n_contrasts, multi-panel plot","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_expression_multicontrast.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot protein and PTM expression across all contrasts in multi-panel layout — n_to_c_expression_multicontrast","text":"","code":"# data(combined_site_prot_data) # result <- n_to_c_expression_multicontrast(combined_site_prot_data, #   max_plots = 50, include_proteins = c(\"Q64337\")) # print(result$plot[[1]])  # Display first protein's multi-contrast plot"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"N to C plot using ggplot2 — n_to_c_plot","title":"N to C plot using ggplot2 — n_to_c_plot","text":"N C plot using ggplot2","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"N to C plot using ggplot2 — n_to_c_plot","text":"","code":"n_to_c_plot(   poi_matrix_min,   protein_name,   prot_length,   contrast,   thr_a = 0.05,   thr_b = 0.2,   color_protein = \"yellow\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"N to C plot using ggplot2 — n_to_c_plot","text":"protein_name name protein contrast name contrast POI_matrixMin data.frame protLength protein length thrA significance threshold small default 0.05 thrB significance threshold small large default 0.20","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"N to C plot using ggplot2 — n_to_c_plot","text":"","code":"data(exampleN_C_dat) # Prepare data for plotting poi_matrix_min <- prepare_n_to_c_data(exampleN_C_dat)  n_to_c_plot(subset(poi_matrix_min, protein_Id == \"A0A1I9LPZ1\"), \"A0A1I9LPZ1\", 2160, \"H1FC\")  n_to_c_plot(subset(poi_matrix_min, protein_Id == \"A0A178US29\"), \"A0A178US29\", 806, \"H1FC\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot_integrated.html","id":null,"dir":"Reference","previous_headings":"","what":"N to C for integrated results — n_to_c_plot_integrated","title":"N to C for integrated results — n_to_c_plot_integrated","text":"N C integrated results","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot_integrated.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"N to C for integrated results — n_to_c_plot_integrated","text":"","code":"n_to_c_plot_integrated(   poi_matrix_min,   protein_name,   prot_length,   contrast,   thr_a = 0.05,   thr_b = 0.2,   color_protein = \"yellow\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot_integrated.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"N to C for integrated results — n_to_c_plot_integrated","text":"POI_matrixMin data.frame","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_plot_integrated.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"N to C for integrated results — n_to_c_plot_integrated","text":"","code":"data(n_c_integrated_df) n_c_integrated_df$imputation_status <- \"observed\" n_to_c_plot_integrated(n_c_integrated_df, \"A0A1I9LT44\", 539, \"WTFC\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot PTM occupation, use after adjusting for total proteome — n_to_c_usage","title":"Plot PTM occupation, use after adjusting for total proteome — n_to_c_usage","text":"Plot PTM occupation, use adjusting total proteome","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot PTM occupation, use after adjusting for total proteome — n_to_c_usage","text":"","code":"n_to_c_usage(   data_combined_diff,   contrast_name,   FDR_threshold = 0.05,   fc_threshold = 0,   impute_flag = \"Imputed_Mean_moderated\",   protein_Id = \"protein_Id\" )"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot PTM occupation, use after adjusting for total proteome — n_to_c_usage","text":"data_combined_diff data frame combined differential analysis results contrast_name name contrast plot FDR_threshold FDR threshold filtering significant sites (default 0.05) fc_threshold Fold change threshold filtering (default 0) impute_flag Flag imputed values (default \"Imputed_Mean_moderated\") protein_Id Column name protein identifier (default \"protein_Id\")","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot PTM occupation, use after adjusting for total proteome — n_to_c_usage","text":"data frame protein_Id, protein_length, contrast, data, plot","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage_multicontrast.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot PTM usage across all contrasts in multi-panel layout — n_to_c_usage_multicontrast","title":"Plot PTM usage across all contrasts in multi-panel layout — n_to_c_usage_multicontrast","text":"Plot PTM usage across contrasts multi-panel layout","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage_multicontrast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot PTM usage across all contrasts in multi-panel layout — n_to_c_usage_multicontrast","text":"","code":"n_to_c_usage_multicontrast(   data_combined_diff,   FDR_threshold = 0.05,   fc_threshold = 0,   impute_flag = \"Imputed_Mean_moderated\",   protein_Id = \"protein_Id\",   max_plots = NULL,   include_proteins = NULL )"},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage_multicontrast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot PTM usage across all contrasts in multi-panel layout — n_to_c_usage_multicontrast","text":"data_combined_diff data frame combined differential analysis results FDR_threshold FDR threshold filtering significant sites (default 0.05) fc_threshold Fold change threshold filtering (default 0) impute_flag Flag imputed values (default \"Imputed_Mean_moderated\") protein_Id Column name protein identifier (default \"protein_Id\") max_plots Maximum number plots generate (default NULL = limit). specified, first max_plots proteins plotted. include_proteins Character vector protein IDs always include output, regardless max_plots limit (default NULL). proteins added even exceed max_plots limit.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage_multicontrast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot PTM usage across all contrasts in multi-panel layout — n_to_c_usage_multicontrast","text":"data frame protein_Id, protein_length, n_contrasts, multi-panel plot","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/n_to_c_usage_multicontrast.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot PTM usage across all contrasts in multi-panel layout — n_to_c_usage_multicontrast","text":"","code":"# data(combined_diff_data) # result <- n_to_c_usage_multicontrast(combined_diff_data, #   max_plots = 50, include_proteins = c(\"Q64337\")) # print(result$plot[[1]])  # Display first protein's multi-contrast plot"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","title":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","text":"function computes position weight matrices (PWMs) upregulated downregulated sites, calculates difference (- ). Positive values indicate amino acids enriched upregulated sites, negative values indicate enrichment downregulated sites. approach particularly useful : Identifying kinases opposing activity changes Detecting motif shifts conditions Highlighting position-specific amino acid preferences","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","text":"","code":"plot_diff_logo(sig_sites)"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","text":"sig_sites data frame containing significant phosphorylation sites following required columns: contrast Character. name experimental contrast     (e.g., \"KO_vs_WT\") regulation Character. Either \"upregulated\" \"downregulated\" SequenceWindow Character. amino acid sequence window     surrounding phosphorylation site (typically 15 amino acids     centered modified residue)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","text":"ggplot2 object created ggseqlogo showing difference   logos contrast. Returns NULL contrasts   upregulated downregulated sequences.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","text":"Creates difference sequence logo plot visualizes difference amino acid frequencies upregulated downregulated phosphorylation sites. visualization helps identify kinase-specific motifs differentially regulated experimental conditions. difference PWM calculated : $$PWM_{diff} = PWM_{} - PWM_{}$$ position sequence window, function calculates frequency 20 standard amino acids. difference frequencies visualized using 'custom' method ggseqlogo, : Letters baseline (positive values) enriched     upregulated sites Letters baseline (negative values) enriched     downregulated sites Letter height corresponds magnitude frequency     difference","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Difference Sequence Logo (Upregulated - Downregulated) — plot_diff_logo","text":"","code":"# Create example data with phosphorylation site motifs sig_sites <- data.frame(   contrast = rep(\"KO_vs_WT\", 20),   regulation = rep(c(\"upregulated\", \"downregulated\"), each = 10),   SequenceWindow = c(     # Upregulated: Proline-directed (CDK-like: S/T-P-x-K)     \"AAATPASPLTPGKRA\", \"GGGKSPVSPLTPGKR\", \"AAATPASPLTPGKRA\",     \"LLLSQVSPKTPAAAA\", \"AAATPASPLTPGKRA\", \"GGGKSPVSPLTPGKR\",     \"VVKTPASPLTPGKRA\", \"AAATPASPLTPGKRA\", \"LLLSQVSPKTPAAAA\",     \"GGGKSPVSPLTPGKR\",      # Downregulated: Basophilic (PKA-like: R-R-x-S)     \"LRRRRSLAAAGKPAA\", \"GGRRRASVAAAGKPA\", \"LRRRRSLAAAGKPAA\",     \"GKRRRSSLAAAGKPA\", \"LRRRRSLAAAGKPAA\", \"GGRRRASVAAAGKPA\",     \"DKRRRSSLAAAGKPA\", \"LRRRRSLAAAGKPAA\", \"GKRRRSSLAAAGKPA\",     \"GGRRRASVAAAGKPA\"   ) )  # Generate difference logo diff_plot <- plot_diff_logo(sig_sites) #> Warning: `aes_string()` was deprecated in ggplot2 3.0.0. #> ℹ Please use tidy evaluation idioms with `aes()`. #> ℹ See also `vignette(\"ggplot2-in-packages\")` for more information. #> ℹ The deprecated feature was likely used in the ggseqlogo package. #>   Please report the issue at <https://github.com/omarwagih/ggseqlogo/issues>. print(diff_plot)"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","title":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","text":"Creates 3-column sequence logo plot showing upregulated sites, downregulated sites, difference (- ) contrast. difference column uses independent y-axis scale appropriate showing positive negative frequency differences.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","text":"","code":"plot_seqlogo_with_diff(sig_sites)"},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","text":"sig_sites data frame containing significant phosphorylation sites required columns: contrast, regulation, SequenceWindow.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","text":"patchwork object combining sequence logos 3 columns per   contrast row: upregulated, downregulated, difference logos.   Returns NULL contrasts upregulated   downregulated sequences.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","text":"contrast, three sequence logos displayed: Upregulated: Amino acid frequencies sites increased     phosphorylation (y-axis: 0-1) Downregulated: Amino acid frequencies sites decreased     phosphorylation (y-axis: 0-1) Difference: difference frequencies (- ),     positive values indicate enrichment upregulated sites (y-axis: symmetric     around 0)","code":""},{"path":[]},{"path":"https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Sequence Logos with Difference Column — plot_seqlogo_with_diff","text":"","code":"# Create example data with phosphorylation site motifs sig_sites <- data.frame(   contrast = rep(\"KO_vs_WT\", 20),   regulation = rep(c(\"upregulated\", \"downregulated\"), each = 10),   SequenceWindow = c(     # Upregulated: Proline-directed (CDK-like: S/T-P-x-K)     \"AAATPASPLTPGKRA\", \"GGGKSPVSPLTPGKR\", \"AAATPASPLTPGKRA\",     \"LLLSQVSPKTPAAAA\", \"AAATPASPLTPGKRA\", \"GGGKSPVSPLTPGKR\",     \"VVKTPASPLTPGKRA\", \"AAATPASPLTPGKRA\", \"LLLSQVSPKTPAAAA\",     \"GGGKSPVSPLTPGKR\",      # Downregulated: Basophilic (PKA-like: R-R-x-S)     \"LRRRRSLAAAGKPAA\", \"GGRRRASVAAAGKPA\", \"LRRRRSLAAAGKPAA\",     \"GKRRRSSLAAAGKPA\", \"LRRRRSLAAAGKPAA\", \"GGRRRASVAAAGKPA\",     \"DKRRRSSLAAAGKPA\", \"LRRRRSLAAAGKPAA\", \"GKRRRSSLAAAGKPA\",     \"GGRRRASVAAAGKPA\"   ) )  # Generate 3-column layout: Up, Down, Difference p <- plot_seqlogo_with_diff(sig_sites) print(p)"},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_n_to_c_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare data for N-to-C plotting — prepare_n_to_c_data","title":"Prepare data for N-to-C plotting — prepare_n_to_c_data","text":"Prepare data N--C plotting","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_n_to_c_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare data for N-to-C plotting — prepare_n_to_c_data","text":"","code":"prepare_n_to_c_data(poi_matrix_min, model_site = \"model_site\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_n_to_c_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare data for N-to-C plotting — prepare_n_to_c_data","text":"poi_matrix_min data.frame phosphorylation data","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_n_to_c_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare data for N-to-C plotting — prepare_n_to_c_data","text":"data.frame prepared data plotting","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/prepare_n_to_c_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare data for N-to-C plotting — prepare_n_to_c_data","text":"","code":"# example code data(exampleN_C_dat) poi_matrix_min <- prepare_n_to_c_data(exampleN_C_dat)"},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_data_prep.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare data for PTM-SEA analysis — ptmsea_data_prep","title":"Prepare data for PTM-SEA analysis — ptmsea_data_prep","text":"Converts phosphosite data list named vectors suitable GSEA. contrast produces one named vector names site IDs PTMsigDB format (SEQUENCE-p) values t-statistics (ranking metric).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_data_prep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare data for PTM-SEA analysis — ptmsea_data_prep","text":"","code":"ptmsea_data_prep(   data,   stat_column,   seq_window_col = \"SequenceWindow\",   contrast_col = \"contrast\",   trim_to = c(\"11\", \"13\", \"15\") )"},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_data_prep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare data for PTM-SEA analysis — ptmsea_data_prep","text":"data data.frame containing phosphosite data statistics per contrast stat_column Character. Column name ranking statistic. Use \"statistic.site\" DPA \"tstatistic_I\" DPU. seq_window_col Character. Column name sequence windows. Default \"SequenceWindow\". contrast_col Character. Column name contrasts. Default \"contrast\". trim_to Character. Trim flanking sequences width. Options: \"11\" (default), \"13\", \"15\" (trimming). Trimming increases overlap PTMsigDB.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_data_prep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare data for PTM-SEA analysis — ptmsea_data_prep","text":"List two elements: ranks: Named list named numeric vectors (one per contrast) dropped: Named list dropped duplicates (one per contrast duplicates)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_data_prep.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare data for PTM-SEA analysis — ptmsea_data_prep","text":"","code":"# Prepare mock data data <- data.frame(   contrast = c(\"A\", \"A\", \"B\", \"B\"),   SequenceWindow = c(\"AAAAAAASAAAAAAA\", \"BBBBBBBSBBBBBBB\", \"AAAAAAASAAAAAAA\", \"CCCCCCCSCCCCCCC\"),   statistic.site = c(2.5, 1.5, -2.0, -1.0),   stringsAsFactors = FALSE )  # Prepare DPA data using t-statistic for ranking prep_dpa <- ptmsea_data_prep(data, stat_column = \"statistic.site\") prep_dpa$ranks # ranked lists per contrast #> $A #> AAAAASAAAAA-p BBBBBSBBBBB-p  #>           2.5           1.5  #>  #> $B #> CCCCCSCCCCC-p AAAAASAAAAA-p  #>            -1            -2  #>  prep_dpa$dropped # duplicates that were dropped #> list()  # Trim to 13-mer to potentially increase PTMsigDB overlap prep_dpa_13 <- ptmsea_data_prep(data, stat_column = \"statistic.site\", trim_to = \"13\")"},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_ora_prep.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare data for PTM-SEA ORA analysis — ptmsea_ora_prep","title":"Prepare data for PTM-SEA ORA analysis — ptmsea_ora_prep","text":"Prepares enriched background site lists -representation analysis. fc_col provided, significant sites split sets. sites intersect PTMsigDB included.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_ora_prep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare data for PTM-SEA ORA analysis — ptmsea_ora_prep","text":"","code":"ptmsea_ora_prep(   data,   ptmsigdb_sites,   score_col,   fc_col = NULL,   seq_window_col = \"SequenceWindow\",   threshold = 0.05,   trim_to = c(\"11\", \"13\", \"15\") )"},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_ora_prep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare data for PTM-SEA ORA analysis — ptmsea_ora_prep","text":"data data.frame flanking sequences, scores, optionally fold changes ptmsigdb_sites Character vector. Site IDs PTMsigDB (stripped, without ;u/;d). Use unique(gsub(\";[ud]$\", \"\", unlist(pathways))). score_col Character. Column significance score (e.g., \"FDR_I\"). fc_col Character NULL. Column fold change. provided, returns separate enriched_up enriched_down. Default NULL. seq_window_col Character. Column flanking sequences. Default \"SequenceWindow\". threshold Numeric. Significance threshold score_col. Default 0.05. trim_to Character. Trim width: \"11\" (default), \"13\", \"15\".","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsea_ora_prep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare data for PTM-SEA ORA analysis — ptmsea_ora_prep","text":"List enriched (enriched_up/enriched_down fc_col) background.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsigdb_to_term2gene.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert PTMsigDB pathways to TERM2GENE format — ptmsigdb_to_term2gene","title":"Convert PTMsigDB pathways to TERM2GENE format — ptmsigdb_to_term2gene","text":"Converts pathway list fgsea::gmtPathways() data.frame format required clusterProfiler::enricher.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsigdb_to_term2gene.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert PTMsigDB pathways to TERM2GENE format — ptmsigdb_to_term2gene","text":"","code":"ptmsigdb_to_term2gene(pathways)"},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsigdb_to_term2gene.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert PTMsigDB pathways to TERM2GENE format — ptmsigdb_to_term2gene","text":"pathways Named list pathways (fgsea::gmtPathways)","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/ptmsigdb_to_term2gene.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert PTMsigDB pathways to TERM2GENE format — ptmsigdb_to_term2gene","text":"data.frame columns: term, gene","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/read_kinase_motifs_csv.html","id":null,"dir":"Reference","previous_headings":"","what":"Read kinase motifs from CSV — read_kinase_motifs_csv","title":"Read kinase motifs from CSV — read_kinase_motifs_csv","text":"Helper function load custom motif database file.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/read_kinase_motifs_csv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read kinase motifs from CSV — read_kinase_motifs_csv","text":"","code":"read_kinase_motifs_csv(file)"},{"path":"https://prolfqua.github.io/prophosqua/reference/read_kinase_motifs_csv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read kinase motifs from CSV — read_kinase_motifs_csv","text":"file Path CSV file. Expected columns: \"kinase_group\", \"motif_name\", \"pattern\", \"description\".","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/read_kinase_motifs_csv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read kinase motifs from CSV — read_kinase_motifs_csv","text":"data.frame suitable `scan_motifs` `get_kinase_motifs(extra_motifs=...)`","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_motif_gsea.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Motif-based GSEA — run_motif_gsea","title":"Run Motif-based GSEA — run_motif_gsea","text":"Run Motif-based GSEA","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_motif_gsea.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Motif-based GSEA — run_motif_gsea","text":"","code":"run_motif_gsea(   ranks_list,   motif_term2gene,   min_size = 3,   max_size = 5000,   n_perm = 1000,   pvalueCutoff = 0.1 )"},{"path":"https://prolfqua.github.io/prophosqua/reference/run_motif_gsea.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Motif-based GSEA — run_motif_gsea","text":"ranks_list Named list named numeric vectors (stats per contrast). motif_term2gene data.frame `scan_motifs`. min_size Minimum set size. max_size Maximum set size. n_perm Number permutations. pvalueCutoff P-value cutoff.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_motif_gsea.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Motif-based GSEA — run_motif_gsea","text":"List GSEA results.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_motif_gsea.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Motif-based GSEA — run_motif_gsea","text":"","code":"# Mock data: 100 sequences, first 10 weighted to include PKA motifs seqs <- paste0(\"SEQ\", 1:100, \"-p\") ranks <- rnorm(100) # Make top ranked sequences PKA-like (MotifA) ranks[1:5] <- c(3.0, 2.5, 2.0, 1.9, 1.8) names(ranks) <- seqs ranks <- sort(ranks, decreasing = TRUE) rankList <- list(contrast1 = ranks)  # Define MotifA as PKA-like sequences (matches SEQ1-SEQ5) motif_term2gene <- data.frame(   term = rep(\"MotifA_PKA\", 5),   gene = seqs[1:5],   stringsAsFactors = FALSE )  # Run GSEA res <- run_motif_gsea(rankList, motif_term2gene, min_size = 3, pvalueCutoff = 1.0) #>"},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PTM-SEA without direction — run_ptmsea","title":"Run PTM-SEA without direction — run_ptmsea","text":"Runs GSEA PTMsigDB pathways, ignoring direction suffixes (;u/;d).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PTM-SEA without direction — run_ptmsea","text":"","code":"run_ptmsea(   ranks_list,   pathways,   min_size = 3,   max_size = 500,   n_perm = 1000,   pvalueCutoff = 0.1 )"},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PTM-SEA without direction — run_ptmsea","text":"ranks_list Named list ranked vectors ptmsea_data_prep(). pathways List pathways fgsea::gmtPathways(). min_size Integer. Minimum pathway size. Default 3. max_size Integer. Maximum pathway size. Default 500. n_perm Integer. Number permutations. Default 1000. pvalueCutoff Numeric. Adjusted p-value cutoff. Default 0.1.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run PTM-SEA without direction — run_ptmsea","text":"Named list clusterProfiler gseaResult objects (one per contrast).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea_up_down.html","id":null,"dir":"Reference","previous_headings":"","what":"Run directional PTM-SEA analysis — run_ptmsea_up_down","title":"Run directional PTM-SEA analysis — run_ptmsea_up_down","text":"Splits PTMsigDB pathways direction (/) runs fgsea twice per contrast (ascending descending rank order).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea_up_down.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run directional PTM-SEA analysis — run_ptmsea_up_down","text":"","code":"run_ptmsea_up_down(   ranks_list,   pathways,   min_size = 3,   max_size = 500,   n_perm = 1000,   pvalueCutoff = 0.1 )"},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea_up_down.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run directional PTM-SEA analysis — run_ptmsea_up_down","text":"ranks_list Named list named numeric vectors ptmsea_data_prep(). pathways Named list pathway definitions (e.g., fgsea::gmtPathways()). min_size Integer. Minimum pathway size. Default 3. max_size Integer. Maximum pathway size. Default 500. n_perm Integer. Number permutations. Default 1000. pvalueCutoff Numeric. Adjusted p-value cutoff. Default 0.1.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/run_ptmsea_up_down.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run directional PTM-SEA analysis — run_ptmsea_up_down","text":"Named list clusterProfiler gseaResult objects, named <contrast>_<ascending/descending>.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/scan_motifs.html","id":null,"dir":"Reference","previous_headings":"","what":"Scan sequences for kinase motifs — scan_motifs","title":"Scan sequences for kinase motifs — scan_motifs","text":"Scans vector sequences database regex motifs. Generates TERM2GENE data.frame GSEA/Enrichment analysis.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/scan_motifs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scan sequences for kinase motifs — scan_motifs","text":"","code":"scan_motifs(sequences, motif_db = get_kinase_motifs(), center_pos = 8L)"},{"path":"https://prolfqua.github.io/prophosqua/reference/scan_motifs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scan sequences for kinase motifs — scan_motifs","text":"sequences Character vector sequences (e.g., 15-mers). motif_db data.frame motifs (must 'motif_name' 'pattern' columns). Defaults `get_kinase_motifs()`. center_pos Integer. Index central phosphosite sequence. NULL, matches anywhere. provided, regex match MUST include/overlap position. Default 8 (15-mers).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/scan_motifs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scan sequences for kinase motifs — scan_motifs","text":"data.frame columns 'term' (motif name) 'gene' (sequence ID).         Sequence ID original sequence \"-p\" appended (std PTMSEA format).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/scan_motifs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scan sequences for kinase motifs — scan_motifs","text":"","code":"# Create some mock sequences (15-mers) # PKA_AKT_consensus pattern: \"R.R..[ST].....\" # To center S at 8, the pattern R.R..S must match indices 3-13. # We'll create sequences with R at 3 and 5, and S at 8.  seqs <- c(   \"GGRRRGSEVVVAAAA\", # Matches PKA (R at 3,5, S at 8)   \"LARRRASVAQLTTAA\", # Matches PKA   \"AARARAASVAAAAAA\", # Matches PKA   \"RRRRAASVAAAAAAA\", # Matches PKA and others   \"GGGGGGSGGGGGGGG\" # Non-match control )  motif_db <- get_kinase_motifs() res <- scan_motifs(seqs, motif_db) head(res) #>                term              gene #> 1 PKA_AKT_consensus AARARAASVAAAAAA-p #> 2             CAMK2 AARARAASVAAAAAA-p"},{"path":"https://prolfqua.github.io/prophosqua/reference/split_ptmsigdb_pathways.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PTM-SEA analysis — split_ptmsigdb_pathways","title":"Run PTM-SEA analysis — split_ptmsigdb_pathways","text":"Applies fgsea contrast's ranked site list PTMsigDB pathways.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/split_ptmsigdb_pathways.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PTM-SEA analysis — split_ptmsigdb_pathways","text":"","code":"split_ptmsigdb_pathways(pathways)"},{"path":"https://prolfqua.github.io/prophosqua/reference/split_ptmsigdb_pathways.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PTM-SEA analysis — split_ptmsigdb_pathways","text":"pathways Named list pathway definitions (e.g., fgsea::gmtPathways()). ranks_list Named list named numeric vectors ptmsea_data_prep(). min_size Integer. Minimum pathway size. Default 3. max_size Integer. Maximum pathway size. Default 500. n_perm Integer. Number permutations. Default 1000.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/split_ptmsigdb_pathways.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run PTM-SEA analysis — split_ptmsigdb_pathways","text":"Named list fgsea result data.frames, one per contrast.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/split_ptmsigdb_pathways.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run PTM-SEA analysis — split_ptmsigdb_pathways","text":"","code":"# Mock ranked lists # Must have > 10 overlap with pathways to run seqs <- paste0(\"SEQ\", 1:15, \"-p\") rank_vec <- setNames(rnorm(15), seqs) ranks_list <- list(contrast1 = sort(rank_vec, decreasing = TRUE))  # Mock pathways # Create pathways that overlap with the sequences pathways <- list(   PathwayA = seqs[1:10],   PathwayB = seqs[6:15] )  # Run PTM-SEA (adjusting min_size for small mock data) results <- run_ptmsea(ranks_list, pathways, min_size = 1, pvalueCutoff = 1.0) #> Running PTM-SEA for 'contrast1' (15 sites, 15 overlap)"},{"path":"https://prolfqua.github.io/prophosqua/reference/test_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"compute MSstats like test statsitics — test_diff","title":"compute MSstats like test statsitics — test_diff","text":"compute MSstats like test statsitics","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/test_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"compute MSstats like test statsitics — test_diff","text":"","code":"test_diff(   phos_res,   tot_res,   join_column = c(\"protein_Id\", \"contrast\", \"description\", \"protein_length\",     \"nr_tryptic_peptides\") )"},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_flanking_seq.html","id":null,"dir":"Reference","previous_headings":"","what":"Trim flanking sequence to specified width — trim_flanking_seq","title":"Trim flanking sequence to specified width — trim_flanking_seq","text":"Trims flanking sequence centered phosphosite (position 8 15-mer). Removes equal amino acids N C termini.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_flanking_seq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trim flanking sequence to specified width — trim_flanking_seq","text":"","code":"trim_flanking_seq(seq, trim_to = 15L)"},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_flanking_seq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trim flanking sequence to specified width — trim_flanking_seq","text":"seq Character. Flanking sequence (15-mer expected). trim_to Integer. Target width: 15 (trim), 13, 11. Default 15.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_flanking_seq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trim flanking sequence to specified width — trim_flanking_seq","text":"Character. Trimmed sequence.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_ptmsigdb_pathways.html","id":null,"dir":"Reference","previous_headings":"","what":"Trim PTMsigDB pathways to shorter flanking sequences — trim_ptmsigdb_pathways","title":"Trim PTMsigDB pathways to shorter flanking sequences — trim_ptmsigdb_pathways","text":"Trims site IDs PTMsigDB pathways specified width. Use trimming data ptmsea_data_prep(trim_to=...) ensure sides match.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_ptmsigdb_pathways.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trim PTMsigDB pathways to shorter flanking sequences — trim_ptmsigdb_pathways","text":"","code":"trim_ptmsigdb_pathways(pathways, trim_to = c(\"11\", \"13\", \"15\"))"},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_ptmsigdb_pathways.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trim PTMsigDB pathways to shorter flanking sequences — trim_ptmsigdb_pathways","text":"pathways Named list pathways fgsea::gmtPathways(). trim_to Character. Target width: \"11\" (default), \"13\", \"15\" (trim).","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_ptmsigdb_pathways.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trim PTMsigDB pathways to shorter flanking sequences — trim_ptmsigdb_pathways","text":"Named list pathways trimmed site IDs.","code":""},{"path":"https://prolfqua.github.io/prophosqua/reference/trim_ptmsigdb_pathways.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Trim PTMsigDB pathways to shorter flanking sequences — trim_ptmsigdb_pathways","text":"","code":"# Mock pathways pathways <- list(   PathwayA = c(\"AAAAAAASAAAAAAA-p\", \"BBBBBBBSBBBBBBB-p\"),   PathwayB = c(\"CCCCCCCSCCCCCCC-p\") )  # Trim to 11-mer pathways_11 <- trim_ptmsigdb_pathways(pathways, trim_to = \"11\")"}]
