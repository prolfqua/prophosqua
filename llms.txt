# prophosqua

**Integration of phosphoproteome and total proteome data for
comprehensive PTM analysis**

The `prophosqua` package provides tools for integrating and analyzing
post-translational modification (PTM) data with total proteome
measurements. It enables researchers to distinguish between changes in
protein abundance and changes in modification site usage, providing
deeper insights into cellular signaling and regulation.

## Overview

`prophosqua` builds upon the `prolfqua` and `prolfquapp` packages to
provide:

- **Differential PTM Feature Expression (DPE)** - Analysis of
  modification site abundance changes
- **Differential PTM Feature Usage (DPU)** - Analysis of modification
  site usage relative to total protein
- **N-to-C plots** - Visualization of phosphorylation sites along
  protein backbones
- **Sequence logo analysis** - Identification of kinase recognition
  motifs
- **Statistical integration** - Combined analysis of phosphoproteome and
  total proteome data

## Installation

### Prerequisites

This package depends on several other packages that should be installed
first:

``` r

# Install prolfqua (core proteomics analysis package)
library(devtools)
devtools::install_github('protviz/prozor', dependencies = TRUE)
devtools::install_github('prolfqua/prolfqua', dependencies = TRUE)
# Install prolfquapp (proteomics analysis workflow package)
devtools::install_github('prolfqua/prolfquapp', dependencies = TRUE)
```

For detailed installation instructions and system requirements, see: -
[prolfqua GitHub repository](https://github.com/prolfqua/prolfqua) -
[prolfquapp GitHub repository](https://github.com/prolfqua/prolfquapp)

### Install prophosqua

``` r

library(devtools)
devtools::install_github('prolfqua/prophosqua', dependencies = TRUE)
```

## Usage

### Basic Workflow

1.  **Run differential expression analysis** using `prolfquapp` for both
    total proteome and PTM data
2.  **Integrate the results** using
    [`prophosqua::test_diff()`](https://prolfqua.github.io/prophosqua/reference/test_diff.md)
3.  **Visualize the data** with N-to-C plots and sequence logos
4.  **Generate comprehensive reports** with statistical summaries

### Example

``` r

library(prophosqua)

# Load your data
tot_res <- load_and_preprocess_data(total_proteome_file, required_cols)
phospho_res <- load_and_preprocess_data(ptm_file, required_cols)

# Integrate analysis
combined_test_diff <- test_diff(phospho_res, tot_res, join_column = join_column)

# Create visualizations
plot_data <- n_to_c_usage(combined_test_diff, contrast_name, FDR_threshold = 0.05)
```

## Vignettes and Documentation

The package includes comprehensive vignettes that demonstrate the
complete analysis workflow:

### Rendering Vignettes

The following code renders the vignettes and copies them to the example
directory:

``` r

# Render the differential expression analysis vignette

wd <- "inst/PTM_analysis_example"


rmarkdown::render("vignettes/QCReport.qmd",
params=list(wd=wd,
psm="ptm_example-main/qc_example_data/QCmini/psm.tsv",
fasta="ptm_example-main/qc_example_data/fgcz_3702_UP000006548_AraUniprot_1spg_d_20231024.fasta",
workunit="exampleQC",
projectid="ABCD1234"))
file.copy("vignettes/QCReport.html", file.path(wd,"QCReport.html"))

# Render the PTM integration and visualization vignette  
rmarkdown::render("vignettes/Supplementary_Material_v2.Rmd",
params=list(wd = wd, dodea = TRUE), output_format=bookdown::pdf_document2())
file.copy("vignettes/Supplementary_Material_v2.pdf", file.path(wd,"Supplementary_Material_v2.pdf"))

rmarkdown::render("vignettes/Supplementary_Material_v2.Rmd",
params=list(wd = wd, dodea = FALSE), output_format=bookdown::html_document2())
file.copy("vignettes/Supplementary_Material_v2.html", file.path(wd,"Supplementary_Material_v2.html"))
```

This code: 1. **Renders R Markdown files** to HTML using
[`rmarkdown::render()`](https://pkgs.rstudio.com/rmarkdown/reference/render.html)
2. **Copies the HTML files** to the `inst/PTM_analysis_example/`
directory for easy access 3. **Creates interactive reports** with code
folding and navigation

### Available Vignettes

- **`Run_DEA_prolfquapp.Rmd`** - Complete workflow for differential
  expression analysis
- **`Visualize_PTM_features.Rmd`** - Integration and visualization of
  PTM data
- **Interactive reports** - Available in the
  `inst/PTM_analysis_example/` directory

## Related Publications

### Core Dependencies

- **prolfqua**: [Proteomics data analysis in
  R](https://www.sciencedirect.com/science/article/pii/S1535947622002857) -
  MSstatsPTM publication
- **prolfquapp**: [Proteomics analysis workflow
  package](https://www.sciencedirect.com/science/article/pii/S1535947623002190) -
  msqrob2PTM publication

### Related Work

- [MSstatsPTM](https://www.sciencedirect.com/science/article/pii/S1535947622002857) -
  Statistical analysis of PTM data
- [msqrob2PTM](https://www.sciencedirect.com/science/article/pii/S1535947623002190) -
  Robust statistical methods for PTM analysis

## GitHub Repositories

- [prolfqua](https://github.com/prolfqua/prolfqua) - Core proteomics
  analysis package
- [prolfquapp](https://github.com/prolfqua/prolfquapp) - Proteomics
  analysis workflow package
- [prophosqua](https://github.com/prolfqua/prophosqua) - PTM integration
  and analysis package

## Poster

[Prophosqua Poster from SIBDays
2024](https://prolfqua.github.io/prophosqua/img/SIBDays24_Poster_Prophosqua_Grossmann.pdf)

## Citation

If you use this package in your research, please cite:

``` bibtex
@article{prophosqua2024,
  title={prophosqua: Integration of phosphoproteome and total proteome data},
  author={Functional Genomics Center Zurich},
  journal={Bioinformatics},
  year={2024}
}
```

## Building and Deploying Documentation

### Build pkgdown site locally

``` r

pkgdown::build_site()
```

### Deploy to GitHub Pages

``` bash
# Using ghp-import (via uv)
uvx ghp-import -n -p -f docs
```

Then enable GitHub Pages in repo settings (Settings → Pages → Source:
`gh-pages` branch).

Site: <https://prolfqua.github.io/prophosqua>

## Contributing

Contributions are welcome! Please visit our [GitHub
repository](https://github.com/prolfqua/prophosqua) for: - Issue
reporting - Feature requests - Code contributions - Documentation
improvements

## License

This package is released under the [MIT
License](https://prolfqua.github.io/prophosqua/LICENSE).

# Package index

## All functions

- [`copy_phospho_integration()`](https://prolfqua.github.io/prophosqua/reference/copy_phospho_integration.md)
  : copy Markdown and runscript for FragPipe combined_protein.tsv
- [`dea_res_dir()`](https://prolfqua.github.io/prophosqua/reference/dea_res_dir.md)
  : get xlsx path
- [`dea_xlsx_path()`](https://prolfqua.github.io/prophosqua/reference/dea_xlsx_path.md)
  : get xlsx path
- [`derive_motifs_from_gmt()`](https://prolfqua.github.io/prophosqua/reference/derive_motifs_from_gmt.md)
  : Derive motifs from PTMsigDB GMT file
- [`.test_diff_diff()`](https://prolfqua.github.io/prophosqua/reference/dot-test_diff_diff.md)
  : Test if differences of differences are significant
- [`download_ptmsigdb()`](https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.md)
  : Download PTMsigDB signatures
- [`exampleN_C_dat`](https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat.md)
  : Example dataset exampleN_C_dat
- [`exampleN_C_dat_no_prot`](https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat_no_prot.md)
  : Example dataset exampleN_C_dat_no_prot
- [`explode_multisites()`](https://prolfqua.github.io/prophosqua/reference/explode_multisites.md)
  : each site goes into own row, if more then on site per multisite
- [`filter_contaminants()`](https://prolfqua.github.io/prophosqua/reference/filter_contaminants.md)
  : filter contaminants
- [`get_kinase_motifs()`](https://prolfqua.github.io/prophosqua/reference/get_kinase_motifs.md)
  : Get default list of kinase motifs
- [`get_sequence_windows()`](https://prolfqua.github.io/prophosqua/reference/get_sequence_windows.md)
  : extract sequence windows, from sequence at pos in protein
- [`load_and_preprocess_data()`](https://prolfqua.github.io/prophosqua/reference/load_and_preprocess_data.md)
  : load_and_preprocess_data
- [`make_fasta_summary()`](https://prolfqua.github.io/prophosqua/reference/make_fasta_summary.md)
  : Make FASTA database summary
- [`n_c_integrated_df`](https://prolfqua.github.io/prophosqua/reference/n_c_integrated_df.md)
  : Example dataset n_c_integrated_df
- [`n_to_c_expression()`](https://prolfqua.github.io/prophosqua/reference/n_to_c_expression.md)
  : Plot protein and PTM expression
- [`n_to_c_expression_multicontrast()`](https://prolfqua.github.io/prophosqua/reference/n_to_c_expression_multicontrast.md)
  : Plot protein and PTM expression across all contrasts in multi-panel
  layout
- [`n_to_c_plot()`](https://prolfqua.github.io/prophosqua/reference/n_to_c_plot.md)
  : N to C plot using ggplot2
- [`n_to_c_plot_integrated()`](https://prolfqua.github.io/prophosqua/reference/n_to_c_plot_integrated.md)
  : N to C for integrated results
- [`n_to_c_usage()`](https://prolfqua.github.io/prophosqua/reference/n_to_c_usage.md)
  : Plot PTM occupation, use after adjusting for total proteome
- [`n_to_c_usage_multicontrast()`](https://prolfqua.github.io/prophosqua/reference/n_to_c_usage_multicontrast.md)
  : Plot PTM usage across all contrasts in multi-panel layout
- [`plot_diff_logo()`](https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.md)
  : Plot Difference Sequence Logo (Upregulated - Downregulated)
- [`plot_seqlogo_with_diff()`](https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.md)
  : Plot Sequence Logos with Difference Column
- [`ptmsea_data_prep()`](https://prolfqua.github.io/prophosqua/reference/ptmsea_data_prep.md)
  : Prepare data for PTM-SEA analysis
- [`ptmsea_ora_prep()`](https://prolfqua.github.io/prophosqua/reference/ptmsea_ora_prep.md)
  : Prepare data for PTM-SEA ORA analysis
- [`ptmsigdb_to_term2gene()`](https://prolfqua.github.io/prophosqua/reference/ptmsigdb_to_term2gene.md)
  : Convert PTMsigDB pathways to TERM2GENE format
- [`read_kinase_motifs_csv()`](https://prolfqua.github.io/prophosqua/reference/read_kinase_motifs_csv.md)
  : Read kinase motifs from CSV
- [`run_motif_gsea()`](https://prolfqua.github.io/prophosqua/reference/run_motif_gsea.md)
  : Run Motif-based GSEA
- [`run_ptmsea()`](https://prolfqua.github.io/prophosqua/reference/run_ptmsea.md)
  : Run PTM-SEA without direction
- [`run_ptmsea_up_down()`](https://prolfqua.github.io/prophosqua/reference/run_ptmsea_up_down.md)
  : Run directional PTM-SEA analysis
- [`scan_motifs()`](https://prolfqua.github.io/prophosqua/reference/scan_motifs.md)
  : Scan sequences for kinase motifs
- [`split_ptmsigdb_pathways()`](https://prolfqua.github.io/prophosqua/reference/split_ptmsigdb_pathways.md)
  : Run PTM-SEA analysis
- [`test_diff()`](https://prolfqua.github.io/prophosqua/reference/test_diff.md)
  : compute MSstats like test statsitics
- [`trim_ptmsigdb_pathways()`](https://prolfqua.github.io/prophosqua/reference/trim_ptmsigdb_pathways.md)
  : Trim PTMsigDB pathways to shorter flanking sequences

# Articles

### Complete Workflow

- [Integrated Analysis of Post-Translational Modifications and Total
  Proteome: Methods for Distinguishing Abundance from Usage
  Changes](https://prolfqua.github.io/prophosqua/articles/Supplementary_Material_v3.md):

### Kinase/Motif Enrichment Analysis

- [PTM-SEA: Kinase Activity Inference from Phosphoproteomics
  Data](https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.md):
- [Motif-Based Enrichment Analysis: Kinase Activity
  Inference](https://prolfqua.github.io/prophosqua/articles/Analysis_Motif_Enrichment.md):
- [Kinase Library: Kinase Activity Inference from Phosphoproteomics
  Data](https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.md):
- [Visualizing Kinase Library MEA
  Results](https://prolfqua.github.io/prophosqua/articles/Vis_MEA.md):

### Quality Control

- [FragPipe TMT
  QC](https://prolfqua.github.io/prophosqua/articles/QCReport.md):
