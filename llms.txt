# prophosqua

**Integration of phosphoproteome and total proteome data for
comprehensive PTM analysis**

The `prophosqua` package provides tools for integrating and analyzing
post-translational modification (PTM) data with total proteome
measurements. It enables researchers to distinguish between changes in
protein abundance and changes in modification site usage, providing
deeper insights into cellular signaling and regulation.

## Overview

The integrated PTM analysis is carried out using `prophosqua`, which
implements three complementary statistical approaches:

- **DPA** (Differential PTM Abundance): tests for changes in PTM-site
  intensity between conditions.
- **DPU** (Differential PTM Usage): tests whether the ratio of PTM-site
  to total protein intensity changes, identifying regulation independent
  of protein abundance.
- **CorrectFirst**: applies protein-level correction before testing PTM
  sites, an alternative approach to distinguish PTM-specific regulation
  from protein expression changes.

Building on the [prolfqua](https://github.com/prolfqua/prolfqua) and
[prolfquapp](https://github.com/prolfqua/prolfquapp) packages,
`prophosqua` additionally provides:

- **N-to-C plots** - Visualization of phosphorylation sites along
  protein backbones
- **Sequence logo analysis** - Identification of kinase recognition
  motifs
- **PTM-SEA** - Post-translational modification set enrichment analysis
- **Kinase activity inference** - Kinase library-based analysis from
  phosphoproteomics data
- **Motif enrichment analysis** - MEA visualization
- **Enrichment visualization** - Dot plots, heatmaps, and volcano plots
  for enrichment results

## Installation

### Prerequisites

This package depends on several other packages that should be installed
first:

``` r

# Install prolfqua (core proteomics analysis package)
library(devtools)
devtools::install_github('protviz/prozor', dependencies = TRUE)
devtools::install_github('prolfqua/prolfqua', dependencies = TRUE)
# Install prolfquapp (proteomics analysis workflow package)
devtools::install_github('prolfqua/prolfquapp', dependencies = TRUE, build_vignettes=TRUE)
```

For detailed installation instructions and system requirements, see: -
[prolfqua GitHub repository](https://github.com/prolfqua/prolfqua) -
[prolfquapp GitHub repository](https://github.com/prolfqua/prolfquapp)

### Install prophosqua

``` r

library(devtools)
devtools::install_github('prolfqua/prophosqua', dependencies = TRUE, build_vignettes=TRUE)
```

## Usage

### Basic Workflow

1.  **Run differential expression analysis** using `prolfquapp` for both
    total proteome and PTM data
2.  **Integrate the results** using
    [`prophosqua::test_diff()`](https://prolfqua.github.io/prophosqua/reference/test_diff.md)
3.  **Visualize the data** with N-to-C plots and sequence logos
4.  **Generate comprehensive reports** with statistical summaries

### Example

``` r

library(prophosqua)

# Load your data
tot_res <- load_and_preprocess_data(total_proteome_file, required_cols)
phospho_res <- load_and_preprocess_data(ptm_file, required_cols)

# Integrate analysis
combined_test_diff <- test_diff(phospho_res, tot_res, join_column = join_column)

# Create visualizations
plot_data <- n_to_c_usage(combined_test_diff, contrast_name, FDR_threshold = 0.05)
```

## Vignettes

The package includes vignettes demonstrating the analysis workflow:

- **`MiMBIntegratedPTM.Rmd`** - Integrated analysis of PTM and total
  proteome (DPA, DPU, CorrectFirst)
- **`Analysis_n_to_c.Rmd`** - N-to-C plots for PTM site visualization
- **`Analysis_seqlogo.Rmd`** - Sequence logo analysis
- **`Analysis_PTMSEA.Rmd`** - PTM-SEA analysis
- **`Analysis_KinaseLibrary.Rmd`** - Kinase activity inference from
  phosphoproteomics data
- **`Analysis_MEA.Rmd`** - Motif enrichment analysis visualization
- **`QCReport.qmd`** - FragPipe TMT quality control report

## Citation

If you use this package in your research, please cite:

> Wolski W, Dittmann A, Panse C, Kunz L, Grossmann J. “Integrated
> Analysis of Post-Translational Modifications and Total Proteome:
> Methods for Distinguishing Abundance from Usage Changes.” *Methods in
> Molecular Biology*, 2025 (submitted).

> Grossmann J, Wolski W. “prolfqua/prophosqua: 0.1.0.” Zenodo, 2025.
> DOI:
> [10.5281/zenodo.15845272](https://doi.org/10.5281/zenodo.15845272)

## Related Packages

- [prolfqua](https://github.com/prolfqua/prolfqua) - Core proteomics
  analysis package
- [prolfquapp](https://github.com/prolfqua/prolfquapp) - Proteomics
  analysis workflow package

## Building and Deploying Documentation

### Build pkgdown site locally

``` r

pkgdown::build_site()
```

### Deploy to GitHub Pages

``` bash
# Using ghp-import (via uv)
uvx ghp-import -n -p -f docs
```

Then enable GitHub Pages in repo settings (Settings -\> Pages -\>
Source: `gh-pages` branch).

Site: <https://prolfqua.github.io/prophosqua>

## Contributing

Contributions are welcome! Please visit our [GitHub
repository](https://github.com/prolfqua/prophosqua) for: - Issue
reporting - Feature requests - Code contributions

## License

This package is released under the [MIT
License](https://prolfqua.github.io/prophosqua/LICENSE).

# Package index

## All functions

- [`combined_test_diff_example`](https://prolfqua.github.io/prophosqua/reference/combined_test_diff_example.md)
  : Example phosphoproteomics differential expression results
- [`copy_phospho_integration()`](https://prolfqua.github.io/prophosqua/reference/copy_phospho_integration.md)
  : copy Markdown and runscript for FragPipe combined_protein.tsv
- [`dea_res_dir()`](https://prolfqua.github.io/prophosqua/reference/dea_res_dir.md)
  : Get DEA results directory path
- [`dea_xlsx_path()`](https://prolfqua.github.io/prophosqua/reference/dea_xlsx_path.md)
  : Get DEA xlsx file path
- [`download_ptmsigdb()`](https://prolfqua.github.io/prophosqua/reference/download_ptmsigdb.md)
  : Download PTMsigDB signatures
- [`enrichment_visualization`](https://prolfqua.github.io/prophosqua/reference/enrichment_visualization.md)
  : Enrichment Visualization Functions
- [`exampleN_C_dat`](https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat.md)
  : Example dataset exampleN_C_dat
- [`exampleN_C_dat_no_prot`](https://prolfqua.github.io/prophosqua/reference/exampleN_C_dat_no_prot.md)
  : Example dataset exampleN_C_dat_no_prot
- [`explode_multisites()`](https://prolfqua.github.io/prophosqua/reference/explode_multisites.md)
  : Explode multisites into individual rows
- [`export_gsea_plots_pdf()`](https://prolfqua.github.io/prophosqua/reference/export_gsea_plots_pdf.md)
  : Export GSEA enrichment plots to PDF
- [`extract_gsea_results()`](https://prolfqua.github.io/prophosqua/reference/extract_gsea_results.md)
  : Extract results from clusterProfiler GSEA objects
- [`filter_contaminants()`](https://prolfqua.github.io/prophosqua/reference/filter_contaminants.md)
  : Filter contaminant proteins from data
- [`filter_significant_sites()`](https://prolfqua.github.io/prophosqua/reference/filter_significant_sites.md)
  : Filter significant PTM sites
- [`get_sequence_windows()`](https://prolfqua.github.io/prophosqua/reference/get_sequence_windows.md)
  : extract sequence windows, from sequence at pos in protein
- [`load_and_preprocess_data()`](https://prolfqua.github.io/prophosqua/reference/load_and_preprocess_data.md)
  : Load and preprocess DEA data from Excel
- [`make_fasta_summary()`](https://prolfqua.github.io/prophosqua/reference/make_fasta_summary.md)
  : Make FASTA database summary
- [`n_c_integrated_df`](https://prolfqua.github.io/prophosqua/reference/n_c_integrated_df.md)
  : Example dataset n_c_integrated_df
- [`n_to_c_expression()`](https://prolfqua.github.io/prophosqua/reference/n_to_c_expression.md)
  : Plot protein and PTM expression
- [`n_to_c_expression_multicontrast()`](https://prolfqua.github.io/prophosqua/reference/n_to_c_expression_multicontrast.md)
  : Plot protein and PTM expression across all contrasts in multi-panel
  layout
- [`n_to_c_plot()`](https://prolfqua.github.io/prophosqua/reference/n_to_c_plot.md)
  : N to C plot using ggplot2
- [`n_to_c_plot_integrated()`](https://prolfqua.github.io/prophosqua/reference/n_to_c_plot_integrated.md)
  : N to C plot for integrated (DPU) results
- [`n_to_c_usage()`](https://prolfqua.github.io/prophosqua/reference/n_to_c_usage.md)
  : Plot PTM occupation, use after adjusting for total proteome
- [`n_to_c_usage_multicontrast()`](https://prolfqua.github.io/prophosqua/reference/n_to_c_usage_multicontrast.md)
  : Plot PTM usage across all contrasts in multi-panel layout
- [`plot_diff_logo()`](https://prolfqua.github.io/prophosqua/reference/plot_diff_logo.md)
  : Plot Difference Sequence Logo (Upregulated - Downregulated)
- [`plot_enrichment_dotplot()`](https://prolfqua.github.io/prophosqua/reference/plot_enrichment_dotplot.md)
  : Create enrichment dotplot for top items by FDR
- [`plot_enrichment_heatmap()`](https://prolfqua.github.io/prophosqua/reference/plot_enrichment_heatmap.md)
  : Create NES heatmap for top items across contrasts
- [`plot_enrichment_volcano()`](https://prolfqua.github.io/prophosqua/reference/plot_enrichment_volcano.md)
  : Create volcano plot for enrichment results
- [`plot_seqlogo_with_diff()`](https://prolfqua.github.io/prophosqua/reference/plot_seqlogo_with_diff.md)
  : Plot Sequence Logos with Difference Column
- [`prepare_enrichment_data()`](https://prolfqua.github.io/prophosqua/reference/prepare_enrichment_data.md)
  : Prepare enrichment data with common computed columns
- [`prepare_gsea_ranks()`](https://prolfqua.github.io/prophosqua/reference/prepare_gsea_ranks.md)
  : Prepare ranked lists for GSEA analysis
- [`prepare_ntoc_data()`](https://prolfqua.github.io/prophosqua/reference/prepare_ntoc_data.md)
  : Prepare data for N-to-C plotting
- [`ptmsea_data_prep()`](https://prolfqua.github.io/prophosqua/reference/ptmsea_data_prep.md)
  : Prepare data for PTM-SEA analysis
- [`ptmsea_ora_prep()`](https://prolfqua.github.io/prophosqua/reference/ptmsea_ora_prep.md)
  : Prepare data for PTM-SEA ORA analysis
- [`ptmsigdb_to_term2gene()`](https://prolfqua.github.io/prophosqua/reference/ptmsigdb_to_term2gene.md)
  : Convert PTMsigDB pathways to TERM2GENE format
- [`run_ptmsea()`](https://prolfqua.github.io/prophosqua/reference/run_ptmsea.md)
  : Run PTM-SEA without direction
- [`run_ptmsea_up_down()`](https://prolfqua.github.io/prophosqua/reference/run_ptmsea_up_down.md)
  : Run directional PTM-SEA analysis
- [`split_ptmsigdb_pathways()`](https://prolfqua.github.io/prophosqua/reference/split_ptmsigdb_pathways.md)
  : Split PTMsigDB pathways by direction
- [`summarize_enrichment_results()`](https://prolfqua.github.io/prophosqua/reference/summarize_enrichment_results.md)
  : Create summary table for enrichment results
- [`summarize_significant_sites()`](https://prolfqua.github.io/prophosqua/reference/summarize_significant_sites.md)
  : Summarize significant sites by group
- [`test_diff()`](https://prolfqua.github.io/prophosqua/reference/test_diff.md)
  : Compute MSstats-like test statistics for differential PTM usage
- [`trim_ptmsigdb_pathways()`](https://prolfqua.github.io/prophosqua/reference/trim_ptmsigdb_pathways.md)
  : Trim PTMsigDB pathways to shorter flanking sequences
- [`validate_sequence_window()`](https://prolfqua.github.io/prophosqua/reference/validate_sequence_window.md)
  : Validate sequence window alignment

# Articles

### Methods Paper

- [Integrated Analysis of Post-Translational Modifications and Total
  Proteome: Methods for Distinguishing Abundance from Usage
  Changes](https://prolfqua.github.io/prophosqua/articles/MiMBIntegratedPTM.md):

### Analysis Vignettes

- [Kinase Library: Kinase Activity Inference from Phosphoproteomics
  Data](https://prolfqua.github.io/prophosqua/articles/Analysis_KinaseLibrary.md):
- [Motif Enrichment Analysis (MEA)
  Visualization](https://prolfqua.github.io/prophosqua/articles/Analysis_MEA.md):
- [PTM Analysis - N-to-C
  Plots](https://prolfqua.github.io/prophosqua/articles/Analysis_n_to_c.md):
- [PTM-SEA
  Analysis](https://prolfqua.github.io/prophosqua/articles/Analysis_PTMSEA.md):
- [PTM Analysis - Sequence
  Logo](https://prolfqua.github.io/prophosqua/articles/Analysis_seqlogo.md):

### Quality Control

- [FragPipe TMT
  QC](https://prolfqua.github.io/prophosqua/articles/QCReport.md):
